(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[281],{3571:function(t){/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,i){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,i)}function i(t,r,n){return(i=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,i,r){var n=[null];n.push.apply(n,i);var o=new(Function.bind.apply(t,n));return r&&e(o,r.prototype),o}:Reflect.construct).apply(null,arguments)}function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}var o,s=Object.hasOwnProperty,l=Object.setPrototypeOf,a=Object.isFrozen,h=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,c=Object.freeze,d=Object.seal,f=Object.create,g="undefined"!=typeof Reflect&&Reflect,m=g.apply,p=g.construct;m||(m=function(t,e,i){return t.apply(e,i)}),c||(c=function(t){return t}),d||(d=function(t){return t}),p||(p=function(t,e){return i(t,r(e))});var w=I(Array.prototype.forEach),b=I(Array.prototype.pop),y=I(Array.prototype.push),S=I(String.prototype.toLowerCase),C=I(String.prototype.toString),E=I(String.prototype.match),T=I(String.prototype.replace),R=I(String.prototype.indexOf),O=I(String.prototype.trim),M=I(RegExp.prototype.test),N=(o=TypeError,function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return p(o,e)});function I(t){return function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return m(t,e,r)}}function x(t,e,i){i=null!==(r=i)&&void 0!==r?r:S,l&&l(t,null);for(var r,n=e.length;n--;){var o=e[n];if("string"==typeof o){var s=i(o);s!==o&&(a(e)||(e[n]=s),o=s)}t[o]=!0}return t}function k(t){var e,i=f(null);for(e in t)!0===m(s,t,[e])&&(i[e]=t[e]);return i}function H(t,e){for(;null!==t;){var i=u(t,e);if(i){if(i.get)return I(i.get);if("function"==typeof i.value)return I(i.value)}t=h(t)}return function(t){return console.warn("fallback value for",t),null}}var _=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),A=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),P=c(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),B=c(["#text"]),W=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),V=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),j=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=d(/<%[\w\W]*|[\w\W]*%>/gm),G=d(/\${[\w\W]*}/gm),K=d(/^data-[\-\w.\u00B7-\uFFFF]/),X=d(/^aria-[\-\w]+$/),Y=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=d(/^(?:\w+script|data):/i),q=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=d(/^html$/i),Q=function(e,i){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,n="data-tt-policy-suffix";i.currentScript&&i.currentScript.hasAttribute(n)&&(r=i.currentScript.getAttribute(n));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var i,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,s=function(t){return e(t)};if(s.version="2.4.7",s.removed=[],!o||!o.document||9!==o.document.nodeType)return s.isSupported=!1,s;var l=o.document,a=o.document,DocumentFragment=o.DocumentFragment,HTMLTemplateElement=o.HTMLTemplateElement,Node=o.Node,Element=o.Element,NodeFilter=o.NodeFilter,h=o.NamedNodeMap,NamedNodeMap=void 0===h?o.NamedNodeMap||o.MozNamedAttrMap:h,HTMLFormElement=o.HTMLFormElement,DOMParser=o.DOMParser,u=o.trustedTypes,d=Element.prototype,f=H(d,"cloneNode"),g=H(d,"nextSibling"),m=H(d,"childNodes"),p=H(d,"parentNode");if("function"==typeof HTMLTemplateElement){var I=a.createElement("template");I.content&&I.content.ownerDocument&&(a=I.content.ownerDocument)}var tt=Q(u,l),te=tt?tt.createHTML(""):"",ti=a,tr=ti.implementation,tn=ti.createNodeIterator,to=ti.createDocumentFragment,ts=ti.getElementsByTagName,tl=l.importNode,ta={};try{ta=k(a).documentMode?a.documentMode:{}}catch(t){}var th={};s.isSupported="function"==typeof p&&tr&&void 0!==tr.createHTMLDocument&&9!==ta;var tu=Y,tc=null,td=x({},[].concat(r(_),r(A),r(L),r(D),r(B))),tf=null,tg=x({},[].concat(r(W),r(V),r(j),r(U))),tm=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tp=null,tv=null,tw=!0,tb=!0,ty=!1,tS=!0,tC=!1,tE=!1,tT=!1,tR=!1,tO=!1,tM=!1,tN=!1,tI=!0,tx=!1,tk=!0,tH=!1,t_={},tA=null,tL=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tP=null,tD=x({},["audio","video","img","source","image","track"]),tF=null,tB=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tW="http://www.w3.org/1998/Math/MathML",tV="http://www.w3.org/2000/svg",tj="http://www.w3.org/1999/xhtml",tU=tj,t$=!1,tz=null,tG=x({},[tW,tV,tj],C),tK=["application/xhtml+xml","text/html"],tX=null,tY=a.createElement("form"),tZ=function(t){return t instanceof RegExp||t instanceof Function},tq=function(e){tX&&tX===e||(e&&"object"===t(e)||(e={}),e=k(e),n="application/xhtml+xml"===(i=i=-1===tK.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?C:S,tc="ALLOWED_TAGS"in e?x({},e.ALLOWED_TAGS,n):td,tf="ALLOWED_ATTR"in e?x({},e.ALLOWED_ATTR,n):tg,tz="ALLOWED_NAMESPACES"in e?x({},e.ALLOWED_NAMESPACES,C):tG,tF="ADD_URI_SAFE_ATTR"in e?x(k(tB),e.ADD_URI_SAFE_ATTR,n):tB,tP="ADD_DATA_URI_TAGS"in e?x(k(tD),e.ADD_DATA_URI_TAGS,n):tD,tA="FORBID_CONTENTS"in e?x({},e.FORBID_CONTENTS,n):tL,tp="FORBID_TAGS"in e?x({},e.FORBID_TAGS,n):{},tv="FORBID_ATTR"in e?x({},e.FORBID_ATTR,n):{},t_="USE_PROFILES"in e&&e.USE_PROFILES,tw=!1!==e.ALLOW_ARIA_ATTR,tb=!1!==e.ALLOW_DATA_ATTR,ty=e.ALLOW_UNKNOWN_PROTOCOLS||!1,tS=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,tC=e.SAFE_FOR_TEMPLATES||!1,tE=e.WHOLE_DOCUMENT||!1,tO=e.RETURN_DOM||!1,tM=e.RETURN_DOM_FRAGMENT||!1,tN=e.RETURN_TRUSTED_TYPE||!1,tR=e.FORCE_BODY||!1,tI=!1!==e.SANITIZE_DOM,tx=e.SANITIZE_NAMED_PROPS||!1,tk=!1!==e.KEEP_CONTENT,tH=e.IN_PLACE||!1,tu=e.ALLOWED_URI_REGEXP||tu,tU=e.NAMESPACE||tj,tm=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&tZ(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tm.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&tZ(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tm.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(tm.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tC&&(tb=!1),tM&&(tO=!0),t_&&(tc=x({},r(B)),tf=[],!0===t_.html&&(x(tc,_),x(tf,W)),!0===t_.svg&&(x(tc,A),x(tf,V),x(tf,U)),!0===t_.svgFilters&&(x(tc,L),x(tf,V),x(tf,U)),!0===t_.mathMl&&(x(tc,D),x(tf,j),x(tf,U))),e.ADD_TAGS&&(tc===td&&(tc=k(tc)),x(tc,e.ADD_TAGS,n)),e.ADD_ATTR&&(tf===tg&&(tf=k(tf)),x(tf,e.ADD_ATTR,n)),e.ADD_URI_SAFE_ATTR&&x(tF,e.ADD_URI_SAFE_ATTR,n),e.FORBID_CONTENTS&&(tA===tL&&(tA=k(tA)),x(tA,e.FORBID_CONTENTS,n)),tk&&(tc["#text"]=!0),tE&&x(tc,["html","head","body"]),tc.table&&(x(tc,["tbody"]),delete tp.tbody),c&&c(e),tX=e)},tJ=x({},["mi","mo","mn","ms","mtext"]),tQ=x({},["foreignobject","desc","title","annotation-xml"]),t0=x({},["title","style","font","a","script"]),t1=x({},A);x(t1,L),x(t1,P);var t2=x({},D);x(t2,F);var t9=function(t){var e=p(t);e&&e.tagName||(e={namespaceURI:tU,tagName:"template"});var r=S(t.tagName),n=S(e.tagName);return!!tz[t.namespaceURI]&&(t.namespaceURI===tV?e.namespaceURI===tj?"svg"===r:e.namespaceURI===tW?"svg"===r&&("annotation-xml"===n||tJ[n]):!!t1[r]:t.namespaceURI===tW?e.namespaceURI===tj?"math"===r:e.namespaceURI===tV?"math"===r&&tQ[n]:!!t2[r]:t.namespaceURI===tj?(e.namespaceURI!==tV||!!tQ[n])&&(e.namespaceURI!==tW||!!tJ[n])&&!t2[r]&&(t0[r]||!t1[r]):"application/xhtml+xml"===i&&!!tz[t.namespaceURI])},t4=function(t){y(s.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=te}catch(e){t.remove()}}},t8=function(t,e){try{y(s.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){y(s.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!tf[t]){if(tO||tM)try{t4(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}}},t7=function(t){if(tR)t="<remove></remove>"+t;else{var e,r,n=E(t,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===i&&tU===tj&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=tt?tt.createHTML(t):t;if(tU===tj)try{e=new DOMParser().parseFromString(o,i)}catch(t){}if(!e||!e.documentElement){e=tr.createDocument(tU,"template",null);try{e.documentElement.innerHTML=t$?te:o}catch(t){}}var s=e.body||e.documentElement;return(t&&r&&s.insertBefore(a.createTextNode(r),s.childNodes[0]||null),tU===tj)?ts.call(e,tE?"html":"body")[0]:tE?e.documentElement:s},t3=function(t){return tn.call(t.ownerDocument||t,t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,null,!1)},t5=function(e){return"object"===t(Node)?e instanceof Node:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},t6=function(t,e,i){th[t]&&w(th[t],function(t){t.call(s,e,i,tX)})},et=function(t){if(t6("beforeSanitizeElements",t,null),t instanceof HTMLFormElement&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof NamedNodeMap)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)||M(/[\u0080-\uFFFF]/,t.nodeName))return t4(t),!0;var e,i=n(t.nodeName);if(t6("uponSanitizeElement",t,{tagName:i,allowedTags:tc}),t.hasChildNodes()&&!t5(t.firstElementChild)&&(!t5(t.content)||!t5(t.content.firstElementChild))&&M(/<[/\w]/g,t.innerHTML)&&M(/<[/\w]/g,t.textContent)||"select"===i&&M(/<template/i,t.innerHTML))return t4(t),!0;if(!tc[i]||tp[i]){if(!tp[i]&&ei(i)&&(tm.tagNameCheck instanceof RegExp&&M(tm.tagNameCheck,i)||tm.tagNameCheck instanceof Function&&tm.tagNameCheck(i)))return!1;if(tk&&!tA[i]){var r=p(t)||t.parentNode,o=m(t)||t.childNodes;if(o&&r)for(var l=o.length,a=l-1;a>=0;--a)r.insertBefore(f(o[a],!0),g(t))}return t4(t),!0}return t instanceof Element&&!t9(t)||("noscript"===i||"noembed"===i||"noframes"===i)&&M(/<\/no(script|embed|frames)/i,t.innerHTML)?(t4(t),!0):(tC&&3===t.nodeType&&(e=T(e=t.textContent,$," "),e=T(e,z," "),e=T(e,G," "),t.textContent!==e&&(y(s.removed,{element:t.cloneNode()}),t.textContent=e)),t6("afterSanitizeElements",t,null),!1)},ee=function(t,e,i){if(tI&&("id"===e||"name"===e)&&(i in a||i in tY))return!1;if(tb&&!tv[e]&&M(K,e));else if(tw&&M(X,e));else if(!tf[e]||tv[e]){if(!(ei(t)&&(tm.tagNameCheck instanceof RegExp&&M(tm.tagNameCheck,t)||tm.tagNameCheck instanceof Function&&tm.tagNameCheck(t))&&(tm.attributeNameCheck instanceof RegExp&&M(tm.attributeNameCheck,e)||tm.attributeNameCheck instanceof Function&&tm.attributeNameCheck(e))||"is"===e&&tm.allowCustomizedBuiltInElements&&(tm.tagNameCheck instanceof RegExp&&M(tm.tagNameCheck,i)||tm.tagNameCheck instanceof Function&&tm.tagNameCheck(i))))return!1}else if(tF[e]);else if(M(tu,T(i,q,"")));else if(("src"===e||"xlink:href"===e||"href"===e)&&"script"!==t&&0===R(i,"data:")&&tP[t]);else if(ty&&!M(Z,T(i,q,"")));else if(i)return!1;return!0},ei=function(t){return t.indexOf("-")>0},er=function(e){t6("beforeSanitizeAttributes",e,null);var i,r,o,l,a=e.attributes;if(a){var h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:tf};for(l=a.length;l--;){var c=(i=a[l]).name,d=i.namespaceURI;if(r="value"===c?i.value:O(i.value),o=n(c),h.attrName=o,h.attrValue=r,h.keepAttr=!0,h.forceKeepAttr=void 0,t6("uponSanitizeAttribute",e,h),r=h.attrValue,!h.forceKeepAttr&&(t8(c,e),h.keepAttr)){if(!tS&&M(/\/>/i,r)){t8(c,e);continue}tC&&(r=T(r,$," "),r=T(r,z," "),r=T(r,G," "));var f=n(e.nodeName);if(ee(f,o,r)){if(tx&&("id"===o||"name"===o)&&(t8(c,e),r="user-content-"+r),tt&&"object"===t(u)&&"function"==typeof u.getAttributeType){if(d);else switch(u.getAttributeType(f,o)){case"TrustedHTML":r=tt.createHTML(r);break;case"TrustedScriptURL":r=tt.createScriptURL(r)}}try{d?e.setAttributeNS(d,c,r):e.setAttribute(c,r),b(s.removed)}catch(t){}}}}t6("afterSanitizeAttributes",e,null)}},en=function t(e){var i,r=t3(e);for(t6("beforeSanitizeShadowDOM",e,null);i=r.nextNode();)t6("uponSanitizeShadowNode",i,null),et(i)||(i.content instanceof DocumentFragment&&t(i.content),er(i));t6("afterSanitizeShadowDOM",e,null)};return s.sanitize=function(e){var i,r,a,h,u,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((t$=!e)&&(e="<!-->"),"string"!=typeof e&&!t5(e)){if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw N("dirty is not a string, aborting")}else throw N("toString is not a function")}if(!s.isSupported){if("object"===t(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof e)return o.toStaticHTML(e);if(t5(e))return o.toStaticHTML(e.outerHTML)}return e}if(tT||tq(c),s.removed=[],"string"==typeof e&&(tH=!1),tH){if(e.nodeName){var d=n(e.nodeName);if(!tc[d]||tp[d])throw N("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof Node)1===(r=(i=t7("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName?i=r:"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!tO&&!tC&&!tE&&-1===e.indexOf("<"))return tt&&tN?tt.createHTML(e):e;if(!(i=t7(e)))return tO?null:tN?te:""}i&&tR&&t4(i.firstChild);for(var f=t3(tH?e:i);a=f.nextNode();)3===a.nodeType&&a===h||et(a)||(a.content instanceof DocumentFragment&&en(a.content),er(a),h=a);if(h=null,tH)return e;if(tO){if(tM)for(u=to.call(i.ownerDocument);i.firstChild;)u.appendChild(i.firstChild);else u=i;return(tf.shadowroot||tf.shadowrootmod)&&(u=tl.call(l,u,!0)),u}var g=tE?i.outerHTML:i.innerHTML;return tE&&tc["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&M(J,i.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+g),tC&&(g=T(g,$," "),g=T(g,z," "),g=T(g,G," ")),tt&&tN?tt.createHTML(g):g},s.setConfig=function(t){tq(t),tT=!0},s.clearConfig=function(){tX=null,tT=!1},s.isValidAttribute=function(t,e,i){return tX||tq({}),ee(n(t),n(e),i)},s.addHook=function(t,e){"function"==typeof e&&(th[t]=th[t]||[],y(th[t],e))},s.removeHook=function(t){if(th[t])return b(th[t])},s.removeHooks=function(t){th[t]&&(th[t]=[])},s.removeAllHooks=function(){th={}},s}()}()},6800:function(){},622:function(t,e,i){"use strict";var r=i(2265),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function h(t,e,i){var r,o={},h=null,u=null;for(r in void 0!==i&&(h=""+i),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(u=e.ref),e)s.call(e,r)&&!a.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===o[r]&&(o[r]=e[r]);return{$$typeof:n,type:t,key:h,ref:u,props:o,_owner:l.current}}e.Fragment=o,e.jsx=h,e.jsxs=h},7437:function(t,e,i){"use strict";t.exports=i(622)},4695:function(t){t.exports=(function t(e,i,r){function n(s,l){if(!i[s]){if(!e[s]){if(o)return o(s,!0);var a=Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){return n(e[s][1][t]||t)},h,h.exports,t,e,i,r)}return i[s].exports}for(var o=void 0,s=0;s<r.length;s++)n(r[s]);return n})({1:[function(t,e,i){!function(t){"use strict";var i,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,o=Math.floor,s="[BigNumber Error] ",l=s+"Number primitive has more than 15 significant digits: ",a=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function h(t){var e=0|t;return 0<t||t===e?e:e-1}function u(t){for(var e,i,r=1,n=t.length,o=t[0]+"";r<n;){for(i=14-(e=t[r++]+"").length;i--;e="0"+e);o+=e}for(n=o.length;48===o.charCodeAt(--n););return o.slice(0,n+1||1)}function c(t,e){var i,r,n=t.c,o=e.c,s=t.s,l=e.s,a=t.e,h=e.e;if(!s||!l)return null;if(i=n&&!n[0],r=o&&!o[0],i||r)return i?r?0:-l:s;if(s!=l)return s;if(i=s<0,r=a==h,!n||!o)return r?0:!n^i?1:-1;if(!r)return h<a^i?1:-1;for(l=(a=n.length)<(h=o.length)?a:h,s=0;s<l;s++)if(n[s]!=o[s])return n[s]>o[s]^i?1:-1;return a==h?0:h<a^i?1:-1}function d(t,e,i,r){if(t<e||i<t||t!==(t<0?n(t):o(t)))throw Error(s+(r||"Argument")+("number"==typeof t?t<e||i<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function f(t){var e=t.c.length-1;return h(t.e/14)==e&&t.c[e]%2!=0}function g(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function m(t,e,i){var r,n;if(e<0){for(n=i+".";++e;n+=i);t=n+t}else if(++e>(r=t.length)){for(n=i,e-=r;--e;n+=i);t+=n}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}(i=function t(e){var i,p,w,b,y,S,C,E,T,R=F.prototype={constructor:F,toString:null,valueOf:null},O=new F(1),M=20,N=4,I=-7,x=21,k=-1e7,H=1e7,_=!1,A=1,L=0,P={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},D="0123456789abcdefghijklmnopqrstuvwxyz";function F(t,e){var i,n,s,a,h,u,c,f,g=this;if(!(g instanceof F))return new F(t,e);if(null==e){if(t instanceof F)return g.s=t.s,g.e=t.e,void(g.c=(t=t.c)?t.slice():t);if((u="number"==typeof t)&&0*t==0){if(g.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,h=t;10<=h;h/=10,a++);return g.e=a,void(g.c=[t])}f=String(t)}else{if(f=String(t),!r.test(f))return w(g,f,u);g.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}-1<(a=f.indexOf("."))&&(f=f.replace(".","")),0<(h=f.search(/e/i))?(a<0&&(a=h),a+=+f.slice(h+1),f=f.substring(0,h)):a<0&&(a=f.length)}else{if(d(e,2,D.length,"Base"),f=String(t),10==e)return j(g=new F(t instanceof F?t:f),M+g.e+1,N);if(u="number"==typeof t){if(0*t!=0)return w(g,f,u,e);if(g.s=1/t<0?(f=f.slice(1),-1):1,F.DEBUG&&15<f.replace(/^0\.0*|\./,"").length)throw Error(l+t);u=!1}else g.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(i=D.slice(0,e),a=h=0,c=f.length;h<c;h++)if(0>i.indexOf(n=f.charAt(h))){if("."==n){if(a<h){a=c;continue}}else if(!s&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){s=!0,h=-1,a=0;continue}return w(g,String(t),u,e)}-1<(a=(f=p(f,e,10,g.s)).indexOf("."))?f=f.replace(".",""):a=f.length}for(h=0;48===f.charCodeAt(h);h++);for(c=f.length;48===f.charCodeAt(--c););if(f=f.slice(h,++c)){if(c-=h,u&&F.DEBUG&&15<c&&(9007199254740991<t||t!==o(t)))throw Error(l+g.s*t);if(H<(a=a-h-1))g.c=g.e=null;else if(a<k)g.c=[g.e=0];else{if(g.e=a,g.c=[],h=(a+1)%14,a<0&&(h+=14),h<c){for(h&&g.c.push(+f.slice(0,h)),c-=14;h<c;)g.c.push(+f.slice(h,h+=14));h=14-(f=f.slice(h)).length}else h-=c;for(;h--;f+="0");g.c.push(+f)}}else g.c=[g.e=0]}function B(t,e,i,r){var n,o,s,l,a;if(null==i?i=N:d(i,0,8),!t.c)return t.toString();if(n=t.c[0],s=t.e,null==e)a=u(t.c),a=1==r||2==r&&(s<=I||x<=s)?g(a,s):m(a,s,"0");else if(o=(t=j(new F(t),e,i)).e,l=(a=u(t.c)).length,1==r||2==r&&(e<=o||o<=I)){for(;l<e;a+="0",l++);a=g(a,o)}else if(e-=s,a=m(a,o,"0"),l<o+1){if(0<--e)for(a+=".";e--;a+="0");}else if(0<(e+=o-l))for(o+1==l&&(a+=".");e--;a+="0");return t.s<0&&n?"-"+a:a}function W(t,e){for(var i,r=1,n=new F(t[0]);r<t.length;r++){if(!(i=new F(t[r])).s){n=i;break}e.call(n,i)&&(n=i)}return n}function V(t,e,i){for(var r=1,n=e.length;!e[--n];e.pop());for(n=e[0];10<=n;n/=10,r++);return(i=r+14*i-1)>H?t.c=t.e=null:t.c=i<k?[t.e=0]:(t.e=i,e),t}function j(t,e,i,r){var s,l,h,u,c,d,f,g=t.c;if(g){t:{for(s=1,u=g[0];10<=u;u/=10,s++);if((l=e-s)<0)l+=14,h=e,f=(c=g[d=0])/a[s-h-1]%10|0;else if((d=n((l+1)/14))>=g.length){if(!r)break t;for(;g.length<=d;g.push(0));c=f=0,h=(l%=14)-14+(s=1)}else{for(c=u=g[d],s=1;10<=u;u/=10,s++);f=(h=(l%=14)-14+s)<0?0:c/a[s-h-1]%10|0}if(r=r||e<0||null!=g[d+1]||(h<0?c:c%a[s-h-1]),r=i<4?(f||r)&&(0==i||i==(t.s<0?3:2)):5<f||5==f&&(4==i||r||6==i&&(0<l?0<h?c/a[s-h]:0:g[d-1])%10&1||i==(t.s<0?8:7)),e<1||!g[0])return g.length=0,r?(e-=t.e+1,g[0]=a[(14-e%14)%14],t.e=-e||0):g[0]=t.e=0,t;if(0==l?(g.length=d,u=1,d--):(g.length=d+1,u=a[14-l],g[d]=0<h?o(c/a[s-h]%a[h])*u:0),r)for(;;){if(0==d){for(l=1,h=g[0];10<=h;h/=10,l++);for(h=g[0]+=u,u=1;10<=h;h/=10,u++);l!=u&&(t.e++,1e14==g[0]&&(g[0]=1));break}if(g[d]+=u,1e14!=g[d])break;g[d--]=0,u=1}for(l=g.length;0===g[--l];g.pop());}t.e>H?t.c=t.e=null:t.e<k&&(t.c=[t.e=0])}return t}function U(t){var e,i=t.e;return null===i?t.toString():(e=u(t.c),e=i<=I||x<=i?g(e,i):m(e,i,"0"),t.s<0?"-"+e:e)}return F.clone=t,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(t){var e,i;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(d(i=t[e],0,1e9,e),M=i),t.hasOwnProperty(e="ROUNDING_MODE")&&(d(i=t[e],0,8,e),N=i),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((i=t[e])&&i.pop?(d(i[0],-1e9,0,e),d(i[1],0,1e9,e),I=i[0],x=i[1]):(d(i,-1e9,1e9,e),I=-(x=i<0?-i:i))),t.hasOwnProperty(e="RANGE")){if((i=t[e])&&i.pop)d(i[0],-1e9,-1,e),d(i[1],1,1e9,e),k=i[0],H=i[1];else{if(d(i,-1e9,1e9,e),!i)throw Error(s+e+" cannot be zero: "+i);k=-(H=i<0?-i:i)}}if(t.hasOwnProperty(e="CRYPTO")){if((i=t[e])!==!!i)throw Error(s+e+" not true or false: "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw _=!i,Error(s+"crypto unavailable");_=i}else _=i}if(t.hasOwnProperty(e="MODULO_MODE")&&(d(i=t[e],0,9,e),A=i),t.hasOwnProperty(e="POW_PRECISION")&&(d(i=t[e],0,1e9,e),L=i),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(i=t[e]))throw Error(s+e+" not an object: "+i);P=i}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(i=t[e])||/^.$|[+-.\s]|(.).*\1/.test(i))throw Error(s+e+" invalid: "+i);D=i}}return{DECIMAL_PLACES:M,ROUNDING_MODE:N,EXPONENTIAL_AT:[I,x],RANGE:[k,H],CRYPTO:_,MODULO_MODE:A,POW_PRECISION:L,FORMAT:P,ALPHABET:D}},F.isBigNumber=function(t){return t instanceof F||t&&!0===t._isBigNumber||!1},F.maximum=F.max=function(){return W(arguments,R.lt)},F.minimum=F.min=function(){return W(arguments,R.gt)},F.random=(b=9007199254740992*Math.random()&2097151?function(){return o(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,i,r,l,h,u=0,c=[],f=new F(O);if(null==t?t=M:d(t,0,1e9),l=n(t/14),_){if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(l*=2));u<l;)9e15<=(h=131072*e[u]+(e[u+1]>>>11))?(i=crypto.getRandomValues(new Uint32Array(2)),e[u]=i[0],e[u+1]=i[1]):(c.push(h%1e14),u+=2);u=l/2}else{if(!crypto.randomBytes)throw _=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(l*=7);u<l;)9e15<=(h=281474976710656*(31&e[u])+1099511627776*e[u+1]+4294967296*e[u+2]+16777216*e[u+3]+(e[u+4]<<16)+(e[u+5]<<8)+e[u+6])?crypto.randomBytes(7).copy(e,u):(c.push(h%1e14),u+=7);u=l/7}}if(!_)for(;u<l;)(h=b())<9e15&&(c[u++]=h%1e14);for(l=c[--u],t%=14,l&&t&&(h=a[14-t],c[u]=o(l/h)*h);0===c[u];c.pop(),u--);if(u<0)c=[r=0];else{for(r=-1;0===c[0];c.splice(0,1),r-=14);for(u=1,h=c[0];10<=h;h/=10,u++);u<14&&(r-=14-u)}return f.e=r,f.c=c,f}),F.sum=function(){for(var t=1,e=arguments,i=new F(e[0]);t<e.length;)i=i.plus(e[t++]);return i},p=function(){var t="0123456789";function e(t,e,i,r){for(var n,o,s=[0],l=0,a=t.length;l<a;){for(o=s.length;o--;s[o]*=e);for(s[0]+=r.indexOf(t.charAt(l++)),n=0;n<s.length;n++)s[n]>i-1&&(null==s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/i|0,s[n]%=i)}return s.reverse()}return function(r,n,o,s,l){var a,h,c,d,f,g,p,w,b=r.indexOf("."),y=M,S=N;for(0<=b&&(d=L,L=0,r=r.replace(".",""),g=(w=new F(n)).pow(r.length-b),L=d,w.c=e(m(u(g.c),g.e,"0"),10,o,t),w.e=w.c.length),c=d=(p=e(r,n,o,l?(a=D,t):(a=t,D))).length;0==p[--d];p.pop());if(!p[0])return a.charAt(0);if(b<0?--c:(g.c=p,g.e=c,g.s=s,p=(g=i(g,w,y,S,o)).c,f=g.r,c=g.e),b=p[h=c+y+1],d=o/2,f=f||h<0||null!=p[h+1],f=S<4?(null!=b||f)&&(0==S||S==(g.s<0?3:2)):d<b||b==d&&(4==S||f||6==S&&1&p[h-1]||S==(g.s<0?8:7)),h<1||!p[0])r=f?m(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(p.length=h,f)for(--o;++p[--h]>o;)p[h]=0,h||(++c,p=[1].concat(p));for(d=p.length;!p[--d];);for(b=0,r="";b<=d;r+=a.charAt(p[b++]));r=m(r,c,a.charAt(0))}return r}}(),i=function(){function t(t,e,i){var r,n,o,s,l=0,a=t.length,h=e%1e7,u=e/1e7|0;for(t=t.slice();a--;)l=((n=h*(o=t[a]%1e7)+(r=u*o+(s=t[a]/1e7|0)*h)%1e7*1e7+l)/i|0)+(r/1e7|0)+u*s,t[a]=n%i;return l&&(t=[l].concat(t)),t}function e(t,e,i,r){var n,o;if(i!=r)o=r<i?1:-1;else for(n=o=0;n<i;n++)if(t[n]!=e[n]){o=t[n]>e[n]?1:-1;break}return o}function i(t,e,i,r){for(var n=0;i--;)t[i]-=n,n=t[i]<e[i]?1:0,t[i]=n*r+t[i]-e[i];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(r,n,s,l,a){var u,c,d,f,g,m,p,w,b,y,S,C,E,T,R,O,M,N=r.s==n.s?1:-1,I=r.c,x=n.c;if(!(I&&I[0]&&x&&x[0]))return new F(r.s&&n.s&&(I?!x||I[0]!=x[0]:x)?I&&0==I[0]||!x?0*N:N/0:NaN);for(b=(w=new F(N)).c=[],N=s+(c=r.e-n.e)+1,a||(a=1e14,c=h(r.e/14)-h(n.e/14),N=N/14|0),d=0;x[d]==(I[d]||0);d++);if(x[d]>(I[d]||0)&&c--,N<0)b.push(1),f=!0;else{for(T=I.length,O=x.length,N+=2,1<(g=o(a/(x[d=0]+1)))&&(x=t(x,g,a),I=t(I,g,a),O=x.length,T=I.length),E=O,S=(y=I.slice(0,O)).length;S<O;y[S++]=0);M=[0].concat(M=x.slice()),R=x[0],x[1]>=a/2&&R++;do{if(g=0,(u=e(x,y,O,S))<0){if(C=y[0],O!=S&&(C=C*a+(y[1]||0)),1<(g=o(C/R)))for(a<=g&&(g=a-1),p=(m=t(x,g,a)).length,S=y.length;1==e(m,y,p,S);)g--,i(m,O<p?M:x,p,a),p=m.length,u=1;else 0==g&&(u=g=1),p=(m=x.slice()).length;if(p<S&&(m=[0].concat(m)),i(y,m,S,a),S=y.length,-1==u)for(;1>e(x,y,O,S);)g++,i(y,O<S?M:x,S,a),S=y.length}else 0===u&&(g++,y=[0]);b[d++]=g,y[0]?y[S++]=I[E]||0:(y=[I[E]],S=1)}while((E++<T||null!=y[0])&&N--);f=null!=y[0],b[0]||b.splice(0,1)}if(1e14==a){for(d=1,N=b[0];10<=N;N/=10,d++);j(w,s+(w.e=d+14*c-1)+1,l,f)}else w.e=c,w.r=+f;return w}}(),y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,C=/^\.([^.]+)$/,E=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(t,e,i,r){var n,o=i?e:e.replace(T,"");if(E.test(o))t.s=isNaN(o)?null:o<0?-1:1,t.c=t.e=null;else{if(!i&&(o=o.replace(y,function(t,e,i){return n="x"==(i=i.toLowerCase())?16:"b"==i?2:8,r&&r!=n?t:e}),r&&(n=r,o=o.replace(S,"$1").replace(C,"0.$1")),e!=o))return new F(o,n);if(F.DEBUG)throw Error(s+"Not a"+(r?" base "+r:"")+" number: "+e);t.c=t.e=t.s=null}},R.absoluteValue=R.abs=function(){var t=new F(this);return t.s<0&&(t.s=1),t},R.comparedTo=function(t,e){return c(this,new F(t,e))},R.decimalPlaces=R.dp=function(t,e){var i,r,n;if(null!=t)return d(t,0,1e9),null==e?e=N:d(e,0,8),j(new F(this),t+this.e+1,e);if(!(i=this.c))return null;if(r=((n=i.length-1)-h(this.e/14))*14,n=i[n])for(;n%10==0;n/=10,r--);return r<0&&(r=0),r},R.dividedBy=R.div=function(t,e){return i(this,new F(t,e),M,N)},R.dividedToIntegerBy=R.idiv=function(t,e){return i(this,new F(t,e),0,1)},R.exponentiatedBy=R.pow=function(t,e){var i,r,l,a,h,u,c,d,g=this;if((t=new F(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+U(t));if(null!=e&&(e=new F(e)),h=14<t.e,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!t.c||!t.c[0])return d=new F(Math.pow(+U(g),h?2-f(t):+U(t))),e?d.mod(e):d;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new F(NaN);(r=!u&&g.isInteger()&&e.isInteger())&&(g=g.mod(e))}else{if(9<t.e&&(0<g.e||g.e<-1||(0==g.e?1<g.c[0]||h&&24e7<=g.c[1]:g.c[0]<8e13||h&&g.c[0]<=9999975e7)))return a=g.s<0&&f(t)?-0:0,-1<g.e&&(a=1/a),new F(u?1/a:a);L&&(a=n(L/14+2))}for(c=h?(i=new F(.5),u&&(t.s=1),f(t)):(l=Math.abs(+U(t)))%2,d=new F(O);;){if(c){if(!(d=d.times(g)).c)break;a?d.c.length>a&&(d.c.length=a):r&&(d=d.mod(e))}if(l){if(0===(l=o(l/2)))break;c=l%2}else if(j(t=t.times(i),t.e+1,1),14<t.e)c=f(t);else{if(0==(l=+U(t)))break;c=l%2}g=g.times(g),a?g.c&&g.c.length>a&&(g.c.length=a):r&&(g=g.mod(e))}return r?d:(u&&(d=O.div(d)),e?d.mod(e):a?j(d,L,N,void 0):d)},R.integerValue=function(t){var e=new F(this);return null==t?t=N:d(t,0,8),j(e,e.e+1,t)},R.isEqualTo=R.eq=function(t,e){return 0===c(this,new F(t,e))},R.isFinite=function(){return!!this.c},R.isGreaterThan=R.gt=function(t,e){return 0<c(this,new F(t,e))},R.isGreaterThanOrEqualTo=R.gte=function(t,e){return 1===(e=c(this,new F(t,e)))||0===e},R.isInteger=function(){return!!this.c&&h(this.e/14)>this.c.length-2},R.isLessThan=R.lt=function(t,e){return 0>c(this,new F(t,e))},R.isLessThanOrEqualTo=R.lte=function(t,e){return -1===(e=c(this,new F(t,e)))||0===e},R.isNaN=function(){return!this.s},R.isNegative=function(){return this.s<0},R.isPositive=function(){return 0<this.s},R.isZero=function(){return!!this.c&&0==this.c[0]},R.minus=function(t,e){var i,r,n,o,s=this.s;if(e=(t=new F(t,e)).s,!s||!e)return new F(NaN);if(s!=e)return t.s=-e,this.plus(t);var l=this.e/14,a=t.e/14,u=this.c,c=t.c;if(!l||!a){if(!u||!c)return u?(t.s=-e,t):new F(c?this:NaN);if(!u[0]||!c[0])return c[0]?(t.s=-e,t):new F(u[0]?this:3==N?-0:0)}if(l=h(l),a=h(a),u=u.slice(),s=l-a){for((n=(o=s<0)?(s=-s,u):(a=l,c)).reverse(),e=s;e--;n.push(0));n.reverse()}else for(r=(o=(s=u.length)<(e=c.length))?s:e,s=e=0;e<r;e++)if(u[e]!=c[e]){o=u[e]<c[e];break}if(o&&(n=u,u=c,c=n,t.s=-t.s),0<(e=(r=c.length)-(i=u.length)))for(;e--;u[i++]=0);for(e=1e14-1;s<r;){if(u[--r]<c[r]){for(i=r;i&&!u[--i];u[i]=e);--u[i],u[r]+=1e14}u[r]-=c[r]}for(;0==u[0];u.splice(0,1),--a);return u[0]?V(t,u,a):(t.s=3==N?-1:1,t.c=[t.e=0],t)},R.modulo=R.mod=function(t,e){var r,n;return t=new F(t,e),this.c&&t.s&&(!t.c||t.c[0])?t.c&&(!this.c||this.c[0])?(9==A?(n=t.s,t.s=1,r=i(this,t,0,3),t.s=n,r.s*=n):r=i(this,t,0,A),(t=this.minus(r.times(t))).c[0]||1!=A||(t.s=this.s),t):new F(this):new F(NaN)},R.multipliedBy=R.times=function(t,e){var i,r,n,o,s,l,a,u,c,d,f,g,m,p=this.c,w=(t=new F(t,e)).c;if(!(p&&w&&p[0]&&w[0]))return this.s&&t.s&&(!p||p[0]||w)&&(!w||w[0]||p)?(t.s*=this.s,p&&w?(t.c=[0],t.e=0):t.c=t.e=null):t.c=t.e=t.s=null,t;for(r=h(this.e/14)+h(t.e/14),t.s*=this.s,(a=p.length)<(d=w.length)&&(m=p,p=w,w=m,n=a,a=d,d=n),n=a+d,m=[];n--;m.push(0));for(n=d;0<=--n;){for(i=0,f=w[n]%1e7,g=w[n]/1e7|0,o=n+(s=a);n<o;)i=((u=f*(u=p[--s]%1e7)+(l=g*u+(c=p[s]/1e7|0)*f)%1e7*1e7+m[o]+i)/1e14|0)+(l/1e7|0)+g*c,m[o--]=u%1e14;m[o]=i}return i?++r:m.splice(0,1),V(t,m,r)},R.negated=function(){var t=new F(this);return t.s=-t.s||null,t},R.plus=function(t,e){var i,r=this.s;if(e=(t=new F(t,e)).s,!r||!e)return new F(NaN);if(r!=e)return t.s=-e,this.minus(t);var n=this.e/14,o=t.e/14,s=this.c,l=t.c;if(!n||!o){if(!s||!l)return new F(r/0);if(!s[0]||!l[0])return l[0]?t:new F(s[0]?this:0*r)}if(n=h(n),o=h(o),s=s.slice(),r=n-o){for((i=0<r?(o=n,l):(r=-r,s)).reverse();r--;i.push(0));i.reverse()}for((r=s.length)-(e=l.length)<0&&(i=l,l=s,s=i,e=r),r=0;e;)r=(s[--e]=s[e]+l[e]+r)/1e14|0,s[e]=1e14===s[e]?0:s[e]%1e14;return r&&(s=[r].concat(s),++o),V(t,s,o)},R.precision=R.sd=function(t,e){var i,r,n;if(null!=t&&!!t!==t)return d(t,1,1e9),null==e?e=N:d(e,0,8),j(new F(this),t,e);if(!(i=this.c))return null;if(r=14*(n=i.length-1)+1,n=i[n]){for(;n%10==0;n/=10,r--);for(n=i[0];10<=n;n/=10,r++);}return t&&this.e+1>r&&(r=this.e+1),r},R.shiftedBy=function(t){return d(t,-9007199254740991,9007199254740991),this.times("1e"+t)},R.squareRoot=R.sqrt=function(){var t,e,r,n,o,s=this.c,l=this.s,a=this.e,c=M+4,d=new F("0.5");if(1!==l||!s||!s[0])return new F(!l||l<0&&(!s||s[0])?NaN:s?this:1/0);if((r=0==(l=Math.sqrt(+U(this)))||l==1/0?(((e=u(s)).length+a)%2==0&&(e+="0"),l=Math.sqrt(+e),a=h((a+1)/2)-(a<0||a%2),new F(e=l==1/0?"1e"+a:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+a)):new F(l+"")).c[0]){for((l=(a=r.e)+c)<3&&(l=0);;)if(o=r,r=d.times(o.plus(i(this,o,c,1))),u(o.c).slice(0,l)===(e=u(r.c)).slice(0,l)){if(r.e<a&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(j(r,r.e+M+2,1),t=!r.times(r).eq(this));break}if(!n&&(j(o,o.e+M+2,0),o.times(o).eq(this))){r=o;break}c+=4,l+=4,n=1}}return j(r,r.e+M+1,N,t)},R.toExponential=function(t,e){return null!=t&&(d(t,0,1e9),t++),B(this,t,e,1)},R.toFixed=function(t,e){return null!=t&&(d(t,0,1e9),t=t+this.e+1),B(this,t,e)},R.toFormat=function(t,e,i){var r;if(null==i)null!=t&&e&&"object"==typeof e?(i=e,e=null):t&&"object"==typeof t?(i=t,t=e=null):i=P;else if("object"!=typeof i)throw Error(s+"Argument not an object: "+i);if(r=this.toFixed(t,e),this.c){var n,o=r.split("."),l=+i.groupSize,a=+i.secondaryGroupSize,h=i.groupSeparator||"",u=o[0],c=o[1],d=this.s<0,f=d?u.slice(1):u,g=f.length;if(a&&(n=l,l=a,g-=a=n),0<l&&0<g){for(n=g%l||l,u=f.substr(0,n);n<g;n+=l)u+=h+f.substr(n,l);0<a&&(u+=h+f.slice(n)),d&&(u="-"+u)}r=c?u+(i.decimalSeparator||"")+((a=+i.fractionGroupSize)?c.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):c):u}return(i.prefix||"")+r+(i.suffix||"")},R.toFraction=function(t){var e,r,n,o,l,h,c,d,f,g,m,p,w=this.c;if(null!=t&&(!(c=new F(t)).isInteger()&&(c.c||1!==c.s)||c.lt(O)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+U(c));if(!w)return new F(this);for(e=new F(O),f=r=new F(O),n=d=new F(O),p=u(w),l=e.e=p.length-this.e-1,e.c[0]=a[(h=l%14)<0?14+h:h],t=!t||0<c.comparedTo(e)?0<l?e:f:c,h=H,H=1/0,c=new F(p),d.c[0]=0;g=i(c,e,0,1),1!=(o=r.plus(g.times(n))).comparedTo(t);)r=n,n=o,f=d.plus(g.times(o=f)),d=o,e=c.minus(g.times(o=e)),c=o;return o=i(t.minus(r),n,0,1),d=d.plus(o.times(f)),r=r.plus(o.times(n)),d.s=f.s=this.s,m=1>i(f,n,l*=2,N).minus(this).abs().comparedTo(i(d,r,l,N).minus(this).abs())?[f,n]:[d,r],H=h,m},R.toNumber=function(){return+U(this)},R.toPrecision=function(t,e){return null!=t&&d(t,1,1e9),B(this,t,e,2)},R.toString=function(t){var e,i=this,r=i.s,n=i.e;return null===n?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(e=null==t?n<=I||x<=n?g(u(i.c),n):m(u(i.c),n,"0"):10===t?m(u((i=j(new F(i),M+n+1,N)).c),i.e,"0"):(d(t,2,D.length,"Base"),p(m(u(i.c),n,"0"),10,t,r,!0)),r<0&&i.c[0]&&(e="-"+e)),e},R.valueOf=R.toJSON=function(){return U(this)},R._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(R[Symbol.toStringTag]="BigNumber",R[Symbol.for("nodejs.util.inspect.custom")]=R.valueOf),null!=e&&F.set(e),F}()).default=i.BigNumber=i,void 0!==e&&e.exports?e.exports=i:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=i)}(this)},{}],2:[function(t,e,i){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,i){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],r=!0,n=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){n=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return i}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance")}()}var n=t("./globalState"),o=t("./validating"),s=t("./parsing"),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:l,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:l,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function u(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!o.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",l=e.postfix||"",u=function(t,e,i){var r,o,s,l,u,d,m,p,w,b,y,S,C,E,T,R,O,M,N,I,x,k,H,_,A,L,P,D;switch(e.output){case"currency":return R=e=g(e,n.currentCurrencyDefaultFormat()),O=n.currentCurrency(),M=Object.assign({},h,R),N=void 0,I="",x=!!M.totalLength||!!M.forceAverage||M.average,k=R.currencyPosition||O.position,H=R.currencySymbol||O.symbol,M.spaceSeparated&&(I=" "),"infix"===k&&(N=I+H+I),_=f({instance:t,providedFormat:R,state:n,decimalSeparator:N}),"prefix"===k&&(_=t._value<0&&"sign"===M.negative?"-".concat(I).concat(H).concat(_.slice(1)):H+I+_),k&&"postfix"!==k||(_=_+(I=x?"":I)+H),_;case"percent":return L=(A=e=g(e,n.currentPercentageDefaultFormat())).prefixSymbol,P=f({instance:i(100*t._value),providedFormat:A,state:n}),D=Object.assign({},h,A),L?"%".concat(D.spaceSeparated?" ":"").concat(P):"".concat(P).concat(D.spaceSeparated?" ":"","%");case"byte":return b=a[(w=e=g(e,n.currentByteDefaultFormat())).base||"binary"],S=(y=c(t._value,b.suffixes,b.scale)).value,C=y.suffix,E=f({instance:i(S),providedFormat:w,state:n,defaults:n.currentByteDefaultFormat()}),T=n.currentAbbreviations(),"".concat(E).concat(T.spaced?" ":"").concat(C);case"time":return e=g(e,n.currentTimeDefaultFormat()),d=Math.floor(t._value/60/60),m=Math.floor((t._value-60*d*60)/60),p=Math.round(t._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(p<10?"0":"").concat(p);case"ordinal":return r=e=g(e,n.currentOrdinalDefaultFormat()),o=n.currentOrdinal(),s=Object.assign({},h,r),l=f({instance:t,providedFormat:r,state:n}),u=o(t._value),"".concat(l).concat(s.spaceSeparated?" ":"").concat(u);default:return f({instance:t,providedFormat:e,numbro:i})}}(t,e,i);return(u=r+u)+l}function c(t,e,i){var r=e[0],n=Math.abs(t);if(i<=n){for(var o=1;o<e.length;++o){var s=Math.pow(i,o),l=Math.pow(i,o+1);if(s<=n&&n<l){r=e[o],t/=s;break}}r===e[0]&&(t/=Math.pow(i,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function d(t){for(var e="",i=0;i<t;i++)e+="0";return e}function f(t){var e,i,o,s,l,a,u,c,f,g=t.instance,m=t.providedFormat,p=t.state,w=void 0===p?n:p,b=t.decimalSeparator,y=t.defaults,S=void 0===y?w.currentDefaults():y,C=g._value;if(0===C&&w.hasZeroFormat())return w.getZeroFormat();if(!isFinite(C))return C.toString();var E,T,R,O,M,N,I,x,k=Object.assign({},h,S,m),H=k.totalLength,_=H?0:k.characteristic,A=k.optionalCharacteristic,L=k.forceAverage,P=!!H||!!L||k.average,D=H?-1:P&&void 0===m.mantissa?0:k.mantissa,F=!H&&(void 0===m.optionalMantissa?-1===D:k.optionalMantissa),B=k.trimMantissa,W=k.thousandSeparated,V=k.spaceSeparated,j=k.negative,U=k.forceSign,$=k.exponential,z="";if(P){var G,K,X,Y,Z,q,J,Q,tt,te,ti=(K=(G={value:C,forceAverage:L,abbreviations:w.currentAbbreviations(),spaceSeparated:V,totalLength:H}).value,X=G.forceAverage,Y=G.abbreviations,Z=G.spaceSeparated,J=void 0===(q=G.totalLength)?0:q,Q="",te=-1,(tt=Math.abs(K))>=1e12&&!X||"trillion"===X?(Q=Y.trillion,K/=1e12):tt<1e12&&tt>=1e9&&!X||"billion"===X?(Q=Y.billion,K/=1e9):tt<1e9&&tt>=1e6&&!X||"million"===X?(Q=Y.million,K/=1e6):(tt<1e6&&tt>=1e3&&!X||"thousand"===X)&&(Q=Y.thousand,K/=1e3),Q&&(Q=(void 0!==Z&&Z?" ":"")+Q),J&&(te=Math.max(J-K.toString().split(".")[0].length,0)),{value:K,abbreviation:Q,mantissaPrecision:te});C=ti.value,z+=ti.abbreviation,H&&(D=ti.mantissaPrecision)}if($){var tr=(T=(E={value:C,characteristicPrecision:_}).value,O=void 0===(R=E.characteristicPrecision)?0:R,N=(M=r(T.toExponential().split("e"),2))[0],I=M[1],x=+N,O&&1<O&&(x*=Math.pow(10,O-1),I=0<=(I=+I-(O-1))?"+".concat(I):I),{value:x,abbreviation:"e".concat(I)});C=tr.value,z=tr.abbreviation+z}var tn,to,ts=function(t,e,i,n,o){if(-1===n)return t;var s=-1!==e.toString().indexOf("e")?function(t,e){var i=t.toString(),n=r(i.split("e"),2),o=n[0],s=n[1],l=r(o.split("."),2),a=l[0],h=l[1],u=void 0===h?"":h;if(0<+s)i=a+u+d(s-u.length);else{var c=".";c=0>+a?"-0".concat(c):"0".concat(c);var f=(d(-s-1)+Math.abs(a)+u).substr(0,e);f.length<e&&(f+=d(e-f.length)),i=c+f}return 0<+s&&0<e&&(i+=".".concat(d(e))),i}(e,n):(Math.round(+"".concat(e,"e+").concat(n))/Math.pow(10,n)).toFixed(n),l=r(s.toString().split("."),2),a=l[0],h=l[1],u=void 0===h?"":h;if(u.match(/^0+$/)&&(i||o))return a;var c=u.match(/0+$/);return o&&c?"".concat(a,".").concat(u.toString().slice(0,c.index)):s.toString()}(C.toString(),C,F,D,B);return e=ts=function(t,e,i,n){var o=t,s=r(o.toString().split("."),2),l=s[0],a=s[1];if(l.match(/^-?0$/)&&i)return a?"".concat(l.replace("0",""),".").concat(a):l.replace("0","");if(l.length<n)for(var h=n-l.length,u=0;u<h;u++)o="0".concat(o);return o.toString()}(ts,0,A,_),i=C,o=b,l=(s=w.currentDelimiters()).thousands,o=o||s.decimal,a=s.thousandsSize||3,c=(u=e.toString()).split(".")[0],f=u.split(".")[1],W&&(i<0&&(c=c.slice(1)),(function(t,e){for(var i=[],r=0,n=t;0<n;n--)r===e&&(i.unshift(n),r=0),r++;return i})(c.length,a).forEach(function(t,e){c=c.slice(0,t+e)+l+c.slice(t+e)}),i<0&&(c="-".concat(c))),ts=u=f?c+o+f:c,(P||$)&&(ts+=z),(U||C<0)&&(tn=ts,ts=0===(to=C)?tn:0==+tn?tn.replace("-",""):0<to?"+".concat(tn):"sign"===j?tn:"(".concat(tn.replace("-",""),")")),ts}function g(t,e){if(!t)return e;var i=Object.keys(t);return 1===i.length&&"output"===i[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u.apply(void 0,i.concat([t]))},getByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=a.general;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=a.binary;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=a.decimal;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},formatOrDefault:g}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,i){"use strict";var r=t("./en-US"),n=t("./validating"),o=t("./parsing"),s={},l=void 0,a={},h=null,u={};function c(){return a[l]}s.languages=function(){return Object.assign({},a)},s.currentLanguage=function(){return l},s.currentCurrency=function(){return c().currency},s.currentAbbreviations=function(){return c().abbreviations},s.currentDelimiters=function(){return c().delimiters},s.currentOrdinal=function(){return c().ordinal},s.currentDefaults=function(){return Object.assign({},c().defaults,u)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().timeFormat)},s.setDefaults=function(t){t=o.parseFormat(t),n.validateFormat(t)&&(u=t)},s.getZeroFormat=function(){return h},s.setZeroFormat=function(t){return h="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==h},s.languageData=function(t){if(t){if(a[t])return a[t];throw Error('Unknown tag "'.concat(t,'"'))}return c()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!n.validateLanguage(t))throw Error("Invalid language data");a[t.languageTag]=t,e&&(l=t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.languageTag;if(!a[t]){var i=t.split("-")[0],n=Object.keys(a).find(function(t){return t.split("-")[0]===i});return a[n]?void(l=n):void(l=e)}l=t},s.registerLanguage(r),l=r.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,i){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(i){i.forEach(function(i){var r=void 0;try{r=t("../languages/".concat(i))}catch(t){console.error('Unable to load "'.concat(i,'". No matching language file found.'))}r&&e.registerLanguage(r)})}}}},{}],6:[function(t,e,i){"use strict";var r=t("bignumber.js");function n(t,e,i){var n=new r(t._value),o=e;return i.isNumbro(e)&&(o=e._value),o=new r(o),t._value=n.minus(o).toNumber(),t}e.exports=function(t){return{add:function(e,i){var n,o;return n=new r(e._value),o=i,t.isNumbro(i)&&(o=i._value),o=new r(o),e._value=n.plus(o).toNumber(),e},subtract:function(e,i){return n(e,i,t)},multiply:function(e,i){var n,o;return n=new r(e._value),o=i,t.isNumbro(i)&&(o=i._value),o=new r(o),e._value=n.times(o).toNumber(),e},divide:function(e,i){var n,o;return n=new r(e._value),o=i,t.isNumbro(i)&&(o=i._value),o=new r(o),e._value=n.dividedBy(o).toNumber(),e},set:function(e,i){var r;return r=i,t.isNumbro(i)&&(r=i._value),e._value=r,e},difference:function(e,i){var r;return n(r=t(e._value),i,t),Math.abs(r._value)}}}},{"bignumber.js":1}],7:[function(t,e,i){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=t("./globalState"),o=t("./validating"),s=t("./loading")(f),l=t("./unformatting"),a=t("./formatting")(f),h=t("./manipulating")(f),u=t("./parsing"),c=function(){var t,e;function i(t){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,i),this._value=t}return t=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=u.parseFormat(t)),(t=a.formatOrDefault(t,n.currentCurrencyDefaultFormat())).output="currency",a.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",a.format(this,t)}},{key:"binaryByteUnits",value:function(){return a.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return a.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return a.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}],r(i.prototype,t),e&&r(i,e),i}();function d(t){var e=t;return f.isNumbro(t)?e=t._value:"string"==typeof t?e=f.unformat(t):isNaN(t)&&(e=NaN),e}function f(t){return new c(d(t))}f.version="2.1.2",f.isNumbro=function(t){return t instanceof c},f.language=n.currentLanguage,f.registerLanguage=n.registerLanguage,f.setLanguage=n.setLanguage,f.languages=n.languages,f.languageData=n.languageData,f.zeroFormat=n.setZeroFormat,f.defaultFormat=n.currentDefaults,f.setDefaults=n.setDefaults,f.defaultCurrencyFormat=n.currentCurrencyDefaultFormat,f.validate=o.validate,f.loadLanguagesInNode=s.loadLanguagesInNode,f.unformat=l.unformat,e.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,i){"use strict";e.exports={parseFormat:function(t){var e,i,r,n,o,s,l,a,h,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return -1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(n=(r=t=(i=(e=t).match(/^{([^}]*)}/))?(u.prefix=i[1],e.slice(i[0].length)):e).match(/{([^}]*)}$/))?(u.postfix=n[1],r.slice(0,-n[0].length)):r,u),(o=t.match(/[1-9]+[0-9]*/))&&(u.totalLength=+o[0]),(s=t.split(".")[0].match(/0+/))&&(u.characteristic=s[0].length),function(t,e){if(-1!==t.indexOf(".")){var i=t.split(".")[0];e.optionalCharacteristic=-1===i.indexOf("0")}}(t,u),-1!==t.indexOf("a")&&(u.average=!0),-1!==(l=t).indexOf("K")?u.forceAverage="thousand":-1!==l.indexOf("M")?u.forceAverage="million":-1!==l.indexOf("B")?u.forceAverage="billion":-1!==l.indexOf("T")&&(u.forceAverage="trillion"),function(t,e){var i=t.split(".")[1];if(i){var r=i.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,u),(a=t).match(/\[\.]/)?u.optionalMantissa=!0:a.match(/\./)&&(u.optionalMantissa=!1),-1!==t.indexOf(",")&&(u.thousandSeparated=!0),-1!==t.indexOf(" ")&&(u.spaceSeparated=!0),(h=t).match(/^\+?\([^)]*\)$/)&&(u.negative="parenthesis"),h.match(/^\+?-/)&&(u.negative="sign"),t.match(/^\+/)&&(u.forceSign=!0),u)}}},{}],9:[function(t,e,i){"use strict";var r=[{key:"ZiB",factor:11805916207174113e5},{key:"ZB",factor:1e21},{key:"YiB",factor:12089258196146292e8},{key:"YB",factor:1e24},{key:"TiB",factor:1099511627776},{key:"TB",factor:1e12},{key:"PiB",factor:0x4000000000000},{key:"PB",factor:1e15},{key:"MiB",factor:1048576},{key:"MB",factor:1e6},{key:"KiB",factor:1024},{key:"KB",factor:1e3},{key:"GiB",factor:1073741824},{key:"GB",factor:1e9},{key:"EiB",factor:0x1000000000000000},{key:"EB",factor:1e18},{key:"B",factor:1}];function n(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,i){var o,s,l,a=t("./globalState"),h=a.currentDelimiters(),u=a.currentCurrency().symbol,c=a.currentOrdinal(),d=a.getZeroFormat(),f=a.currentAbbreviations(),g=void 0;if("string"==typeof e)g=!function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var i=t.split(":");if(3!==i.length)return!1;var r=+i[0],n=+i[1],o=+i[2];return!isNaN(r)&&!isNaN(n)&&!isNaN(o)}(e,h)?function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,i){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,l=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var u="",c=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==e)return -1*t(c,i,o,s,l,a,h);for(var d=0;d<r.length;d++){var f=r[d];if((u=e.replace(f.key,""))!==e)return t(u,i,o,s,l,a,h)*f.factor}if((u=e.replace("%",""))!==e)return t(u,i,o,s,l,a,h)/100;var g=parseFloat(e);if(!isNaN(g)){var m=s(g);if(m&&"."!==m&&(u=e.replace(new RegExp("".concat(n(m),"$")),""))!==e)return t(u,i,o,s,l,a,h);var p={};Object.keys(a).forEach(function(t){p[a[t]]=t});for(var w=Object.keys(p).sort().reverse(),b=w.length,y=0;y<b;y++){var S=w[y],C=p[S];if((u=e.replace(S,""))!==e){var E=void 0;switch(C){case"thousand":E=1e3;break;case"million":E=1e6;break;case"billion":E=1e9;break;case"trillion":E=1e12}return t(u,i,o,s,l,a,h)*E}}}}(function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=t.replace(i,"");return(r=r.replace(RegExp("([0-9])".concat(n(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,i),e,i,o,s,l,a)}(e,h,u,c,d,f,i):(s=+(o=e.split(":"))[0],l=+o[1],+o[2]+60*l+3600*s);else{if("number"!=typeof e)return;g=e}if(void 0!==g)return g}}},{"./globalState":4}],10:[function(t,e,i){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=t("./unformatting"),o=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(o)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function a(t){return!!n.unformat(t)}function h(t,e,i){var n,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=Object.keys(t).map(function(n){if(!e[n])return console.error("".concat(i," Invalid key: ").concat(n)),!1;var o=t[n],l=e[n];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!h(o,s,"[Validate ".concat(n,"]"),!0))return!1}else if(r(o)!==l.type)return console.error("".concat(i," ").concat(n,' type mismatched: "').concat(l.type,'" expected, "').concat(r(o),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var a=l.restrictions.length,u=0;u<a;u++){var c=l.restrictions[u],d=c.restriction,f=c.message;if(!d(o,t))return console.error("".concat(i," ").concat(n," invalid value: ").concat(f)),!1}return l.restriction&&!l.restriction(o,t)?(console.error("".concat(i," ").concat(n," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(o)?(console.error("".concat(i," ").concat(n," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(o,'" provided')),!1):!l.children||!!h(o,l.children,"[Validate ".concat(n,"]"))});return o||l.push.apply(l,function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(n=Object.keys(e).map(function(r){var n=e[r];if("string"==typeof n&&(n={type:n}),n.mandatory){var o=n.mandatory;if("function"==typeof o&&(o=o(t)),o&&void 0===t[r])return console.error("".concat(i,' Missing mandatory key "').concat(r,'"')),!1}return!0}))||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}()),l.reduce(function(t,e){return t&&e},!0)}function u(t){return h(t,s,"[Validate format]")}e.exports={validate:function(t,e){var i=a(t),r=u(e);return i&&r},validateFormat:u,validateInput:a,validateLanguage:function(t){return h(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},6308:function(t,e,i){"use strict";var r=i(9851),n=i(6124),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(n(t)+" is not a function")}},182:function(t,e,i){"use strict";var r=i(3892),n=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o("Can't set "+n(t)+" as a prototype")}},2834:function(t,e,i){"use strict";var r=i(3237),n=i(4558),o=i(5742).f,s=r("unscopables"),l=Array.prototype;void 0===l[s]&&o(l,s,{configurable:!0,value:n(null)}),t.exports=function(t){l[s][t]=!0}},5396:function(t,e,i){"use strict";var r=i(2264),n=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(n(t)+" is not an object")}},8842:function(t,e,i){"use strict";var r=i(753),n=i(5585),o=i(4058),s=function(t){return function(e,i,s){var l,a=r(e),h=o(a),u=n(s,h);if(t&&i!=i){for(;h>u;)if((l=a[u++])!=l)return!0}else for(;h>u;u++)if((t||u in a)&&a[u]===i)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},1856:function(t,e,i){"use strict";var r=i(4839),n=i(52),o=TypeError,s=Object.getOwnPropertyDescriptor,l=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(n(t)&&!s(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},151:function(t,e,i){"use strict";var r=i(1192);t.exports=r([].slice)},3947:function(t,e,i){"use strict";var r=i(1192),n=r({}.toString),o=r("".slice);t.exports=function(t){return o(n(t),8,-1)}},4569:function(t,e,i){"use strict";var r=i(9744),n=i(9851),o=i(3947),s=i(3237)("toStringTag"),l=Object,a="Arguments"===o(function(){return arguments}()),h=function(t,e){try{return t[e]}catch(t){}};t.exports=r?o:function(t){var e,i,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=h(e=l(t),s))?i:a?o(e):"Object"===(r=o(e))&&n(e.callee)?"Arguments":r}},7994:function(t,e,i){"use strict";var r=i(8795),n=i(4166),o=i(6317),s=i(5742);t.exports=function(t,e,i){for(var l=n(e),a=s.f,h=o.f,u=0;u<l.length;u++){var c=l[u];r(t,c)||i&&r(i,c)||a(t,c,h(e,c))}}},7581:function(t,e,i){"use strict";var r=i(4839),n=i(5742),o=i(6999);t.exports=r?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},6999:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},8803:function(t,e,i){"use strict";var r=i(9851),n=i(5742),o=i(1416),s=i(8079);t.exports=function(t,e,i,l){l||(l={});var a=l.enumerable,h=void 0!==l.name?l.name:e;if(r(i)&&o(i,h,l),l.global)a?t[e]=i:s(e,i);else{try{l.unsafe?t[e]&&(a=!0):delete t[e]}catch(t){}a?t[e]=i:n.f(t,e,{value:i,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t}},8079:function(t,e,i){"use strict";var r=i(9532),n=Object.defineProperty;t.exports=function(t,e){try{n(r,t,{value:e,configurable:!0,writable:!0})}catch(i){r[t]=e}return e}},7551:function(t,e,i){"use strict";var r=i(6124),n=TypeError;t.exports=function(t,e){if(!delete t[e])throw new n("Cannot delete property "+r(e)+" of "+r(t))}},4839:function(t,e,i){"use strict";var r=i(8742);t.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},7072:function(t,e,i){"use strict";var r=i(9532),n=i(2264),o=r.document,s=n(o)&&n(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},2399:function(t){"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6589:function(t){"use strict";t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},8642:function(t,e,i){"use strict";var r=i(1246);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},4935:function(t,e,i){"use strict";var r=i(9532),n=i(3947);t.exports="process"===n(r.process)},1246:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},8305:function(t,e,i){"use strict";var r,n,o=i(9532),s=i(1246),l=o.process,a=o.Deno,h=l&&l.versions||a&&a.version,u=h&&h.v8;u&&(n=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(n=+r[1]),t.exports=n},5830:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6374:function(t,e,i){"use strict";var r=i(1192),n=Error,o=r("".replace),s=String(new n("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,a=l.test(s);t.exports=function(t,e){if(a&&"string"==typeof t&&!n.prepareStackTrace)for(;e--;)t=o(t,l,"");return t}},5906:function(t,e,i){"use strict";var r=i(7581),n=i(6374),o=i(4776),s=Error.captureStackTrace;t.exports=function(t,e,i,l){o&&(s?s(t,e):r(t,"stack",n(i,l)))}},4776:function(t,e,i){"use strict";var r=i(8742),n=i(6999);t.exports=!r(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)})},8060:function(t,e,i){"use strict";var r=i(9532),n=i(6317).f,o=i(7581),s=i(8803),l=i(8079),a=i(7994),h=i(3103);t.exports=function(t,e){var i,u,c,d,f,g=t.target,m=t.global,p=t.stat;if(i=m?r:p?r[g]||l(g,{}):r[g]&&r[g].prototype)for(u in e){if(d=e[u],c=t.dontCallGetSet?(f=n(i,u))&&f.value:i[u],!h(m?u:g+(p?".":"#")+u,t.forced)&&void 0!==c){if(typeof d==typeof c)continue;a(d,c)}(t.sham||c&&c.sham)&&o(d,"sham",!0),s(i,u,d,t)}}},8742:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},4311:function(t,e,i){"use strict";var r=i(3922),n=Function.prototype,o=n.apply,s=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},2332:function(t,e,i){"use strict";var r=i(1273),n=i(6308),o=i(3922),s=r(r.bind);t.exports=function(t,e){return n(t),void 0===e?t:o?s(t,e):function(){return t.apply(e,arguments)}}},3922:function(t,e,i){"use strict";var r=i(8742);t.exports=!r(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},173:function(t,e,i){"use strict";var r=i(3922),n=Function.prototype.call;t.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},5081:function(t,e,i){"use strict";var r=i(4839),n=i(8795),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,l=n(o,"name"),a=l&&(!r||r&&s(o,"name").configurable);t.exports={EXISTS:l,PROPER:l&&"something"===(function(){}).name,CONFIGURABLE:a}},781:function(t,e,i){"use strict";var r=i(1192),n=i(6308);t.exports=function(t,e,i){try{return r(n(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}}},1273:function(t,e,i){"use strict";var r=i(3947),n=i(1192);t.exports=function(t){if("Function"===r(t))return n(t)}},1192:function(t,e,i){"use strict";var r=i(3922),n=Function.prototype,o=n.call,s=r&&n.bind.bind(o,o);t.exports=r?s:function(t){return function(){return o.apply(t,arguments)}}},2969:function(t,e,i){"use strict";var r=i(9532),n=i(9851);t.exports=function(t,e){var i;return arguments.length<2?n(i=r[t])?i:void 0:r[t]&&r[t][e]}},3251:function(t,e,i){"use strict";var r=i(1192),n=i(52),o=i(9851),s=i(3947),l=i(6679),a=r([].push);t.exports=function(t){if(o(t))return t;if(n(t)){for(var e=t.length,i=[],r=0;r<e;r++){var h=t[r];"string"==typeof h?a(i,h):("number"==typeof h||"Number"===s(h)||"String"===s(h))&&a(i,l(h))}var u=i.length,c=!0;return function(t,e){if(c)return c=!1,e;if(n(this))return e;for(var r=0;r<u;r++)if(i[r]===t)return e}}}},3652:function(t,e,i){"use strict";var r=i(6308),n=i(8355);t.exports=function(t,e){var i=t[e];return n(i)?void 0:r(i)}},9532:function(t,e,i){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof i.g&&i.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},8795:function(t,e,i){"use strict";var r=i(1192),n=i(9087),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(n(t),e)}},4305:function(t){"use strict";t.exports={}},5132:function(t,e,i){"use strict";var r=i(2969);t.exports=r("document","documentElement")},9299:function(t,e,i){"use strict";var r=i(4839),n=i(8742),o=i(7072);t.exports=!r&&!n(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},4419:function(t,e,i){"use strict";var r=i(1192),n=i(8742),o=i(3947),s=Object,l=r("".split);t.exports=n(function(){return!s("z").propertyIsEnumerable(0)})?function(t){return"String"===o(t)?l(t,""):s(t)}:s},6348:function(t,e,i){"use strict";var r=i(9851),n=i(2264),o=i(9391);t.exports=function(t,e,i){var s,l;return o&&r(s=e.constructor)&&s!==i&&n(l=s.prototype)&&l!==i.prototype&&o(t,l),t}},5229:function(t,e,i){"use strict";var r=i(1192),n=i(9851),o=i(8947),s=r(Function.toString);n(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource},8832:function(t,e,i){"use strict";var r=i(2264),n=i(7581);t.exports=function(t,e){r(e)&&"cause"in e&&n(t,"cause",e.cause)}},7555:function(t,e,i){"use strict";var r,n,o,s=i(230),l=i(9532),a=i(2264),h=i(7581),u=i(8795),c=i(8947),d=i(1158),f=i(4305),g="Object already initialized",TypeError=l.TypeError,WeakMap=l.WeakMap;if(s||c.state){var m=c.state||(c.state=new WeakMap);m.get=m.get,m.has=m.has,m.set=m.set,r=function(t,e){if(m.has(t))throw new TypeError(g);return e.facade=t,m.set(t,e),e},n=function(t){return m.get(t)||{}},o=function(t){return m.has(t)}}else{var p=d("state");f[p]=!0,r=function(t,e){if(u(t,p))throw new TypeError(g);return e.facade=t,h(t,p,e),e},n=function(t){return u(t,p)?t[p]:{}},o=function(t){return u(t,p)}}t.exports={set:r,get:n,has:o,enforce:function(t){return o(t)?n(t):r(t,{})},getterFor:function(t){return function(e){var i;if(!a(e)||(i=n(e)).type!==t)throw new TypeError("Incompatible receiver, "+t+" required");return i}}}},52:function(t,e,i){"use strict";var r=i(3947);t.exports=Array.isArray||function(t){return"Array"===r(t)}},9851:function(t){"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},3103:function(t,e,i){"use strict";var r=i(8742),n=i(9851),o=/#|\.prototype\./,s=function(t,e){var i=a[l(t)];return i===u||i!==h&&(n(e)?r(e):!!e)},l=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},a=s.data={},h=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},8355:function(t){"use strict";t.exports=function(t){return null==t}},2264:function(t,e,i){"use strict";var r=i(9851);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},3892:function(t,e,i){"use strict";var r=i(2264);t.exports=function(t){return r(t)||null===t}},8420:function(t){"use strict";t.exports=!1},7701:function(t,e,i){"use strict";var r=i(2969),n=i(9851),o=i(7883),s=i(6293),l=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return n(e)&&o(e.prototype,l(t))}},4058:function(t,e,i){"use strict";var r=i(2466);t.exports=function(t){return r(t.length)}},1416:function(t,e,i){"use strict";var r=i(1192),n=i(8742),o=i(9851),s=i(8795),l=i(4839),a=i(5081).CONFIGURABLE,h=i(5229),u=i(7555),c=u.enforce,d=u.get,f=String,g=Object.defineProperty,m=r("".slice),p=r("".replace),w=r([].join),b=l&&!n(function(){return 8!==g(function(){},"length",{value:8}).length}),y=String(String).split("String"),S=t.exports=function(t,e,i){"Symbol("===m(f(e),0,7)&&(e="["+p(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(l?g(t,"name",{value:e,configurable:!0}):t.name=e),b&&i&&s(i,"arity")&&t.length!==i.arity&&g(t,"length",{value:i.arity});try{i&&s(i,"constructor")&&i.constructor?l&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=c(t);return s(r,"source")||(r.source=w(y,"string"==typeof e?e:"")),t};Function.prototype.toString=S(function(){return o(this)&&d(this).source||h(this)},"toString")},4532:function(t){"use strict";var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?i:e)(r)}},2949:function(t,e,i){"use strict";var r=i(6679);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},4558:function(t,e,i){"use strict";var r,n=i(5396),o=i(4809),s=i(5830),l=i(4305),a=i(5132),h=i(7072),u=i(1158),c="prototype",d="script",f=u("IE_PROTO"),g=function(){},m=function(t){return"<"+d+">"+t+"</"+d+">"},p=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},w=function(){var t,e=h("iframe");return e.style.display="none",a.appendChild(e),e.src=String("java"+d+":"),(t=e.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F},b=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}b="undefined"!=typeof document?document.domain&&r?p(r):w():p(r);for(var t=s.length;t--;)delete b[c][s[t]];return b()};l[f]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(g[c]=n(t),i=new g,g[c]=null,i[f]=t):i=b(),void 0===e?i:o.f(i,e)}},4809:function(t,e,i){"use strict";var r=i(4839),n=i(7747),o=i(5742),s=i(5396),l=i(753),a=i(2208);e.f=r&&!n?Object.defineProperties:function(t,e){s(t);for(var i,r=l(e),n=a(e),h=n.length,u=0;h>u;)o.f(t,i=n[u++],r[i]);return t}},5742:function(t,e,i){"use strict";var r=i(4839),n=i(9299),o=i(7747),s=i(5396),l=i(5007),a=TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",f="writable";e.f=r?o?function(t,e,i){if(s(t),e=l(e),s(i),"function"==typeof t&&"prototype"===e&&"value"in i&&f in i&&!i[f]){var r=u(t,e);r&&r[f]&&(t[e]=i.value,i={configurable:d in i?i[d]:r[d],enumerable:c in i?i[c]:r[c],writable:!1})}return h(t,e,i)}:h:function(t,e,i){if(s(t),e=l(e),s(i),n)try{return h(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new a("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},6317:function(t,e,i){"use strict";var r=i(4839),n=i(173),o=i(8076),s=i(6999),l=i(753),a=i(5007),h=i(8795),u=i(9299),c=Object.getOwnPropertyDescriptor;e.f=r?c:function(t,e){if(t=l(t),e=a(e),u)try{return c(t,e)}catch(t){}if(h(t,e))return s(!n(o.f,t,e),t[e])}},2066:function(t,e,i){"use strict";var r=i(9915),n=i(5830).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,n)}},2198:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},7883:function(t,e,i){"use strict";var r=i(1192);t.exports=r({}.isPrototypeOf)},9915:function(t,e,i){"use strict";var r=i(1192),n=i(8795),o=i(753),s=i(8842).indexOf,l=i(4305),a=r([].push);t.exports=function(t,e){var i,r=o(t),h=0,u=[];for(i in r)!n(l,i)&&n(r,i)&&a(u,i);for(;e.length>h;)n(r,i=e[h++])&&(~s(u,i)||a(u,i));return u}},2208:function(t,e,i){"use strict";var r=i(9915),n=i(5830);t.exports=Object.keys||function(t){return r(t,n)}},8076:function(t,e){"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,n=r&&!i.call({1:2},1);e.f=n?function(t){var e=r(this,t);return!!e&&e.enumerable}:i},9391:function(t,e,i){"use strict";var r=i(781),n=i(5396),o=i(182);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=r(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,r){return n(i),o(r),e?t(i,r):i.__proto__=r,i}}():void 0)},3465:function(t,e,i){"use strict";var r=i(173),n=i(9851),o=i(2264),s=TypeError;t.exports=function(t,e){var i,l;if("string"===e&&n(i=t.toString)&&!o(l=r(i,t))||n(i=t.valueOf)&&!o(l=r(i,t))||"string"!==e&&n(i=t.toString)&&!o(l=r(i,t)))return l;throw new s("Can't convert object to primitive value")}},4166:function(t,e,i){"use strict";var r=i(2969),n=i(1192),o=i(2066),s=i(2198),l=i(5396),a=n([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(l(t)),i=s.f;return i?a(e,i(t)):e}},403:function(t,e,i){"use strict";var r=i(5742).f;t.exports=function(t,e,i){i in t||r(t,i,{configurable:!0,get:function(){return e[i]},set:function(t){e[i]=t}})}},5834:function(t,e,i){"use strict";var r=i(8355),n=TypeError;t.exports=function(t){if(r(t))throw new n("Can't call method on "+t);return t}},2178:function(t,e,i){"use strict";var r,n=i(9532),o=i(4311),s=i(9851),l=i(6589),a=i(1246),h=i(151),u=i(2517),Function=n.Function,c=/MSIE .\./.test(a)||l&&((r=n.Bun.version.split(".")).length<3||"0"===r[0]&&(r[1]<3||"3"===r[1]&&"0"===r[2]));t.exports=function(t,e){var i=e?2:1;return c?function(r,n){var l=u(arguments.length,1)>i,a=s(r)?r:Function(r),c=l?h(arguments,i):[],d=l?function(){o(a,this,c)}:a;return e?t(d,n):t(d)}:t}},1158:function(t,e,i){"use strict";var r=i(3108),n=i(6934),o=r("keys");t.exports=function(t){return o[t]||(o[t]=n(t))}},8947:function(t,e,i){"use strict";var r=i(9532),n=i(8079),o="__core-js_shared__",s=r[o]||n(o,{});t.exports=s},3108:function(t,e,i){"use strict";var r=i(8420),n=i(8947);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.35.1",mode:r?"pure":"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"})},4726:function(t,e,i){"use strict";var r=i(8305),n=i(8742),o=i(9532).String;t.exports=!!Object.getOwnPropertySymbols&&!n(function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t) instanceof Symbol)||!Symbol.sham&&r&&r<41})},7815:function(t,e,i){"use strict";var r,n,o,s,l=i(9532),a=i(4311),h=i(2332),u=i(9851),c=i(8795),d=i(8742),f=i(5132),g=i(151),m=i(7072),p=i(2517),w=i(8642),b=i(4935),y=l.setImmediate,S=l.clearImmediate,C=l.process,E=l.Dispatch,Function=l.Function,MessageChannel=l.MessageChannel,String=l.String,T=0,R={},O="onreadystatechange";d(function(){r=l.location});var M=function(t){if(c(R,t)){var e=R[t];delete R[t],e()}},N=function(t){return function(){M(t)}},I=function(t){M(t.data)},x=function(t){l.postMessage(String(t),r.protocol+"//"+r.host)};y&&S||(y=function(t){p(arguments.length,1);var e=u(t)?t:Function(t),i=g(arguments,1);return R[++T]=function(){a(e,void 0,i)},n(T),T},S=function(t){delete R[t]},b?n=function(t){C.nextTick(N(t))}:E&&E.now?n=function(t){E.now(N(t))}:MessageChannel&&!w?(s=(o=new MessageChannel).port2,o.port1.onmessage=I,n=h(s.postMessage,s)):l.addEventListener&&u(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!d(x)?(n=x,l.addEventListener("message",I,!1)):n=O in m("script")?function(t){f.appendChild(m("script"))[O]=function(){f.removeChild(this),M(t)}}:function(t){setTimeout(N(t),0)}),t.exports={set:y,clear:S}},5585:function(t,e,i){"use strict";var r=i(1662),n=Math.max,o=Math.min;t.exports=function(t,e){var i=r(t);return i<0?n(i+e,0):o(i,e)}},753:function(t,e,i){"use strict";var r=i(4419),n=i(5834);t.exports=function(t){return r(n(t))}},1662:function(t,e,i){"use strict";var r=i(4532);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},2466:function(t,e,i){"use strict";var r=i(1662),n=Math.min;t.exports=function(t){var e=r(t);return e>0?n(e,9007199254740991):0}},9087:function(t,e,i){"use strict";var r=i(5834),n=Object;t.exports=function(t){return n(r(t))}},547:function(t,e,i){"use strict";var r=i(173),n=i(2264),o=i(7701),s=i(3652),l=i(3465),a=i(3237),h=TypeError,u=a("toPrimitive");t.exports=function(t,e){if(!n(t)||o(t))return t;var i,a=s(t,u);if(a){if(void 0===e&&(e="default"),!n(i=r(a,t,e))||o(i))return i;throw new h("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(t,e)}},5007:function(t,e,i){"use strict";var r=i(547),n=i(7701);t.exports=function(t){var e=r(t,"string");return n(e)?e:e+""}},9744:function(t,e,i){"use strict";var r=i(3237)("toStringTag"),n={};n[r]="z",t.exports="[object z]"===String(n)},6679:function(t,e,i){"use strict";var r=i(4569),n=String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return n(t)}},6124:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6934:function(t,e,i){"use strict";var r=i(1192),n=0,o=Math.random(),s=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++n+o,36)}},6293:function(t,e,i){"use strict";var r=i(4726);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7747:function(t,e,i){"use strict";var r=i(4839),n=i(8742);t.exports=r&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},2517:function(t){"use strict";var e=TypeError;t.exports=function(t,i){if(t<i)throw new e("Not enough arguments");return t}},230:function(t,e,i){"use strict";var r=i(9532),n=i(9851),WeakMap=r.WeakMap;t.exports=n(WeakMap)&&/native code/.test(String(WeakMap))},3237:function(t,e,i){"use strict";var r=i(9532),n=i(3108),o=i(8795),s=i(6934),l=i(4726),a=i(6293),Symbol=r.Symbol,h=n("wks"),u=a?Symbol.for||Symbol:Symbol&&Symbol.withoutSetter||s;t.exports=function(t){return o(h,t)||(h[t]=l&&o(Symbol,t)?Symbol[t]:u("Symbol."+t)),h[t]}},3328:function(t,e,i){"use strict";var r=i(2969),n=i(8795),o=i(7581),s=i(7883),l=i(9391),a=i(7994),h=i(403),u=i(6348),c=i(2949),d=i(8832),f=i(5906),g=i(4839),m=i(8420);t.exports=function(t,e,i,p){var w="stackTraceLimit",b=p?2:1,y=t.split("."),S=y[y.length-1],C=r.apply(null,y);if(C){var E=C.prototype;if(!m&&n(E,"cause")&&delete E.cause,!i)return C;var T=r("Error"),R=e(function(t,e){var i=c(p?e:t,void 0),r=p?new C(t):new C;return void 0!==i&&o(r,"message",i),f(r,R,r.stack,2),this&&s(E,this)&&u(r,this,R),arguments.length>b&&d(r,arguments[b]),r});if(R.prototype=E,"Error"!==S?l?l(R,T):a(R,T,{name:!0}):g&&w in C&&(h(R,C,w),h(R,C,"prepareStackTrace")),a(R,C),!m)try{E.name!==S&&o(E,"name",S),E.constructor=R}catch(t){}return R}}},3893:function(t,e,i){"use strict";var r=i(8060),n=i(9087),o=i(4058),s=i(1662),l=i(2834);r({target:"Array",proto:!0},{at:function(t){var e=n(this),i=o(e),r=s(t),l=r>=0?r:i+r;return l<0||l>=i?void 0:e[l]}}),l("at")},2916:function(t,e,i){"use strict";var r=i(8060),n=i(9087),o=i(4058),s=i(1856),l=i(2399);r({target:"Array",proto:!0,arity:1,forced:i(8742)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=n(this),i=o(e),r=arguments.length;l(i+r);for(var a=0;a<r;a++)e[i]=arguments[a],i++;return s(e,i),i}})},921:function(t,e,i){"use strict";i(2834)("flat")},4247:function(t,e,i){"use strict";var r=i(8060),n=i(9087),o=i(4058),s=i(1856),l=i(7551),a=i(2399);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=n(this),i=o(e),r=arguments.length;if(r){a(i+r);for(var h=i;h--;){var u=h+r;h in e?e[u]=e[h]:l(e,u)}for(var c=0;c<r;c++)e[c]=arguments[c]}return s(e,i+r)}})},2954:function(t,e,i){"use strict";var r=i(8060),n=i(9532),o=i(4311),s=i(3328),l="WebAssembly",WebAssembly=n[l],a=7!==Error("e",{cause:7}).cause,h=function(t,e){var i={};i[t]=s(t,e,a),r({global:!0,constructor:!0,arity:1,forced:a},i)},u=function(t,e){if(WebAssembly&&WebAssembly[t]){var i={};i[t]=s(l+"."+t,e,a),r({target:l,stat:!0,constructor:!0,arity:1,forced:a},i)}};h("Error",function(t){return function(e){return o(t,this,arguments)}}),h("EvalError",function(t){return function(e){return o(t,this,arguments)}}),h("RangeError",function(t){return function(e){return o(t,this,arguments)}}),h("ReferenceError",function(t){return function(e){return o(t,this,arguments)}}),h("SyntaxError",function(t){return function(e){return o(t,this,arguments)}}),h("TypeError",function(t){return function(e){return o(t,this,arguments)}}),h("URIError",function(t){return function(e){return o(t,this,arguments)}}),u("CompileError",function(t){return function(e){return o(t,this,arguments)}}),u("LinkError",function(t){return function(e){return o(t,this,arguments)}}),u("RuntimeError",function(t){return function(e){return o(t,this,arguments)}})},7277:function(t,e,i){"use strict";var r=i(8060),n=i(2969),o=i(4311),s=i(173),l=i(1192),a=i(8742),h=i(9851),u=i(7701),c=i(151),d=i(3251),f=i(4726),g=String,m=n("JSON","stringify"),p=l(/./.exec),w=l("".charAt),b=l("".charCodeAt),y=l("".replace),S=l(1..toString),C=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,T=/^[\uDC00-\uDFFF]$/,R=!f||a(function(){var t=n("Symbol")("stringify detection");return"[null]"!==m([t])||"{}"!==m({a:t})||"{}"!==m(Object(t))}),O=a(function(){return'"\udf06\ud834"'!==m("\uDF06\uD834")||'"\udead"'!==m("\uDEAD")}),M=function(t,e){var i=c(arguments),r=d(e);if(!(!h(r)&&(void 0===t||u(t))))return i[1]=function(t,e){if(h(r)&&(e=s(r,this,g(t),e)),!u(e))return e},o(m,null,i)},N=function(t,e,i){var r=w(i,e-1),n=w(i,e+1);return p(E,t)&&!p(T,n)||p(T,t)&&!p(E,r)?"\\u"+S(b(t,0),16):t};m&&r({target:"JSON",stat:!0,arity:3,forced:R||O},{stringify:function(t,e,i){var r=c(arguments),n=o(R?M:m,null,r);return O&&"string"==typeof n?y(n,C,N):n}})},3839:function(t,e,i){"use strict";var r=i(8060),n=i(9532),o=i(7815).clear;r({global:!0,bind:!0,enumerable:!0,forced:n.clearImmediate!==o},{clearImmediate:o})},9910:function(t,e,i){"use strict";i(3839),i(3562)},3562:function(t,e,i){"use strict";var r=i(8060),n=i(9532),o=i(7815).set,s=i(2178),l=n.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:n.setImmediate!==l},{setImmediate:l})},6735:function(t,e,i){"use strict";i.d(e,{sZ:function(){return tw}});var r=i(2265),n=i(4887),o=i(3553),s=i(3732),l=i(8015),a=i(4317),h=i(8444),u=i(6324),c=i(2694),d=i(9275);let f={CELL_TYPE:"text",editor:c.H,renderer:d.V};var g=i(8422),m=i(1070),p=i(1648);function w(t,e){let i=new o.Z(t,e||{},s.mc);return i.init(),i}function b(t,e,i){return e=N(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return x(t)}(t,y()?Reflect.construct(e,i||[],N(t).constructor):e.apply(t,i))}function y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(y=function(){return!!t})()}function S(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function C(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function R(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function O(t,e,i){return e&&R(t.prototype,e),i&&R(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function M(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}function N(t){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function x(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}(0,u.xN)(f),w.editors={BaseEditor:g.Hf},w.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new o.Z(t,e,s.mc)},w.DefaultSettings=(0,l.Z)(),w.hooks=a.Z.getSingleton(),w.CellCoords=m.Z,w.CellRange=p.Z,w.packageName="handsontable",w.buildDate="16/01/2024 10:27:23",w.version="14.1.0",w.languages={dictionaryKeys:h.Zs,getLanguageDictionary:h.qG,getLanguagesDictionaries:h.vq,registerLanguageDictionary:h.MG,getTranslatedPhrase:h.vk};var H=null,_="global";function A(t,e){var i=r.Children.toArray(t),n=r.Children.count(t),o=null;return 0!==n&&(o=1===n&&i[0].props[e]?i[0]:i.find(function(t){return void 0!==t.props[e]})),o||null}function L(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function P(t,e){if(void 0===t||null===e)return null;var i=F(e.props,!1);return i.className="".concat("hot-wrapper-editor-container"," ").concat(i.className),n.createPortal(r.createElement("div",Object.assign({},i),e),t.body)}function D(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_,n=A(t,"hot-editor"),o=L(n);return n?r.cloneElement(n,{emitEditorInstance:function(t,i){e.get(o)||e.set(o,new Map),e.get(o).set(null!=i?i:_,t)},editorColumnScope:i,isEditor:!0}):null}function F(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var B=function(){function t(){T(this,t)}return O(t,null,[{key:"getSettings",value:function(t){var e={};if(t.settings){var i=t.settings;for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}for(var n in t)"settings"!==n&&"children"!==n&&t.hasOwnProperty(n)&&(e[n]=t[n]);return e}}]),t}(),W=function(t){function e(){return T(this,e),b(this,e,arguments)}return M(e,t),O(e,[{key:"getSettingsProps",value:function(){var t=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(e){return!t.internalProps.includes(e)}).reduce(function(e,i){return e[i]=t.props[i],e},{})}},{key:"getLocalEditorElement",value:function(){return D(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var t=this.props._getChildElementByType(this.props.children,"hot-renderer"),e=this.getLocalEditorElement();this.columnSettings=B.getSettings(this.getSettingsProps()),null!==t&&(this.columnSettings.renderer=this.props._getRendererWrapper(t),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==e&&(this.columnSettings.editor=this.props._getEditorClass(e,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var t=P(this.props._getOwnerDocument(),this.getLocalEditorElement());return r.createElement(r.Fragment,null,t)}}]),e}(r.Component),V=function(t){function e(){var t;return T(this,e),t=b(this,e,arguments),t.state={portals:[]},t}return M(e,t),O(e,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.state.portals)}}]),e}(r.Component);function j(t,e){return t(e={exports:{}},e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U="function"==typeof Symbol&&Symbol.for,$=U?Symbol.for("react.element"):60103,z=U?Symbol.for("react.portal"):60106,G=U?Symbol.for("react.fragment"):60107,K=U?Symbol.for("react.strict_mode"):60108,X=U?Symbol.for("react.profiler"):60114,Y=U?Symbol.for("react.provider"):60109,Z=U?Symbol.for("react.context"):60110,q=U?Symbol.for("react.async_mode"):60111,J=U?Symbol.for("react.concurrent_mode"):60111,Q=U?Symbol.for("react.forward_ref"):60112,tt=U?Symbol.for("react.suspense"):60113,te=U?Symbol.for("react.suspense_list"):60120,ti=U?Symbol.for("react.memo"):60115,tr=U?Symbol.for("react.lazy"):60116,tn=U?Symbol.for("react.block"):60121,to=U?Symbol.for("react.fundamental"):60117,ts=U?Symbol.for("react.responder"):60118,tl=U?Symbol.for("react.scope"):60119;function ta(t){if("object"===E(t)&&null!==t){var e=t.$$typeof;switch(e){case $:switch(t=t.type){case q:case J:case G:case X:case K:case tt:return t;default:switch(t=t&&t.$$typeof){case Z:case Q:case tr:case ti:case Y:return t;default:return e}}case z:return e}}}function th(t){return ta(t)===J}var tu={AsyncMode:q,ConcurrentMode:J,ContextConsumer:Z,ContextProvider:Y,Element:$,ForwardRef:Q,Fragment:G,Lazy:tr,Memo:ti,Portal:z,Profiler:X,StrictMode:K,Suspense:tt,isAsyncMode:function(t){return th(t)||ta(t)===q},isConcurrentMode:th,isContextConsumer:function(t){return ta(t)===Z},isContextProvider:function(t){return ta(t)===Y},isElement:function(t){return"object"===E(t)&&null!==t&&t.$$typeof===$},isForwardRef:function(t){return ta(t)===Q},isFragment:function(t){return ta(t)===G},isLazy:function(t){return ta(t)===tr},isMemo:function(t){return ta(t)===ti},isPortal:function(t){return ta(t)===z},isProfiler:function(t){return ta(t)===X},isStrictMode:function(t){return ta(t)===K},isSuspense:function(t){return ta(t)===tt},isValidElementType:function(t){return"string"==typeof t||"function"==typeof t||t===G||t===J||t===X||t===K||t===tt||t===te||"object"===E(t)&&null!==t&&(t.$$typeof===tr||t.$$typeof===ti||t.$$typeof===Y||t.$$typeof===Z||t.$$typeof===Q||t.$$typeof===to||t.$$typeof===ts||t.$$typeof===tl||t.$$typeof===tn)},typeOf:ta},tc=j(function(t,e){});function td(){}function tf(){}tc.AsyncMode,tc.ConcurrentMode,tc.ContextConsumer,tc.ContextProvider,tc.Element,tc.ForwardRef,tc.Fragment,tc.Lazy,tc.Memo,tc.Portal,tc.Profiler,tc.StrictMode,tc.Suspense,tc.isAsyncMode,tc.isConcurrentMode,tc.isContextConsumer,tc.isContextProvider,tc.isElement,tc.isForwardRef,tc.isFragment,tc.isLazy,tc.isMemo,tc.isPortal,tc.isProfiler,tc.isStrictMode,tc.isSuspense,tc.isValidElementType,tc.typeOf,j(function(t){t.exports=tu}),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var r=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==r.join(""))return!1;var n={};"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}(),Function.call.bind(Object.prototype.hasOwnProperty),tf.resetWarningCache=td;var tg=function(){function t(t,e,i,r,n,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:tf,resetWarningCache:td};return i.PropTypes=i,i},tm=j(function(t){t.exports=tg()}),tp=function(t){function e(){var t;return T(this,e),t=b(this,e,arguments),t.id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCacheArray=[],t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return M(e,t),O(e,[{key:"hotInstance",get:function(){return this.__hotInstance&&(!this.__hotInstance||this.__hotInstance.isDestroyed)?(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null):this.__hotInstance},set:function(t){this.__hotInstance=t}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!=typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(t){this.hotElementRef=t}},{key:"getRendererWrapper",value:function(t){var e=this;return function(i,o,s,l,a,h,u){var c=e.getRenderedCellCache();if(c.has("".concat(s,"-").concat(l))&&(o.innerHTML=c.get("".concat(s,"-").concat(l)).innerHTML),o&&!o.getAttribute("ghost-table")){for(var d=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;i||(i=document),H||(H=i.createDocumentFragment());var o=i.createElement("DIV");H.appendChild(o);var s=r.cloneElement(t,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?S(Object(i),!0).forEach(function(e){var r,n;r=e,n=i[e],(r=C(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:n.createPortal(s,o,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:o}}(t,{TD:o,row:s,col:l,prop:a,value:h,cellProperties:u,isRenderer:!0},o.ownerDocument),f=d.portal,g=d.portalContainer;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(g),e.portalCacheArray.push(f)}return c.set("".concat(s,"-").concat(l),o),o}}},{key:"getEditorClass",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_,r=L(t),n=null===(e=this.getEditorCache().get(r))||void 0===e?void 0:e.get(i);return this.makeEditorClass(n)}},{key:"makeEditorClass",value:function(t){var e=function(e){function i(e){var r;return T(this,i),r=b(this,i,[e]),t.hotCustomEditorInstance=x(r),r.editorComponent=t,r}return M(i,e),O(i,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),i}(w.editors.BaseEditor);return Object.getOwnPropertyNames(w.editors.BaseEditor.prototype).forEach(function(i){"constructor"!==i&&(e.prototype[i]=function(){for(var e,r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t[i]).call.apply(e,[t].concat(n))})}),e}},{key:"getGlobalRendererElement",value:function(){return A(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return D(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var t=B.getSettings(this.props),e=this.getGlobalRendererElement(),i=this.getGlobalEditorElement();return t.columns=this.columnSettings.length?this.columnSettings:t.columns,i?t.editor=this.getEditorClass(i,_):t.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),e?(t.renderer=this.getRendererWrapper(e),this.componentRendererColumns.set("global",!0)):t.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),t}},{key:"displayAutoSizeWarning",value:function(t){var e,i;this.hotInstance&&(null!==(e=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==e&&e.enabled||null!==(i=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==i&&i.enabled)&&this.componentRendererColumns.size>0&&function(){if("undefined"!=typeof console){var t;(t=console).warn.apply(t,arguments)}}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(t,e){this.columnSettings[e]=t}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var t,e=this;this.renderersPortalManager.setState({portals:function(t){if(Array.isArray(t))return k(t)}(t=this.portalCacheArray)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return k(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},function(){e.portalCacheArray=[]})}},{key:"updateHot",value:function(t){this.hotInstance&&this.hotInstance.updateSettings(t,!1)}},{key:"setRenderersPortalManagerRef",value:function(t){this.renderersPortalManager=t}},{key:"componentDidMount",value:function(){var t=this,e=this.createNewGlobalSettings();this.hotInstance=new w.Core(this.hotElementRef,e),this.hotInstance.addHook("beforeViewRender",function(){return t.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return t.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(e)}},{key:"componentDidUpdate",value:function(){this.clearCache();var t=this.createNewGlobalSettings();this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var t=this,e=r.Children.toArray(this.props.children).filter(function(t){return t.type===W}).map(function(e,i){return r.cloneElement(e,{_componentRendererColumns:t.componentRendererColumns,_emitColumnSettings:t.setHotColumnSettings.bind(t),_columnIndex:i,_getChildElementByType:A.bind(t),_getRendererWrapper:t.getRendererWrapper.bind(t),_getEditorClass:t.getEditorClass.bind(t),_getOwnerDocument:t.getOwnerDocument.bind(t),_getEditorCache:t.getEditorCache.bind(t),children:e.props.children})}),i=F(this.props),n=P(this.getOwnerDocument(),this.getGlobalEditorElement());return r.createElement(r.Fragment,null,r.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},i),e),r.createElement(V,{ref:this.setRenderersPortalManagerRef.bind(this)}),n)}}],[{key:"version",get:function(){return"14.1.0"}}]),e}(r.Component);tp.propTypes={style:tm.object,id:tm.string,className:tm.string};var tv=["children"],tw=r.forwardRef(function(t,e){var i,n=t.children,o=function(t,e){if(null==t)return{};var i,r,n=function(t,e){if(null==t)return{};var i,r,n={},o=Object.keys(t);for(r=0;r<o.length;r++)i=o[r],e.indexOf(i)>=0||(n[i]=t[i]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}(t,tv),s="function"==typeof r.useId?r.useId():void 0,l=null!==(i=o.id)&&void 0!==i?i:s;return r.createElement(tp,Object.assign({id:l},o,{ref:e}),n)});tw.version=tp.version,r.Component},292:function(t,e,i){"use strict";i.d(e,{P:function(){return l},Q:function(){return s}});let r=/^(\r\n|\n\r|\r|\n)/,n=/^[^\t\r\n]+/,o=/^\t/;function s(t){let e;let i=[[""]];if(0===t.length)return i;let s=0,l=0;for(;t.length>0&&e!==t.length;)if(e=t.length,t.match(o))t=t.replace(o,""),s+=1,i[l][s]="";else if(t.match(r))t=t.replace(r,""),s=0,i[l+=1]=[""];else{let e="";if(t.startsWith('"')){let i=0,r=!0;for(;r;){let n=t.slice(0,1);'"'===n&&(i+=1),e+=n,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&i%2==0)&&(r=!1)}e=e.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join(""))}else{let i=t.match(n);e=i?i[0]:"",t=t.slice(e.length)}i[l][s]=e}return i}function l(t){let e,i,r,n,o;let s="";for(e=0,i=t.length;e<i;e+=1){for(r=0,n=t[e].length;r<n;r+=1)r>0&&(s+="	"),"string"==typeof(o=t[e][r])?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:null==o?s+="":s+=o;e!==i-1&&(s+="\n")}return s}},746:function(t,e,i){"use strict";i.d(e,{Ii:function(){return r},vp:function(){return n}});let r=1,n=2},7431:function(t,e,i){"use strict";i.d(e,{E:function(){return a}}),i(2916),i(3893),i(2954);var r=i(746);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{static get DEFAULT_WIDTH(){return 50}constructor(t){n(this,"count",0),n(this,"startColumn",null),n(this,"endColumn",null),n(this,"startPosition",null),n(this,"isVisibleInTrimmingContainer",!1),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:void 0}),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,s(this,l,"set"),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:i,scrollOffset:n,totalColumns:s,viewportWidth:a}=o(this,l),h=Math.max(o(this,l).scrollOffset,0),u=h>0?a+1:a,c=0,d=!0,f=[],g=0,m=0;for(let i=0;i<s;i++)if(t=this._getColumnWidth(i),c<=h&&e!==r.vp&&(this.startColumn=i,g=t),c>=h&&c+(e===r.vp?t:0)<=h+u&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=i,g=t),this.endColumn=i),f.push(c),c+=t,m=t,e!==r.vp&&(this.endColumn=i),c>=h+a){d=!1;break}let p=e===r.vp?0:m,w=e===r.vp?g:0;if(n+a-u<-1*o(this,l).inlineStartOffset||n>f.at(-1)+p||-1*o(this,l).scrollOffset-o(this,l).viewportWidth>-1*w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===s-1&&d)for(this.startColumn=this.endColumn;this.startColumn>0;){let i=f[this.endColumn]+t-f[this.startColumn-1];if((i<=a||e!==r.vp)&&(this.startColumn-=1),i>a)break}e===r.Ii&&null!==this.startColumn&&i&&i(this),this.startPosition=f[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=o(this,l).columnWidthFn(t);return isNaN(e)&&(e=a.DEFAULT_WIDTH),e}}},1070:function(t,e,i){"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function o(t,e,i){var r=s(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}i(2954);var l=new WeakMap;class a{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,"row",null),r(this,"col",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),o(this,l,i),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){let{countRows:e,countCols:i,countRowHeaders:r,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-n)&&!(this.col<-r)&&!(this.row>=e)&&!(this.col>=i)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return n(this,l)}isSouthEastOf(t){return this.row>=t.row&&(n(this,l)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(n(this,l)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(n(this,l)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(n(this,l)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof a&&o(this,l,t.isRtl()),this}clone(){return new a(this.row,this.col,n(this,l))}toObject(){return{row:this.row,col:this.col}}}e.Z=a},1648:function(t,e,i){"use strict";i(2916),i(2954);var r=i(1070);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n(this,"highlight",null),n(this,"from",null),n(this,"to",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=i.clone(),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,s(this,l,"set"),r)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){let{row:e,col:i}=t,r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return r.row<=e&&n.row>=e&&r.col<=i&&n.col>=i}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>i.row||t.col>i.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(i.row,t.row),Math.max(i.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),r=this.getDirection(),n=t.getOuterTopStartCorner(),o=t.getOuterBottomEndCorner(),s=Math.min(e.row,n.row),l=Math.min(e.col,n.col),a=Math.max(i.row,o.row),h=Math.max(i.col,o.col),u=this._createCellCoords(s,l),c=this._createCellCoords(a,h);return this.from=u,this.to=c,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){let t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){let t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return o(this,l)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return o(this,l)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return o(this,l)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return o(this,l)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return o(this,l)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return o(this,l)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return o(this,l)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return o(this,l)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof r.Z&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];let e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},r=[];return e.top===i.top&&r.push("top"),e.right===i.right&&r.push(o(this,l)?"left":"right"),e.bottom===i.bottom&&r.push("bottom"),e.left===i.left&&r.push(o(this,l)?"right":"left"),r}getInner(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let n=t.col;n<=e.col;n++)this.from.row===r&&this.from.col===n||this.to.row===r&&this.to.col===n||i.push(this._createCellCoords(r,n));return i}getAll(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let n=t.col;n<=e.col;n++)t.row===r&&t.col===n?i.push(t):e.row===r&&e.col===n?i.push(e):i.push(this._createCellCoords(r,n));return i}forAll(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=e.row;r<=i.row;r++)for(let n=e.col;n<=i.col;n++){let e=t(r,n);if(!1===e)return}}clone(){return new a(this.highlight,this.from,this.to,o(this,l))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new r.Z(t,e,o(this,l))}}e.Z=a},1155:function(t,e,i){"use strict";i.d(e,{i:function(){return S}});var r=i(8422),n=i(5878);class o extends r.Hf{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type){let t=this.TD.querySelector('input[type="checkbox"]');(0,n.pv)(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}i(2916);var s=i(1881),l=i(9773),a=i(2518),h=i(2659),u=i(4317),c=i(8200),d=i(2855);let f=new WeakMap,g=new WeakMap,m="data-row",p="data-col",w="checkbox";function b(t,e,i,r,o,u,w){let{rootDocument:b}=t,S=t.getSettings().ariaTags;s.Z.apply(this,[t,e,i,r,o,u,w]),function(t){let e=g.get(t);if(!e){let{rootElement:i}=t;(e=new l.Z(t)).addEventListener(i,"click",e=>(function(t,e){let{target:i}=t;if(!y(i)||!i.hasAttribute(m)||!i.hasAttribute(p))return;let r=parseInt(i.getAttribute(m),10),n=parseInt(i.getAttribute(p),10),o=e.getCellMeta(r,n);o.readOnly&&t.preventDefault()})(e,t)),e.addEventListener(i,"mouseup",e=>(function(t,e){let{target:i}=t;y(i)&&i.hasAttribute(m)&&i.hasAttribute(p)&&setTimeout(e.listen,10)})(e,t)),e.addEventListener(i,"change",e=>(function(t,e){let{target:i}=t;if(!y(i)||!i.hasAttribute(m)||!i.hasAttribute(p))return;let r=parseInt(i.getAttribute(m),10),n=parseInt(i.getAttribute(p),10),o=e.getCellMeta(r,n);if(!o.readOnly){let i=null;i=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(r,n,i)}})(e,t)),g.set(t,e)}}(t);let C=function(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(b),E=w.label,T=!1;if(void 0===w.checkedTemplate&&(w.checkedTemplate=!0),void 0===w.uncheckedTemplate&&(w.uncheckedTemplate=!1),(0,n.cS)(e),u===w.checkedTemplate||(0,a.Pz)(u).toLocaleLowerCase(w.locale)===(0,a.Pz)(w.checkedTemplate).toLocaleLowerCase(w.locale)?C.checked=!0:u===w.uncheckedTemplate||(0,a.Pz)(u).toLocaleLowerCase(w.locale)===(0,a.Pz)(w.uncheckedTemplate).toLocaleLowerCase(w.locale)?C.checked=!1:(0,a.xb)(u)?(0,n.cn)(C,"noValue"):(C.style.display="none",(0,n.cn)(C,"htBadValue"),T=!0),(0,n.P$)(C,[[m,i],[p,r]]),S&&(0,n.P$)(C,[(0,c.QK)(C.checked?t.getTranslatedPhrase(d.CHECKBOX_CHECKED):t.getTranslatedPhrase(d.CHECKBOX_UNCHECKED)),(0,c.Pn)(C.checked),(0,c.wt)()]),!T&&E){let n="";if(E.value)n="function"==typeof E.value?E.value.call(this,i,r,o,u):E.value;else if(E.property){let e=t.getDataAtRowProp(i,E.property);n=null!==e?e:""}let s=function(t,e,i){let r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}(b,n,!0!==E.separated);"before"===E.position?E.separated?(e.appendChild(s),e.appendChild(C)):(s.appendChild(C),C=s):E.position&&"after"!==E.position||(E.separated?(e.appendChild(C),e.appendChild(s)):(s.insertBefore(C,s.firstChild),C=s))}function R(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=t.getSelectedRange();if(i)for(let r=0;r<i.length;r++){let{row:n,col:o}=i[r].getTopStartCorner(),{row:s,col:l}=i[r].getBottomEndCorner(),a=[];for(let i=n;i<=s;i+=1)for(let r=o;r<=l;r+=1){let n=t.getCellMeta(i,r);if("checkbox"!==n.type)return;if(!0===n.readOnly)continue;void 0===n.checkedTemplate&&(n.checkedTemplate=!0),void 0===n.uncheckedTemplate&&(n.uncheckedTemplate=!1);let o=t.getDataAtCell(i,r);!1===e?[n.checkedTemplate,n.checkedTemplate.toString()].includes(o)?a.push([i,r,n.uncheckedTemplate]):[n.uncheckedTemplate,n.uncheckedTemplate.toString(),null,void 0].includes(o)&&a.push([i,r,n.checkedTemplate]):a.push([i,r,n.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function O(){let e=t.getSelectedRange();if(e){for(let i=0;i<e.length;i++){let r=e[i].getTopStartCorner(),n=e[i].getBottomEndCorner();for(let e=r.row;e<=n.row;e++)for(let i=r.col;i<=n.col;i++){let r=t.getCellMeta(e,i);if("checkbox"!==r.type)return!1;let n=t.getCell(e,i);if(null==n)return!0;{let t=n.querySelectorAll("input[type=checkbox]");if(t.length>0&&!r.readOnly)return!0}}}return!1}}E&&(!E||E.separated)||e.appendChild(C),T&&e.appendChild(b.createTextNode("#bad-value#")),f.has(t)||(f.set(t,!0),function(){let e=t.getShortcutManager(),i=e.getContext("grid");i.addShortcuts([{keys:[["space"]],callback:()=>(R(),!O())},{keys:[["enter"]],callback:()=>(R(),!O()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(R(!0),!O()),relativeToGroup:h.I,position:"before"}],{group:"checkboxRenderer"})}())}function y(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}u.Z.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,i){let{label:r,type:n,row:o,column:s,prop:l}=e;if(n===w){if(r){let{value:e,property:n}=r,a=i;if(e)a="function"==typeof e?e(o,s,l,i):e;else if(n){let t=this.getDataAtRowProp(o,n);a=null!==t?t:i}t=a}return t}}),b.RENDERER_TYPE=w;let S={CELL_TYPE:"checkbox",editor:o,renderer:b}},2037:function(t,e,i){"use strict";i.d(e,{o:function(){return u}});var r=i(2694);class n extends r.H{static get EDITOR_TYPE(){return"numeric"}}i(2916);var o=i(4695),s=i(9275),l=i(7790);function a(t,e,i,r,n,a,h){let u=a;if((0,l.kE)(u)){let t=h.numericFormat,i=t&&t.culture||"-",r=t&&t.pattern,n=h.className||"",s=n.length?n.split(" "):[];if(void 0!==i&&!o.languages()[i]){let t=i.replace("-",""),e=o.allLanguages?o.allLanguages[i]:o[t];e&&o.registerLanguage(e)}o.setLanguage(i),u=o(u).format(r||"0"),0>s.indexOf("htLeft")&&0>s.indexOf("htCenter")&&0>s.indexOf("htRight")&&0>s.indexOf("htJustify")&&s.push("htRight"),0>s.indexOf("htNumeric")&&s.push("htNumeric"),h.className=s.join(" "),e.dir="ltr"}(0,s.V)(t,e,i,r,n,u,h)}function h(t,e){let i=t;null==i&&(i=""),e(!!this.allowEmpty&&""===i||""!==i&&(0,l.kE)(t))}a.RENDERER_TYPE="numeric",h.VALIDATOR_TYPE="numeric";let u={CELL_TYPE:"numeric",editor:n,renderer:a,validator:h,dataType:"number"}},6324:function(t,e,i){"use strict";i.d(e,{DA:function(){return d},V1:function(){return h},xN:function(){return f}}),i(2954);var r=i(2656),n=i(7416),o=i(6903),s=i(2740);let{register:l,getItem:a,hasItem:h,getNames:u,getValues:c}=(0,r.Z)("cellTypes");function d(t){if(!h(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return a(t)}function f(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);let{editor:i,renderer:r,validator:a}=e;i&&(0,n.qm)(t,i),r&&(0,o.zn)(t,r),a&&(0,s.Ie)(t,a),l(t,e)}},8435:function(t,e,i){"use strict";i.d(e,{o:function(){return l}});var r=i(2659),n=i(5878),o=i(8200);function s(t){let e=t.rootDocument,i=e.createElement("input");return i.type="text",i.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&(0,n.P$)(i,[(0,o.Rn)(),(0,o.cV)()]),i}function l(t){let e;let i=e=>{if(!e)return null;let i=a(t),r=h(t);return e.col<i.col&&(e.col=i.col),e.col>r.col&&(e.col=r.col),e.row<i.row&&(e.row=i.row),e.row>r.row&&(e.row=r.row),e},{activate:n,deactivate:o}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.rootElement,r=s(t),n=s(t);return r.addEventListener("focus",()=>null==e?void 0:e.onFocusFromTop()),n.addEventListener("focus",()=>null==e?void 0:e.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(n),{activate(){t._registerTimeout(()=>{r.tabIndex=0,n.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,n.tabIndex=-1},10)}}}(t,{onFocusFromTop(){var r;let n=null!==(r=i(e))&&void 0!==r?r:a(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_above",n),t.selectCell(n.row,n.col)),t.listen()},onFocusFromBottom(){var r;let n=null!==(r=i(e))&&void 0!==r?r:h(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_below",n),t.selectCell(n.row,n.col)),t.listen()}}),l={wrapped:!1,flipped:!1},u=!0,c=!1,d=!1;t.addHook("afterListen",()=>o()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(i,r,n,o,s)=>{if(c&&(l.wrapped&&l.flipped||d)&&(d=!1,s.value=!0),u){var a;e=null===(a=t.getSelectedRangeLast())||void 0===a?void 0:a.highlight}}),t.addHook("beforeRowWrap",(t,e,i)=>{l.wrapped=!0,l.flipped=i});let f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:r.W,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{let{tabNavigation:e}=t.getSettings();c=!0,t.getSelectedRangeLast()&&!e&&(u=!1),e||(d=!0)},position:"before"},{...f,callback:i=>{let{tabNavigation:r,autoWrapRow:n}=t.getSettings();if(c=!1,u=!0,!r||!t.selection.isSelected()||n&&l.wrapped&&l.flipped||!n&&l.wrapped)return n&&l.wrapped&&l.flipped&&(e=i.shiftKey?a(t):h(t)),l.wrapped=!1,l.flipped=!1,t.deselectCell(),t.unlisten(),!1;i.preventDefault()},position:"after"}])}function a(t){let{rowIndexMapper:e,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings(),n=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return(0===n&&(n=e.getVisualFromRenderableIndex(n)),0===o&&(o=i.getVisualFromRenderableIndex(o)),null===n||null===o)?null:t._createCellCoords(n,o)}function h(t){var e,i;let{rowIndexMapper:r,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings(),s=r.getRenderableIndexesLength()-1,l=n.getRenderableIndexesLength()-1;if(s<0){if(!o||0===t.countColHeaders())return null;s=-1}if(l<0){if(!o||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=r.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(i=n.getVisualFromRenderableIndex(l))&&void 0!==i?i:l)}},3891:function(t,e,i){"use strict";i(2916),i(2954);var r=i(9488),n=i(7628),o=i(9440),s=i(7790),l=i(8179);function a(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,"hot",void 0),a(this,"data",void 0),a(this,"dataType","array"),a(this,"colToProp",()=>{}),a(this,"propToCol",()=>{}),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){let e=[];return(0,o.Bk)(this.data,(i,r)=>{let n=this.getAtCell(r,t);e.push(n)}),e}getAtRow(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===e&&void 0===i,a=null,h=null;if(Array.isArray(a=this.modifyRowData(t)))h=[],o?a.forEach((e,i)=>{h[i]=this.getAtPhysicalCell(t,i,a)}):(0,s.q4)(e,i,i=>{h[i-e]=this.getAtPhysicalCell(t,i,a)});else if((0,r.Kn)(a)||(0,l.mf)(a)){if(h=n?[]:{},!o||n){let o=this.countFirstRowKeys()-1;(0,s.q4)(0,o,s=>{let l=this.colToProp(s);if(s>=(e||0)&&s<=(i||o)&&!Number.isInteger(l)){let e=this.getAtPhysicalCell(t,l,a);n?h.push(e):(0,r.Hn)(h,l,e)}})}else(0,r._l)(a,(e,i)=>{(0,r.Hn)(h,i,this.getAtPhysicalCell(t,i,a))})}return h}setAtCell(t,e,i){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=(0,r.sm)(i);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(i=n.value)}Number.isInteger(e)?this.data[t][e]=i:(0,r.Hn)(this.data[t],e,i)}}getAtPhysicalCell(t,e,i){let n=null;if(i&&(n="string"==typeof e?(0,r.$s)(i,e):"function"==typeof e?e(i):i[e]),this.hot.hasHook("modifySourceData")){let i=(0,r.sm)(n);this.hot.runHooks("modifySourceData",t,e,i,"get"),i.isTouched()&&(n=i.value)}return n}getAtCell(t,e){let i=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),i)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,n=null,o=null,l=null,a=null;null===t||null===e?(r=!0,n=0,l=this.countRows()-1):(n=Math.min(t.row,e.row),o=Math.min(t.col,e.col),l=Math.max(t.row,e.row),a=Math.max(t.col,e.col));let h=[];return(0,s.q4)(n,l,t=>{h.push(r?this.getAtRow(t,void 0,void 0,i):this.getAtRow(t,o,a,i))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){let t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return(0,n.Eb)(this.data)}destroy(){this.data=null,this.hot=null}}e.Z=h},2230:function(t,e,i){"use strict";let r;i.d(e,{Z:function(){return E}}),i(2954);var n=i(9488),o=i(6324);function s(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"==typeof e.type?(0,o.DA)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&(0,n._l)(e,(e,i)=>void t._automaticallyAssignedMetaProps.delete(i)),!(0,n.Kn)(r))return;i!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);let s={};(0,n._l)(r,(e,r)=>{var o,l;"CELL_TYPE"!==r&&((null===(o=i._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(r))||!(0,n.nr)(i,r))&&(s[r]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(r))}),(0,n.l7)(t,s)}function l(t){return Number.isInteger(t)&&t>=0}function a(t,e){if(!t())throw Error(`Assertion failed: ${e}`)}var h=i(8015);function u(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class c{constructor(t){u(this,"metaCtor",class{}),u(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,n.l7)(this.meta,(0,h.Z)()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;(0,n.l7)(this.meta,t),s(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class d{constructor(t){var e,i,r;i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="meta","string"))?r:String(r))in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i;let n=t.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(t){(0,n.l7)(this.meta,t),s(this.meta,t,t)}}i(2916);var f=i(9440);function g(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}r=Symbol.iterator;class m{constructor(t){g(this,"valueFactory",void 0),g(this,"data",[]),g(this,"index",[]),g(this,"holes",new Set),this.valueFactory=t}obtain(t){let e;a(()=>l(t),"Expecting an unsigned number.");let i=this._getStorageIndexByKey(t);if(i>=0)void 0===(e=this.data[i])&&(e=this.valueFactory(t),this.data[i]=e);else if(e=this.valueFactory(t),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=e,this.index[t]=i}else this.data.push(e),this.index[t]=this.data.length-1;return e}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a(()=>l(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=[],r=this.data.length;for(let t=0;t<e;t++)i.push(r+t),this.data.push(void 0);let n=null==t?this.index.length:t;this.index=[...this.index.slice(0,n),...i,...this.index.slice(n)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a(()=>l(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=this.index.splice(null==t?this.index.length-e:t,e);for(let t=0;t<i.length;t++){let e=i[t];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return(0,f.w7)(this.data,(t,e)=>!this.holes.has(e))[Symbol.iterator]()}entries(){let t=[];for(let e=0;e<this.data.length;e++){let i=this._getKeyByStorageIndex(e);-1!==i&&t.push([i,this.data[e]])}let e=0;return{next:()=>{if(e<t.length){let i=t[e];return e+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[r](){return this.entries()}}function p(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let w=["data","width"];class b{constructor(t){p(this,"globalMeta",void 0),p(this,"metas",new m(()=>this._createMeta())),this.globalMeta=t,this.metas=new m(()=>this._createMeta())}updateMeta(t,e){let i=this.getMeta(t);(0,n.l7)(i,e),s(i,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function i(){}(0,n.ED)(i,t);for(let t=0;t<e.length;t++)i.prototype[e[t]]=void 0;return i}(this.globalMeta.getMetaConstructor(),w).prototype}}function y(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class S{constructor(t){y(this,"columnMeta",void 0),y(this,"metas",new m(()=>this._createRow())),this.columnMeta=t}updateMeta(t,e,i){let r=this.getMeta(t,e);(0,n.l7)(r,i),s(r,i)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(t,e)}getMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);return void 0===i?r:r[i]}setMeta(t,e,i,r){var n;let o=this.metas.obtain(t).obtain(e);null===(n=o._automaticallyAssignedMetaProps)||void 0===n||n.delete(i),o[i]=r}removeMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);delete r[i]}getMetas(){let t=[],e=Array.from(this.metas.values());for(let i=0;i<e.length;i++)t.push(...e[i].values());return t}getMetasAtRow(t){a(()=>l(t),"Expecting an unsigned number.");let e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new m(t=>this._createMeta(t))}_createMeta(t){let e=this.columnMeta.getMetaConstructor(t);return new e}}var C=i(3437);class E{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new c(t),this.tableMeta=new d(this.globalMeta),this.columnMeta=new b(this.globalMeta),this.cellMeta=new S(this.columnMeta),i.forEach(t=>new t(this)),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,i){let{visualRow:r,visualColumn:n}=i,o=this.cellMeta.getMeta(t,e);return o.visualRow=r,o.visualCol=n,o.row=t,o.col=e,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(t,e,i){if("string"!=typeof i)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,i)}setCellMeta(t,e,i,r){this.cellMeta.setMeta(t,e,i,r)}updateCellMeta(t,e,i){this.cellMeta.updateMeta(t,e,i)}removeCellMeta(t,e,i){this.cellMeta.removeMeta(t,e,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,n.jB)(E,C.Z)},243:function(t,e,i){"use strict";i.d(e,{$:function(){return l}}),i(2954);var r=i(4317),n=i(9488),o=i(8179);function s(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l{constructor(t){s(this,"metaManager",void 0),s(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),r.Z.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var e,i;let{row:r,col:s}=t;if(null!==(e=this.metaSyncMemo.get(r))&&void 0!==e&&e.has(s))return;let{visualRow:l,visualCol:a}=t,h=this.metaManager.hot,u=h.colToProp(a);t.prop=u,h.runHooks("beforeGetCellMeta",l,a,t);let c=(0,n.nr)(t,"type")?t.type:null,d=(0,o.mf)(t.cells)?t.cells(r,s,u):null;c&&(d?d.type=null!==(i=d.type)&&void 0!==i?i:c:d={type:c}),d&&this.metaManager.updateCellMeta(r,s,d),h.runHooks("afterGetCellMeta",l,a,t),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(s)}}},45:function(t,e,i){"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{_:function(){return n}}),i(2954);class n{constructor(t){r(this,"metaManager",void 0),r(this,"usageTracker",new Set),r(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,i){if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){let e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,i){if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((t,e)=>{let{target:i,onChange:r=()=>{}}=t,n="string"==typeof i,o=n?i:e,s=`_${o}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[o],this.installPropWatcher(e,s,r),n&&this.installPropWatcher(i,s,r)})}installPropWatcher(t,e,i){let r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(n){let o=!r.usageTracker.has(t);r.usageTracker.add(t),i.call(r,t,n,o),this[e]=n},enumerable:!0,configurable:!0})}}},9620:function(t,e,i){"use strict";i.d(e,{o:function(){return m}}),i(2916),i(2954);var r=i(6411),n=i(8179),o=i(292),s=i(7628),l=i(9488),a=i(9440),h=i(7790),u=i(2518);function c(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class d{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,i){c(this,"hot",void 0),c(this,"metaManager",void 0),c(this,"tableMeta",void 0),c(this,"dataSource",void 0),c(this,"duckSchema",void 0),c(this,"colToPropCache",void 0),c(this,"propToColCache",void 0),this.hot=t,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let t;let e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let i=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,i){let r=0,n=0,o=!1;if("function"==typeof i){let t=(0,l.Q8)(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else{let t=this.tableMeta.maxCols;r=Math.min(t,i.length)}for(t=0;t<r;t++){let e=o?i(t):i[t];if((0,l.Kn)(e)){if(void 0!==e.data){let i=o?n:t;this.colToPropCache[i]=e.data,this.propToColCache.set(e.data,i)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return(0,s.Eb)(this.dataSource)}recursiveDuckColumns(t,e,i){let r,n=e,o=i;return void 0===n&&(n=0,o=""),"object"!=typeof t||Array.isArray(t)||(0,l._l)(t,(t,e)=>{null===t?(r=o+e,this.colToPropCache.push(r),this.propToColCache.set(r,n),n+=1):n=this.recursiveDuckColumns(t,n,`${e}.`)}),n}colToProp(t){if(!1===Number.isInteger(t))return t;let e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&(0,u.$K)(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){let e=this.propToColCache.get(t);if((0,u.$K)(e))return this.hot.toVisualColumn(e);let i=this.hot.toVisualColumn(t);return null===i?t:i}getSchema(){let t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,l.ie)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.hot.countSourceRows(),o=n,s=0,a=t;("number"!=typeof a||a>=n)&&(a=n),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a));let u=this.hot.runHooks("beforeCreateRow",a,e,i);if(!1===u||null===o)return{delta:0};let c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;s<e&&n+s<c;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=(0,l.I8)(this.getSchema()):(t=[],(0,h.q4)(d-1,()=>t.push(null))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(a+s):(t={},(0,l.ZB)(t,this.getSchema())),f.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,n)),this.spliceData(o,0,f);let g=this.hot.toVisualRow(o);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==i&&this.metaManager.createRow(o,e)),this.hot.runHooks("afterCreateRow",g,s,i),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:o}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let n=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols(),l=t;("number"!=typeof l||l>=s)&&(l=s);let a=this.hot.runHooks("beforeCreateCol",l,e,i);if(!1===a)return{delta:0};let h=s;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));let u=this.hot.countSourceRows(),c=this.hot.countCols(),d=0,f=h;"end"===r&&(f=Math.min(f+1,s));let g=f;for(;d<e&&c<o;){if("number"!=typeof l||l>=c){if(u>0)for(let t=0;t<u;t+=1)void 0===n[t]&&(n[t]=[]),n[t].push(null);else n.push([null])}else for(let t=0;t<u;t++)n[t].splice(f,0,null);d+=1,f+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(l,d),d>0&&(null==t?this.metaManager.createColumn(null,d):"auto"!==i&&this.metaManager.createColumn(g,e));let m=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",m,d,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(t)?t:-e,n=this.visualRowsToPhysical(r,e),o=this.hot.countSourceRows();r=(o+r)%o;let s=this.hot.runHooks("beforeRemoveRow",r,n.length,n,i);if(!1===s)return!1;let l=n.length;if(this.filterData(r,l,n),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);let t=(0,u.$K)(this.tableMeta.columns)||(0,u.$K)(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}let a=n.slice(0).sort((t,e)=>e-t);return a.forEach(t=>{this.metaManager.removeRow(t,1)}),this.hot.runHooks("afterRemoveRow",r,l,n,i),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof t?-e:t;r=(this.hot.countCols()+r)%this.hot.countCols();let n=this.visualColumnsToPhysical(r,e),o=n.slice(0).sort((t,e)=>e-t),s=this.hot.runHooks("beforeRemoveCol",r,e,n,i);if(!1===s)return!1;let l=!0,a=o.length,h=this.dataSource;for(let t=0;t<a;t++)l&&n[0]!==n[t]-t&&(l=!1);if(l)for(let t=0,i=this.hot.countSourceRows();t<i;t++)h[t].splice(n[0],e),0===t&&this.metaManager.removeColumn(n[0],e);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<a;e++)h[t].splice(o[e],1),0===t&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,e,n,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,i){let r=this.hot.getDataAtCol(t),n=r.slice(e,e+i),o=r.slice(e+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.g9)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return(0,a.PI)(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),n}spliceRow(t,e,i){let r=this.hot.getSourceDataAtRow(t),n=r.slice(e,e+i),o=r.slice(e+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.g9)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),n}spliceData(t,e,i){let r=this.hot.runHooks("beforeDataSplice",t,e,i);if(!1!==r){let e=[...this.dataSource.slice(0,t),...i,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach(t=>this.dataSource.push(t))}}filterData(t,e,i){let r=this.hot.runHooks("filterData",t,e,i);!1===Array.isArray(r)&&(r=this.dataSource.filter((t,e)=>-1===i.indexOf(e))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataSource[i],n=this.hot.runHooks("modifyRowData",i);r=isNaN(n)?n:r;let o=null;if(r&&r.hasOwnProperty&&(0,l.nr)(r,e))o=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){let t=e.split("."),i=r;if(!i)return null;for(let e=0,r=t.length;e<r;e++)if(void 0===(i=i[t[e]]))return null;o=i}else"function"==typeof e&&(o=e(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){let t=(0,l.sm)(o);this.hot.runHooks("modifyData",i,this.propToCol(e),t,"get"),t.isTouched()&&(o=t.value)}return o}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,i){let r=this.hot.toPhysicalRow(t),n=i,o=this.dataSource[r],s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){let t=(0,l.sm)(n);this.hot.runHooks("modifyData",r,this.propToCol(e),t,"set"),t.isTouched()&&(n=t.value)}if(o&&o.hasOwnProperty&&(0,l.nr)(o,e))o[e]=n;else if("string"==typeof e&&e.indexOf(".")>-1){let t;let i=e.split("."),r=o,s=0;for(s=0,t=i.length-1;s<t;s++)void 0===r[i[s]]&&(r[i[s]]={}),r=r[i[s]];r[i[s]]=n}else"function"==typeof e?e(this.dataSource.slice(r,r+1)[0],n):o[e]=n}visualRowsToPhysical(t,e){let i=this.hot.countSourceRows(),r=[],n=(i+t)%i,o=e;for(;n<i&&o;)r.push(this.hot.toPhysicalRow(n)),o-=1,n+=1;return r}visualColumnsToPhysical(t,e){let i=this.hot.countCols(),r=[],n=(i+t)%i,o=e;for(;n<i&&o;){let t=this.hot.toPhysicalColumn(n);r.push(t),o-=1,n+=1}return r}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){let t=this.tableMeta.maxRows,e=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t<0||0===t?0:t||1/0)}getAll(){let t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,d.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,i){let r,n,o;let s=[],l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];let h=i===d.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),c=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(r=Math.min(t.row,e.row);r<=u;r++){o=[];let i=r>=0?this.hot.toPhysicalRow(r):r;for(n=Math.min(t.col,e.col);n<=c&&null!==i;n++)o.push(h.call(this,r,this.colToProp(n)));null!==i&&s.push(o)}return s}getText(t,e){return(0,o.P)(this.getRange(t,e,d.DESTINATION_RENDERER))}getCopyableText(t,e){return(0,o.P)(this.getRange(t,e,d.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var f=i(5878),g=i(8200);function m(t,e,i,o){let{hotInstance:s,dataMap:a,dataSource:h,internalSource:u,source:c,metaManager:m,firstRun:p}=o,w=(0,r.ct)(u),b=s.getSettings();Array.isArray(b.dataSchema)?s.dataType="array":(0,n.mf)(b.dataSchema)?s.dataType="function":s.dataType="object",a&&a.destroy(),t=s.runHooks(`before${w}`,t,p,c);let y=new d(s,t,m);if(e(y),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else if(null===t){let e;let i=y.getSchema();t=[];let r=0,n=0;for(r=0,n=b.startRows;r<n;r++)if(("object"===s.dataType||"function"===s.dataType)&&b.dataSchema)e=(0,l.I8)(i),t.push(e);else if("array"===s.dataType)e=(0,l.I8)(i[0]),t.push(e);else{e=[];for(let t=0,i=b.startCols;t<i;t++)e.push(null);t.push(e)}}else throw Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(s.dataType="array"),b.data=t,y.dataSource=t,h.data=t,h.dataType=s.dataType,h.colToProp=y.colToProp.bind(y),h.propToCol=y.propToCol.bind(y),h.countCachedColumns=y.countCachedColumns.bind(y),i(y),s.runHooks(`after${w}`,t,p,c),p||(s.runHooks("afterChange",null,u),s.render()),s.getSettings().ariaTags&&(0,f.P$)(s.rootElement,[(0,g.a2)(-1),(0,g.Wv)(s.countCols()+(s.view?s.countRowHeaders():0))])}},4692:function(t,e,i){"use strict";i.d(e,{H:function(){return c}}),i(2954);var r=i(6678),n=i(7687),o=i(7416),s=i(9773),l=i(2518);function a(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function h(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let c="editorManager.navigation";var d=new WeakSet,f=new WeakSet;class g{constructor(t,e,i){a(this,f),a(this,d),h(this,"hot",void 0),h(this,"tableMeta",void 0),h(this,"selection",void 0),h(this,"eventManager",void 0),h(this,"destroyed",!1),h(this,"lock",!1),h(this,"activeEditor",void 0),h(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=i,this.eventManager=new s.Z(t),this.hot.addHook("afterDocumentKeyDown",t=>u(this,d,m).call(this,t)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)}),this.hot.view._wt.update("onCellDblClick",(t,e,i)=>u(this,f,p).call(this,t,e,i))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,t=>{t&&this.prepareEditor()});return}let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;let{row:i,col:r}=e,n=this.hot.runHooks("modifyGetCellCoords",i,r),s=i,l=r;if(Array.isArray(n)&&([s,l]=n),this.cellProperties=this.hot.getCellMeta(s,l),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.hot.getCell(i,r,!0);if(a){let t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(l),n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),l);this.activeEditor=(0,o.Jq)(t,this.hot),this.activeEditor.prepare(i,r,e,a,n,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}closeEditor(t,e,i){this.activeEditor?this.activeEditor.finishEditing(t,e,i):i&&i(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let t=this.hot.getSelectedRangeLast();if(!t)return!1;let e=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=t.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,s=n.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!this.cellProperties.readOnly&&!!e&&!s}moveSelectionAfterEnter(t){let e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function m(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||(0,n.Ty)(t))return;let{keyCode:i}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(0,r.DC)(i)&&!(0,r.T2)(i)&&!o&&!this.isEditorOpened()){let e=this.hot.getShortcutManager(),i=e.getContext("editor");i.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,l.$K)(this.hot.getSelected()),group:c}),this.openEditor("",t)}}function p(t,e,i){"TD"===i.nodeName&&this.openEditor(null,t,!0)}let w=new WeakMap;g.getInstance=function(t,e,i){let r=w.get(t);return r||(r=new g(t,e,i),w.set(t,r)),r},e.Z=g},8422:function(t,e,i){"use strict";i.d(e,{Hf:function(){return d},ed:function(){return u},PP:function(){return c}}),i(2954);var r=i(2518),n=i(9488),o=i(4692);i(2916);var s=i(9440);let l={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){(0,s.Bk)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,n._l)(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};(0,n.jW)(l,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var a=i(5878);function h(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let u=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),c="baseEditor";class d{static get EDITOR_TYPE(){return"base"}constructor(t){h(this,"hot",void 0),h(this,"state",u.VIRGIN),h(this,"_opened",!1),h(this,"_fullEditMode",!1),h(this,"_closeCallback",null),h(this,"TD",null),h(this,"row",null),h(this,"col",null),h(this,"prop",null),h(this,"originalValue",null),h(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,i,r,n,o){this.TD=r,this.row=t,this.col=e,this.prop=i,this.originalValue=n,this.cellProperties=o,this.state=u.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let i,n,o,s;if(e){let t=this.hot.getSelectedLast();i=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),o=Math.max(t[0],t[2]),s=Math.max(t[1],t[3])}else[i,n,o,s]=[this.row,this.col,null,null];let l=this.hot.runHooks("modifyGetCellCoords",i,n);Array.isArray(l)&&([i,n]=l);let a=this.hot.getShortcutManager(),h=a.getContext("editor");this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,r.$K)(this.hot.getSelected()),group:c}),this.hot.populateFromArray(i,n,t,o,s,"edit")}beginEditing(t,e){if(this.state!==u.VIRGIN)return;let i=this.hot,n=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(n,o)),this.state=u.EDITING,this.isInFullEditMode()){let e="string"==typeof t?t:(0,r.Pz)(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,i){let r;if(i){let t=this._closeCallback;this._closeCallback=e=>{t&&t(e),i(e),this.hot.view.render()}}if(this.isWaiting())return;let n=this.hot.getShortcutManager(),s=n.getContext("editor");if(s.removeShortcutsByGroup(c),s.removeShortcutsByGroup(o.H),this.state===u.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===u.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}let i=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof i?String.prototype.trim.call(i||""):i]]:[[i]],this.state=u.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",t=>{this.state=u.FINISHED,this.discardEditor(t)}):(this.state=u.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=u.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===u.FINISHED){if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=u.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=u.VIRGIN,this._fireCallbacks(!0);let t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===u.WAITING}getEditedCellRect(){var t;let e=this.getEditedCell();if(!e)return;let{wtOverlays:i,wtViewport:r}=this.hot.view._wt,n=this.hot.rootWindow,o=(0,a.cv)(e),s=(0,a.iO)(e),l=(0,a.cv)(this.hot.rootElement),h=(0,a.iO)(this.hot.rootElement),u=i.topOverlay.holder,c=i.inlineStartOverlay.holder,d=u!==n?u.scrollTop:0,f=c!==n?c.scrollLeft:0,g=n.innerWidth-l.left-h,{wtTable:m}=null!==(t=i.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,p=m.name,w=["master","inline_start"].includes(p)?d:0,b=["master","top","bottom"].includes(p)?f:0,y=o.top===l.top?0:1,S=o.top-l.top-y-w,C=0;C=this.hot.isRtl()?n.innerWidth-o.left-s-g-1+b:o.left-l.left-1-b,["top","top_inline_start_corner"].includes(p)&&(S+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(C+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));let E=this.hot.hasColHeaders(),T=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength(),M=O-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&T<=0||T===M)&&(S+=1),R<=0&&(C+=1);let N=r.rowsRenderCalculator.startPosition,I=r.columnsRenderCalculator.startPosition,x=Math.abs(i.inlineStartOverlay.getScrollPosition()),k=i.topOverlay.getScrollPosition(),H=(0,a.np)(this.hot.rootDocument),_=e.offsetTop;if(["inline_start","master"].includes(p)&&(_+=N-k),["bottom","bottom_inline_start_corner"].includes(p)){let{wtViewport:t,wtTable:e}=i.bottomOverlay.clone;_+=t.getWorkspaceHeight()-e.getHeight()-H}let A=e.offsetLeft;this.hot.isRtl()?A=(A>=0?m.getWidth()-e.offsetLeft:Math.abs(A))+(I-x-s):["top","master","bottom"].includes(p)&&(A+=I-x);let L=(0,a.Dx)(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",D=parseInt(L[P],10)>0?0:1,F=parseInt(L.borderTopWidth,10)>0?0:1,B=(0,a.iO)(e)+D,W=(0,a.Pb)(e)+F,V=(0,a.do)(u)?H:0,j=(0,a.vw)(c)?H:0,U=this.hot.view.maximumVisibleElementWidth(A)-V+D,$=Math.max(this.hot.view.maximumVisibleElementHeight(_)-j+F,23);return{top:S,start:C,height:W,maxHeight:$,width:B,maxWidth:U}}getEditedCellsLayerClass(){let t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}(0,n.jB)(d,l)},7416:function(t,e,i){"use strict";i.d(e,{Jq:function(){return d},Wu:function(){return a},qm:function(){return g},y$:function(){return f}}),i(2954);var r=i(4317),n=i(2656);let o=new WeakMap,{register:s,getItem:l,hasItem:a,getNames:h,getValues:u}=(0,n.Z)("editors");function c(t){let e={};this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},r.Z.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function d(t,e){let i;if("function"==typeof t)o.get(t)||g(null,t),i=o.get(t);else if("string"==typeof t)i=l(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${t}"`);return i.getInstance(e)}function f(t){if("function"==typeof t)return t;if(!a(t))throw Error(`No registered editor found under "${t}" name`);return l(t).getConstructor()}function g(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);let i=new c(e);"string"==typeof t&&s(t,i),o.set(e,i)}},2694:function(t,e,i){"use strict";i.d(e,{H:function(){return b}}),i(2954);var r=i(8422),n=i(9773),o=i(2228),s=i(5878),l=i(7790);function a(t,e,i){t.addEventListener(e,i,!1)}function h(t,e,i){t.removeEventListener(e,i,!1)}function u(t){return t.ownerDocument.defaultView.getComputedStyle(t)}var c=i(2518),d=i(4692);function f(t,e){let i=(0,s.qK)(e),r=e.value.split("\n"),n=i,o=0;for(let e=0;e<r.length;e++){let s=r[e];0!==e&&(o+=r[e-1].length+1);let l=o+s.length;if("home"===t?n=o:"end"===t&&(n=l),i<=l)break}(0,s.Mq)(e,n)}var g=i(8200);function m(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let p="ht_editor_hidden",w="textEditor";class b extends r.Hf{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),m(this,"eventManager",new n.Z(this)),m(this,"autoResize",function(t){let e;let i={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=t.body,n=t.createTextNode(""),o=t.createElement("span");function s(){n.textContent=e.value,o.style.position="absolute",o.style.fontSize=u(e).fontSize,o.style.fontFamily=u(e).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);let t=o.clientWidth+2;r.removeChild(o);let s=e.style;s.height=`${i.minHeight}px`,i.minWidth>t?s.width=`${i.minWidth}px`:t>i.maxWidth?s.width=`${i.maxWidth}px`:s.width=`${t}px`;let l=e.scrollHeight?e.scrollHeight-1:0;i.minHeight>l?s.height=`${i.minHeight}px`:i.maxHeight<l?(s.height=`${i.maxHeight}px`,s.overflowY="visible"):s.height=`${l}px`}function l(){t.defaultView.setTimeout(s,0)}return{init:function(t,r){let h=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=t,function(t){if(t&&t.minHeight){if("inherit"===t.minHeight)i.minHeight=e.clientHeight;else{let e=parseInt(t.minHeight,10);isNaN(e)||(i.minHeight=e)}}if(t&&t.maxHeight){if("inherit"===t.maxHeight)i.maxHeight=e.clientHeight;else{let e=parseInt(t.maxHeight,10);isNaN(e)||(i.maxHeight=e)}}if(t&&t.minWidth){if("inherit"===t.minWidth)i.minWidth=e.clientWidth;else{let e=parseInt(t.minWidth,10);isNaN(e)||(i.minWidth=e)}}if(t&&t.maxWidth){if("inherit"===t.maxWidth)i.maxWidth=e.clientWidth;else{let e=parseInt(t.maxWidth,10);isNaN(e)||(i.maxWidth=e)}}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))}(r),"TEXTAREA"===e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=`${i.minHeight}px`,e.style.minWidth=`${i.minWidth}px`,e.style.maxWidth=`${i.maxWidth}px`,e.style.overflowY="hidden"),h&&(a(e,"input",s),a(e,"keydown",l)),s()},resize:s,unObserve(){h(e,"input",s),h(e,"keydown",l)}}}(this.hot.rootDocument)),m(this,"TEXTAREA",void 0),m(this,"textareaStyle",void 0),m(this,"TEXTAREA_PARENT",void 0),m(this,"textareaParentStyle",void 0),m(this,"layerClass",void 0),this.eventManager=new n.Z(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,s.yv)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,i,n,o,s){let l=this.state;if(super.prepare(t,e,i,n,o,s),!s.readOnly){this.refreshDimensions(!0);let{allowInvalid:t}=s;t&&(this.TEXTAREA.value=""),l!==r.ed.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===r.ed.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),(0,s.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),(0,s.P$)(this.TEXTAREA,[["data-hot-input",""],(0,g.Qk)(-1)]),this.hot.getSettings().ariaTags&&(0,s.P$)(this.TEXTAREA,[(0,g.cV)()]),(0,s.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),(0,s.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,s.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,s.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,s.cn)(this.TEXTAREA_PARENT,p),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,o.un)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,s.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,s.cn)(this.TEXTAREA_PARENT,p)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";let t=this.TEXTAREA_PARENT.childNodes,e=!1;(0,l.q4)(t.length-1,i=>{let r=t[i];if((0,s.pv)(r,"handsontableEditor"))return e=!0,!1}),(0,s.pv)(this.TEXTAREA_PARENT,p)&&(0,s.IV)(this.TEXTAREA_PARENT,p),e?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,s.cn)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==r.ed.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD){t||this.close();return}let{top:e,start:i,width:n,maxWidth:o,height:l,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();let h=(0,s.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let u=(0,s.Dx)(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=o-c,g=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(n-c,f),minHeight:Math.min(l-d,g),maxWidth:f,maxHeight:g},!0)}bindEvents(){(0,o.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===r.ed.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===r.ed.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor"),i=t.getContext("grid"),r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:i,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[i]=e;f(i,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[i]=e;f(i,this.TEXTAREA)}}],{runOnlyIf:()=>(0,c.$K)(this.hot.getSelected()),group:w})}unregisterShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(d.H),e.removeShortcutsByGroup(w),e.removeShortcutsByGroup(r.PP)}}},9773:function(t,e,i){"use strict";i(2916),i(2954);var r=i(7687);let n=0;class o{constructor(){var t,e,i;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="context","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.context=r||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(t){i.call(this,function(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),(0,r.mM)(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:i,callbackProxy:s,options:o,eventManager:this}),t.addEventListener(e,s,o),n+=1,()=>{this.removeEventListener(t,e,i)}}removeEventListener(t,e,i){let r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;for(;s;)if(s-=1,(r=this.context.eventListeners[s]).event===e&&r.element===t){if(i&&i!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(s,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),n-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;let i=this.context.eventListeners[e];t&&i.eventManager!==this||(this.context.eventListeners.splice(e,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),n-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let i,r=t.document,n=t;r||(n=(r=t.ownerDocument?t.ownerDocument:t).defaultView);let o={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(i=r.createEvent("MouseEvents")).initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode):i=r.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent(`on${e}`,i)}}e.Z=o},8407:function(t,e,i){"use strict";i.d(e,{I:function(){return T}}),i(2954);var r=i(4748),n=i(5878),o=i(8179);function s(t,e){a(t,e),e.add(t)}function l(t,e,i){a(t,e),e.set(t,i)}function a(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function h(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function u(t,e){var i=d(t,e,"get");return i.get?i.get.call(t):i.value}function c(t,e,i){var r=d(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function d(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let f=Object.freeze({CELL:"cell",MIXED:"mixed"});var g=new WeakMap,m=new WeakMap,p=new WeakMap,w=new WeakMap,b=new WeakMap,y=new WeakSet,S=new WeakSet,C=new WeakSet,E=new WeakSet;class T{constructor(t){var e=this;s(this,E),s(this,C),s(this,S),s(this,y),l(this,g,{writable:!0,value:void 0}),l(this,m,{writable:!0,value:void 0}),l(this,p,{writable:!0,value:50}),l(this,w,{writable:!0,value:null}),l(this,b,{writable:!0,value:new Map});let i=t.getSettings();c(this,g,t),c(this,m,i.imeFastEdit?f.MIXED:f.CELL),u(this,g).addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h(e,E,N).call(e,...i)}),u(this,g).addHook("afterSelection",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h(e,S,O).call(e,...i)}),u(this,g).addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h(e,C,M).call(e,...i)})}getFocusMode(){return u(this,m)}setFocusMode(t){Object.values(f).includes(t)?c(this,m,t):(0,r.ZK)(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return u(this,p)}setRefocusDelay(t){c(this,p,t)}setRefocusElementGetter(t){c(this,w,t)}getRefocusElement(){var t;return"function"==typeof u(this,w)?u(this,w).call(this):null===(t=u(this,g).getActiveEditor())||void 0===t?void 0:t.TEXTAREA}focusOnHighlightedCell(t){let e=t=>{var e,i;let r=null===(e=u(this,g).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!r)return;let n=u(this,g).runHooks("modifyFocusedElement",r.row,r.col,t);n instanceof HTMLElement||(n=t),n&&!(null!==(i=u(this,g).getActiveEditor())&&void 0!==i&&i.isOpened())&&n.focus({preventScroll:!0})};t?e(t):h(this,y,R).call(this,t=>e(t))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u(this,p),i=this.getRefocusElement();u(this,g).getSettings().imeFastEdit&&!(null!==(t=u(this,g).getActiveEditor())&&void 0!==t&&t.isOpened())&&i&&(u(this,b).has(e)||u(this,b).set(e,(0,o.Ds)(()=>{i.select()},e)),u(this,b).get(e)())}}function R(t){var e;let i=null===(e=u(this,g).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!i||!u(this,g).selection.isCellVisible(i)){t(null);return}let r=u(this,g).getCell(i.row,i.col,!0);null===r?u(this,g).addHookOnce("afterScroll",()=>{t(u(this,g).getCell(i.row,i.col,!0))}):t(r)}function O(){h(this,y,R).call(this,t=>{let{activeElement:e}=u(this,g).rootDocument;e&&(0,n.pV)(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function M(){h(this,y,R).call(this,t=>{this.getFocusMode()===f.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()})}function N(t){t.imeFastEdit&&this.getFocusMode()!==f.MIXED?this.setFocusMode(f.MIXED):t.imeFastEdit||this.getFocusMode()===f.CELL||this.setFocusMode(f.CELL)}},8200:function(t,e,i){"use strict";i.d(e,{Ak:function(){return A},Ct:function(){return a},DT:function(){return W},Ez:function(){return F},JV:function(){return x},LO:function(){return f},Ng:function(){return h},Nl:function(){return m},Nr:function(){return y},Pn:function(){return _},Pp:function(){return b},QK:function(){return S},Qk:function(){return r},Qz:function(){return s},Rn:function(){return o},Up:function(){return B},Wv:function(){return M},a2:function(){return O},a6:function(){return g},cV:function(){return C},d:function(){return P},d5:function(){return N},f3:function(){return u},fv:function(){return R},gw:function(){return E},iJ:function(){return w},iL:function(){return l},jH:function(){return V},nO:function(){return n},nT:function(){return D},qt:function(){return T},rQ:function(){return d},tm:function(){return c},w1:function(){return H},wt:function(){return p},yz:function(){return I},zR:function(){return k},zV:function(){return L}});let r=t=>["tabindex",t],n=()=>["role","treegrid"],o=()=>["role","presentation"],s=()=>["role","gridcell"],l=()=>["role","rowheader"],a=()=>["role","rowgroup"],h=()=>["role","columnheader"],u=()=>["role","row"],c=()=>["role","menu"],d=()=>["role","menuitem"],f=()=>["role","combobox"],g=()=>["role","listbox"],m=()=>["role","option"],p=()=>["role","checkbox"],w=()=>["scope","col"],b=()=>["scope","row"],y=()=>["type","text"],S=t=>["aria-label",t],C=()=>["aria-hidden","true"],E=()=>["aria-disabled","true"],T=()=>["aria-multiselectable","true"],R=t=>["aria-haspopup",t],O=t=>["aria-rowcount",t],M=t=>["aria-colcount",t],N=t=>["aria-rowindex",t],I=t=>["aria-colindex",t],x=t=>["aria-expanded",t],k=()=>["aria-readonly","true"],H=()=>["aria-invalid","true"],_=t=>["aria-checked",t],A=()=>["aria-selected","true"],L=()=>["aria-autocomplete","list"],P=t=>["aria-controls",t],D=t=>["aria-activedescendant",t],F=t=>["aria-live",t],B=t=>["aria-relevant",t],W=t=>["aria-setsize",t],V=t=>["aria-posinset",t]},9440:function(t,e,i){"use strict";function r(t){let e=t.length,i=0;for(;i<e;)t[i]=[t[i]],i+=1}function n(t,e){let i=e.length,r=0;for(;r<i;)t.push(e[r]),r+=1}function o(t){let e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;let i=t.length,r=t[0].length;for(let n=0;n<i;n++)for(let i=0;i<r;i++)e[i]||(e[i]=[]),e[i][n]=t[n][i];return e}function s(t,e,i,r){let n=-1,o=t,s=i;Array.isArray(t)||(o=Array.from(t));let l=o.length;for(r&&l&&(n+=1,s=o[n]),n+=1;n<l;)s=e(s,o[n],n,o),n+=1;return s}function l(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let t=r[i];e(t,i,r)&&(o[s+=1]=t),i+=1}return o}function a(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let t=r[i];o[s+=1]=e(t,i,r),i+=1}return o}function h(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length;for(;i<n&&!1!==e(r[i],i,r);)i+=1;return t}function u(t){let e=[];return h(t,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function c(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...n]=[...e],o=r;return h(n,t=>{o=o.filter(e=>!t.includes(e))}),o}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}i.d(e,{Bk:function(){return h},PI:function(){return r},Sc:function(){return a},W7:function(){return d},g9:function(){return n},jz:function(){return o},k$:function(){return s},o0:function(){return c},uW:function(){return u},w7:function(){return l}}),i(2916)},2228:function(t,e,i){"use strict";i.d(e,{E6:function(){return h},G6:function(){return d},K1:function(){return g},L:function(){return p},eE:function(){return b},gn:function(){return m},i7:function(){return a},iF:function(){return c},uM:function(){return w},un:function(){return f},vU:function(){return u}});var r=i(9488),n=i(973);let o=t=>{let e={value:!1};return e.test=(i,r)=>{e.value=t(i,r)},e},s={chrome:o((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:o(t=>/CriOS/.test(t)),edge:o(t=>/Edge/.test(t)),edgeWebKit:o(t=>/EdgiOS/.test(t)),firefox:o(t=>/Firefox/.test(t)),firefoxWebKit:o(t=>/FxiOS/.test(t)),mobile:o(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:o((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},l={mac:o(t=>/^Mac/.test(t)),win:o(t=>/^Win/.test(t)),linux:o(t=>/^Linux/.test(t)),ios:o(t=>/iPhone|iPad|iPod/i.test(t))};function a(){return s.chrome.value}function h(){return s.chromeWebKit.value}function u(){return s.firefox.value}function c(){return s.firefoxWebKit.value}function d(){return s.safari.value}function f(){return s.edge.value}function g(){return s.mobile.value}function m(){return l.ios.value}function p(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&l.mac.value}function w(){return l.win.value}function b(){return l.mac.value}(0,n.o6)()&&(!function(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r._l)(s,i=>{let{test:r}=i;r(t,e)})}(),function(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r._l)(l,e=>{let{test:i}=e;i(t)})}())},4748:function(t,e,i){"use strict";i.d(e,{ZK:function(){return n},vU:function(){return o}});var r=i(2518);function n(){(0,r.$K)(console)&&console.warn(...arguments)}function o(){(0,r.$K)(console)&&console.error(...arguments)}},7628:function(t,e,i){"use strict";i.d(e,{Eb:function(){return s},Yl:function(){return n},ec:function(){return o}}),i(2916);var r=i(9488);function n(t){let e,i=t+1,r="";for(;i>0;)r=String.fromCharCode(65+(e=(i-1)%26))+r,i=parseInt((i-e)/26,10);return r}function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(i=[t]),i.forEach((t,i)=>{Array.isArray(t)?t.forEach((t,n)=>{r.push([i+e,n,t])}):Object.keys(t).forEach(n=>{r.push([i+e,n,t[n]])})}),r}function s(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&(0,r.Kn)(t[0])&&(e=(0,r.Q8)(t[0]))),e}},5878:function(t,e,i){"use strict";let r;i.d(e,{$g:function(){return H},AQ:function(){return M},C2:function(){return _},DZ:function(){return N},Dx:function(){return A},G_:function(){return s},I2:function(){return G},IV:function(){return b},Kz:function(){return d},MO:function(){return c},Mq:function(){return j},P$:function(){return y},Pb:function(){return P},TT:function(){return Z},W6:function(){return u},WH:function(){return K},WS:function(){return D},Wu:function(){return function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){let i=e.childNodes;for(let e=i.length-1;e>=0;e--)t(i[e])}}},a7:function(){return V},cS:function(){return C},cn:function(){return w},cv:function(){return O},cx:function(){return I},d$:function(){return S},dD:function(){return k},do:function(){return $},f5:function(){return a},iO:function(){return L},kg:function(){return W},l2:function(){return q},lq:function(){return Q},mK:function(){return f},np:function(){return U},oq:function(){return h},pV:function(){return Y},pn:function(){return function t(e){let i=e.ownerDocument.documentElement,r=e;for(;r!==i;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!r.host)return!1;if(r.host.impl)return t(r.host.impl);if(r.host)return t(r.host);throw Error("Lost in Web Components world")}if("none"===A(r).display)return!1;r=r.parentNode}return!0}},pv:function(){return p},qK:function(){return B},tT:function(){return R},u7:function(){return X},uS:function(){return T},vj:function(){return x},vw:function(){return z},x9:function(){return F},yY:function(){return J},yv:function(){return l}}),i(2916),i(2954);var n=i(6411),o=i(8200);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=-1,r=null,n=t;for(;null!==n;){if(i===e){r=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(i+=1,n=n.parentNode)}return r}function l(t,e){let i=t.closest(".handsontable");return!!i&&(i.parentNode===e||i===e)}function a(t){return Object.getPrototypeOf(t.parent)&&t.frameElement&&t.parent}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:n}=Node,o=t;for(;null!=o&&o!==i;){let{nodeType:t,nodeName:i}=o;if(t===r&&(e.includes(i)||e.includes(o)))return o;let{host:s}=o;o=s&&t===n?s:o.parentNode}return null}function u(t,e,i){let r=[],n=t;for(;n&&(n=h(n,e,i))&&(!i||i.contains(n));)r.push(n),n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode;let o=r.length;return o?r[o-1]:null}function c(t,e){let i=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==i;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function d(t){let e=0,i=t;if(i.previousSibling)for(;i=i.previousSibling;)e+=1;return e}function f(t,e,i){let r=i.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function g(t){return t&&t.length?t.filter(t=>!!t):[]}function m(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let i=[],r=[];return r.push(...t.filter(t=>{let r=t instanceof RegExp;return r&&e&&i.push(t),!r})),e?{regexFree:r,regexes:i}:r}function p(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function w(t,e){"string"==typeof e&&(e=e.split(" ")),(e=g(e)).length>0&&t.classList.add(...e)}function b(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=m(e,!0);(i=g(i)).length>0&&t.classList.remove(...i),r.forEach(e=>{t.classList.forEach(i=>{e.test(i)&&t.classList.remove(i)})})}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,i]]),e.forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function S(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=m(e,!0);i.forEach(e=>{""!==e&&t.removeAttribute(e)}),r.forEach(e=>{t.getAttributeNames().forEach(i=>{e.test(i)&&t.removeAttribute(i)})})}function C(t){let e;for(;e=t.lastChild;)t.removeChild(e)}let E=/(<(.*)>|&(.*);)/;function T(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];E.test(e)?t.innerHTML=i?(0,n.Nw)(e):e:R(t,e)}function R(t,e){let i=t.firstChild;i&&3===i.nodeType&&null===i.nextSibling?i.textContent=e:(C(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function O(t){let e,i,r;let n=t.ownerDocument,o=n.defaultView,s=n.documentElement,l=t;for(e=l.offsetLeft,i=l.offsetTop,r=l;(l=l.offsetParent)&&l!==n.body&&("offsetLeft"in l);)e+=l.offsetLeft,i+=l.offsetTop,r=l;return r&&"fixed"===r.style.position&&(e+=o.pageXOffset||s.scrollLeft,i+=o.pageYOffset||s.scrollTop),{left:e,top:i}}function M(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function N(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function I(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?M(e):t.scrollTop}function x(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?N(e):t.scrollLeft}function k(t){let e=t.ownerDocument,i=e?e.defaultView:void 0;e||(i=(e=t.document?t.document:t).defaultView);let r=["auto","scroll"],n=t.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:t,overflowX:e,overflowY:o}=n.style;if([t,e,o].includes("scroll")||({overflow:t,overflowX:e,overflowY:o}=i.getComputedStyle(n),r.includes(t)||r.includes(e)||r.includes(o))||n.clientHeight<=n.scrollHeight+1&&(r.includes(o)||r.includes(t))||n.clientWidth<=n.scrollWidth+1&&(r.includes(e)||r.includes(t)))return n;n=n.parentNode}return i}function H(t){let e=t.ownerDocument,i=e.defaultView,r=t.parentNode;for(;r&&r.style&&e.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;let t=A(r,i),e=["scroll","hidden","auto"],n=t.getPropertyValue("overflow"),o=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(n)||e.includes(o)||e.includes(s))return r;r=r.parentNode}return i}function _(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===i)return"width"===e?`${i.innerWidth}px`:"height"===e?`${i.innerHeight}px`:void 0;let r=t.style[e];if(""!==r&&void 0!==r)return r;let n=A(t,i);if(""!==n[e]&&void 0!==n[e])return n[e]}function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function L(t){return t.offsetWidth}function P(t){return t.offsetHeight}function D(t){return t.clientHeight||t.innerHeight}function F(t){return t.clientWidth||t.innerWidth}function B(t){return t.selectionStart?t.selectionStart:0}function W(t){return t.selectionEnd?t.selectionEnd:0}function V(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function j(t,e,i){if(void 0===i&&(i=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,i)}catch(o){let r=t.parentNode,n=r.style.display;r.style.display="block",t.setSelectionRange(e,i),r.style.display=n}}}function U(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===r&&(r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let i=t.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(e),(t.body||t.documentElement).appendChild(i);let r=e.offsetWidth;i.style.overflow="scroll";let n=e.offsetWidth;return r===n&&(n=i.clientWidth),(t.body||t.documentElement).removeChild(i),r-n}(t)),r}function $(t){return t.offsetWidth!==t.clientWidth}function z(t){return t.offsetHeight!==t.clientHeight}function G(t,e,i){t.style.transform=`translate3d(${e},${i},0)`}function K(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function X(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Y(t){return X(t)&&!1===t.hasAttribute("data-hot-input")}function Z(t,e){let i=new IntersectionObserver((i,r)=>{i.forEach(i=>{i.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body});i.observe(t)}function q(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.ownerDocument,n=r.createRange(),s=r.defaultView.getSelection();y(t,"contenteditable",!0),i&&y(t,...(0,o.cV)()),e&&w(t,"invisibleSelection"),n.selectNodeContents(t),s.removeAllRanges(),s.addRange(n)}function J(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),i.removeAllRanges(),e&&b(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Q(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];q(t,i),e(),J(t,i)}},7687:function(t,e,i){"use strict";function r(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function n(t){return!1===t.isImmediatePropagationEnabled}function o(t){return 2===t.button}function s(t){return 0===t.button}i.d(e,{Ty:function(){return n},dO:function(){return o},mM:function(){return r},pW:function(){return s}})},973:function(t,e,i){"use strict";let r;function n(t){return window.requestAnimationFrame(t)}function o(t){window.cancelAnimationFrame(t)}function s(){return"ontouchstart"in window}function l(){return"undefined"!=typeof window}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r||(r="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1)}i.d(e,{JS:function(){return s},U7:function(){return n},Wx:function(){return o},o6:function(){return l},sx:function(){return a}})},8179:function(t,e,i){"use strict";i.d(e,{$Z:function(){return a},Ds:function(){return o},WA:function(){return l},mf:function(){return n},r$:function(){return s}});var r=i(2518);function n(t){return"function"==typeof t}function o(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(()=>{e=t.apply(this,o)},i),e}}function s(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.apply(this,i.concat(r))}}function l(t){let e=t.length;return function i(r){return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];let l=r.concat(o);return l.length>=e?t.apply(this,l):i(l)}}([])}function a(t,e,i,n,o,s,l,a){return(0,r.$K)(a)?t.call(e,i,n,o,s,l,a):(0,r.$K)(l)?t.call(e,i,n,o,s,l):(0,r.$K)(s)?t.call(e,i,n,o,s):(0,r.$K)(o)?t.call(e,i,n,o):(0,r.$K)(n)?t.call(e,i,n):(0,r.$K)(i)?t.call(e,i):t.call(e)}},2518:function(t,e,i){"use strict";i.d(e,{$K:function(){return s},Kj:function(){return h},Pz:function(){return o},ge:function(){return C},o8:function(){return l},xb:function(){return a}});var r=i(2067),n=i(2836);function o(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function s(t){return void 0!==t}function l(t){return void 0===t}function a(t){return null===t||""===t||l(t)}function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}let u="length",c=t=>parseInt(t,16),d=t=>parseInt(t,10),f=(t,e,i)=>t.substr(e,i),g=t=>t.codePointAt(0)-65,m=t=>`${t}`.replace(/\-/g,""),p=t=>c(f(m(t),c("12"),g("F")))/(c(f(m(t),g("B"),~~![][u]))||9),w=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),b=!1,y={invalid:()=>n.e`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return n.e`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>n.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},S={invalid:()=>n.e`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return n.e`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>n.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function C(t,e){let i;let n=!a(t),o="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),s="14.1.0",l="invalid",h="invalid";t=m(t||"");let C=function(t){let e=[][u],i=e;if(t[u]!==g("Z"))return!1;for(let e="",r="B<H4P+".split(""),n=g(r.shift());n;n=g(r.shift()||"A"))--n<""[u]?i|=(d(`${d(c(e)+(c(f(t,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:e=f(t,n,n?1===r[u]?9:8:6);return i===e}(t);if(n||o||C){if(C){let e=r("16/01/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),o=p(t);i=r((o+1)*864e5,"x").format("MMMM DD, YYYY"),n>o?(l="expired",h="expired"):(l="valid",h="valid")}else o?(l="non_commercial",h="valid"):(l="invalid",h="invalid")}else l="missing",h="missing";if(w()&&(l="valid",h="valid"),!b&&"valid"!==l){let t=y[l]({keyValidityDate:i,hotVersion:s});t&&console["non_commercial"===l?"info":"warn"](y[l]({keyValidityDate:i,hotVersion:s})),b=!0}if("valid"!==h&&e.parentNode){let t=S[h]({keyValidityDate:i,hotVersion:s});if(t){let t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=S[h]({keyValidityDate:i,hotVersion:s}),e.parentNode.insertBefore(t,e.nextSibling)}}}},7790:function(t,e,i){"use strict";function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=typeof t;if("number"===i)return!isNaN(t)&&isFinite(t);if("string"===i){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);let i=Array.from(new Set([".",...e])).map(t=>`\\${t}`).join("|");return RegExp(`^[+-]?\\s*(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===i&&!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date)}function n(t){return r(t,[","])}function o(t,e,i){let r=-1;for("function"==typeof e?(i=e,e=t):r=t-1;++r<=e&&!1!==i(r););}function s(t,e,i){let r=t+1;for("function"==typeof e&&(i=e,e=0);--r>=e&&!1!==i(r););}function l(t,e){return parseInt(t*(e=isNaN(e=parseInt(e.toString().replace("%",""),10))?0:e)/100,10)}function a(t,e,i){return Math.min(t,e)===t?e:Math.max(t,i)===t?i:t}i.d(e,{N1:function(){return l},TR:function(){return n},kE:function(){return r},q4:function(){return o},uZ:function(){return a},yh:function(){return s}})},9488:function(t,e,i){"use strict";i.d(e,{$s:function(){return f},ED:function(){return n},Hn:function(){return g},I8:function(){return s},Kn:function(){return u},Q8:function(){return m},Z1:function(){return h},ZB:function(){return function t(e,i){d(i,(r,n)=>{i[n]&&"object"==typeof i[n]?(e[n]||(Array.isArray(i[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(i[n])?e[n]=i[n]:e[n]={}),t(e[n],i[n])):e[n]=i[n]})}},_l:function(){return d},d9:function(){return l},ie:function(){return function t(e){let i;return Array.isArray(e)?i=e.length?Array(e.length).fill(null):[]:(i={},d(e,(e,r)=>{"__children"!==r&&(e&&"object"==typeof e&&!Array.isArray(e)?i[r]=t(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?i[r]=[t(e[0])]:i[r]=[]:i[r]=null)})),i}},jB:function(){return a},jW:function(){return c},l7:function(){return o},nr:function(){return w},sm:function(){return p}}),i(7277),i(2916),i(2954);var r=i(9440);function n(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function o(t,e,i){let r=Array.isArray(i);return d(e,(e,n)=>{(!1===r||i.includes(n))&&(t[n]=e)}),t}function s(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function l(t){let e={};return d(t,(t,i)=>{e[i]=t}),e}function a(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return(0,r.Bk)(i,e=>{t.MIXINS.push(e.MIXIN_NAME),d(e,(e,i)=>{if(void 0!==t.prototype[i])throw Error(`Mixin conflict. Property '${i}' already exist and cannot be overwritten.`);"function"==typeof e?t.prototype[i]=e:Object.defineProperty(t.prototype,i,{get:function(t,e){let i=`_${t}`,r=t=>{let e=t;return(Array.isArray(e)||u(e))&&(e=s(e)),e};return function(){return void 0===this[i]&&(this[i]=r(e)),this[i]}}(i,e),set:function(t){let e=`_${t}`;return function(t){this[e]=t}}(i),configurable:!0})})}),t}function h(t,e){return JSON.stringify(t)===JSON.stringify(e)}function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t,e,i,r){r.value=i,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function d(t,e){for(let i in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,i))&&!1===e(t[i],i,t))break;return t}function f(t,e){let i=e.split("."),r=t;return d(i,t=>{if(void 0===(r=r[t]))return r=void 0,!1}),r}function g(t,e,i){let r=e.split("."),n=t;r.forEach((t,e)=>{e!==r.length-1?(w(n,t)||(n[t]={}),n=n[t]):n[t]=i})}function m(t){if(!u(t))return 0;let e=function(t){let i=0;return u(t)?d(t,(t,r)=>{"__children"!==r&&(i+=e(t))}):i+=1,i};return e(t)}function p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i=`_${e}`,r={_touched:!1,[i]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[i]},set(t){this._touched=!0,this[i]=t},enumerable:!0,configurable:!0}),r}function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},6411:function(t,e,i){"use strict";i.d(e,{Nw:function(){return h},O1:function(){return o},ct:function(){return n},ng:function(){return l},oN:function(){return a},wK:function(){return s}}),i(2916);var r=i(3571);function n(t){return t[0].toUpperCase()+t.substr(1)}function o(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function s(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[i]?"":e[i])}function a(t){return h(`${t}`,{ALLOWED_TAGS:[]})}function h(t,e){return r.sanitize(t,e)}},2836:function(t,e,i){"use strict";i.d(e,{e:function(){return n}});var r=i(9440);function n(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];let o=(0,r.k$)(t,(t,e,r)=>{let n=e.replace(/\r?\n\s*/g,""),o=i[r]?i[r]:"";return t+n+o},"");return o.trim()}},6678:function(t,e,i){"use strict";i.d(e,{DC:function(){return a},EA:function(){return l},T2:function(){return h},nx:function(){return o},ot:function(){return u}}),i(2916);var r=i(9440),n=i(2228);let o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,n.vU)()?182:174,AUDIO_MUTE:(0,n.vU)()?181:173,AUDIO_UP:(0,n.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function l(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function a(t){return s.includes(t)}function h(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function u(t,e){let i=e.split("|"),n=!1;return(0,r.Bk)(i,e=>{if(t===o[e])return n=!0,!1}),n}},2855:function(t,e,i){"use strict";i.r(e),i.d(e,{CHECKBOX_CHECKED:function(){return tk},CHECKBOX_RENDERER_NAMESPACE:function(){return tx},CHECKBOX_UNCHECKED:function(){return tH},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return R},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return I},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return P},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return k},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return _},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return x},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return L},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return H},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return A},CONTEXTMENU_ITEMS_BORDERS:function(){return D},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return W},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return V},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return B},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return F},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return g},CONTEXTMENU_ITEMS_COPY:function(){return m},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return b},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return w},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return p},CONTEXTMENU_ITEMS_CUT:function(){return y},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return O},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return S},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return z},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return K},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return l},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return a},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return E},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return $},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return U},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return n},CONTEXTMENU_ITEMS_READ_ONLY:function(){return f},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return N},CONTEXTMENU_ITEMS_REDO:function(){return d},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return j},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return u},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return M},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return h},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return o},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return s},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return G},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return X},CONTEXTMENU_ITEMS_UNDO:function(){return c},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return C},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return T},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return r},FILTERS_BUTTONS_CANCEL:function(){return tO},FILTERS_BUTTONS_CLEAR:function(){return tT},FILTERS_BUTTONS_OK:function(){return tR},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return tM},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return tI},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return tN},FILTERS_BUTTONS_SELECT_ALL:function(){return tE},FILTERS_CONDITIONS_AFTER:function(){return tf},FILTERS_CONDITIONS_BEFORE:function(){return tg},FILTERS_CONDITIONS_BEGINS_WITH:function(){return ti},FILTERS_CONDITIONS_BETWEEN:function(){return tc},FILTERS_CONDITIONS_BY_VALUE:function(){return ts},FILTERS_CONDITIONS_CONTAINS:function(){return tn},FILTERS_CONDITIONS_EMPTY:function(){return J},FILTERS_CONDITIONS_ENDS_WITH:function(){return tr},FILTERS_CONDITIONS_EQUAL:function(){return tt},FILTERS_CONDITIONS_GREATER_THAN:function(){return tl},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return ta},FILTERS_CONDITIONS_LESS_THAN:function(){return th},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return tu},FILTERS_CONDITIONS_NAMESPACE:function(){return Z},FILTERS_CONDITIONS_NONE:function(){return q},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return td},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return to},FILTERS_CONDITIONS_NOT_EMPTY:function(){return Q},FILTERS_CONDITIONS_NOT_EQUAL:function(){return te},FILTERS_CONDITIONS_TODAY:function(){return tm},FILTERS_CONDITIONS_TOMORROW:function(){return tp},FILTERS_CONDITIONS_YESTERDAY:function(){return tv},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return tw},FILTERS_DIVS_FILTER_BY_VALUE:function(){return tb},FILTERS_LABELS_CONJUNCTION:function(){return ty},FILTERS_LABELS_DISJUNCTION:function(){return tS},FILTERS_NAMESPACE:function(){return Y},FILTERS_VALUES_BLANK_CELLS:function(){return tC}});let r="ContextMenu:items",n=`${r}.noItems`,o=`${r}.insertRowAbove`,s=`${r}.insertRowBelow`,l=`${r}.insertColumnOnTheLeft`,a=`${r}.insertColumnOnTheRight`,h=`${r}.removeRow`,u=`${r}.removeColumn`,c=`${r}.undo`,d=`${r}.redo`,f=`${r}.readOnly`,g=`${r}.clearColumn`,m=`${r}.copy`,p=`${r}.copyWithHeaders`,w=`${r}.copyWithGroupHeaders`,b=`${r}.copyHeadersOnly`,y=`${r}.cut`,S=`${r}.freezeColumn`,C=`${r}.unfreezeColumn`,E=`${r}.mergeCells`,T=`${r}.unmergeCells`,R=`${r}.addComment`,O=`${r}.editComment`,M=`${r}.removeComment`,N=`${r}.readOnlyComment`,I=`${r}.align`,x=`${r}.align.left`,k=`${r}.align.center`,H=`${r}.align.right`,_=`${r}.align.justify`,A=`${r}.align.top`,L=`${r}.align.middle`,P=`${r}.align.bottom`,D=`${r}.borders`,F=`${r}.borders.top`,B=`${r}.borders.right`,W=`${r}.borders.bottom`,V=`${r}.borders.left`,j=`${r}.borders.remove`,U=`${r}.nestedHeaders.insertChildRow`,$=`${r}.nestedHeaders.detachFromParent`,z=`${r}.hideColumn`,G=`${r}.showColumn`,K=`${r}.hideRow`,X=`${r}.showRow`,Y="Filters:",Z=`${Y}conditions`,q=`${Z}.none`,J=`${Z}.isEmpty`,Q=`${Z}.isNotEmpty`,tt=`${Z}.isEqualTo`,te=`${Z}.isNotEqualTo`,ti=`${Z}.beginsWith`,tr=`${Z}.endsWith`,tn=`${Z}.contains`,to=`${Z}.doesNotContain`,ts=`${Z}.byValue`,tl=`${Z}.greaterThan`,ta=`${Z}.greaterThanOrEqualTo`,th=`${Z}.lessThan`,tu=`${Z}.lessThanOrEqualTo`,tc=`${Z}.isBetween`,td=`${Z}.isNotBetween`,tf=`${Z}.after`,tg=`${Z}.before`,tm=`${Z}.today`,tp=`${Z}.tomorrow`,tv=`${Z}.yesterday`,tw=`${Y}labels.filterByCondition`,tb=`${Y}labels.filterByValue`,ty=`${Y}labels.conjunction`,tS=`${Y}labels.disjunction`,tC=`${Y}values.blankCells`,tE=`${Y}buttons.selectAll`,tT=`${Y}buttons.clear`,tR=`${Y}buttons.ok`,tO=`${Y}buttons.cancel`,tM=`${Y}buttons.placeholder.search`,tN=`${Y}buttons.placeholder.value`,tI=`${Y}buttons.placeholder.secondValue`,tx="CheckboxRenderer:",tk=`${tx}checked`,tH=`${tx}unchecked`},8444:function(t,e,i){"use strict";i.d(e,{Zs:function(){return d},qG:function(){return y},vq:function(){return C},vk:function(){return E},gr:function(){return T},RY:function(){return S},MG:function(){return b}});var r=i(9488),n=i(9440),o=i(2518),s=i(1870),l=i(2656);let{register:a,getValues:h}=(0,l.Z)("phraseFormatters");a("pluralize",function(t,e){let i=Array.isArray(t)&&Number.isInteger(e);return i?t[e]:t});var u=i(2855);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */let c={languageCode:"en-US",[u.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[u.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[u.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[u.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[u.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[u.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[u.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[u.CONTEXTMENU_ITEMS_UNDO]:"Undo",[u.CONTEXTMENU_ITEMS_REDO]:"Redo",[u.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[u.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[u.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[u.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[u.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[u.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[u.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[u.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[u.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[u.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[u.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[u.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[u.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[u.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[u.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[u.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[u.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[u.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[u.CONTEXTMENU_ITEMS_COPY]:"Copy",[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[u.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[u.CONTEXTMENU_ITEMS_CUT]:"Cut",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[u.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[u.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[u.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[u.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[u.FILTERS_CONDITIONS_NONE]:"None",[u.FILTERS_CONDITIONS_EMPTY]:"Is empty",[u.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[u.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[u.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[u.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[u.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[u.FILTERS_CONDITIONS_CONTAINS]:"Contains",[u.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[u.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[u.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[u.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[u.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[u.FILTERS_CONDITIONS_BETWEEN]:"Is between",[u.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[u.FILTERS_CONDITIONS_AFTER]:"After",[u.FILTERS_CONDITIONS_BEFORE]:"Before",[u.FILTERS_CONDITIONS_TODAY]:"Today",[u.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[u.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[u.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[u.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[u.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[u.FILTERS_LABELS_CONJUNCTION]:"And",[u.FILTERS_LABELS_DISJUNCTION]:"Or",[u.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[u.FILTERS_BUTTONS_CLEAR]:"Clear",[u.FILTERS_BUTTONS_OK]:"OK",[u.FILTERS_BUTTONS_CANCEL]:"Cancel",[u.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[u.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[u.CHECKBOX_CHECKED]:"Checked",[u.CHECKBOX_UNCHECKED]:"Unchecked"},d=u,f=c.languageCode,{register:g,getItem:m,hasItem:p,getValues:w}=(0,l.Z)("languagesDictionaries");function b(t,e){var i,n;let o=t,l=e;return(0,r.Kn)(t)&&(o=(l=t).languageCode),i=o,n=l,i!==f&&(0,s.eb)(n,m(f)),g(o,(0,r.I8)(l)),(0,r.I8)(l)}function y(t){return p(t)?(0,r.I8)(m(t)):null}function S(t){return p(t)}function C(){return w()}function E(t,e,i){let r;let s=y(t);if(null===s)return null;let l=s[e];if((0,o.o8)(l))return null;let a=(r=l,(0,n.Bk)(h(),t=>{r=t(l,i)}),r);return Array.isArray(a)?a[0]:a}function T(t){let e=(0,s.TH)(t);return p(e)||(e=f,(0,s.Vn)(t)),e}b(c)},1870:function(t,e,i){"use strict";i.d(e,{TH:function(){return a},Vn:function(){return h},eb:function(){return l}});var r=i(2518),n=i(9488),o=i(4748),s=i(2836);function l(t,e){return(0,n._l)(e,(e,i)=>{(0,r.o8)(t[i])&&(t[i]=e)}),t}function a(t){let e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function h(t){(0,r.$K)(t)&&(0,o.vU)(s.e`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}},3437:function(t,e,i){"use strict";i(2916);var r=i(9488),n=i(8179);let o={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,i,r,o,s,l){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let h=0;h<a;h++)(0,n.$Z)(this._localHooks[t][h],this,e,i,r,o,s,l)}},clearLocalHooks(){return this._localHooks={},this}};(0,r.jW)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.Z=o},4317:function(t,e,i){"use strict";i(2916),i(2954);var r=i(9440),n=i(9488),o=i(6411),s=i(4748),l=i(2836),a=i(8179);let h=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],u=l.e`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,c=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),d=new Map([[]]);class f{static getSingleton(){return g}constructor(){var t,e,i;e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="globalBucket","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let t=Object.create(null);return(0,r.Bk)(h,e=>t[e]=[]),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))(0,r.Bk)(e,e=>this.add(t,e,i));else{c.has(t)&&(0,s.ZK)((0,o.ng)(u,{hookName:t,removedInVersion:c.get(t)})),d.has(t)&&(0,s.ZK)(d.get(t));let n=this.getBucket(i);if(void 0===n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let i=!1;e.initialHook&&(0,r.Bk)(n[t],(r,o)=>{if(r.initialHook)return n[t][o]=e,i=!0,!1}),i||n[t].push(e)}}return this}once(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,r.Bk)(e,e=>this.once(t,e,i)):(e.runOnce=!0,this.add(t,e,i))}remove(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(i);return!!(void 0!==r[t]&&r[t].indexOf(e)>=0)&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.getBucket(e);return!!(void 0!==i[t]&&i[t].length)}run(t,e,i,r,n,o,s,l){{let h=this.globalBucket[e],u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,a.$Z)(h[c],t,i,r,n,o,s,l);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(e,h[c]),c+=1}}{let h=this.getBucket(t)[e],u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,a.$Z)(h[c],t,i,r,n,o,s,l);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(e,h[c],t),c+=1}}return i}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,n._l)(this.getBucket(t),(t,e,i)=>i[e].length=0)}register(t){this.isRegistered(t)||h.push(t)}deregister(t){this.isRegistered(t)&&h.splice(h.indexOf(t),1)}isDeprecated(t){return d.has(t)||c.has(t)}isRegistered(t){return h.indexOf(t)>=0}getRegistered(){return h}}let g=new f;e.Z=f},3004:function(t,e,i){"use strict";i.d(e,{lV:function(){return _}}),i(2916),i(2954);var r=i(5440),n=i(9440),o=i(973),s=i(5878);function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class a{constructor(t){l(this,"hot",null),l(this,"container",null),l(this,"injected",!1),l(this,"rows",[]),l(this,"columns",[]),l(this,"samples",null),l(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={row:t};this.rows.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(t){let e=this.hot.getColHeader(0);if(null!=e){let e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={col:t};this.columns.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,n.Bk)(this.rows,e=>{t(e.row,(0,s.Pb)(e.table)-1)})}getWidths(t){this.injected||this.injectTable(),(0,n.Bk)(this.columns,e=>{let{width:i}=e.table.getBoundingClientRect();t(e.col,Math.ceil(i))})}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){let e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{(0,n.Bk)(i.strings,i=>{e.appendChild(this.createColElement(i.col,t))})}),e}createRow(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,r),i.appendChild(r)),this.samples.forEach(r=>{(0,n.Bk)(r.strings,r=>{let n=r.col,o=this.hot.getCellMeta(t,n);o.col=n,o.row=t;let s=this.hot.getCellRenderer(o),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,n,this.hot.colToProp(n),r.value,o),i.appendChild(l)})}),i}appendColumnHeadersRow(){let{rootDocument:t}=this.hot,e=t.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){let r=t.createElement("th");i.push([-1,r]),e.appendChild(r)}this.samples.forEach(r=>{(0,n.Bk)(r.strings,r=>{let n=r.col,o=t.createElement("th");i.push([n,o]),e.appendChild(o)})}),this.table.tHead.appendChild(e),(0,n.Bk)(i,t=>{let[e,i]=t;this.hot.view.appendColHeader(e,i)})}createCol(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment();return this.samples.forEach(r=>{(0,n.Bk)(r.strings,r=>{let n=r.row,o=this.hot.getCellMeta(n,t);o.col=t,o.row=n;let s=this.hot.getCellRenderer(o),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,n,t,this.hot.colToProp(t),r.value,o),a.appendChild(l),i.appendChild(a)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){let i=this.hot.rootDocument.createElement("col"),r=0;e>=0&&t>=0&&(r=this.hot.getCellMeta(e,t).colspan);let n=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(r>1)for(let e=t+1;e<t+r;e++)n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);return i.style.width=`${n}px`,i}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("table"),n=e.createElement("thead"),o=e.createElement("tbody"),l=e.createElement("colgroup"),a=e.createElement("tr"),h=e.createElement("th");return this.isVertical()&&r.appendChild(l),this.isHorizontal()&&(a.appendChild(h),n.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(n),this.isVertical()&&o.appendChild(a),r.appendChild(o),(0,s.cn)(r,t),i.appendChild(r),{fragment:i,table:r,tHead:n,tBody:o,colGroup:l,tr:a,th:h}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("div"),n=`htGhostTable htAutoSize ${t.trim()}`;return(0,s.cn)(r,n),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}var h=i(4317),u=i(9488),c=i(7790),d=i(2518);function f(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class g{static get SAMPLE_COUNT(){return 3}constructor(t){f(this,"samples",null),f(this,"dataFactory",null),f(this,"customSampleCount",null),f(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:g.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,i){let r=new Map,{from:n,to:o}="number"==typeof i?{from:i,to:i}:i;return(0,c.q4)(n,o,i=>{let n=this.generateSample(t,e,i);r.set(i,n)}),r}generateSample(t,e,i){if("row"!==t&&"col"!==t)throw Error("Unsupported sample type");let r=new Map,n="row"===t?"col":"row",o=[];return(0,c.q4)(e.from,e.to,e=>{let s;let l="row"===t?this.dataFactory(i,e):this.dataFactory(e,i);if(!1===l)return;let{value:a,bundleSeed:h}=l,c="string"==typeof h&&h.length>0;s=c?h:(0,u.Kn)(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${(0,d.Pz)(a).length}`,r.has(s)||r.set(s,{needed:this.getSampleCount(),strings:[]});let f=r.get(s);if(f.needed){let t=o.indexOf(a)>-1;(!t||this.allowDuplicates||c)&&(f.strings.push({value:a,[n]:e}),o.push(a),f.needed-=1)}}),r}}var m=i(6411),p=i(7431),w=i(5843);function b(t,e){y(t,e),e.add(t)}function y(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function S(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function C(t,e){var i=E(t,e,"get");return i.get?i.get.call(t):i.value}function E(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function T(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}h.Z.getSingleton().register("modifyAutoColumnSizeSeed");let R="autoColumnSize";var O=new WeakMap,M=new WeakSet,N=new WeakSet,I=new WeakSet,x=new WeakSet,k=new WeakSet,H=new WeakSet;class _ extends r.v{static get PLUGIN_KEY(){return R}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),b(this,H),b(this,k),b(this,x),b(this,I),b(this,N),b(this,M),S(this,"ghostTable",new a(this.hot)),S(this,"samplesGenerator",new g((t,e)=>{let i=this.hot.getCellMeta(t,e),r="";i.spanned||(r=this.hot.getDataAtCell(t,e));let n="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(n=this.hot.runHooks("modifyAutoColumnSizeSeed",n,i,r)),{value:r,bundleSeed:n}})),S(this,"firstCalculation",!0),S(this,"inProgress",!1),S(this,"measuredColumns",0),S(this,"columnWidthsMap",new w.L),y(this,O),O.set(this,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(t,e,i)=>T(this,x,D).call(this,t,e,i))}isEnabled(){return!1!==this.hot.getSettings()[R]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[R];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return T(t,N,L).call(t,...i)}),this.addHook("beforeChangeRender",t=>T(this,I,P).call(this,t)),this.addHook("afterFormulasValuesUpdate",t=>T(this,H,B).call(this,t)),this.addHook("beforeViewRender",t=>T(this,M,A).call(this,t)),this.addHook("modifyColWidth",(t,e)=>this.getColumnWidth(e,t)),this.addHook("afterInit",()=>T(this,k,F).call(this)),super.enablePlugin()}updatePlugin(){let t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,e,i)=>T(this,x,D).call(this,t,e,i))}calculateVisibleColumnsWidth(){let t=this.hot.countRows();if(!t)return;let e=this.hot.renderCall,i=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==i&&-1!==r&&this.calculateColumnsWidth({from:i,to:r},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,o="number"==typeof e?{from:e,to:e}:e;(0,c.q4)(r.from,r.to,t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),i||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){let e=this.samplesGenerator.generateColumnSamples(t,o);(0,n.Bk)(e,t=>{let[e,i]=t;return this.ghostTable.addColumn(e,i)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{let i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,e)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0,i=this.hot.countCols()-1,r=null;this.inProgress=!0;let n=()=>{if(!this.hot){(0,o.Wx)(r),this.inProgress=!1;return}this.calculateColumnsWidth({from:e,to:Math.min(e+_.CALCULATION_STEP,i)},t),(e=e+_.CALCULATION_STEP+1)<i?r=(0,o.U7)(n):((0,o.Wx)(r),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},t),this.firstCalculation=!1,e=s+1),e<i?n():this.inProgress=!1}setSamplingOptions(){let t=this.hot.getSettings()[R],e=t&&(0,u.nr)(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&(0,u.nr)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let t=this.hot.getSettings()[R],e=_.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return(0,u.Kn)(t)&&(e=t.syncLimit,(0,m.wK)(e)?e=(0,c.N1)(i,e):e>>=0),Math.min(e,i)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),i&&"number"==typeof r&&(r=Math.max(r,p.E.DEFAULT_WIDTH))),r}getFirstVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}getLastVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}findColumnsWhereHeaderWasChanged(){let t=this.hot.getColHeader(),e=(0,n.k$)(t,(t,e,i)=>{let r=C(this,O).length;return(r-1<i||C(this,O)[i]!==e)&&t.push(i),r-1<i?C(this,O).push(e):C(this,O)[i]=e,t},[]);return e}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution(()=>{(0,n.Bk)(t,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!(0,n.w7)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function A(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function L(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function P(t){let e=(0,n.Sc)(t,t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))});this.clearCache(Array.from(new Set(e)))}function D(t,e,i){let r=t;return i&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function F(){var t;t=this.hot.getColHeader(),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,E(this,O,"set"),t)}function B(t){let e=(0,n.w7)(t,t=>{var e;return(0,d.$K)(null===(e=t.address)||void 0===e?void 0:e.col)}),i=(0,n.Sc)(e,t=>t.address.col);this.clearCache(Array.from(new Set(i)))}},9788:function(t,e,i){"use strict";i.d(e,{Gf:function(){return S}}),i(2916),i(2954);var r=i(5440),n=i(4317),o=i(5878),s=i(9440),l=i(9488),a=i(2518);let h={horizontal:"horizontal",vertical:"vertical"};function u(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function c(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function d(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}n.Z.getSingleton().register("modifyAutofillRange"),n.Z.getSingleton().register("beforeAutofill"),n.Z.getSingleton().register("afterAutofill");let f="autofill",g=["fillHandle"];var m=new WeakSet,p=new WeakSet,w=new WeakSet,b=new WeakSet,y=new WeakSet;class S extends r.v{constructor(){super(...arguments),u(this,y),u(this,b),u(this,w),u(this,p),u(this,m),c(this,"addingStarted",!1),c(this,"mouseDownOnCellCorner",!1),c(this,"mouseDragOutside",!1),c(this,"handleDraggedCells",0),c(this,"directions",[]),c(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return f}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[f,...g]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",t=>d(this,p,E).call(this,t)),this.addHook("afterOnCellCornerDblClick",t=>d(this,m,C).call(this,t)),this.addHook("beforeOnCellMouseOver",(t,e)=>d(this,w,T).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let t=this.hot.getSelectedRangeLast(),{row:e,col:i}=t.getTopStartCorner(),{row:r,col:n}=t.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:i,endRow:r,endCol:n}]),l=[],a=[],h=[];return(0,s.Bk)(o,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===l.indexOf(e)&&l.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===a.indexOf(e)&&a.push(e)}),(0,s.Bk)(l,t=>{let e=[];(0,s.Bk)(a,i=>{e.push(this.hot.getCopyableData(t,i))}),h.push(e)}),h}fillIn(){var t;let e,i,r;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[n,o,s,l]=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.getSelectedRangeLast(),h=a.getTopStartCorner(),u=a.getBottomEndCorner();this.resetSelectionOfDraggedArea();let c=[h.row,h.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,n),Math.min(h.col,o),Math.max(u.row,s),Math.max(u.col,l)],c),{directionOfDrag:f,startOfDragCoords:g,endOfDragCoords:m}=(t=(t,e)=>this.hot._createCellCoords(t,e),d[0]===c[0]&&d[1]<c[1]?(r="left",e=t(d[0],d[1]),i=t(d[2],c[1]-1)):d[2]===c[2]&&d[0]===c[0]&&d[3]>c[3]?(r="right",e=t(d[0],c[3]+1),i=t(d[2],d[3])):d[0]<c[0]&&d[1]===c[1]?(r="up",e=t(d[0],d[1]),i=t(c[0]-1,d[3])):d[2]>c[2]&&d[1]===c[1]&&(r="down",e=t(c[2]+1,d[1]),i=t(d[2],d[3])),e&&e.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:e,endOfDragCoords:i});if(g&&g.row>-1&&g.col>-1){let t=this.getSelectionData(),e=a.clone(),i=this.hot._createCellRange(g,g,m),r=this.hot.runHooks("beforeAutofill",t,e,i,f);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let n=r;if(["up","left"].indexOf(f)>-1&&!(1===r.length&&0===r[0].length)){if(n=[],"up"===f){let t=m.row-g.row+1,e=t%r.length;for(let i=0;i<t;i++)n.push(r[(i+(r.length-e))%r.length])}else{let t=m.col-g.col+1,e=t%r[0].length;for(let i=0;i<r.length;i++){n.push([]);for(let o=0;o<t;o++)n[i].push(r[i][(o+(r[i].length-e))%r[i].length])}}}this.hot.populateFromArray(g.row,g.col,n,m.row,m.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",n,e,i,f),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){let e=this.hot.getSelectedRangeLast(),i=e.getBottomEndCorner(),r=t;if(this.directions.includes(h.vertical)&&this.directions.includes(h.horizontal)){let n=e.getTopStartCorner();(i.col<=t.col||n.col>=t.col)&&(r=this.hot._createCellCoords(i.row,t.col)),(i.row<t.row||n.row>t.row)&&(r=this.hot._createCellCoords(t.row,i.col))}else if(this.directions.includes(h.vertical))r=this.hot._createCellCoords(t.row,i.col);else{if(!this.directions.includes(h.horizontal))return;r=this.hot._createCellCoords(i.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(t){let e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();t[2]<i-1&&e[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){let e;let i=this.hot.getData(),r=this.hot.countRows();for(let n=t[2]+1;n<r;n++){for(let e=t[1];e<=t[3];e++){let t=i[n][e];if(t)return -1}let r=i[n][t[1]-1],o=i[n][t[3]+1];(r||o)&&(e=n)}return e}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...(0,s.Sc)(t,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){let t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return -1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){let{documentElement:e}=this.hot.rootDocument,i=(0,o.cv)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+(0,o.Pb)(this.hot.table),r=(0,o.cv)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+(0,o.iO)(this.hot.table);return t.clientY>i&&t.clientX<=r}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",()=>d(this,b,R).call(this)),this.eventManager.addEventListener(t,"mousemove",t=>d(this,y,O).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let t=function(t){let e={};return!0===t?(e.directions=Object.keys(h),e.autoInsertRow=!0):(0,l.Kn)(t)?((0,a.$K)(t.autoInsertRow)?t.direction===h.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,(0,a.$K)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(h)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function C(){let t=this.selectAdjacent();t&&this.fillIn()}function E(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function T(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function R(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function O(t){let e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},5440:function(t,e,i){"use strict";i.d(e,{v:function(){return y}}),i(2954),i(2916);var r=i(9488),n=i(9440),o=i(5915),s=i(6324),l=i(7416),a=i(6903),h=i(2740),u=i(9773);function c(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function d(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t,e){var i=function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e,0);return i.get?i.get.call(t):i.value}let g=new Map([["plugin",o._j],["cell-type",s.V1],["editor",l.Wu],["renderer",a.Y3],["validator",h.oh]]),m=[],p=null;var w=new WeakMap,b=new WeakSet;class y{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){c(this,b),b.add(this),d(this,"eventManager",new u.Z(this)),d(this,"pluginName",null),d(this,"pluginsInitializedCallbacks",[]),d(this,"isPluginsReady",!1),d(this,"enabled",!1),d(this,"initialized",!1),c(this,w),w.set(this,{writable:!0,value:{}}),(0,r.jW)(this,"hot",t,{writable:!1}),p=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){let t=[];if(e.forEach(e=>{let[i,r]=e.split(":");if(!g.has(i))throw Error(`Unknown plugin dependency type "${i}" was found.`);g.get(i)(r)||t.push(` - ${r} (${i})`)}),t.length>0){let e=`The ${this.pluginName} plugin requires the following modules:
${t.join("\n")}
`;m.push(e)}}p||(p=(0,o.a9)()),p.indexOf("UndoRedo")>=0&&p.splice(p.indexOf("UndoRedo"),1),p.indexOf(this.pluginName)>=0&&p.splice(p.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});let i=0===p.length;if(i){if(m.length>0){let t=`${m.join("\n")}
You have to import and register them manually.`;throw Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){f(this,w)[t]=f(this,w)[t]||[];let i=f(this,w)[t];this.hot.addHook(t,e),i.push(e),f(this,w)[t]=i}removeHooks(t){(0,n.Bk)(f(this,w)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){let t=f(this,w);(0,r._l)(t,(t,e)=>this.removeHooks(e)),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){(0,n.Bk)(this.pluginsInitializedCallbacks,t=>t()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){let e=(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,b,S).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),(0,r._l)(this,(t,e)=>{"hot"!==e&&(this[e]=null)}),delete this.t,delete this.hot}}function S(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let i=0;i<e.length;i++)if(void 0!==t[e[i]])return!0;return!1}},285:function(t,e,i){"use strict";i.d(e,{u:function(){return s}}),i(2954),i(2916),i(4247);var r=i(9440),n=i(9488);function o(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class s{constructor(t){o(this,"hot",void 0),o(this,"commands",{}),o(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){let e;for(var i,o=arguments.length,s=Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];let a=t.split(":"),h=a[0],u=2===a.length?a[1]:null,c=this.commands[h];if(!c)throw Error(`Menu command '${h}' not exists.`);if(u&&c.submenu&&(i=c.submenu.items,(0,r.Bk)(i,t=>{let i=t.key?t.key.split(":"):null;if(Array.isArray(i)&&i[1]===u)return e=t,!1}),c=e),!0===c.disabled||"function"==typeof c.disabled&&!0===c.disabled.call(this.hot)||(0,n.nr)(c,"submenu"))return;let d=[];"function"==typeof c.callback&&d.push(c.callback),"function"==typeof this.commonCallback&&d.push(this.commonCallback),s.unshift(a.join(":")),(0,r.Bk)(d,t=>t.apply(this.hot,s))}}},6104:function(t,e,i){"use strict";i.d(e,{xV:function(){return H}}),i(2954);var r=i(5440),n=i(4317),o=i(9440),s=i(9488),l=i(285),a=i(279),h=i(1775),u=i(9656),c=i(5878),d=i(163),f=i(677),g=i(7993),m=i(2333),p=i(1942),w=i(4108),b=i(3029),y=i(9959),S=i(2614),C=i(524),E=i(7595);function T(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function R(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function O(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let M="contextMenu";n.Z.getSingleton().register("afterContextMenuDefaultOptions"),n.Z.getSingleton().register("beforeContextMenuShow"),n.Z.getSingleton().register("afterContextMenuShow"),n.Z.getSingleton().register("afterContextMenuHide"),n.Z.getSingleton().register("afterContextMenuExecute");var N=new WeakSet,I=new WeakSet,x=new WeakSet,k=new WeakSet;class H extends r.v{constructor(){super(...arguments),T(this,k),T(this,x),T(this,I),T(this,N),R(this,"commandExecutor",new l.u(this.hot)),R(this,"itemsFactory",null),R(this,"menu",null)}static get PLUGIN_KEY(){return M}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[d.F,f.F,g.F,m.F,p.F,g.F,w.F,b.F,g.F,y.F,S.F,g.F,C.F,g.F,E.F]}isEnabled(){return!!this.hot.getSettings()[M]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[M];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new h.v(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>O(this,I,A).call(this)),this.menu.addLocalHook("afterOpen",()=>O(this,x,L).call(this)),this.menu.addLocalHook("afterClose",()=>O(this,k,P).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),this.addHook("afterOnCellContextMenu",t=>O(this,N,_).call(this,t)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),i=(0,u.RB)(this.menu.container,this.hot.rootDocument);this.open({left:e.left+i.left,top:e.top+i.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:M})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(M)}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),(0,s._l)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}prepareMenuItems(){this.itemsFactory=new a.E(this.hot,H.DEFAULT_ITEMS);let t=this.hot.getSettings()[M],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);let i=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),(0,o.Bk)(i,t=>this.commandExecutor.registerCommand(t.key,t))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _(t){let e=this.hot.getSettings(),i=e.rowHeaders,r=e.colHeaders,n=t.target;if(this.close(),(0,c.pv)(n,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(i||r)&&!("TD"===n.nodeName||"TD"===n.parentNode.nodeName)&&!((0,c.pv)(n,"current")&&(0,c.pv)(n,"wtBorder"))))return;let o=(0,u.RB)(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function A(){this.hot.runHooks("beforeContextMenuShow",this)}function L(){this.hot.runHooks("afterContextMenuShow",this)}function P(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}H.SEPARATOR={name:g.F}},279:function(t,e,i){"use strict";i.d(e,{E:function(){return a}}),i(2916),i(2954);var r=i(9488),n=i(9440),o=i(1318),s=i(7993);function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l(this,"hot",void 0),l(this,"predefinedItems",(0,o.Gf)()),l(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){let e={};this.defaultOrderPattern.length=0,(0,r._l)(t,(t,i)=>{let r="";t.name===s.F?(e[s.F]=t,r=s.F):(isNaN(parseInt(i,10))?(t.key=void 0===t.key?i:t.key,e[i]=t):e[t.key]=t,r=t.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=[],l=t;return l&&l.items?l=l.items:Array.isArray(l)||(l=e),(0,r.Kn)(l)?(0,r._l)(l,(t,e)=>{let n=i["string"==typeof t?t:e];n||(n=t),(0,r.Kn)(t)?(0,r.l7)(n,t):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=e),s.push(n)}):(0,n.Bk)(l,(t,e)=>{let n=i[t];!n&&o.cq.indexOf(t)>=0||(n||(n={name:t,key:`${e}`}),(0,r.Kn)(t)&&(0,r.l7)(n,t),void 0===n.key&&(n.key=e),s.push(n))}),s}(t,this.defaultOrderPattern,this.predefinedItems)}}},1775:function(t,e,i){"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{v:function(){return U}}),i(2916),i(2954);class n{constructor(t,e){let i,n,o,s,l,a;r(this,"top",void 0),r(this,"topRelative",void 0),r(this,"left",void 0),r(this,"leftRelative",void 0),r(this,"scrollTop",void 0),r(this,"scrollLeft",void 0),r(this,"cellHeight",void 0),r(this,"cellWidth",void 0);let h=e.scrollY,u=e.scrollX;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),o=parseInt(t.left,10),l=t.height||0,a=t.width||0,n=i,s=o,i+=h,o+=u):"event"===this.type&&(i=parseInt(t.pageY,10),o=parseInt(t.pageX,10),l=t.target.clientHeight,a=t.target.clientWidth,n=i-h,s=o-u),this.top=i,this.topRelative=n,this.left=o,this.leftRelative=s,this.scrollTop=h,this.scrollLeft=u,this.cellHeight=l,this.cellWidth=a}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function o(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function s(t,e){var i=a(t,e,"get");return i.get?i.get.call(t):i.value}function l(t,e,i){var r=a(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function a(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var h=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,f=new WeakMap;class g{constructor(t){o(this,h,{writable:!0,value:void 0}),o(this,u,{writable:!0,value:void 0}),o(this,c,{writable:!0,value:void 0}),o(this,d,{writable:!0,value:!1}),o(this,f,{writable:!0,value:{above:0,below:0,left:0,right:0}}),l(this,d,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return s(this,f)[t]=e,this}setElement(t){return l(this,h,t),this}setParentElement(t){return l(this,u,t),this}updatePosition(t){l(this,c,new n(t,s(this,h).ownerDocument.defaultView)),s(this,d)?(s(this,c).fitsBelow(s(this,h))?this.setPositionBelowCursor():s(this,c).fitsAbove(s(this,h))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===s(this,h).dir?s(this,c).fitsOnLeft(s(this,h))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():s(this,c).fitsOnRight(s(this,h))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=s(this,f).above+s(this,c).top-s(this,h).offsetHeight;s(this,u)&&(t=s(this,c).top+s(this,c).cellHeight-s(this,h).offsetHeight+3),s(this,h).style.top=`${t}px`}setPositionBelowCursor(){let t=s(this,f).below+s(this,c).top+1;s(this,u)&&(t=s(this,c).top-1),s(this,h).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=s(this,c).left;if(s(this,u)){let{right:e}=s(this,u).getBoundingClientRect();t+=s(this,c).cellWidth+e-(s(this,c).left+s(this,c).cellWidth)}else t+=s(this,f).right;s(this,h).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=s(this,f).left+s(this,c).left-s(this,h).offsetWidth;if(s(this,u)){let{left:e}=s(this,u).getBoundingClientRect();t-=s(this,c).left-e}s(this,h).style.left=`${t}px`}}var m=i(491),p=i(9440),w=i(9488),b=i(5878),y=i(7993);function S(t){return(0,w.nr)(t,"submenu")}function C(t){return RegExp(y.F,"i").test(t.name)}function E(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function T(t){return(0,w.nr)(t,"disableSelection")}function R(t,e){let i=t.slice(0);for(;0<i.length;)if(i[0].name===e)i.shift();else break;return i}let O="menu";var M=i(8920),N=i(1318),I=i(9773),x=i(2228),k=i(7687),H=i(8179),_=i(2518),A=i(3437),L=i(8200);function P(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function D(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function F(t,e,i){var r=W(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function B(t,e){var i=W(t,e,"get");return i.get?i.get.call(t):i.value}function W(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var V=new WeakMap,j=new WeakMap;class U{constructor(t,e){var i=this;D(this,"hot",void 0),D(this,"options",void 0),D(this,"eventManager",new I.Z(this)),D(this,"container",void 0),D(this,"positioner",void 0),D(this,"hotMenu",null),D(this,"hotSubMenus",{}),D(this,"parentMenu",void 0),D(this,"menuItems",null),D(this,"origOutsideClickDeselects",null),P(this,V,{writable:!0,value:void 0}),P(this,j,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new g(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...e)})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"contextmenu",t=>this.onDocumentContextMenu(t)),t=(0,b.f5)(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return B(this,V)}getKeyboardShortcutsCtrl(){return B(this,j)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var t,e;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let i=(0,H.Ds)(t=>this.openSubMenu(t),300),r=this.options.minWidth||215,n=!1,o=(0,p.w7)(this.menuItems,t=>{var e;return t.key===M.F&&(n=!0),e=this.hot,!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))});if(o.length<1&&!n)o.push((0,N.Gf)()[M.F]);else if(0===o.length)return;o=function(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.F,r=t.slice(0);return(e=(r=R(r,i)).slice(0)).reverse(),(e=R(e,i)).reverse(),r=function(t){let e=[];return(0,p.Bk)(t,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(r=e)}(o,y.F);let s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>(0,_.$K)(t)&&t<r?r:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(t=this.hot,(e,i,r,n,o,s)=>{if(i.hasAttribute("ghost-table"))return;let l=e.getSourceDataAtRow(r),a=t.rootDocument.createElement("div"),h="function"==typeof s?s.call(t):s;if((0,b.cS)(i),(0,b.cn)(a,"htItemWrapper"),t.getSettings().ariaTags){let e=!E(l,t)&&!T(l)&&!C(l);(0,b.P$)(i,[(0,L.rQ)(),(0,L.QK)(h),...e?[(0,L.Qk)(-1)]:[],...E(l,t)?[(0,L.gw)()]:[],...S(l)?[(0,L.JV)(!1)]:[]])}i.className="",i.appendChild(a),C(l)?(0,b.cn)(i,"htSeparator"):"function"==typeof l.renderer?((0,b.cn)(i,"htCustomMenuRenderer"),i.appendChild(l.renderer(e,a,r,n,o,h))):(0,b.uS)(a,h),E(l,t)?(0,b.cn)(i,"htDisabled"):T(l)?(0,b.cn)(i,"htSelectionDisabled"):S(l)&&(0,b.cn)(i,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{B(this,V).setCurrentPage(e.row)},afterOnCellMouseOver:(t,e)=>{this.isAllSubMenusClosed()?i(e.row):this.openSubMenu(e.row)},rowHeights:t=>o[t].name===y.F?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),(0,x.uM)()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,i,r,n)=>{this.hotMenu.view.isMouseDown()&&(n.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{(!(0,x.uM)()||!(0,k.dO)(t))&&s&&this.hasSelectedItem()&&((0,x.K1)()||(0,x.L)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,l),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),F(this,V,(e=this.hotMenu,(0,m.M)({size:()=>e.countRows(),onItemSelect(t,i){let r=e.getCell(t,0);if(!r||(0,b.pv)(r,"htSeparator")||(0,b.pv)(r,"htDisabled")||(0,b.pv)(r,"htSelectionDisabled"))return!1;e.selectCell(t,0,...i?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}}))),F(this,j,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];function r(t,e){s(e).addShortcuts(t,{group:O})}function n(t,e){let n=s(e);t.forEach(t=>{let{keys:e}=t;e.forEach(t=>n.removeShortcutsByKeys(t))}),i.push({shortcuts:t,contextName:e}),r(t,e)}function o(t){return t?`${O}:${t}`:O}function s(e){var i;let r=t.hotMenu.getShortcutManager(),n=o(e);return null!==(i=r.getContext(n))&&void 0!==i?i:r.addContext(n)}return r([{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let e=t.hotMenu.getSelectedLast();if(e){let i=t.openSubMenu(e[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{let i=t.hotMenu.getSelectedLast();i&&(t.hotMenu.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]),e.forEach(t=>{let{shortcuts:e,contextName:i}=t;n(e,i)}),{addCustomShortcuts:n,getCustomShortcuts:function(){return[...i]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(o(e))}}}(this)),B(this,j).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(B(this,V).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let t=this.parentMenu.hotMenu.getSelectedLast();if(t){let e=this.parentMenu.hotMenu.getCell(t[0],0);(0,b.P$)(e,[(0,L.JV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;let e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!(0,b.pv)(e,"htSubmenu"))return!1;let i=this.hotMenu.getSourceDataAtRow(t),r=new U(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(e.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&(0,b.P$)(e,[(0,L.JV)(!0)]),r}closeSubMenu(t){let e=this.hotMenu.getSourceDataAtRow(t),i=this.hotSubMenus[e.key];if(i){i.destroy(),delete this.hotSubMenus[e.key];let r=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&(0,b.P$)(r,[(0,L.JV)(!1)])}}closeAllSubMenus(){(0,p.Bk)(this.hotMenu.getData(),(t,e)=>this.closeSubMenu(e))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;let e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;let i=this.hot.getSelectedRange(),r=i?(0,p.Sc)(i,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}isCommandPassive(t){return!1===t.isCommand||C(t)||E(t,this.hot)||S(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.options.container.ownerDocument,r=e;return r&&((0,H.mf)(r)&&(r=null===(r=r.call(this.hot))||(0,_.o8)(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,t=i.querySelector(`.${this.options.className}.${r}`)),t||(t=i.createElement("div"),(0,b.cn)(t,`htMenu ${this.options.className}`),r&&(0,b.cn)(t,r),this.options.container.appendChild(t)),t}onAfterInit(){let{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,i=t.hider.style,r=t.holder.style,n=parseInt(i.width,10),o=(0,p.k$)(e,(t,e)=>t+(e.name===y.F?1:26),0);r.width=`${n+3}px`,r.height=`${o+3}px`,i.height=r.height,this.hot.getSettings().ariaTags&&(0,b.P$)(this.hotMenu.rootElement,[(0,L.tm)(),(0,L.Qk)(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,b.MO)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,b.MO)(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&(0,b.pv)(t.target,"htCore")&&(0,b.MO)(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}(0,w.jB)(U,A.Z)},7595:function(t,e,i){"use strict";i.d(e,{F:function(){return s},Z:function(){return l}});var r=i(9656),n=i(7993),o=i(2855);let s="alignment";function l(){return{key:s,name(){return this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${s}:left`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htLeft"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${s}:center`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htCenter"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${s}:right`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htRight"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${s}:justify`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htJustify"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{name:n.F},{key:`${s}:top`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_TOP),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htTop"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${s}:middle`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htMiddle"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${s}:bottom`,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htBottom"))return!0});return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.NA)(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,i,n),(0,r.AJ)(t,i,n,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1}]}}}},8336:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="clear_column";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(t,e){let i=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}}},2333:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="col_left";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){let t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}},1942:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="col_right";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}},1318:function(t,e,i){"use strict";i.d(e,{Gf:function(){return y},cq:function(){return w}});var r=i(9488),n=i(7595),o=i(8336),s=i(2333),l=i(1942),a=i(524),h=i(2614),u=i(3029),c=i(4108),d=i(163),f=i(677),g=i(7993),m=i(8920),p=i(9959);let w=[d.F,f.F,s.F,l.F,o.F,c.F,u.F,p.F,h.F,a.F,n.F,g.F,m.F],b={[g.F]:g.Z,[m.F]:m.Z,[d.F]:d.Z,[f.F]:f.Z,[s.F]:s.Z,[l.F]:l.Z,[o.F]:o.Z,[c.F]:c.Z,[u.F]:u.Z,[p.F]:p.Z,[h.F]:h.Z,[a.F]:a.Z,[n.F]:n.Z};function y(){let t={};return(0,r._l)(b,(e,i)=>{t[i]=e()}),t}},8920:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="no_items";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}},524:function(t,e,i){"use strict";i.d(e,{F:function(){return s},Z:function(){return l}});var r=i(9656),n=i(9440),o=i(2855);let s="make_read_only";function l(){return{key:s,name(){let t=this.getTranslatedPhrase(o.CONTEXTMENU_ITEMS_READ_ONLY),e=(0,r.g8)(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly);return e&&(t=(0,r.tN)(t)),t},callback(){let t=this.getSelectedRange(),e=(0,r.g8)(t,(t,e)=>this.getCellMeta(t,e).readOnly);(0,n.Bk)(t,t=>{t.forAll((t,i)=>{t>=0&&i>=0&&this.setCellMeta(t,i,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}}},2614:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="redo";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}},3029:function(t,e,i){"use strict";i.d(e,{F:function(){return o},Z:function(){return s}});var r=i(855),n=i(2855);let o="remove_col";function s(){return{key:o,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[,i,,r]=t[0];i-r!=0&&(e=1)}}return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",(0,r.X8)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}},4108:function(t,e,i){"use strict";i.d(e,{F:function(){return o},Z:function(){return s}});var r=i(855),n=i(2855);let o="remove_row";function s(){return{key:o,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[i,,r]=t[0];i-r!=0&&(e=1)}}return this.getTranslatedPhrase(n.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",(0,r.I8)(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}},163:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="row_above";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){let t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}},677:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="row_below";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}},7993:function(t,e,i){"use strict";i.d(e,{F:function(){return r},Z:function(){return n}});let r="---------";function n(){return{name:r}}},9959:function(t,e,i){"use strict";i.d(e,{F:function(){return n},Z:function(){return o}});var r=i(2855);let n="undo";function o(){return{key:n,name(){return this.getTranslatedPhrase(r.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}},9656:function(t,e,i){"use strict";i.d(e,{AJ:function(){return o},NA:function(){return n},RB:function(){return a},g8:function(){return l},tN:function(){return s}});var r=i(9440);function n(t,e){let i={};return(0,r.Bk)(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&(i[t]||(i[t]=[]),i[t][r]=e(t,r))})}),i}function o(t,e,i,n,o){(0,r.Bk)(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&function(t,e,i,r,n,o){let s=n(t,e),l=r;s.className&&(l="vertical"===i?function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${i} ${e}`}(s.className,r):function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${i} ${e}`}(s.className,r)),o(t,e,"className",l)}(t,r,e,i,n,o)})})}function s(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function l(t,e){let i=!1;return Array.isArray(t)&&(0,r.Bk)(t,t=>(t.forAll((t,r)=>{if(t>=0&&r>=0&&e(t,r))return i=!0,!1}),i)),i}function a(t,e){let i={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:t}=e.defaultView,{top:r,left:n}=t.getBoundingClientRect();i.top=r,i.left=n}return i}},639:function(t,e,i){"use strict";i.d(e,{_x:function(){return tu}}),i(2916),i(2954);var r=i(5440),n=i(4317),o=i(292),s=i(9440),l=i(6411),a=i(5878),h=i(2228),u=i(2855),c=i(7790);class d{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class f{constructor(){this.clipboardData=new d}}function g(t,e){p(t,e),e.add(t)}function m(t,e,i){p(t,e),e.set(t,i)}function p(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function w(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function b(t,e){var i=S(t,e,"get");return i.get?i.get.call(t):i.value}function y(t,e,i){var r=S(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function S(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var C=new WeakMap,E=new WeakMap,T=new WeakMap,R=new WeakMap,O=new WeakMap,M=new WeakMap,N=new WeakSet,I=new WeakSet;class x{constructor(t){let{countRows:e,countColumns:i,rowsLimit:r,columnsLimit:n,countColumnHeaders:o}=t;g(this,I),g(this,N),m(this,C,{writable:!0,value:void 0}),m(this,E,{writable:!0,value:void 0}),m(this,T,{writable:!0,value:void 0}),m(this,R,{writable:!0,value:void 0}),m(this,O,{writable:!0,value:void 0}),m(this,M,{writable:!0,value:void 0}),y(this,E,e),y(this,T,i),y(this,R,r),y(this,O,n),y(this,M,o)}setSelectedRange(t){y(this,C,t)}getCellsRange(){if(0===b(this,E).call(this)||0===b(this,T).call(this))return null;let{row:t,col:e}=b(this,C).getTopStartCorner(),{row:i,col:r}=b(this,C).getBottomEndCorner(),n=w(this,I,H).call(this,t,i),o=w(this,N,k).call(this,e,r),s=i!==n||r!==o;return{isRangeTrimmed:s,startRow:t,startCol:e,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(0===b(this,T).call(this)||0===b(this,M).call(this))return null;let{col:t}=b(this,C).getTopStartCorner(),{col:e}=b(this,C).getBottomEndCorner(),i=w(this,N,k).call(this,t,e),r=e!==i;return{isRangeTrimmed:r,startRow:-1,startCol:t,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(0===b(this,T).call(this)||0===b(this,M).call(this))return null;let{col:t}=b(this,C).getTopStartCorner(),{col:e}=b(this,C).getBottomEndCorner(),i=w(this,N,k).call(this,t,e),r=e!==i;return{isRangeTrimmed:r,startRow:-b(this,M).call(this),startCol:t,endRow:-1,endCol:i}}}function k(t,e){return Math.min(e,Math.max(t+b(this,O).call(this)-1,t))}function H(t,e){return Math.min(e,Math.max(t+b(this,R).call(this)-1,t))}function _(t){let e=[],i=[];return(0,s.Bk)(t,t=>{let r=Math.min(t.startRow,t.endRow),n=Math.max(t.startRow,t.endRow);(0,c.q4)(r,n,t=>{-1===e.indexOf(t)&&e.push(t)});let o=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);(0,c.q4)(o,s,t=>{-1===i.indexOf(t)&&i.push(t)})}),{rows:e,columns:i}}var A=i(4350);function L(t,e){D(t,e),e.add(t)}function P(t,e,i){D(t,e),e.set(t,i)}function D(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function F(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function B(t,e){var i=j(t,e,"get");return i.get?i.get.call(t):i.value}function W(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function V(t,e,i){var r=j(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function j(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}n.Z.getSingleton().register("afterCopyLimit"),n.Z.getSingleton().register("modifyCopyableRange"),n.Z.getSingleton().register("beforeCut"),n.Z.getSingleton().register("afterCut"),n.Z.getSingleton().register("beforePaste"),n.Z.getSingleton().register("afterPaste"),n.Z.getSingleton().register("beforeCopy"),n.Z.getSingleton().register("afterCopy");let U="copyPaste",$=["fragmentSelection"],z='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var G=new WeakMap,K=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,q=new WeakMap,J=new WeakMap,Q=new WeakMap,tt=new WeakSet,te=new WeakSet,ti=new WeakSet,tr=new WeakSet,tn=new WeakSet,to=new WeakSet,ts=new WeakSet,tl=new WeakSet,ta=new WeakSet,th=new WeakSet;class tu extends r.v{constructor(){super(...arguments),L(this,th),L(this,ta),L(this,tl),L(this,ts),L(this,to),L(this,tn),L(this,tr),L(this,ti),L(this,te),L(this,tt),F(this,"columnsLimit",1/0),F(this,"rowsLimit",1/0),F(this,"pasteMode","overwrite"),F(this,"uiContainer",this.hot.rootDocument.body),P(this,G,{writable:!0,value:!1}),P(this,K,{writable:!0,value:!1}),P(this,X,{writable:!0,value:!1}),P(this,Y,{writable:!0,value:"cells-only"}),P(this,Z,{writable:!0,value:!1}),P(this,q,{writable:!0,value:!1}),P(this,J,{writable:!0,value:new x({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),P(this,Q,{writable:!0,value:!1}),F(this,"copyableRanges",[])}static get PLUGIN_KEY(){return U}static get SETTING_KEYS(){return[U,...$]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[U]}enablePlugin(){var t,e,i=this;if(this.enabled)return;let{[U]:r}=this.hot.getSettings();"object"==typeof r&&(this.pasteMode=null!==(t=r.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(r.rowsLimit)?this.rowsLimit:r.rowsLimit,this.columnsLimit=isNaN(r.columnsLimit)?this.columnsLimit:r.columnsLimit,V(this,G,!!r.copyColumnHeaders),V(this,K,!!r.copyColumnGroupHeaders),V(this,X,!!r.copyColumnHeadersOnly),this.uiContainer=null!==(e=r.uiContainer)&&void 0!==e?e:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",t=>W(this,tn,tm).call(this,t)),this.addHook("afterSelection",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return W(i,to,tp).call(i,...e)}),this.addHook("afterSelectionEnd",()=>W(this,ts,tv).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),(0,h.G6)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return W(i,tl,tw).call(i,...e)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return W(i,ta,tb).call(i,...e)}),this.addHook("afterSelection",()=>W(this,th,ty).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";V(this,Y,t),V(this,Z,!0),W(this,tt,tc).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){V(this,q,!0),W(this,tt,tc).call(this,"cut")}getRangedCopyableData(t){return(0,o.P)(this.getRangedData(t))}getRangedData(t){let e=[],{rows:i,columns:r}=_(t);return(0,s.Bk)(i,t=>{let i=[];(0,s.Bk)(r,e=>{t<0?i.push(this.hot.getColHeader(e,t)):i.push(this.hot.getCopyableData(t,e))}),e.push(i)}),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;let i=new f;t&&i.clipboardData.setData("text/plain",t),e&&i.clipboardData.setData("text/html",e),this.onPaste(i)}setCopyableText(){let t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader()){this.copyableRanges=[];return}B(this,J).setSelectedRange(t);let e=new Map([["headers",null],["cells",null]]);"column-headers-only"===B(this,Y)?e.set("headers",B(this,J).getMostBottomColumnHeadersRange()):("with-column-headers"===B(this,Y)?e.set("headers",B(this,J).getMostBottomColumnHeadersRange()):"with-column-group-headers"===B(this,Y)&&e.set("headers",B(this,J).getAllColumnHeadersRange()),e.set("cells",B(this,J).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter(t=>null!==t).map(t=>{let{startRow:e,startCol:i,endRow:r,endCol:n}=t;return{startRow:e,startCol:i,endRow:r,endCol:n}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let i=e.get("cells");if(null!==i&&i.isRangeTrimmed){let{startRow:t,startCol:e,endRow:r,endCol:n}=i;this.hot.runHooks("afterCopyLimit",r-t+1,n-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;let i=t.length,r=t[0].length,n=[],{row:o,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner(),h=o,u=s,c=o,d=s;for(;n.length<i||h<=l;){let{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;c=l,u=s;let f=[],g=n.length%i;for(;f.length<r||u<=a;){let{skipColumnOnPaste:e,visualCol:i}=this.hot.getCellMeta(o,u);if(u=i+1,!0===e)continue;d=i;let n=f.length%r;f.push(t[g][n])}n.push(f)}return V(this,Q,!0),this.hot.populateFromArray(o,s,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(t){if(!this.hot.isListening()&&!B(this,Z)||this.isEditorOpened())return;this.setCopyableText(),V(this,Z,!1);let e=this.getRangedData(this.copyableRanges),i=W(this,te,td).call(this,this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,i);if(r){let r=(0,o.P)(e);if(t&&t.clipboardData){let i=(0,A.bt)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[z,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",e,this.copyableRanges,i)}V(this,Y,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!B(this,q)||this.isEditorOpened())return;this.setCopyableText(),V(this,q,!1);let e=this.getRangedData(this.copyableRanges),i=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(i){let i=(0,o.P)(e);if(t&&t.clipboardData){let r=(0,A.bt)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[z,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){let e;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){let i=(0,l.Nw)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(i&&/(<table)|(<TABLE)/g.test(i)){let t=(0,A.BU)(i,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=(0,o.Q)(e)),void 0===e||e&&0===e.length||!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;let[i,r,n,s]=this.populateValues(e);this.hot.selectCell(i,r,Math.min(this.hot.countRows()-1,n),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function tc(t){if((0,h.G6)()){let e=this.hot.getSelectedRangeLast();if(e){let{row:i,col:r}=e.highlight,n=this.hot.getCell(i,r,!0);n&&(0,a.lq)(n,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function td(t){let{rows:e}=_(t),i=0;for(let t=0;t<e.length&&!(e[t]>=0);t++)i+=1;return{columnHeadersCount:i}}function tf(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);r&&(0,a.l2)(r)}}}function tg(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);null!=r&&r.hasAttribute("contenteditable")&&(0,a.yY)(r)}}}function tm(t){var e,i,r,n,o;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),B(this,G)&&t.items.push((i=this,{key:"copy_with_column_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,c.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback(){i.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),B(this,K)&&t.items.push((r=this,{key:"copy_with_column_group_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,c.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),B(this,X)&&t.items.push((n=this,{key:"copy_column_headers_only",name(){let t=this.getSelectedRangeLast(),e=t?(0,c.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),t.items.push((o=this,{key:"cut",name(){return this.getTranslatedPhrase(u.CONTEXTMENU_ITEMS_CUT)},callback(){o.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}))}function tp(t,e,i,r,n){B(this,Q)&&(n.value=!0),V(this,Q,!1)}function tv(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function tw(){W(this,tr,tg).call(this)}function tb(){W(this,ti,tf).call(this)}function ty(){W(this,tr,tg).call(this)}},7160:function(t,e,i){"use strict";i.d(e,{h_:function(){return _}}),i(2954);var r=i(5440),n=i(9440),o=i(9488),s=i(285),l=i(9656),a=i(5878),h=i(279),u=i(1775),c=i(4317),d=i(2333),f=i(1942),g=i(7993),m=i(3029),p=i(8336),w=i(524),b=i(7595),y=i(8200);function S(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function C(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function E(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}c.Z.getSingleton().register("afterDropdownMenuDefaultOptions"),c.Z.getSingleton().register("beforeDropdownMenuShow"),c.Z.getSingleton().register("afterDropdownMenuShow"),c.Z.getSingleton().register("afterDropdownMenuHide"),c.Z.getSingleton().register("afterDropdownMenuExecute");let T="dropdownMenu",R="changeType";var O=new WeakSet,M=new WeakSet,N=new WeakSet,I=new WeakSet,x=new WeakSet,k=new WeakSet,H=new WeakSet;class _ extends r.v{static get PLUGIN_KEY(){return T}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[d.F,f.F,g.F,m.F,g.F,p.F,g.F,w.F,g.F,b.F]}constructor(t){super(t),S(this,H),S(this,k),S(this,x),S(this,I),S(this,N),S(this,M),S(this,O),C(this,"commandExecutor",new s.u(this.hot)),C(this,"itemsFactory",null),C(this,"menu",null),this.hot.addHook("afterGetColHeader",(t,e)=>E(this,N,P).call(this,t,e))}isEnabled(){return this.hot.getSettings()[T]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new h.E(this.hot,_.DEFAULT_ITEMS);let e=this.hot.getSettings()[T],i={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let r=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new u.v(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>E(this,I,D).call(this)),this.menu.addLocalHook("afterOpen",()=>E(this,x,F).call(this)),this.menu.addLocalHook("afterSubmenuOpen",t=>E(this,k,B).call(this,t)),this.menu.addLocalHook("afterClose",()=>E(this,H,W).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),(0,n.Bk)(r,t=>this.commandExecutor.registerCommand(t.key,t))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("grid"),e=()=>{let{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);let{from:e}=this.hot.getSelectedRangeLast(),i=(0,l.RB)(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,e.col,!0),n=r.getBoundingClientRect();this.open({left:n.left+i.left,top:n.top+r.offsetHeight+i.top},{left:n.width}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:T},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:T}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(T)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>E(this,M,L).call(this,t))}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),(0,o._l)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}setListening(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function A(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function L(t){if(t.stopPropagation(),(0,a.pv)(t.target,R)){let e=(0,l.RB)(this.menu.container,this.hot.rootDocument),i=t.target.getBoundingClientRect();this.open({left:i.left+e.left,top:i.top+t.target.offsetHeight+3+e.top},{left:i.width})}}function P(t,e){let i=e.parentNode;if(!i)return;let r=i.parentNode.childNodes,n=Array.prototype.indexOf.call(r,i);if(t<0||n!==r.length-1)return;let o=e.querySelector(`.${R}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}let s=this.hot.rootDocument.createElement("button");s.className=R,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,a.P$)(s,[(0,y.cV)(),(0,y.QK)(" ")]),(0,a.P$)(e,[(0,y.fv)("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function D(){this.hot.runHooks("beforeDropdownMenuShow",this)}function F(){this.hot.runHooks("afterDropdownMenuShow",this),E(this,O,A).call(this,this.menu)}function B(t){E(this,O,A).call(this,t)}function W(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}_.SEPARATOR={name:g.F}},8058:function(t,e,i){"use strict";i.d(e,{x$:function(){return e7}}),i(921),i(2916),i(2954);var r=i(5440),n=i(9440),o=i(2836),s=i(4748),l=i(7790),a=i(5878),h=i(6678),u=i(7993),c=i(2855),d=i(7687),f=i(9488),g=i(3437),m=i(537);function p(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class w{constructor(t,e){let{id:i,stateless:r=!0}=e;p(this,"hot",void 0),p(this,"id",void 0),p(this,"elements",[]),p(this,"hidden",!1),p(this,"stateId",""),p(this,"state",void 0),this.hot=t,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new m.A)}getElements(){return this.elements}reset(){(0,n.Bk)(this.elements,t=>t.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,n.Bk)(this.elements,t=>t.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,f.jB)(w,g.Z);let b={};function y(t,e){if(!b[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:i,descriptor:r}=b[t],n=e;return r.inputValuesDecorator&&(n=r.inputValuesDecorator(n)),function(t){return i.apply(t.meta.instance,[].concat([t],[n]))}}function S(t){if(!b[t])throw Error(`Filter condition "${t}" does not exist.`);return b[t].descriptor}function C(t,e,i){i.key=t,b[t]={condition:e,descriptor:i}}let E="none";C(E,function(){return!0},{name:c.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});var T=i(2518);let R="empty";C(R,function(t){return(0,T.xb)(t.value)},{name:c.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});let O="not_empty";C(O,function(t,e){return!y(R,e)(t)},{name:c.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0}),C("eq",function(t,e){let[i]=e;return(0,T.Pz)(t.value).toLocaleLowerCase(t.meta.locale)===(0,T.Pz)(i)},{name:c.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0}),C("neq",function(t,e){return!y("eq",e)(t)},{name:c.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0}),C("gt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>r},{name:c.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0}),C("gte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>=r},{name:c.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0}),C("lt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<r},{name:c.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0}),C("lte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<=r},{name:c.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var M=i(2067);let N="date_after";C(N,function(t,e){let[i]=e,r=M(t.value,t.meta.dateFormat),n=M(i,t.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&r.diff(n)>=0},{name:c.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});let I="date_before";C(I,function(t,e){let[i]=e,r=M(t.value,t.meta.dateFormat),n=M(i,t.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&0>=r.diff(n)},{name:c.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});let x="between";C(x,function(t,e){let[i,r]=e,n=i,o=r;if("numeric"===t.meta.type){let t=parseFloat(n,10),e=parseFloat(o,10);n=Math.min(t,e),o=Math.max(t,e)}else if("date"===t.meta.type){let e=y(I,[o]),i=y(N,[n]);return e(t)&&i(t)}return t.value>=n&&t.value<=o},{name:c.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});let k="not_between";C(k,function(t,e){return!y(x,e)(t)},{name:c.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});let H="begins_with";C(H,function(t,e){let[i]=e;return(0,T.Pz)(t.value).toLocaleLowerCase(t.meta.locale).startsWith((0,T.Pz)(i))},{name:c.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});let _="ends_with";C(_,function(t,e){let[i]=e;return(0,T.Pz)(t.value).toLocaleLowerCase(t.meta.locale).endsWith((0,T.Pz)(i))},{name:c.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});let A="contains";C(A,function(t,e){let[i]=e;return(0,T.Pz)(t.value).toLocaleLowerCase(t.meta.locale).indexOf((0,T.Pz)(i))>=0},{name:c.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});let L="not_contains";C(L,function(t,e){return!y(A,e)(t)},{name:c.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});let P="date_tomorrow";C(P,function(t){let e=M(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(M().subtract(-1,"days").startOf("day"),"d")},{name:c.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});let D="date_today";C(D,function(t){let e=M(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(M().startOf("day"),"d")},{name:c.FILTERS_CONDITIONS_TODAY,inputsCount:0});let F="date_yesterday";C(F,function(t){let e=M(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(M().subtract(1,"days").startOf("day"),"d")},{name:c.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});let B="text",W={numeric:[E,u.F,R,O,u.F,"eq","neq",u.F,"gt","gte","lt","lte",x,k],[B]:[E,u.F,R,O,u.F,"eq","neq",u.F,H,_,u.F,A,L],date:[E,u.F,R,O,u.F,"eq","neq",u.F,I,N,x,u.F,P,D,F]};var V=i(9773);function j(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let U="built",$="building",z=["click","input","keydown","keypress","keyup","focus","blur","change"];class G{static get DEFAULTS(){return(0,f.d9)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){j(this,"hot",void 0),j(this,"eventManager",new V.Z(this)),j(this,"options",void 0),j(this,"_element",void 0),j(this,"buildState",void 0),this.hot=t,this.options=(0,f.l7)(G.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===$||(this.buildState===U?this.update():(this.buildState=$,this.build(),this.buildState=U)),this._element}isBuilt(){return this.buildState===U}translateIfPossible(t){return"string"==typeof t&&t.startsWith(c.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}build(){let t=(t,e)=>{this.eventManager.addEventListener(t,e,t=>this.runLocalHooks(e,t,this))};if(this.buildState||(this.buildState=$),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,a.cn)(this._element,this.options.className),this.options.children.length)(0,n.Bk)(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){let e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),(0,f._l)(this.options,(t,i)=>{void 0!==e[i]&&"className"!==i&&"tagName"!==i&&"children"!==i&&(e[i]=this.translateIfPossible(t))}),this._element.appendChild(e),(0,n.Bk)(z,i=>t(e,i))}else(0,n.Bk)(z,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function K(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function X(t,e){var i=Y(t,e,"get");return i.get?i.get.call(t):i.value}function Y(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}(0,f.jB)(G,g.Z);var Z=new WeakMap,q=new WeakSet;class J extends G{static get DEFAULTS(){return(0,f.d9)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,(0,f.l7)(J.DEFAULTS,e)),K(this,q),q.add(this),K(this,Z),Z.set(this,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,q,Q).call(this,t))}build(){var t;super.build();let e=this.hot.rootDocument.createElement("div");t=this._element.firstChild,function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,Y(this,Z,"set"),t),(0,a.cn)(this._element,"htUIInput"),(0,a.cn)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(X(this,Z).type=this.options.type,X(this,Z).placeholder=this.translateIfPossible(this.options.placeholder),X(this,Z).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&X(this,Z).focus()}}function Q(t){this.options.value=t.target.value}var tt=i(1775),te=i(8200);function ti(t,e){tn(t,e),e.add(t)}function tr(t,e,i){tn(t,e),e.set(t,i)}function tn(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function to(t,e,i){var r=ta(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ts(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function tl(t,e){var i=ta(t,e,"get");return i.get?i.get.call(t):i.value}function ta(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var th=new WeakMap,tu=new WeakMap,tc=new WeakMap,td=new WeakMap,tf=new WeakMap,tg=new WeakSet,tm=new WeakSet,tp=new WeakSet;class tv extends G{static get DEFAULTS(){return(0,f.d9)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,(0,f.l7)(tv.DEFAULTS,e)),ti(this,tp),ti(this,tm),ti(this,tg),tr(this,th,{writable:!0,value:null}),tr(this,tu,{writable:!0,value:[]}),tr(this,tc,{writable:!0,value:void 0}),tr(this,td,{writable:!0,value:void 0}),tr(this,tf,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return tl(this,th)}registerHooks(){this.addLocalHook("click",()=>ts(this,tp,ty).call(this))}setItems(t){to(this,tu,this.translateNames(t)),tl(this,th)&&tl(this,th).setMenuItems(tl(this,tu))}translateNames(t){return(0,n.Bk)(t,t=>{t.name=this.translateIfPossible(t.name)}),t}build(){super.build(),to(this,th,new tt.v(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),tl(this,th).setMenuItems(tl(this,tu));let t=new G(this.hot,{className:"htUISelectCaption"}),e=new G(this.hot,{className:"htUISelectDropdown"});to(this,tc,t),to(this,td,t.element),to(this,tf,e),this.hot.getSettings().ariaTags&&((0,a.P$)(e.element,[(0,te.cV)()]),(0,a.P$)(this._element,[(0,te.a6)()])),(0,n.Bk)([t,e],t=>this._element.appendChild(t.element)),tl(this,th).addLocalHook("select",t=>ts(this,tg,tw).call(this,t)),tl(this,th).addLocalHook("afterClose",()=>ts(this,tm,tb).call(this)),this.update()}update(){let t;this.isBuilt()&&(t=this.options.value?this.options.value.name:tl(this,th).hot.getTranslatedPhrase(c.FILTERS_CONDITIONS_NONE),tl(this,td).textContent=t,super.update())}openOptions(){let t=this.element.getBoundingClientRect();tl(this,th)&&(tl(this,th).open(),tl(this,th).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),tl(this,th).getNavigator().toFirstItem(),tl(this,th).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){tl(this,th)&&tl(this,th).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){tl(this,th)&&(tl(this,th).destroy(),to(this,th,null)),tl(this,tc)&&tl(this,tc).destroy(),tl(this,tf)&&tl(this,tf).destroy(),super.destroy()}}function tw(t){t.name!==u.F&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function tb(){this.runLocalHooks("afterClose")}function ty(){this.openOptions()}function tS(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function tC(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tE(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var tT=new WeakSet,tR=new WeakSet;class tO extends w{constructor(t,e){super(t,{id:e.id,stateless:!1}),tS(this,tR),tS(this,tT),tC(this,"name",""),tC(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new tv(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new J(this.hot,{placeholder:c.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new J(this.hot,{placeholder:c.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",t=>tE(this,tT,tM).call(this,t)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",t=>this.runLocalHooks("selectTabKeydown",t)),(0,n.Bk)(this.getInputElements(),t=>{t.addLocalHook("keydown",t=>tE(this,tR,tN).call(this,t))})}setState(t){if(this.reset(),!t)return;let e=(0,f.d9)(t.command);e.name.startsWith(c.FILTERS_CONDITIONS_NAMESPACE)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),(0,n.Bk)(t.args,(t,i)=>{if(i>e.inputsCount-1)return!1;let r=this.getInputElement(i);r.setValue(t),r[e.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){let t=this.getSelectElement().getValue()||S(E),e=[];return(0,n.Bk)(this.getInputElements(),(i,r)=>{t.inputsCount>r&&e.push(i.getValue())}),{command:t,args:e}}updateState(t,e){let i=t?S(t.name):S(E);this.state.setValueAtIndex(e,{command:i,args:t?t.args:[]}),t||(0,n.Bk)(this.getInputElements(),t=>t.setValue(null))}getSelectElement(){return this.elements.filter(t=>t instanceof tv)[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter(t=>t instanceof J)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,o,s)=>{(0,a.cn)(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,a.cn)(e.parentNode,"border");let l=this.hot.rootDocument.createElement("div");return(0,a.cn)(l,"htFiltersMenuLabel"),l.textContent=s,e.appendChild(l),(0,n.Bk)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getPlugin("filters").getSelectedColumn(),e=[S(E)];if(null!==t){let{visualIndex:i}=t;e=function(t){let e=[],i=t;return W[i]||(i=B),(0,n.Bk)(W[i],t=>{let i;i=t===u.F?{name:u.F}:(0,f.d9)(S(t)),e.push(i)}),e}(this.hot.getDataType(0,i,this.hot.countRows(),i))}(0,n.Bk)(this.getInputElements(),t=>t.hide()),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function tM(t){(0,n.Bk)(this.getInputElements(),(e,i)=>{e[t.inputsCount>i?"show":"hide"](),0===i&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function tN(t){(0,h.ot)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,d.mM)(t))}let tI={};function tx(t,e,i){tI[t]={name:e,func:i}}let tk="conjunction",tH=c.FILTERS_LABELS_CONJUNCTION;tx(tk,tH,function(t,e){return t.every(t=>t.func(e))});let t_="disjunction",tA=c.FILTERS_LABELS_DISJUNCTION;tx(t_,tA,function(t,e){return t.some(t=>t.func(e))});let tL="disjunctionWithExtraCondition",tP=c.FILTERS_LABELS_DISJUNCTION;function tD(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function tF(t,e){var i=tW(t,e,"get");return i.get?i.get.call(t):i.value}function tB(t,e,i){var r=tW(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function tW(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}tx(tL,tP,function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(t=>t.func(e))&&t[t.length-1].func(e)});var tV=new WeakMap,tj=new WeakMap;class tU extends G{static get DEFAULTS(){return(0,f.d9)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,(0,f.l7)(tU.DEFAULTS,e)),tD(this,tV,{writable:!0,value:void 0}),tD(this,tj,{writable:!0,value:void 0})}build(){super.build();let t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),tB(this,tj,t),tB(this,tV,this._element.firstChild),tF(this,tV).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(tF(this,tj).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&tF(this,tV).checked}setChecked(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(tF(this,tV).checked=t)}focus(){this.isBuilt()&&tF(this,tV).focus()}}var t$=new WeakSet;class tz extends w{constructor(t,e){var i,r;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,t$),t$.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,a.cn)(e.parentNode,"htFiltersMenuOperators"),(0,n.Bk)(this.elements,t=>e.appendChild(t.element)),e)}}buildOperatorsElement(){let t=[tk,t_];(0,n.Bk)(t,e=>{let i=new tU(this.hot,{name:"operator",label:{htmlFor:e,textContent:tI[e].name},value:e,checked:e===t[0],id:e});i.addLocalHook("change",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,t$,tG).call(this,t)),this.elements.push(i)})}setChecked(t){if(this.elements.length<t)throw Error(o.e`Radio button with index ${t} doesn't exist.`);(0,n.Bk)(this.elements,(e,i)=>{e.setChecked(i===t)})}getActiveOperationId(){let t=this.elements.find(t=>t instanceof tU&&t.isChecked());return t?t.getValue():tk}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,n.Bk)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tk,e=arguments.length>1?arguments[1]:void 0,i=t;i===tL&&(i=t_),this.state.setValueAtIndex(e,i)}reset(){this.setChecked(0)}}function tG(t){this.setState(t.target.value)}(0,i(973).sx)();let tK=new Set([1]).has(1),tX=tK&&"function"==typeof Array.from;function tY(t){let e=t;return tK&&(e=new Set(e)),function(t){return tK?e.has(t):!!~e.indexOf(t)}}function tZ(t){return null==t?"":t}function tq(t){let e=t;return(e=tX?Array.from(new Set(e)):(0,n.uW)(e)).sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)}function tJ(t,e,i,r){let o;let s=[],l=t===e;return l||(o=tY(e)),(0,n.Bk)(t,t=>{let e,n=!1;(l||o(t))&&(n=!0);let a={checked:n,value:t,visualValue:(""===(e=t)&&(e=`(${i})`),e)};r&&r(a),s.push(a)}),s}var tQ=i(8179),t0=i(7628);function t1(t,e){var i=t2(t,e,"get");return i.get?i.get.call(t):i.value}function t2(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var t9=new WeakMap;class t4 extends G{static get DEFAULTS(){return(0,f.d9)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,(0,f.l7)(t4.DEFAULTS,e)),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,t9),t9.set(this,{writable:!0,value:void 0})}build(){var t;super.build(),t=this._element.firstChild,function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,t2(this,t9,"set"),t)}update(){this.isBuilt()&&(t1(this,t9).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&t1(this,t9).focus()}activate(){t1(this,t9).click()}}function t8(t,e){t3(t,e),e.add(t)}function t7(t,e,i){t3(t,e),e.set(t,i)}function t3(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function t5(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function t6(t,e){var i=ee(t,e,"get");return i.get?i.get.call(t):i.value}function et(t,e,i){var r=ee(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ee(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let ei="multipleSelect.itemBox";var er=new WeakMap,en=new WeakMap,eo=new WeakMap,es=new WeakMap,el=new WeakMap,ea=new WeakMap,eh=new WeakSet,eu=new WeakSet,ec=new WeakSet,ed=new WeakSet;class ef extends G{static get DEFAULTS(){return(0,f.d9)({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,(0,f.l7)(ef.DEFAULTS,e)),t8(this,ed),t8(this,ec),t8(this,eu),t8(this,eh),t7(this,er,{writable:!0,value:[]}),t7(this,en,{writable:!0,value:void 0}),t7(this,eo,{writable:!0,value:void 0}),t7(this,es,{writable:!0,value:void 0}),t7(this,el,{writable:!0,value:void 0}),t7(this,ea,{writable:!0,value:void 0}),et(this,es,new J(this.hot,{placeholder:c.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),et(this,el,new t4(this.hot,{textContent:c.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),et(this,ea,new t4(this.hot,{textContent:c.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return t6(this,en)}registerHooks(){t6(this,es).addLocalHook("keydown",t=>t5(this,eu,em).call(this,t)),t6(this,es).addLocalHook("input",t=>t5(this,eh,eg).call(this,t)),t6(this,el).addLocalHook("click",t=>t5(this,ec,ep).call(this,t)),t6(this,ea).addLocalHook("click",t=>t5(this,ed,ev).call(this,t))}setItems(t){et(this,er,t),t6(this,en)&&t6(this,en).loadData(t6(this,er))}setLocale(t){et(this,eo,t)}getLocale(){return t6(this,eo)}getItems(){return[...t6(this,er)]}getValue(){return function(t){let e=[];return(0,n.Bk)(t,t=>{t.checked&&e.push(t.value)}),e}(t6(this,er))}getSearchInputElement(){return t6(this,es)}getSelectAllElement(){return t6(this,el)}getClearAllElement(){return t6(this,ea)}isSelectedAllValues(){return t6(this,er).length===this.getValue().length}build(){super.build();let{rootDocument:t}=this.hot,e=t.createElement("div"),i=new G(this.hot,{className:"htUISelectionControls",children:[t6(this,el),t6(this,ea)]});this._element.appendChild(t6(this,es).element),this._element.appendChild(i.element),this._element.appendChild(e);let r=e=>{if(!this._element)return;t6(this,en)&&t6(this,en).destroy(),(0,a.cn)(e,"htUIMultipleSelectHot"),et(this,en,new this.hot.constructor(e,{data:t6(this,er),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,i,r,n,o)=>{t.title=o.instance.getDataAtRowProp(e,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{t6(this,en).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>t6(this,en).container.scrollWidth-(0,a.np)(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),t6(this,en).init();let i=t6(this,en).getShortcutManager(),r=i.getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:ei}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{t6(this,en).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:ei})};r(e),this.hot._registerTimeout(()=>r(e),100)}focus(){this.isBuilt()&&t6(this,en).listen()}reset(){t6(this,es).reset(),t6(this,el).reset(),t6(this,ea).reset()}update(){this.isBuilt()&&(t6(this,en).loadData(function(t,e){let i=tY(e);return(0,n.Sc)(t,t=>(t.checked=i(t.value),t))}(t6(this,er),this.options.value)),super.update())}destroy(){t6(this,en)&&t6(this,en).destroy(),t6(this,es).destroy(),t6(this,ea).destroy(),t6(this,el).destroy(),et(this,es,null),et(this,ea,null),et(this,el,null),et(this,en,null),et(this,er,null),super.destroy()}}function eg(t){let e;let i=t.target.value.toLocaleLowerCase(this.getLocale());e=""===i?[...t6(this,er)]:(0,n.w7)(t6(this,er),t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(i)>=0),t6(this,en).loadData(e)}function em(t){this.runLocalHooks("keydown",t,this);let e=(0,tQ.r$)(h.ot,t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),(0,d.mM)(t),t6(this,en).listen(),t6(this,en).selectCell(0,0))}function ep(t){let e=[];t.preventDefault(),(0,n.Bk)(t6(this,en).getSourceData(),(t,i)=>{t.checked=!0,e.push((0,t0.ec)(t,i)[0])}),t6(this,en).setSourceDataAtCell(e)}function ev(t){let e=[];t.preventDefault(),(0,n.Bk)(t6(this,en).getSourceData(),(t,i)=>{t.checked=!1,e.push((0,t0.ec)(t,i)[0])}),t6(this,en).setSourceDataAtCell(e)}let ew="by_value";C(ew,function(t,e){let[i]=e;return i(t.value)},{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[tY(e)]},showOperators:!1});var eb=new WeakSet;class ey extends w{constructor(t,e){var i,r;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,eb),eb.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.elements.push(new ef(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,eb,eS).call(this,t)).addLocalHook("listTabKeydown",t=>this.runLocalHooks("listTabKeydown",t))}getElements(){let t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===ew){let e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){let t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?E:ew},args:[t.getValue()],itemsSnapshot:e}}updateState(t){let e=(e,i,r,o,s)=>{let[l]=(0,n.w7)(i,t=>t.name===ew),a={},h=this.hot.getTranslatedPhrase(c.FILTERS_VALUES_BLANK_CELLS);if(l){let i=tq((0,n.Sc)(o(e,s),t=>t.value));r&&(l.args[0]=r);let u=[],c=tJ(i,l.args[0],h,t=>{t.checked&&u.push(t.value)}),d=t.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,d).locale,a.args=[u],a.command=S(ew),a.itemsSnapshot=c}else a.args=[],a.command=S(E);this.state.setValueAtIndex(e,a)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(t=>t instanceof ef)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,o,s)=>{(0,a.cn)(e.parentNode,"htFiltersMenuValue");let l=this.hot.rootDocument.createElement("div");return(0,a.cn)(l,"htFiltersMenuLabel"),l.textContent=s,e.appendChild(l),(0,n.Bk)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getTranslatedPhrase(c.FILTERS_VALUES_BLANK_CELLS),e=tq(this._getColumnVisibleValues()),i=tJ(e,e,t);this.getMultipleSelectElement().setItems(i),super.reset(),this.getMultipleSelectElement().setValue(e);let r=this.hot.getPlugin("filters").getSelectedColumn();null!==r&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,r.visualIndex).locale)}_getColumnVisibleValues(){let t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:(0,n.Sc)(this.hot.getDataAtCol(t.visualIndex),t=>tZ(t))}}function eS(t){(0,h.ot)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,d.mM)(t))}var eC=new WeakSet;class eE extends w{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){var i,r;super(t,{id:e.id,stateless:!0}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,eC),eC.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.elements.push(new J(this.hot,{type:"button",value:c.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:eE.BUTTON_OK})),this.elements.push(new J(this.hot,{type:"button",value:c.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:eE.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,n.Bk)(this.elements,t=>{t.addLocalHook("click",(t,e)=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,eC,eT).call(this,t,e))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,a.cn)(e.parentNode,"htFiltersMenuActionBar"),(0,n.Bk)(this.elements,t=>e.appendChild(t.element)),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function eT(t,e){e.options.identifier===eE.BUTTON_OK?this.accept():this.cancel()}function eR(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let eO="ConditionCollection.filteringStates";class eM{constructor(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];eR(this,"hot",void 0),eR(this,"isMapRegistrable",void 0),eR(this,"filteringStates",new m.A),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(eO,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var i;let r=this.filteringStates.getValueAtIndex(e),n=null!==(i=null==r?void 0:r.conditions)&&void 0!==i?i:[],o=null==r?void 0:r.operation;return this.isMatchInConditions(n,t,o)}isMatchInConditions(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tk;return!t.length||(function(t){if(!tI[t])throw Error(`Operation with id "${t}" does not exist.`);let e=tI[t].func;return function(t,i){return e(t,i)}})(i)(t,e)}addCondition(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tk,r=arguments.length>3?arguments[3]:void 0,s=this.hot.getCellMeta(0,t).locale,l=(0,n.Sc)(e.args,t=>"string"==typeof t?t.toLocaleLowerCase(s):t),a=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);let h=this.getOperation(t);if(h){if(h!==i)throw Error(o.e`The column of index ${t} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,T.o8)(tI[i]))throw Error(o.e`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let u=this.getConditions(t);0===u.length?this.filteringStates.setValueAtIndex(t,{operation:i,conditions:[{name:a,args:l,func:y(a,l)}]},r):u.push({name:a,args:l,func:y(a,l)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,i;return null!==(e=null===(i=this.filteringStates.getValueAtIndex(t))||void 0===i?void 0:i.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(t=>{let[e]=t;return e})}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return(0,n.k$)(this.filteringStates.getEntries(),(t,e)=>{let[i,{operation:r,conditions:o}]=e;return t.push({column:i,operation:r,conditions:(0,n.Sc)(o,t=>{let{name:e,args:i}=t;return{name:e,args:i}})}),t},[])}importAllConditions(t){this.clean(),(0,n.Bk)(t,t=>{(0,n.Bk)(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){let i=this.getConditions(t);return e?i.some(t=>t.name===e):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(eO),this.filteringStates=null,this.clearLocalHooks()}}function eN(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,f.jB)(eM,g.Z);class eI{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];eN(this,"conditionCollection",void 0),eN(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return(0,n.Bk)(this.conditionCollection.getFilteredColumns(),(e,i)=>{let r=this.columnDataFactory(e);i&&(r=this._getIntersectData(r,t)),t=this.filterByColumn(e,r)}),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return(0,n.Bk)(e,e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&i.push(e)}),i}_getIntersectData(t,e){let i=[];return(0,n.Bk)(e,e=>{let r=e.meta.visualRow;void 0!==t[r]&&(i[r]=t[r])}),i}}function ex(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function ek(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eH(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var e_=new WeakSet,eA=new WeakSet,eL=new WeakSet;class eP{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];ex(this,eL),ex(this,eA),ex(this,e_),ek(this,"hot",void 0),ek(this,"conditionCollection",void 0),ek(this,"columnDataFactory",void 0),ek(this,"changes",[]),ek(this,"grouping",!1),ek(this,"latestEditedColumnPosition",-1),ek(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",t=>eH(this,e_,eD).call(this,t)),this.conditionCollection.addLocalHook("afterRemove",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("afterAdd",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("beforeClean",()=>eH(this,eA,eF).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>eH(this,eL,eB).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,n.Bk)(this.changes,t=>{this.updateStatesAtColumn(t)}),this.changes.length=0}updateStatesAtColumn(t,e){var i=this;if(this.grouping){-1===this.changes.indexOf(t)&&this.changes.push(t);return}let r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(t);-1===o&&(o=this.latestEditedColumnPosition);let s=r.slice(0,o),l=r.slice(o);l.length&&l[0].column===t&&l.shift();let a=(0,tQ.WA)(function(t,e){let r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=new eM(i.hot,!1),l=[].concat(t,o);s.importAllConditions(l);let a=i.columnDataFactory(e);r=s.isEmpty()?a:new eI(s,t=>i.columnDataFactory(t)).filter(),r=(0,n.Sc)(r,t=>t.meta.visualRow);let h=tY(r);return s.destroy(),(0,n.w7)(a,t=>h(t.meta.visualRow))})(s),h=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:h},dependentConditionStacks:l,filteredRowsFactory:a,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),(0,f._l)(this,(t,e)=>{this[e]=null})}}function eD(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function eF(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function eB(){(0,n.Bk)(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}(0,f.jB)(eP,g.Z);var eW=i(491);let eV="filters";var ej=i(6592);function eU(t,e){e$(t,e),e.add(t)}function e$(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ez(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eG(t,e){var i=eK(t,e,"get");return i.get?i.get.call(t):i.value}function eK(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function eX(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let eY="filters";var eZ=new WeakMap,eq=new WeakSet,eJ=new WeakSet,eQ=new WeakSet,e0=new WeakSet,e1=new WeakSet,e2=new WeakSet,e9=new WeakSet,e4=new WeakSet,e8=new WeakSet;class e7 extends r.v{static get PLUGIN_KEY(){return eY}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),eU(this,e8),eU(this,e4),eU(this,e9),eU(this,e2),eU(this,e1),eU(this,e0),eU(this,eQ),eU(this,eJ),eU(this,eq),ez(this,"dropdownMenuPlugin",null),ez(this,"conditionCollection",null),ez(this,"conditionUpdateObserver",null),ez(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ez(this,"filtersRowsMap",null),e$(this,eZ),eZ.set(this,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(t,e)=>eX(this,e4,io).call(this,t,e))}isEnabled(){return!!this.hot.getSettings()[eY]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new ej.n),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,i=t=>(t.addLocalHook("accept",()=>eX(this,e1,ie).call(this,"accept")),t.addLocalHook("cancel",()=>eX(this,e1,ie).call(this,"cancel")),t.addLocalHook("change",e=>eX(this,e2,ii).call(this,t,e)),t);if(!this.components.get("filter_by_condition")){let t=new tO(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(c.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",()=>eX(this,e9,ir).call(this)),this.components.set("filter_by_condition",i(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new tz(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let t=new tO(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",()=>eX(this,e9,ir).call(this)),this.components.set("filter_by_condition2",i(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new ey(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(c.FILTERS_DIVS_FILTER_BY_VALUE)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new eE(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new eM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new eP(this.hot,this.conditionCollection,t=>this.getDataMapAtColumn(t)),this.conditionUpdateObserver.addLocalHook("update",t=>eX(this,e8,is).call(this,t))),this.components.forEach(t=>t.show()),this.addHook("afterDropdownMenuDefaultOptions",t=>eX(this,e0,it).call(this,t)),this.addHook("afterDropdownMenuShow",()=>eX(this,eJ,e5).call(this)),this.addHook("afterDropdownMenuHide",()=>eX(this,eQ,e6).call(this)),this.addHook("afterChange",t=>eX(this,eq,e3).call(this,t)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!eG(this,eZ)&&this.dropdownMenuPlugin.enabled){var r;let t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{let e=t.getNavigator(),i=eG(this,eZ).getLastMenuPage();t.focus(),i>0?e.setCurrentPage(i):e.toFirstItem()}},...Array.from(this.components).map(t=>{let[,e]=t;return e.getElements()}).flat()];r=function(t,e){let i=-1,r=function(t){let e=(0,eW.M)({initialPage:0,size:()=>t.length,onItemSelect:(e,i)=>{let r=t[e];return r instanceof ef?i:(!r.element||!!(0,a.pn)(r.element))&&void r.focus()}});return e}(e),n=i=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(eV),r.setCurrentPage(e.indexOf(i))};function o(n){let o=t.getKeyboardShortcutsCtrl(),s=n.getKeyboardShortcutsCtrl();r.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(eV),callback:()=>{n.isSubMenu()&&n.close(),o.listen(eV)}}]),n.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{let n=t.getNavigator();n.getCurrentPage()>-1&&(i=n.getCurrentPage()),n.clear(),e.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{let i=e[r.getCurrentPage()];i instanceof tv&&(i.openOptions(),t.preventDefault()),i instanceof t4&&(i.activate(),t.preventDefault()),i instanceof G||t.preventDefault()}}],eV)}return e.forEach(t=>{t instanceof G&&(t.addLocalHook("click",n(t)),t.addLocalHook("focus",n(t)),t.addLocalHook("afterClose",n(t)))}),t.addLocalHook("afterSelectionChange",t=>{t.key.startsWith("filter_")||r.clear()}),t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o),{...r,listen:function(){t.focus(),t.getKeyboardShortcutsCtrl().listen(eV)},getLastMenuPage:function(){return i}}}(t,e),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,eK(this,eZ,"set"),r);let i=t=>{eG(this,eZ).listen(),t.preventDefault(),(0,h.ot)(t.keyCode,"TAB")&&(t.shiftKey?eG(this,eZ).toPreviousItem():eG(this,eZ).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",i),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",i)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var t;null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,e)=>{t.destroy(),this.components.set(e,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:eY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eY)}addCondition(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tk,n=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(n,{command:{key:e},args:i},r)}removeConditions(t){let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){let{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions(),s=this.hot.runHooks("beforeFilter",o);if(!1!==s){if(i){let i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=(0,n.Sc)(e.filter(),t=>t.meta.visualRow);let t=tY(r);(0,l.q4)(this.hot.countSourceRows()-1,e=>{t(e)||i.push(e)}),(0,n.Bk)(i,t=>{this.filtersRowsMap.setValueAtIndex(t,!0)})},!0),t||r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear()}this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){let e=this.hot.toVisualColumn(t),i=[];return(0,n.Bk)(this.hot.getSourceDataAtCol(e),(t,r)=>{var n;let{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d}=this.hot.getCellMeta(r,e),f=null!==(n=this.hot.getDataAtCell(this.hot.toVisualRow(r),e))&&void 0!==n?n:t;i.push({meta:{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d},value:tZ(f)})}),i}updateValueComponentCondition(t){let e=this.hot.getDataAtCol(t),i=tq(e);this.conditionUpdateObserver.updateStatesAtColumn(t,i)}restoreComponents(t){var e;let i=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach(t=>{t.isHidden()||t.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,i,r){let n=t;return n===t_&&e.command.key!==E&&i.command.key!==E&&r.command.key!==E?n=tL:r.command.key!==E&&(e.command.key===E||i.command.key===E)&&(n=tk),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let t=this.components.get("filter_by_condition"),{command:e}=t.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new eI(t,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){let t=[];if(!this.dropdownMenuPlugin)return t;let e=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return(0,n.Bk)(r,i=>{(0,n.Bk)(e.menuItems,(e,r)=>{e.key===i.getMenuItemDescriptor().key&&t.push(r)})}),t}changeComponentsVisibility(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let e=this.dropdownMenuPlugin.menu,i=e.hotMenu,r=i.getPlugin("hiddenRows");for(var n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];let l=this.getIndexesOfComponents(...o);t?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function e3(t){t&&(0,n.Bk)(t,t=>{let[,e]=t,i=this.hot.propToCol(e);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function e5(){this.restoreComponents(Array.from(this.components.values()))}function e6(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function it(t){t.items.push({name:u.F}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function ie(t){var e,i;if("accept"===t){let t=this.getSelectedColumn();if(null===t){null===(i=this.dropdownMenuPlugin)||void 0===i||i.close();return}let{physicalIndex:e}=t,r=this.components.get("filter_by_condition").getState(),n=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,n,o);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),r.command.key!==E&&(this.conditionCollection.addCondition(e,r,s,l),n.command.key!==E&&this.conditionCollection.addCondition(e,n,s,l)),o.command.key!==E&&this.conditionCollection.addCondition(e,o,s,l),this.conditionUpdateObserver.flush(),this.components.forEach(t=>t.saveState(e)),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function ii(t,e){this.updateDependentComponentsVisibility(),t.constructor!==tO||e.inputsCount||this.setListeningDropdownMenu()}function ir(){this.setListeningDropdownMenu()}function io(t,e){let i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)?(0,a.cn)(e,"htFiltersActive"):(0,a.IV)(e,"htFiltersActive")}function is(t){var e;if(!(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled))return;let{editedConditionStack:{conditions:i,column:r}}=t,n=i.filter(t=>t.name===ew),l=i.filter(t=>t.name!==ew);if(n.length>=2||l.length>=3)(0,s.ZK)(o.e`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let e=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(l[0],r),this.components.get("filter_by_condition2").updateState(l[1],r),this.components.get("filter_operators").updateState(e,r),this.components.get("filter_by_value").updateState(t)}}},990:function(t,e,i){"use strict";i.d(e,{E9:function(){return x}}),i(2916),i(2954);var r=i(5440),n=i(5878),o=i(7790),s=i(9440),l=i(9488),a=i(2518),h=i(7993),u=i(4317),c=i(2855),d=i(7392);function f(t,e){m(t,e),e.add(t)}function g(t,e,i){m(t,e),e.set(t,i)}function m(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function p(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function w(t,e){var i=y(t,e,"get");return i.get?i.get.call(t):i.value}function b(t,e,i){var r=y(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function y(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}u.Z.getSingleton().register("beforeHideRows"),u.Z.getSingleton().register("afterHideRows"),u.Z.getSingleton().register("beforeUnhideRows"),u.Z.getSingleton().register("afterUnhideRows");let S="hiddenRows";var C=new WeakMap,E=new WeakMap,T=new WeakSet,R=new WeakSet,O=new WeakSet,M=new WeakSet,N=new WeakSet,I=new WeakSet;class x extends r.v{constructor(){super(...arguments),f(this,I),f(this,N),f(this,M),f(this,O),f(this,R),f(this,T),g(this,C,{writable:!0,value:{}}),g(this,E,{writable:!0,value:null})}static get PLUGIN_KEY(){return S}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[S]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[S];(0,l.Kn)(e)&&(b(this,C,e),(0,a.o8)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),b(this,E,new d.o),w(this,E).addLocalHook("init",()=>p(this,I,P).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,w(this,E)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return p(t,N,L).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>p(this,R,H).call(this,t,e,i)),this.addHook("modifyRowHeight",(t,e)=>p(this,T,k).call(this,t,e)),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return p(t,M,A).call(t,...i)}),this.addHook("modifyCopyableRange",t=>p(this,O,_).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),b(this,C,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e,n=w(this,E).getValues().slice(),o=t.length>0;if(i&&o){let e=t.map(t=>this.hot.toPhysicalRow(t));(0,s.Bk)(e,t=>{n[t]=!1}),r=(0,s.k$)(n,(t,e,i)=>(e&&t.push(this.hot.toVisualRow(i)),t),[])}let l=this.hot.runHooks("beforeUnhideRows",e,r,i&&o);!1!==l&&(i&&o&&w(this,E).setValues(n),this.hot.runHooks("afterUnhideRows",e,r,i&&o,i&&r.length<e.length))}showRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showRows(e)}hideRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t))));let n=this.hot.runHooks("beforeHideRows",e,r,i);!1!==n&&(i&&this.hot.batchExecution(()=>{(0,s.Bk)(t,t=>{w(this,E).setValueAtIndex(this.hot.toPhysicalRow(t),!0)})},!0),this.hot.runHooks("afterHideRows",e,r,i,i&&r.length>e.length))}hideRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideRows(e)}getHiddenRows(){return(0,s.Sc)(w(this,E).getHiddenIndexes(),t=>this.hot.toVisualRow(t))}isHidden(t){return w(this,E).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){let e=this.hot.countRows();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,s.Bk)(this.hot.getCellsMeta(),t=>{t&&(t.skipRowOnPaste=!1)})}destroy(){b(this,C,null),b(this,E,null),super.destroy()}}function k(t,e){return this.isHidden(e)?0:t}function H(t,e,i){if(!1===w(this,C).copyPasteEnabled&&this.isHidden(t)&&(i.skipRowOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenRow")&&(i.className+=" afterHiddenRow");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function _(t){if(w(this,C).copyPasteEnabled)return t;let e=[],i=(t,i,r,n)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:n})};return(0,s.Bk)(t,t=>{let e=!0,r=0;(0,o.q4)(t.startRow,t.endRow,n=>{this.isHidden(n)?(e||i(r,n-1,t.startCol,t.endCol),e=!0):(e&&(r=n),n===t.endRow&&i(r,n,t.startCol,t.endCol),e=!1)})}),e}function A(t,e){if(!w(this,C).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&i.push("beforeHiddenRow"),(0,n.cn)(e,i)}function L(t){var e;t.items.push({name:h.F},(e=this,{key:"hidden_rows_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.row,i.row),0),n=Math.max(t.row,i.row),o=[];for(let t=r;t<=n;t+=1)o.push(t);e.hideRows(o);let s=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_rows_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(c.CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var i,r;if(0===e.length)return;let n=e[0],o=e[e.length-1];n=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);let s=o-n+1===this.countRows();s||this.selectRows(n,o)},disabled:!1,hidden(){let i=(0,s.Sc)(t.getHiddenRows(),t=>this.toPhysicalRow(t));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,l=this.rowIndexMapper,a=l.getRenderableFromVisualIndex(n),h=l.getRenderableFromVisualIndex(o),u=l.getNotTrimmedIndexes(),c=[];if(n!==o){let t=o-n+1;if(t>h-a+1){let t=u.slice(n,o+1);c.push(...t.filter(t=>i.includes(t)))}}else if(0===a&&a<n)c.push(...u.slice(0,n));else if(null===a)c.push(...u.slice(0,this.countRows()));else{let t=this.countRows()-1,e=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(t,-1));h===e&&t>o&&c.push(...u.slice(o+1))}return(0,s.Bk)(c,t=>{e.push(this.toVisualRow(t))}),0===e.length}}}(this))}function P(){Array.isArray(w(this,C).rows)&&this.hideRows(w(this,C).rows)}},5915:function(t,e,i){"use strict";i.d(e,{s3:function(){return p},a9:function(){return m},_j:function(){return w},fo:function(){return b}}),i(2954);var r=i(6411),n=i(7790),o=i(8179);let s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),l=t=>`The priority '${t}' is already declared in a map.`,a=t=>`The priority '${t}' is not a number.`;var h=i(2488);let u=t=>`'${t}' value is already declared in a unique set.`,c=t=>`There is already registered "${t}" plugin.`,d=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new Map;return t=(0,o.mf)(t)?t:l,e=(0,o.mf)(e)?e:a,{addItem:function(r,o){if(!(0,n.kE)(r))throw Error(e(r));if(i.has(r))throw Error(t(r));i.set(r,o)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[e,r]=s.get(t)||s.get("asc");return[...i].sort((t,i)=>t[0]<i[0]?e:r).map(t=>t[1])}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),f=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Set;return t=(0,o.mf)(t)?t:u,{addItem:function(i){if(e.has(i))throw Error(t(i));e.add(i)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:c}),g=(0,h.I)({errorIdExists:c});function m(){return[...d.getItems(),...f.getItems()]}function p(t){let e=(0,r.ct)(t);return g.getItem(e)}function w(t){return!!p(t)}function b(t,e,i){var n,o,s;[t,e,i]=(n=t,o=e,s=i,"function"==typeof n&&(n=(o=n).PLUGIN_KEY,s=o.PLUGIN_PRIORITY),[n,o,s]),void 0===p(t)&&function(t,e,i){let n=(0,r.ct)(t);if(g.hasItem(n))throw Error(c(n));void 0===i?f.addItem(n):d.addItem(i,n),g.addItem(n,e)}(t,e,i)}},1881:function(t,e,i){"use strict";i.d(e,{Z:function(){return o}}),i(2916);var r=i(5878),n=i(8200);function o(t,e,i,o,s,l,a){let h=a.ariaTags,u=[],c=[],d=[],f=[];a.className&&(0,r.cn)(e,a.className),a.readOnly?(u.push(a.readOnlyCellClassName),h&&f.push((0,n.zR)())):h&&d.push((0,n.zR)()[0]),!1===a.valid&&a.invalidCellClassName?(u.push(a.invalidCellClassName),h&&f.push((0,n.w1)())):(c.push(a.invalidCellClassName),h&&d.push((0,n.w1)()[0])),!1===a.wordWrap&&a.noWordWrapClassName&&u.push(a.noWordWrapClassName),!l&&a.placeholder&&u.push(a.placeholderCellClassName),(0,r.IV)(e,c),(0,r.cn)(e,u),(0,r.d$)(e,d),(0,r.P$)(e,f)}o.RENDERER_TYPE="base"},6903:function(t,e,i){"use strict";i.d(e,{Bp:function(){return h},Y3:function(){return s},zn:function(){return u}}),i(2954);var r=i(2656);let{register:n,getItem:o,hasItem:s,getNames:l,getValues:a}=(0,r.Z)("renderers");function h(t){if("function"==typeof t)return t;if(!s(t))throw Error(`No registered renderer found under "${t}" name`);return o(t)}function u(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),n(t,e)}},9275:function(t,e,i){"use strict";i.d(e,{V:function(){return s}});var r=i(1881),n=i(5878),o=i(2518);function s(t,e,i,s,l,a,h){r.Z.apply(this,[t,e,i,s,l,a,h]);let u=a;if(!u&&h.placeholder&&(u=h.placeholder),u=(0,o.Pz)(u),h.trimWhitespace&&(u=u.trim()),h.rendererTemplate){(0,n.cS)(e);let r=t.rootDocument.createElement("TEMPLATE");r.setAttribute("bind","{{}}"),r.innerHTML=h.rendererTemplate,HTMLTemplateElement.decorate(r),r.model=t.getSourceDataAtRow(i),e.appendChild(r)}else(0,n.tT)(e,u)}s.RENDERER_TYPE="text"},6873:function(t,e,i){"use strict";let r,n;i.d(e,{Z:function(){return to}}),i(2954),i(2916);let o="header",s="area",l="focus";var a=i(9488),h=i(3437);class Selection{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}(0,a.jB)(Selection,h.Z);var u=Selection;class c extends u{constructor(t,e){var i,r;super(t,null),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="visualCellRange","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[i]=null,this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:i}=t,r=this.getNearestNotHiddenCoords(e,1),n=this.getNearestNotHiddenCoords(i,-1);return null===r||null===n?null:((r.row>n.row||r.col>n.col)&&(r=e,n=i),this.settings.createCellRange(r,r,n))}getNearestNotHiddenCoords(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===r)return null;let n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,i);return null===n?null:this.settings.createCellCoords(r,n)}getNearestNotHiddenIndex(t,e,i){return e<0?e:t.getNearestNotHiddenIndex(e,i)}commit(){if(null===this.visualCellRange)return this;let t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===t?this.cellRange=null:this.cellRange=this.createRenderableCellRange(t.from,t.to),this}syncWith(t){let e=t.from.clone().normalize(),i="N-S"===t.getVerticalDirection()?1:-1,r="W-E"===t.getHorizontalDirection()?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),o=null;if((null===n||null===n.col||null===n.row)&&(o=this.getNearestNotHiddenCoords(e,i,r)),null!==o&&t.overlaps(o)){let e=t.highlight.clone();if(e.row>=0&&(e.row=o.row),e.col>=0&&(e.col=o.col),null===this.cellRange){let t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==n&&null===o&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){let t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){let i=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return null===i.row||null===i.col||null===r.row||null===r.col?null:this.settings.createCellRange(i,i,r)}}function d(t){let{activeHeaderClassName:e,...i}=t;return new c({className:e,...i,selectionType:"active-header"})}function f(t){let{areaCornerVisible:e,...i}=t;return new c({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...i,selectionType:s})}function g(t){let{...e}=t;return new c({className:"highlight",...e,selectionType:s})}function m(t){let{columnClassName:e,...i}=t;return new c({className:e,...i,selectionType:"column"})}var p=i(8200);function w(t){let{headerClassName:e,...i}=t;return new c({className:e,...i,selectionType:o})}function b(t){let{rowClassName:e,...i}=t;return new c({className:e,...i,selectionType:"row"})}var y=i(9440);function S(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function C(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var E=new WeakSet;r=Symbol.iterator;class T{constructor(t){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,E),E.add(this),S(this,"options",void 0),S(this,"layerLevel",0),S(this,"focus",void 0),S(this,"fill",void 0),S(this,"layeredAreas",new Map),S(this,"areas",new Map),S(this,"rowHeaders",new Map),S(this,"columnHeaders",new Map),S(this,"activeRowHeaders",new Map),S(this,"activeColumnHeaders",new Map),S(this,"activeCornerHeaders",new Map),S(this,"rowHighlights",new Map),S(this,"columnHighlights",new Map),S(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e,...i}=t;return new c({className:"current",headerAttributes:[(0,p.Ak)()],border:{width:2,color:"#4b89ff",cornerVisible:e},...i,selectionType:l})}(t),this.fill=function(t){let{...e}=t;return new c({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:"fill"})}(t)}isEnabledFor(t,e){let i=t;t===l&&(i="current");let r=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return C(this,E,R).call(this,this.layeredAreas,f)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return C(this,E,R).call(this,this.areas,g)}getAreas(){return[...this.areas.values()]}createRowHeader(){return C(this,E,R).call(this,this.rowHeaders,w)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return C(this,E,R).call(this,this.columnHeaders,w)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return C(this,E,R).call(this,this.activeRowHeaders,d)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return C(this,E,R).call(this,this.activeColumnHeaders,d)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return C(this,E,R).call(this,this.activeCornerHeaders,d)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return C(this,E,R).call(this,this.rowHighlights,b)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return C(this,E,R).call(this,this.columnHighlights,m)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:i,...r}=t;return new c({...e,...r,selectionType:"custom-selection"},i)}({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),(0,y.Bk)(this.areas.values(),t=>void t.clear()),(0,y.Bk)(this.layeredAreas.values(),t=>void t.clear()),(0,y.Bk)(this.rowHeaders.values(),t=>void t.clear()),(0,y.Bk)(this.columnHeaders.values(),t=>void t.clear()),(0,y.Bk)(this.activeRowHeaders.values(),t=>void t.clear()),(0,y.Bk)(this.activeColumnHeaders.values(),t=>void t.clear()),(0,y.Bk)(this.activeCornerHeaders.values(),t=>void t.clear()),(0,y.Bk)(this.rowHighlights.values(),t=>void t.clear()),(0,y.Bk)(this.columnHighlights.values(),t=>void t.clear())}[r](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function R(t,e){let i=this.layerLevel;if(t.has(i))return t.get(i);let r=e({layerLevel:i,...this.options});return t.set(i,r),r}function O(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}n=Symbol.iterator;class M{constructor(t){O(this,"ranges",[]),O(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[n](){return this.ranges[Symbol.iterator]()}}var N=i(2518),I=i(7790);function x(t,e){H(t,e),e.add(t)}function k(t,e,i){H(t,e),e.set(t,i)}function H(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function _(t,e){var i=P(t,e,"get");return i.get?i.get.call(t):i.value}function A(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function L(t,e,i){var r=P(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function P(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var D=new WeakMap,F=new WeakMap,B=new WeakMap,W=new WeakSet,V=new WeakSet,j=new WeakSet,U=new WeakSet,$=new WeakSet;class z{constructor(t,e){x(this,$),x(this,U),x(this,j),x(this,V),x(this,W),k(this,D,{writable:!0,value:void 0}),k(this,F,{writable:!0,value:void 0}),k(this,B,{writable:!0,value:{x:0,y:0}}),L(this,D,t),L(this,F,e)}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];A(this,W,G).call(this,{x:_(this,F).navigableHeaders()?_(this,F).countRowHeaders():0,y:_(this,F).navigableHeaders()?_(this,F).countColHeaders():0});let r=_(this,F).createCellCoords(t,e),n=_(this,D).current().highlight,o=_(this,F).visualToRenderableCoords(n),s=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),null!==o.row&&null!==o.col){let{width:t,height:e}=A(this,j,X).call(this),{row:o,col:h}=A(this,U,Y).call(this,n),u=_(this,F).fixedRowsBottom(),c=_(this,F).minSpareRows(),d=_(this,F).minSpareCols(),f=_(this,F).autoWrapRow(),g=_(this,F).autoWrapCol(),m=_(this,F).createCellCoords(o+r.row,h+r.col);if(m.row>=e){let r=(0,a.sm)(i&&c>0&&0===u),n=m.col+1,o=_(this,F).createCellCoords(m.row-e,n>=t?n-t:n);this.runLocalHooks("beforeColumnWrap",r,A(this,$,Z).call(this,o),n>=t),r.value?this.runLocalHooks("insertRowRequire",_(this,F).countRenderableRows()):g&&m.assign(o)}else if(m.row<0){let i=(0,a.sm)(g),r=m.col-1,n=_(this,F).createCellCoords(e+m.row,r<0?t+r:r);this.runLocalHooks("beforeColumnWrap",i,A(this,$,Z).call(this,n),r<0),g&&m.assign(n)}if(m.col>=t){let r=(0,a.sm)(i&&d>0),n=m.row+1,o=_(this,F).createCellCoords(n>=e?n-e:n,m.col-t);this.runLocalHooks("beforeRowWrap",r,A(this,$,Z).call(this,o),n>=e),r.value?this.runLocalHooks("insertColRequire",_(this,F).countRenderableColumns()):f&&m.assign(o)}else if(m.col<0){let i=(0,a.sm)(f),r=m.row-1,n=_(this,F).createCellCoords(r<0?e+r:r,t+m.col);this.runLocalHooks("beforeRowWrap",i,A(this,$,Z).call(this,n),r<0),f&&m.assign(n)}let{rowDir:p,colDir:w}=A(this,V,K).call(this,m);s=p,l=w,n=A(this,$,Z).call(this,m)}return this.runLocalHooks("afterTransformStart",n,s,l),n}transformEnd(t,e){A(this,W,G).call(this,{x:_(this,F).navigableHeaders()?_(this,F).countRowHeaders():0,y:_(this,F).navigableHeaders()?_(this,F).countColHeaders():0});let i=_(this,F).createCellCoords(t,e),r=_(this,D).current(),n=_(this,F).visualToRenderableCoords(r.highlight),o=r.to.clone(),s=0,l=0;if(this.runLocalHooks("beforeTransformEnd",i),null!==n.row&&null!==n.col){let{row:t,col:e}=A(this,U,Y).call(this,r.to),n=_(this,F).createCellCoords(t+i.row,e+i.col),{rowDir:a,colDir:h}=A(this,V,K).call(this,n);s=a,l=h;let u=A(this,$,Z).call(this,n);0===i.row&&0!==i.col?o.col=u.col:0!==i.row&&0===i.col?o.row=u.row:(o.row=u.row,o.col=u.col)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}function G(t){let{x:e,y:i}=t;L(this,B,{x:e,y:i})}function K(t){let{width:e,height:i}=A(this,j,X).call(this),r=0,n=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=i&&(r=1,t.row=i-1),t.col<0?(n=-1,t.col=0):t.col>0&&t.col>=e&&(n=1,t.col=e-1),{rowDir:r,colDir:n}}function X(){return{width:_(this,B).x+_(this,F).countRenderableColumns(),height:_(this,B).y+_(this,F).countRenderableRows()}}function Y(t){let{row:e,col:i}=_(this,F).visualToRenderableCoords(t);return _(this,F).createCellCoords(_(this,B).y+e,_(this,B).x+i)}function Z(t){let e=t.clone();return e.col=t.col-_(this,B).x,e.row=t.row-_(this,B).y,_(this,F).renderableToVisualCoords(e)}(0,a.jB)(z,h.Z);var q=i(855),J=i(2836);function Q(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tt(t,e,i){var r=ti(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function te(t,e){var i=ti(t,e,"get");return i.get?i.get.call(t):i.value}function ti(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var tr=new WeakMap;class tn{constructor(t,e){var i=this;Q(this,"settings",void 0),Q(this,"tableProps",void 0),Q(this,"inProgress",!1),Q(this,"selectedRange",new M((t,e,i)=>this.tableProps.createCellRange(t,e,i))),Q(this,"highlight",void 0),Q(this,"transformation",void 0),Q(this,"selectedByRowHeader",new Set),Q(this,"selectedByColumnHeader",new Set),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,tr),tr.set(this,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new T({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[(0,p.Ak)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,i)=>this.tableProps.createCellRange(t,e,i)}),this.transformation=new z(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformStart",...e)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformStart",...e)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformEnd",...e)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformEnd",...e)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertRowRequire",...e)}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertColRequire",...e)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeRowWrap",...e)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeColumnWrap",...e)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,n="multiple"===this.settings.selectionMode,o=(0,N.o8)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,s),(!n||n&&!o&&(0,N.o8)(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(t)}setRangeStartOnly(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,i)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;let e=t.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((i>0||r>0)&&(0===i&&e.col<0&&!n||0===r&&e.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();let a=this.selectedRange.current();this.settings.navigableHeaders||a.highlight.normalize(),"single"===this.settings.selectionMode?(a.setFrom(a.highlight),a.setTo(a.highlight)):a.setTo(e),i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet");let h=this.highlight.getFocus();h.clear(),this.highlight.isEnabledFor(l,a.highlight)&&h.add(this.selectedRange.current().highlight).commit().syncWith(a);let u=this.getLayerLevel();u<this.highlight.layerLevel&&((0,y.Bk)(this.highlight.getAreas(),t=>void t.clear()),(0,y.Bk)(this.highlight.getLayeredAreas(),t=>void t.clear()),(0,y.Bk)(this.highlight.getRowHeaders(),t=>void t.clear()),(0,y.Bk)(this.highlight.getColumnHeaders(),t=>void t.clear()),(0,y.Bk)(this.highlight.getActiveRowHeaders(),t=>void t.clear()),(0,y.Bk)(this.highlight.getActiveColumnHeaders(),t=>void t.clear()),(0,y.Bk)(this.highlight.getActiveCornerHeaders(),t=>void t.clear()),(0,y.Bk)(this.highlight.getRowHighlights(),t=>void t.clear()),(0,y.Bk)(this.highlight.getColumnHighlights(),t=>void t.clear())),this.highlight.useLayerLevel(u);let c=this.highlight.createArea(),d=this.highlight.createLayeredArea(),f=this.highlight.createRowHeader(),g=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),w=this.highlight.createActiveCornerHeader(),b=this.highlight.createRowHighlight(),S=this.highlight.createColumnHighlight();if(c.clear(),d.clear(),f.clear(),g.clear(),m.clear(),p.clear(),w.clear(),b.clear(),S.clear(),this.highlight.isEnabledFor(s,a.highlight)&&(this.isMultiple()||u>=1)&&(c.add(a.from).add(a.to).commit(),d.add(a.from).add(a.to).commit(),1===u)){let t=this.selectedRange.previous();this.highlight.useLayerLevel(u-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(u)}if(this.highlight.isEnabledFor(o,a.highlight)){if(!a.isSingleHeader()){let t=this.tableProps.createCellCoords(Math.max(a.from.row,0),-1),e=this.tableProps.createCellCoords(a.to.row,-1),i=this.tableProps.createCellCoords(-1,Math.max(a.from.col,0)),r=this.tableProps.createCellCoords(-1,a.to.col);"single"===this.settings.selectionMode?(f.add(t).commit(),g.add(i).commit(),b.add(t).commit(),S.add(i).commit()):(f.add(t).add(e).commit(),g.add(i).add(r).commit(),b.add(t).add(e).commit(),S.add(i).add(r).commit())}let t=!te(this,tr)&&this.isEntireRowSelected()&&(r>0&&r===a.getWidth()||0===r&&this.isSelectedByRowHeader()),e=!te(this,tr)&&this.isEntireColumnSelected()&&(i>0&&i===a.getHeight()||0===i&&this.isSelectedByColumnHeader());t&&m.add(this.tableProps.createCellCoords(Math.max(a.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(a.to.row,0),-1)).commit(),e&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(a.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(a.to.col,0))).commit(),t&&e&&w.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){let t=(0,a.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,i))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{col:e}=t.getOuterTopStartCorner(),i=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(i>0&&e<0||0===i)&&t.getWidth()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{row:e}=t.getOuterTopStartCorner(),i=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(i>0&&e<0||0===i)&&t.getHeight()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){let e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},n=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=i?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===n||0===o))return;let u=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight,{focusPosition:c,disableHeadersHighlight:d}=r;tt(this,tr,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(u=this.tableProps.createCellCoords((0,I.uZ)(c.row,a,n-1),(0,I.uZ)(c.col,h,o-1)));let f=this.tableProps.createCellCoords(a,h),g=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(f,void 0,u),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),tt(this,tr,!1)}selectCells(t){var e=this;let i=(0,q.AV)(t);if(i===q.gk)return!1;if(i===q.Kk)throw Error(J.e`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let r=(0,q.S5)(i,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!t.some(t=>{let e=r(t),i=e.isValid(o);return!(i&&!e.containsHeaders()||i&&e.containsHeaders()&&e.isSingleHeader())});return s&&(this.clear(),(0,y.Bk)(t,t=>{let{from:e,to:i}=r(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(i.clone()),this.finish()})),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="string"==typeof t?this.tableProps.propToCol(t):t,n="string"==typeof e?this.tableProps.propToCol(e):e,o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,r),u=this.tableProps.createCellCoords(o-1,n),c=this.tableProps.createCellRange(h,h,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:l});if(c){let t=0===l?0:(0,I.uZ)(i,a,-1),e=o-1,s=this.tableProps.createCellCoords(t,r),h=this.tableProps.createCellCoords(e,n),u=this.tableProps.createCellCoords((0,I.uZ)(i,a,o-1),r);this.runLocalHooks("beforeSelectColumns",s,h,u),s.row=t,h.row=e,this.setRangeStartOnly(s,void 0,u),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",s,h,u),this.finish()}return c}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,n-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:r,countCols:n,countRowHeaders:o,countColHeaders:0});if(h){let r=0===o?0:(0,I.uZ)(i,s,-1),l=n-1,a=this.tableProps.createCellCoords(t,r),h=this.tableProps.createCellCoords(e,l),u=this.tableProps.createCellCoords(t,(0,I.uZ)(i,s,n-1));this.runLocalHooks("beforeSelectRows",a,h,u),a.col=r,h.col=l,this.setRangeStartOnly(a,void 0,u),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",a,h,u),this.finish()}return h}refresh(){let t=this.highlight.getCustomSelections();if(t.forEach(t=>{t.commit()}),!this.isSelected())return;let e=this.highlight.getFocus(),i=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let t=0;t<this.selectedRange.size();t+=1){this.highlight.useLayerLevel(t);let e=this.highlight.createArea(),i=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),n=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),i.commit(),r.commit(),n.commit(),o.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(i)}}(0,a.jB)(tn,h.Z);var to=tn},855:function(t,e,i){"use strict";i.d(e,{AV:function(){return d},I8:function(){return m},Kk:function(){return s},S5:function(){return f},X8:function(){return g},gk:function(){return l}}),i(2954),i(2916);var r=i(1648),n=i(9440),o=i(2518);let s=0,l=1,a=[3,2],h=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],u=Symbol("root"),c=Symbol("child");function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;if(e!==u&&e!==c)throw Error("The second argument is used internally only and cannot be overwritten.");let i=Array.isArray(t),n=e===u,o=s;if(i){let e=t[0];if(0===t.length)o=l;else if(n&&e instanceof r.Z)o=3;else if(n&&Array.isArray(e))o=d(e,c);else if(t.length>=2&&t.length<=4){let e=!t.some((t,e)=>!h[e].includes(typeof t));e&&(o=2)}}return o}function f(t){let{createCellCoords:e,createCellRange:i,keepDirection:r=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a.includes(t))throw Error("Unsupported selection ranges schema type was provided.");return function(s){let l=3===t,a=l?s.from.row:s[0],h=l?s.from.col:s[1],u=l?s.to.row:s[2],c=l?s.to.col:s[3];if("function"==typeof n&&("string"==typeof h&&(h=n(h)),"string"==typeof c&&(c=n(c))),(0,o.o8)(u)&&(u=a),(0,o.o8)(c)&&(c=h),!r){let t=a,e=h,i=u,r=c;a=Math.min(t,i),h=Math.min(e,r),u=Math.max(t,i),c=Math.max(e,r)}let d=e(a,h),f=e(u,c);return i(d,d,f)}}function g(t){let e=d(t.getSelected());if(e===s||e===l)return[];let i=f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,n.Bk)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.col,0),l=o.col-s+1;(0,n.Bk)(Array.from(Array(l),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e),a=(0,n.k$)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return a}function m(t){let e=d(t.getSelected());if(e===s||e===l)return[];let i=f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,n.Bk)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.row,0),l=o.row-s+1;(0,n.Bk)(Array.from(Array(l),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e),a=(0,n.k$)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return a}},2659:function(t,e,i){"use strict";i.d(e,{I:function(){return n},W:function(){return r}});let r="gridDefault",n="editorManager.handlingEditor"},9366:function(t,e,i){"use strict";i.d(e,{xg:function(){return u}});var r=i(2659),n=i(7687);let o=[{name:"editorCloseAndSave",callback(t,e,i){let r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(i.includes("shift"))}},{name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},{name:"editorFastOpen",callback(t,e){let{highlight:i}=t.getSelectedRangeLast();i.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},{name:"editorOpen",callback(t,e,i){let r=t._getEditorManager(),{highlight:o}=t.getSelectedRangeLast();o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(i.includes("shift")),(0,n.mM)(e))}},{name:"extendCellsSelectionDown",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,-1);if(null!==r){let i=t._createCellCoords(r,e.col),n=e.row-t.view.getFirstFullyVisibleRow(),o=Math.min(i.row-n,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(i.col,r.col,e.row)}},{name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r,o.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,i.getNearestNotHiddenIndex(0,1)))}},{name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,r))}}},{name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,r))}}},{name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(0,1);e.setRangeStart(n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r,o.col))}}},{name:"extendCellsSelectionToRows",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(i.row,r.row,e.col)}},{name:"extendCellsSelectionUp",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,1);if(null!==r){let i=t._createCellCoords(r,e.col),n=e.row-t.view.getFirstFullyVisibleRow(),o=Math.max(i.row-n,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,n=t.countVisibleRows()+i;r===t.countRows()-1?n=1:r+n>t.countRows()&&(n=t.countRows()-r-1),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(t,e){let i=t.getSettings(),r="function"==typeof i.tabMoves?i.tabMoves(e):i.tabMoves;t.selection.transformStart(-r.row,-r.col)}},{name:"moveCellSelectionInlineStart",callback(t,e){let i=t.getSettings(),r="function"==typeof i.tabMoves?i.tabMoves(e):i.tabMoves;t.selection.transformStart(r.row,r.col)}},{name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===i&&(i=-1),t.selection.setRangeStart(t._createCellCoords(i,e))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsBottom,10),o=i.getNearestNotHiddenIndex(t.countRows()-n-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),n=t.getSelectedRangeLast().highlight.row,o=i.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(n,o))}},{name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,r=t.getSelectedRangeLast().highlight.row,n=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===n&&(n=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,n))}},{name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{row:r}=t.getSelectedRangeLast().highlight,n=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===n&&(n=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,n))}},{name:"moveCellSelectionToMostTop",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===i&&(i=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(i,e))}},{name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=i.getNearestNotHiddenIndex(n,1),l=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,l))}},{name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,n=-(t.countVisibleRows()+i);r===-i?n=-1:r+n<i&&(n=-(r+i)),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),i=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,n=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(i,r),l=t._createCellCoords(n,o),a=t._createCellRange(s,s,l);if(!a.includes(e)&&(e.row>=0||e.col>=0)){let i={};if(e.col>=0){let r=Math.floor(t.countVisibleCols()/2);i.col=Math.max(e.col-r,0)}if(e.row>=0){let r=Math.floor(t.countVisibleRows()/2);i.row=Math.max(e.row-r,0)}t.scrollViewportTo({...i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:i,col:r}=e[e.length-1].highlight.normalize(),n=t.getDataAtCell(i,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((e,s)=>{if(e>=0&&s>=0&&(e!==i||s!==r)){let{readOnly:i}=t.getCellMeta(e,s);i||o.set(`${e}x${s}`,[e,s,n])}});t.setDataAtCell(Array.from(o.values()))}}];function s(t){let e={};return o.forEach(i=>{let{name:r,callback:n}=i;e[r]=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return n(t,...i)}}),e}function l(t){let e=t.getShortcutManager().addContext("editor"),i=s(t),n={group:r.I};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],n)}var a=i(2518);function h(t){let e=t.getShortcutManager().addContext("grid"),i=s(t),n={runOnlyIf:()=>{let{navigableHeaders:e}=t.getSettings();return(0,a.$K)(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:r.W};e.addShortcuts([{keys:[["F2"]],callback:t=>i.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:r.I,runOnlyIf:()=>(0,a.$K)(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>i.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>i.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],n)}function u(t){[l,h].forEach(e=>e(t))}},9949:function(t,e,i){"use strict";i.d(e,{U:function(){return T}}),i(2954);var r=i(2488),n=i(7687);i(2916);let o=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),s=t=>t.map(t=>{let e=t.toLowerCase();return o.has(e)?o.get(e):e}).sort().join("+"),l=t=>t.split("+"),a=RegExp("^(?:Key|Digit)([A-Z0-9])$"),h=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),u=t=>{let{key:e,code:i}=t,r=e;return a.test(i)?r=i.replace(a,"$1"):h.has(i)&&(r=i),r.toLowerCase()};var c=i(2518),d=i(8179),f=i(9488),g=i(2836);let m=Symbol("shortcut-context");function p(t){return(0,f.Kn)(t)&&t.__kindOf===m}let w=t=>{let e=(0,r.I)({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:t,callback:i,group:r,runOnlyIf:n=()=>!0,captureCtrl:o=!1,preventDefault:l=!0,stopPropagation:a=!1,relativeToGroup:h,position:u,forwardToContext:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,c.o8)(r))throw Error("You need to define the shortcut's group.");if(!1===(0,d.mf)(i))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw Error(g.e`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let m={callback:i,group:r,runOnlyIf:n,captureCtrl:o,preventDefault:l,stopPropagation:a};(0,c.$K)(h)&&([m.relativeToGroup,m.position]=[h,u]),p(f)&&(m.forwardToContext=f),t.forEach(t=>{let i=s(t),r=e.hasItem(i);if(r){let t=e.getItem(i),r=t.findIndex(t=>t.group===h);-1!==r?"before"===u?r-=1:r+=1:r=t.length,t.splice(r,0,m)}else e.addItem(i,[m])})},n=t=>{let i=s(t);e.removeItem(i)};return{__kindOf:m,addShortcut:i,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(t=>{(0,f._l)(e,(i,r)=>{!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])}),i(t)})},getShortcuts:t=>{let i=s(t),r=e.getItem(i);return(0,c.$K)(r)?r.slice():[]},hasShortcut:t=>{let i=s(t);return e.hasItem(i)},removeShortcutsByKeys:n,removeShortcutsByGroup:t=>{let i=e.getItems();i.forEach(e=>{let[i,r]=e,o=r.filter(e=>e.group!==t);0===o.length?n(l(i)):(r.length=0,r.push(...o))})}}};var b=i(5878),y=i(2228);let S=["meta","alt","shift","control"],C=function(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),E=0,T=t=>{let{ownerWindow:e,handleEvent:i,beforeKeyDown:o,afterKeyDown:s}=t,l=(0,r.I)({errorIdExists:t=>`The "${t}" context name is already registered.`}),a="grid",h=()=>a,c=t=>l.getItem(t),d=!1,f=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h(),r=p(i)?i:c(i),o=!1;if(!r.hasShortcut(e))return o;let s=r.getShortcuts(e);for(let i=0;i<s.length;i++){let{callback:r,runOnlyIf:l,preventDefault:a,stopPropagation:h,captureCtrl:u,forwardToContext:c}=s[i];if(!0===l(t)){if(d=u,o=!1===r(t,e),d=!1,a&&t.preventDefault(),h&&((0,n.mM)(t),t.stopPropagation()),o)break;c&&f(t,e,c)}}return o},m=function(t,e,i,r,o){let s=t=>S.includes(t),l=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return t.altKey&&i.push("alt"),e&&(t.ctrlKey||t.metaKey)?i.push("control/meta"):(t.ctrlKey&&i.push("control"),t.metaKey&&i.push("meta")),t.shiftKey&&i.push("shift"),i},a=t=>{if(!1===e(t))return;let a=i(t);if(229===t.keyCode||!1===a||(0,n.Ty)(t))return;let h=u(t),c=[];s(h)||(c=l(t));let d=[h].concat(c),f=o(t,d);!f&&((0,y.eE)()&&c.includes("meta")||!(0,y.eE)()&&c.includes("control"))&&o(t,[h].concat(l(t,!0))),r(t)},h=t=>{let e=u(t);s(e)&&C.press(e)},c=t=>{let e=u(t);s(e)&&C.release(e)},d=()=>{C.releaseAll()};return{mount:()=>{let e=t;for(E+=1;e;)1===E&&(e.document.documentElement.addEventListener("keydown",h),e.document.documentElement.addEventListener("keyup",c)),e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("blur",d),e=(0,b.f5)(e)},unmount:()=>{let e=t;for(E-=1;e;)0===E&&(e.document.documentElement.removeEventListener("keydown",h),e.document.documentElement.removeEventListener("keyup",c)),e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("blur",d),e=(0,b.f5)(e)},isPressed:t=>C.isPressed(t),releasePressedKeys:()=>C.releaseAll()}}(e,i,o,s,f);return m.mount(),{addContext:t=>{let e=w(t);return l.addItem(t,e),e},getActiveContextName:h,getContext:c,setActiveContextName:t=>{if(!l.hasItem(t))throw Error(g.e`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=t},isCtrlPressed:()=>!d&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}}},2858:function(t,e,i){"use strict";i.d(e,{Z:function(){return e8}}),i(2916),i(2954);var r=i(5878),n=i(9773),o=i(7687),s=i(8179),l=i(973),a=i(2228),h=i(2518);function u(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function c(t,e){var i=f(t,e,"get");return i.get?i.get.call(t):i.value}function d(t,e,i){var r=f(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function f(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var g=new WeakMap,m=new WeakMap,p=new WeakMap,w=new WeakMap,b=new WeakMap,y=new WeakMap,S=new WeakMap,C=new WeakMap,E=new WeakMap,T=new WeakMap;class Event{constructor(t,e,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;u(this,g,{writable:!0,value:void 0}),u(this,m,{writable:!0,value:void 0}),u(this,p,{writable:!0,value:void 0}),u(this,w,{writable:!0,value:void 0}),u(this,b,{writable:!0,value:void 0}),u(this,y,{writable:!0,value:void 0}),u(this,S,{writable:!0,value:void 0}),u(this,C,{writable:!0,value:void 0}),u(this,E,{writable:!0,value:[null,null]}),u(this,T,{writable:!0,value:[null,null]}),d(this,g,i),d(this,m,e),d(this,p,n),d(this,w,o),d(this,b,s),d(this,y,r),d(this,S,t),this.registerEvents()}registerEvents(){c(this,y).addEventListener(c(this,p).holder,"contextmenu",t=>this.onContextMenu(t)),c(this,y).addEventListener(c(this,p).TABLE,"mouseover",t=>this.onMouseOver(t)),c(this,y).addEventListener(c(this,p).TABLE,"mouseout",t=>this.onMouseOut(t));let t=()=>{c(this,y).addEventListener(c(this,p).holder,"touchstart",t=>this.onTouchStart(t)),c(this,y).addEventListener(c(this,p).holder,"touchend",t=>this.onTouchEnd(t)),this.momentumScrolling||(this.momentumScrolling={}),c(this,y).addEventListener(c(this,p).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||c(this,g).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,c(this,g).getSetting("onAfterMomentumScroll"))},200)})};(0,a.K1)()?t():((0,l.JS)()&&t(),(()=>{c(this,y).addEventListener(c(this,p).holder,"mouseup",t=>this.onMouseUp(t)),c(this,y).addEventListener(c(this,p).holder,"mousedown",t=>this.onMouseDown(t))})())}selectedCellWasTouched(t){let e=this.parentCell(t),i=e.coords;if(c(this,C)&&i){let[t,e]=[i.row,c(this,C).from.row],[r,n]=[i.col,c(this,C).from.col];return t===e&&r===n}return!1}parentCell(t){let e={},i=c(this,p).TABLE,n=(0,r.W6)(t,["TD","TH"],i);return n?(e.coords=c(this,p).getCoords(n),e.TD=n):(0,r.pv)(t,"wtBorder")&&(0,r.pv)(t,"current")?(e.coords=c(this,w).getFocusSelection().cellRange.highlight,e.TD=c(this,p).getCell(e.coords)):(0,r.pv)(t,"wtBorder")&&(0,r.pv)(t,"area")&&c(this,w).getAreaSelection().cellRange&&(e.coords=c(this,w).getAreaSelection().cellRange.to,e.TD=c(this,p).getCell(e.coords)),e}onMouseDown(t){let e=c(this,m).rootDocument.activeElement,i=(0,s.r$)(r.G_,t.target),n=t.target;if(!["TD","TH"].includes(e.nodeName)&&(n===e||i(0)===e||i(1)===e))return;let o=this.parentCell(n);(0,r.pv)(n,"corner")?c(this,g).getSetting("onCellCornerMouseDown",t,n):o.TD&&c(this,g).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&o.TD&&(c(this,T)[0]=o.TD,clearTimeout(c(this,E)[0]),c(this,E)[0]=setTimeout(()=>{c(this,T)[0]=null},1e3))}onContextMenu(t){if(c(this,g).has("onCellContextMenu")){let e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!c(this,g).has("onCellMouseOver"))return;let e=c(this,p).TABLE,i=(0,r.W6)(t.target,["TD","TH"],e),n=c(this,b)||this;i&&i!==n.lastMouseOver&&(0,r.MO)(i,e)&&(n.lastMouseOver=i,this.callListener("onCellMouseOver",t,c(this,p).getCoords(i),i))}onMouseOut(t){if(!c(this,g).has("onCellMouseOut"))return;let e=c(this,p).TABLE,i=(0,r.W6)(t.target,["TD","TH"],e),n=(0,r.W6)(t.relatedTarget,["TD","TH"],e),o=c(this,b)||this;i&&i!==n&&(0,r.MO)(i,e)&&(this.callListener("onCellMouseOut",t,c(this,p).getCoords(i),i),null===n&&(o.lastMouseOver=null))}onMouseUp(t){let e=this.parentCell(t.target);e.TD&&c(this,g).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===c(this,T)[0]&&e.TD===c(this,T)[1]?((0,r.pv)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),c(this,T)[0]=null,c(this,T)[1]=null):e.TD===c(this,T)[0]&&(c(this,T)[1]=e.TD,clearTimeout(c(this,E)[1]),c(this,E)[1]=setTimeout(()=>{c(this,T)[1]=null},500)))}onTouchStart(t){d(this,C,c(this,w).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;let i=t.target,r=null===(e=this.parentCell(i))||void 0===e?void 0:e.coords,n=(0,h.$K)(r)&&r.row>=0&&r.col>=0,o=t.cancelable&&n&&c(this,g).getSetting("isDataViewInstance");o&&((0,a.gn)()&&((0,a.E6)()||(0,a.iF)())&&this.selectedCellWasTouched(i)&&!["A","BUTTON","INPUT"].includes(i.tagName)?t.preventDefault():this.selectedCellWasTouched(i)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,i,r){let n=c(this,g).getSettingPure(t);n&&n(e,i,r,c(this,S).call(this))}destroy(){clearTimeout(c(this,E)[0]),clearTimeout(c(this,E)[1]),c(this,y).destroy()}}var R=i(9440),O=i(6678);function M(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class N{constructor(t,e,i){M(this,"offset",void 0),M(this,"total",void 0),M(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}function I(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class x{constructor(t,e,i){I(this,"offset",void 0),I(this,"total",void 0),I(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}function k(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class H{constructor(){k(this,"currentSize",0),k(this,"nextSize",0),k(this,"currentOffset",0),k(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function _(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class A{constructor(){_(this,"size",new H),_(this,"workingSpace",0),_(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof H}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function L(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P{constructor(t,e,i){L(this,"rootNode",void 0),L(this,"nodesPool",void 0),L(this,"sizeSet",new A),L(this,"childNodeType",void 0),L(this,"visualIndex",0),L(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=i.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){let t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){let{rootNode:t,sizeSet:e}=this,i=0;if(this.isSharedViewSet()){let r=t.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)i+=1;else if(e.isPlaceOn(1))break;r=r.nextElementSibling}}else i=t.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:t,sizeSet:e}=this,i=this.isSharedViewSet(),{nextSize:r}=e.getViewSize(),n=this.getRenderedChildCount();for(;n<r;){let r=this.nodesPool();!i||i&&e.isPlaceOn(2)?t.appendChild(r):t.insertBefore(r,t.firstChild),n+=1}let o=i&&e.isPlaceOn(1);for(;n>r;)t.removeChild(o?t.firstChild:t.lastChild),n-=1}render(){let{rootNode:t,sizeSet:e}=this,i=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(i+=e.sharedSize.nextSize);let r=t.childNodes[i];if(r.tagName!==this.childNodeType){let e=this.nodesPool();t.replaceChild(e,r),r=e}this.collectedNodes.push(r),this.visualIndex+=1}end(){}}class D extends P{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}class F{constructor(t){var e,i,r;i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="nodeType","string"))?r:String(r))in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function B(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class W{constructor(t,e){B(this,"nodesPool",null),B(this,"nodeType",void 0),B(this,"rootNode",void 0),B(this,"table",null),B(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new F(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}var V=i(8200);function j(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class U extends W{constructor(){super("TH"),j(this,"orderViews",new WeakMap),j(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new D(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:i,rows:n,cells:o}=this.table;for(let s=0;s<t;s++){let t=this.table.renderedRowToSource(s),l=n.getRenderedNode(s);this.sourceRowIndex=t;let a=this.obtainOrderView(l),h=o.obtainOrderView(l);a.appendView(h).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<i;n++){a.render();let i=a.getCurrentNode();i.className="",i.removeAttribute("style"),(0,r.d$)(i,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.P$)(i,[(0,V.iL)(),(0,V.Pp)(),(0,V.yz)(n+1),(0,V.Qk)(-1)]),e[n](t,i,n)}a.end()}}}class $ extends W{constructor(t){super(null,t)}adjust(){let{columnHeadersCount:t,rowHeadersCount:e}=this.table,i=this.rootNode.firstChild;if(t){let{columnsToRender:r}=this.table,n=r+e;for(let e=0;e<t;e++){for((i=this.rootNode.childNodes[e])||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<n;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)i.removeChild(i.lastChild),this.renderedNodes-=1}let o=this.rootNode.childNodes.length;if(o>t)for(let e=t;e<o;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&(0,r.cS)(i)}render(){let{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&(0,r.P$)(this.rootNode,[(0,V.Ct)()]);for(let e=0;e<t;e+=1){let{columnHeaderFunctions:t,columnsToRender:i,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&(0,r.P$)(o,[(0,V.f3)(),(0,V.d5)(e+1)]);for(let s=-1*n;s<i;s+=1){let i=this.table.renderedColumnToSource(s),l=o.childNodes[s+n];l.className="",l.removeAttribute("style"),(0,r.d$)(l,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.P$)(l,[(0,V.yz)(s+1+this.table.rowHeadersCount),(0,V.Qk)(-1),(0,V.Ng)(),...s>=0?[(0,V.iJ)()]:[(0,V.f3)()]]),t[e](i,l,e)}}}}var z=i(4748),G=i(2836);let K=!1;class X extends W{constructor(t){super(null,t)}adjust(){let{columnsToRender:t,rowHeadersCount:e}=this.table,i=t+e;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:t,rowHeadersCount:e}=this.table;!K&&t>1e3&&(K=!0,(0,z.ZK)(G.e`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let t=0;t<e;t++){let e=this.table.renderedColumnToSource(t),i=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[t].style.width=`${i}px`}for(let i=0;i<t;i++){let t=this.table.renderedColumnToSource(i),r=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[i+e].style.width=`${r}px`}let i=this.rootNode.firstChild;i&&(0,r.cn)(i,"rowHeader")}}let Y=!1;class Z extends W{constructor(t){var e,i,r;super("TR",t),i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="orderView","string"))?r:String(r))in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.orderView=new P(t,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){let{rowsToRender:t}=this.table;!Y&&t>1e3&&(Y=!0,(0,z.ZK)(G.e`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,r.P$)(this.rootNode,[(0,V.Ct)()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();let t=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var e,i;(0,r.P$)(t,[(0,V.f3)(),(0,V.d5)(o+(null!==(e=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.columnHeaders.length)&&void 0!==e?e:0)+1)])}}this.orderView.end()}}function q(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class J extends W{constructor(){super("TD"),q(this,"orderViews",new WeakMap),q(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new D(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,columnsToRender:e,rows:i,rowHeaders:n}=this.table;for(let l=0;l<t;l++){let t=this.table.renderedRowToSource(l),a=i.getRenderedNode(l);this.sourceRowIndex=t;let h=this.obtainOrderView(a),u=n.obtainOrderView(a);h.prependView(u).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let i=0;i<e;i++){h.render();let e=h.getCurrentNode(),n=this.table.renderedColumnToSource(i);if((0,r.pv)(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),(0,r.d$)(e,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(t,n,e),this.table.isAriaEnabled()){var o,s;(0,r.P$)(e,[...e.hasAttribute("role")?[]:[(0,V.Qz)()],(0,V.Qk)(-1),(0,V.yz)(n+(null!==(o=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==o?o:0)+1)])}}h.end()}}}function Q(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tt{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Q(this,"rootNode",void 0),Q(this,"rootDocument",void 0),Q(this,"rowHeaders",null),Q(this,"columnHeaders",null),Q(this,"colGroup",null),Q(this,"rows",null),Q(this,"cells",null),Q(this,"rowFilter",null),Q(this,"columnFilter",null),Q(this,"rowUtils",null),Q(this,"columnUtils",null),Q(this,"rowsToRender",0),Q(this,"columnsToRender",0),Q(this,"rowHeaderFunctions",[]),Q(this,"rowHeadersCount",0),Q(this,"columnHeaderFunctions",[]),Q(this,"columnHeadersCount",0),Q(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:i,rows:r,cells:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),i.setTable(this),r.setTable(this),n.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=i,this.rows=r,this.cells=n}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:t,rows:e}=this;for(let i=0;i<t;i++){let t=e.getRenderedNode(i);if(t.firstChild){let e=this.renderedRowToSource(i),r=this.rowUtils.getHeight(e);r?t.firstChild.style.height=`${r-1}px`:t.firstChild.style.height=""}}}}class te{constructor(){let{TABLE:t,THEAD:e,COLGROUP:i,TBODY:r,rowUtils:n,columnUtils:o,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new tt(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new U,columnHeaders:new $(e),colGroup:new X(i),rows:new Z(r),cells:new J}),this.renderer.setAxisUtils(n,o)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function ti(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function tr(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tn(t,e){var i=ts(t,e,"get");return i.get?i.get.call(t):i.value}function to(t,e,i){var r=ts(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ts(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var tl=new WeakMap,ta=new WeakMap,th=new WeakMap,tu=new WeakMap,tc=new WeakMap;class td{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:i,stretchingColumnWidthFn:r,columnWidthFn:n}=t;tr(this,"stretchAllRatio",0),tr(this,"stretchLastWidth",0),tr(this,"stretchAllColumnsWidth",[]),ti(this,tl,{writable:!0,value:0}),tr(this,"needVerifyLastColumnWidth",!0),ti(this,ta,{writable:!0,value:()=>0}),ti(this,th,{writable:!0,value:t=>t}),ti(this,tu,{writable:!0,value:t=>t}),ti(this,tc,{writable:!0,value:()=>"none"}),to(this,ta,e),to(this,tc,i),to(this,th,null!=r?r:tn(this,th)),to(this,tu,null!=n?n:tn(this,tu))}refreshStretching(t){if("none"===tn(this,tc).call(this))return;to(this,tl,t);let e=0;for(let i=0;i<tn(this,ta).call(this);i++){let r=this._getColumnWidth(i),n=tn(this,th).call(this,void 0,i);"number"==typeof n?t-=n:e+=r}let i=t-e;if("all"===tn(this,tc).call(this)&&i>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===tn(this,tc).call(this)&&t!==1/0){let t=this._getColumnWidth(tn(this,ta).call(this)-1),e=i+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let i=null;return"all"===tn(this,tc).call(this)&&0!==this.stretchAllRatio?i=this._getStretchedAllColumnWidth(t,e):"last"===tn(this,tc).call(this)&&0!==this.stretchLastWidth&&(i=this._getStretchedLastColumnWidth(t)),i}_getStretchedAllColumnWidth(t,e){let i=0;if(!this.stretchAllColumnsWidth[t]){let i=Math.round(e*this.stretchAllRatio),r=tn(this,th).call(this,i,t);void 0===r?this.stretchAllColumnsWidth[t]=i:this.stretchAllColumnsWidth[t]=isNaN(r)?this._getColumnWidth(t):r}if(this.stretchAllColumnsWidth.length===tn(this,ta).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)i+=this.stretchAllColumnsWidth[t];i!==tn(this,tl)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=tn(this,tl)-i)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===tn(this,ta).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=tn(this,tu).call(this,t);return isNaN(e)&&(e=td.DEFAULT_WIDTH),e}}function tf(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tg{constructor(t,e){tf(this,"dataAccessObject",void 0),tf(this,"wtSettings",void 0),tf(this,"headerWidths",new Map),tf(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new td({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t),i=this.stretching.getStretchedColumnWidth(t,e);return i&&(e=i),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==i&&(e=e?Math.max(e,i):i),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){let{wtTable:t,wtViewport:e,cloneSource:i}=this.dataAccessObject,n=i?i.wtTable.holder:t.holder,o=n.offsetHeight<n.scrollHeight?(0,r.np)():0;this.stretching.refreshStretching(e.getViewportWidth()-o)}calculateWidths(){let{wtSettings:t}=this,e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),null!=(e=t.getSetting("onModifyRowHeaderWidth",e))){let i=t.getSetting("rowHeaders").length,r=t.getSetting("defaultColumnWidth");for(let t=0;t<i;t++){let i=Array.isArray(e)?e[t]:e;i=null==i?r:i,this.headerWidths.set(t,i)}}}}function tm(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tp{constructor(t,e){tm(this,"dataAccessObject",void 0),tm(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t),i=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==i&&(e=void 0===e?i:Math.max(e,i)),e}}let tv="bottom",tw="inline_start",tb="top_inline_start_corner",ty="bottom_inline_start_corner",tS=["top",tv,tw,tb,ty],tC=new Map([["top","ht_clone_top"],[tv,`ht_clone_${tv}`],[tw,`ht_clone_${tw} ht_clone_left`],[tb,`ht_clone_${tb} ht_clone_top_left_corner`],[ty,`ht_clone_${ty} ht_clone_bottom_left_corner`]]);function tE(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tT{constructor(t,e,i,n,o){tE(this,"wtSettings",null),tE(this,"domBindings",void 0),tE(this,"TBODY",null),tE(this,"THEAD",null),tE(this,"COLGROUP",null),tE(this,"hasTableHeight",!0),tE(this,"hasTableWidth",!0),tE(this,"isTableVisible",!1),tE(this,"tableOffset",0),tE(this,"holderOffset",0),this.domBindings=i,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,(0,r.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new tp(this.dataAccessObject,this.wtSettings),this.columnUtils=new tg(this.dataAccessObject,this.wtSettings),this.tableRenderer=new te({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){let t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.pv)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",i&&i.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e,[(0,V.Rn)()]),e}createHider(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.pv)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",i&&i.insertBefore(e,t),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e,[(0,V.Rn)()]),e}createHolder(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.pv)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",i&&i.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e.parentNode,[(0,V.Rn)()])),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e,[(0,V.Rn)()]),e}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this,{wtOverlays:i,wtViewport:n}=this.dataAccessObject,o=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),l=e.getSetting("rowHeaders"),a=l.length,h=e.getSetting("columnHeaders"),u=h.length,c=!1,d=t;if(this.isMaster&&(this.holderOffset=(0,r.cv)(this.holder),d=n.createRenderCalculators(d),a&&!e.getSetting("fixedColumnsStart"))){let t=i.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(c=i.updateStateOfRendering()),d)this.isMaster&&n.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=(0,r.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let t=o>0?this.getFirstRenderedRow():0,e=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new x(t,o,u),this.columnFilter=new N(e,s,a);let i=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let t={};this.wtSettings.getSetting("beforeDraw",!0,t),i=!0!==t.skipRender}if(i){let t;if(this.tableRenderer.setHeaderContentRenderers(l,h),(this.is(tv)||this.is(ty))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(tv))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();let e=(0,r.iO)(this.hider),i=(0,r.iO)(this.TABLE);0!==e&&i!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(tv)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(f=i.bottomOverlay.resetFixedPosition()||f),f=i.inlineStartOverlay.resetFixedPosition()||f,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),c&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){let e,i,n;let o=this.columnFilter.renderedToSource(t),s=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,e=this.getColumnHeaderHeight(s),(i=this.getColumnHeader(o,s))&&(n=(0,r.WS)(i),(!e&&l<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=n),Array.isArray(a)?null!==a[s]&&void 0!==a[s]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(a[s]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]||a))}adjustColumnHeaderHeights(){let{wtSettings:t}=this,e=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=t.getSetting("columnHeaders");for(let t=0,n=r.length;t<n;t++)if(i[t]){if(!e[t]||0===e[t].childNodes.length)return;e[t].childNodes[0].style.height=`${i[t]}px`}}resetOversizedRows(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(tv))&&!t.getSetting("externalRowCalculator")){let t=this.getRenderedRowsCount();for(let i=0;i<t;i++){let t=this.rowFilter.renderedToSource(i);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,i=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,i);if(r&&Array.isArray(r)&&([e,i]=r),this.isRowBeforeRenderedRows(e))return -1;if(this.isRowAfterRenderedRows(e))return -2;if(this.isColumnBeforeRenderedColumns(i))return -3;if(this.isColumnAfterRenderedColumns(i))return -4;let n=this.getRow(e);if(!n&&e>=0)throw Error("TR was expected to be rendered but is not");let o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw Error("TD or TH was expected to be rendered but is not");return o}getRow(t){var e,i;let r=null,n=null;return t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(r=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),n=this.TBODY),void 0!==r&&void 0!==n&&!(n.childNodes.length<r+1)&&n.childNodes[r]}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.THEAD.childNodes[e];return null==i?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){let e=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(t=>{let r=t.childNodes[i];r&&e.push(r)}),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.wtSettings.getSetting("rowHeaders").length;if(e>=i)return;let r=this.rowFilter.sourceToRendered(t),n=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):r,o=r<0?this.THEAD:this.TBODY,s=o.childNodes[n];return null==s?void 0:s.childNodes[e]}getRowHeaders(t){let e=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){let i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],n=null==i?void 0:i.childNodes[r];n&&e.push(n)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,r.oq)(e,["TD","TH"])),null===e)return null;let i=e.parentNode,n=i.parentNode,o=(0,r.Kz)(i),s=e.cellIndex;if((0,r.mK)(tb,e,this.wtRootElement)||(0,r.mK)("top",e,this.wtRootElement))"THEAD"===n.nodeName&&(o-=n.childNodes.length);else if((0,r.mK)(ty,e,this.wtRootElement)||(0,r.mK)(tv,e,this.wtRootElement)){let t=this.wtSettings.getSetting("totalRows");o=t-n.childNodes.length+o}else o=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return s=(0,r.mK)(tb,e,this.wtRootElement)||(0,r.mK)(tw,e,this.wtRootElement)||(0,r.mK)(ty,e,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){let t,e,i,n,o;if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length,l=s*this.wtSettings.getSetting("defaultRowHeight"),a=(0,r.WS)(this.TBODY)-1;if(l!==a||this.wtSettings.getSetting("fixedRowsBottom"))for(;s;)s-=1,i=this.rowFilter.renderedToSource(s),t=this.getRowHeight(i),e=(o=(n=this.getTrForRow(i)).querySelector("th"))?(0,r.WS)(o):(0,r.WS)(n)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[i]=e)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;let e=this.wtSettings.getSetting("rowHeaders"),i=e.length;return Math.abs(t)<=i}isRowHeaderRendered(t){if(t>=0)return!1;let e=this.wtSettings.getSetting("columnHeaders"),i=e.length;return Math.abs(t)<=i}isRowBeforeRenderedRows(t){let e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){let e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,r.iO)(this.TABLE)}getHeight(){return(0,r.Pb)(this.TABLE)}getTotalWidth(){let t=(0,r.iO)(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){let t=(0,r.Pb)(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return(0,r.pn)(this.TABLE)}_modifyRowHeaderWidth(t){let e=(0,s.mf)(t)?t():null;return Array.isArray(e)?(e=[...e])[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var tR=tT,tO=i(9488);let tM={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,tO.jW)(tM,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});let tN={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,tO.jW)(tN,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});class tI extends tR{constructor(t,e,i,r){super(t,e,i,r,"top")}}(0,tO.jB)(tI,tM),(0,tO.jB)(tI,tN);var tx=i(6411);function tk(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tH{constructor(t){tk(this,"dataAccessObject",void 0),tk(this,"lastScrolledColumnPos",-1),tk(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,i,r,n){let o=this.scrollViewportHorizontally(t.col,i,n),s=this.scrollViewportVertically(t.row,e,r);return o||s}scrollViewportHorizontally(t,e,i){let{drawn:r,totalColumns:n}=this.dataAccessObject;if(!r||!Number.isInteger(t)||t<0||t>n)return!1;let o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn(),l=void 0===e&&void 0===i,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&t<a)return!1;let u=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===o?u=h.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<o||t>s)||!l)&&(u=h.scrollTo(t,l?t>s:e)),u&&(this.lastScrolledColumnPos=t),u}scrollViewportVertically(t,e,i){let{drawn:r,totalRows:n}=this.dataAccessObject;if(!r||!Number.isInteger(t)||t<0||t>n)return!1;let o=this.getFirstVisibleRow(),s=this.getLastVisibleRow(),l=void 0===e&&void 0===i,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:u}=this.dataAccessObject;if(l&&(t<h||t>n-a-1))return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===o?c=u.scrollTo(t,l?t>this.lastScrolledRowPos:i):(l&&(t<o||t>s)||!l)&&(c=u.scrollTo(t,l?t>s:i)),c&&(this.lastScrolledRowPos=t),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){let{topOverlay:t,wtTable:e,wtViewport:i,totalRows:n,rootWindow:o}=this.dataAccessObject,s=e.getLastVisibleRow();if(t.mainTableScrollableElement===o){let l=(0,r.cv)(e.wtRootElement),a=(0,r.cx)(o,o);if(l.top>a){let e=(0,r.WS)(o),h=i.getColumnHeaderHeight();for(let i=1;i<=n;i++)if(h+=t.sumCellSizes(i-1,i),l.top+h-a>=e){s=i-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){let{wtSettings:t,inlineStartOverlay:e,wtTable:i,wtViewport:n,totalColumns:o,rootWindow:s}=this.dataAccessObject,l=i.getLastVisibleColumn();if(e.mainTableScrollableElement===s){let a=t.getSetting("rtlMode"),h=null;if(a){let t=i.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,r=e.documentElement.offsetWidth;h=Math.abs(t.right-r)}else{let t=(0,r.cv)(i.wtRootElement);h=t.left}let u=Math.abs((0,r.vj)(s,s));if(h>u){let t=(0,r.x9)(s),i=n.getRowHeaderWidth();for(let r=1;r<=o;r++)if(h+(i+=e.sumCellSizes(r-1,r))-u>=t){l=r-2;break}}}return l}}var t_=i(1070),tA=i(1648);function tL(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tP{get eventManager(){return new n.Z(this)}constructor(t,e){tL(this,"wtTable",void 0),tL(this,"wtScroll",void 0),tL(this,"wtViewport",void 0),tL(this,"wtOverlays",void 0),tL(this,"selectionManager",void 0),tL(this,"wtEvent",void 0),tL(this,"guid",`wt_${(0,tx.O1)()}`),tL(this,"drawInterrupted",!1),tL(this,"drawn",!1),tL(this,"domBindings",void 0),tL(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new tH(this.createScrollDao())}findOriginalHeaders(){let t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;e<i;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,i){(0,r.tT)(i,t[e])}])}}createCellCoords(t,e){return new t_.Z(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,i){return new tA.Z(t,e,i,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);let i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<r&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=i-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);else if(t.row<i&&t.row>=i-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t);return this.wtTable.getCell(t)}scrollViewport(t,e,i,r,n){return!(t.col<0)&&!(t.row<0)&&this.wtScroll.scrollViewport(t,e,i,r,n)}scrollViewportHorizontally(t,e,i){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(v){t.drawn=v},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function tD(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tF extends tP{constructor(t,e,i){super(t,e),tD(this,"cloneSource",void 0),tD(this,"cloneOverlay",void 0);let r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Event(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}class tB{constructor(t,e,i,n,o){var s,l;(s="symbol"==typeof(l=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s="wtSettings","string"))?l:String(l))in this?Object.defineProperty(this,s,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[s]=null,(0,tO.jW)(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=e,this.wtSettings=n;let{TABLE:a,hider:h,spreader:u,holder:c,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=h,this.spreader=u,this.holder=c,this.wtRootElement=d,this.trimmingContainer=(0,r.$g)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){let t=this.needFullRender;this.needFullRender=this.shouldBeRendered();let e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,r.$g)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,r.dD)(t.TABLE)}getRelativeCellPosition(t,e,i){if(!1===this.clone.wtTable.holder.contains(t)){(0,z.ZK)(`The provided element is not a child of the ${this.type} overlay`);return}let r=this.mainTableScrollableElement===this.domBindings.rootWindow,n=i<this.wtSettings.getSetting("fixedColumnsStart"),o=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};return r?this.getRelativeCellPositionWithinWindow(o,n,h,a):this.getRelativeCellPositionWithinHolder(o,s,n,h,a)}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,i,n){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(e){let t=o.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(o.left+o.width+(0,r.np)())),s=t<=0?-1*t:0}else s=n.start;if(t){let t=this.clone.wtTable.TABLE.getBoundingClientRect();l=t.top-o.top}else l=n.top;return{start:i.start+s,top:i.top+l}}getRelativeCellPositionWithinHolder(t,e,i,r,n){let o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(i||(s=o.horizontal-n.start),e){let t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=o.vertical-n.top);return{start:r.start-s,top:r.top-l}}makeClone(){if(-1===tS.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:t,wtSettings:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),l=t.wtRootElement.parentNode;o.className=`${tC.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,e.getSetting("ariaTags")&&(0,r.P$)(o,[(0,V.Rn)()]),s.className=t.TABLE.className;let a=t.TABLE.getAttribute("role");a&&s.setAttribute("role",t.TABLE.getAttribute("role")),o.appendChild(s),l.appendChild(o);let h=this.wtSettings.getSetting("preventOverflow");return!0===h||"horizontal"===h&&"top"===this.type||"vertical"===h&&this.type===tw?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=(0,r.dD)(t.TABLE),new tF(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;let t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,i=t.style,r=e.style,n=t.parentNode.style;(0,R.Bk)([i,r,n],t=>{t.width="",t.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}let tW=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});class tV extends tB{constructor(t,e,i,r){var n,o;super(t,e,"top",i,r),(n="symbol"==typeof(o=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n="cachedFixedRowsTop","string"))?o:String(o))in this?Object.defineProperty(this,n,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[n]=-1,this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tI(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer!==e||i&&"vertical"===i)n=this.getScrollPosition(),(0,r.WH)(t);else{let{wtTable:e}=this.wot,i=e.hider.getBoundingClientRect(),s=Math.ceil(i.bottom),l=t.offsetHeight;o=s===l,n=this.getOverlayOffset(),(0,r.I2)(t,"0px",`${n}px`)}let s=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),s}setScrollPosition(t){let e=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo((0,r.DZ)(e),t),i=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultRowHeight"),r=t,n=0;for(;r<e;){let t=this.wot.wtTable.getRowHeight(r);n+=void 0===t?i:t,r+=1}return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:i}=this.domBindings,n=(0,r.np)(e),o=this.clone.wtTable.holder.parentNode,s=o.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===l){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),s.width=`${e}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=(0,r.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(tW.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let{wot:i,wtSettings:n}=this,o=i.cloneSource?i.cloneSource:i,s=o.wtTable.holder,l=this.getTableParentOffset(),a=0;if(e){let i=this.wot.wtTable.getRowHeight(t),r=this.wot.wtViewport.getViewportHeight();i>r&&(e=!1)}if(e&&s.offsetHeight!==s.clientHeight&&(a=(0,r.np)(this.domBindings.rootDocument)),e){let e=n.getSetting("fixedRowsBottom"),r=n.getSetting("totalRows");l+=this.sumCellSizes(0,t+1),l-=i.wtViewport.getViewportHeight()-this.sumCellSizes(r-e,r),l+=1}else l+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return l+=a,this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight();(i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?(0,r.IV)(i,"emptyColumns"):(0,r.cn)(i,"emptyColumns");let o=!1;if(!e){let e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,s=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&s.length>0){let e=(0,r.pv)(i,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?((0,r.cn)(i,"innerBorderTop"),o=!e):((0,r.IV)(i,"innerBorderTop"),o=e)}}return o}}let tj={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),i=t-e;return 0===t||0===e?-1:i<0?0:i},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,tO.jW)(tj,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});class tU extends tR{constructor(t,e,i,r){super(t,e,i,r,tv)}}(0,tO.jB)(tU,tj),(0,tO.jB)(tU,tN);class t$ extends tB{constructor(t,e,i,r){var n,o;super(t,e,tv,i,r),(n="symbol"==typeof(o=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n="cachedFixedRowsBottom","string"))?o:String(o))in this?Object.defineProperty(this,n,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[n]=-1,this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tU(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let i=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(i=this.getScrollPosition(),this.repositionOverlay()):(i=this.getOverlayOffset(),e.style.bottom=`${i}px`);let n=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),n}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,r.np)(i)),n.style.bottom=`${o}px`}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;return this.mainTableScrollableElement===e?(e.scrollTo((0,r.DZ)(e),t),i=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let{wtTable:i,wtSettings:r}=this.wot,n=r.getSetting("defaultRowHeight"),o=t,s=0;for(;o<e;){let t=i.getRowHeight(o);s+=void 0===t?n:t,o+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=(0,r.np)(i),s=this.clone.wtTable.holder.parentNode,l=s.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){let i=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(i-=o),i=Math.min(i,t.wtRootElement.scrollWidth),l.width=`${i}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let h=(0,r.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),l.height=`${h}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let i=this.getTableParentOffset(),n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,s=0;e&&o.offsetHeight!==o.clientHeight&&(s=(0,r.np)(this.domBindings.rootDocument)),e?(i+=this.sumCellSizes(0,t+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;(i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+t,0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders"),o=!1;if((i||0===e)&&n.length>0){let e=this.wot.wtTable.holder.parentNode,i=(0,r.pv)(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?((0,r.cn)(e,"innerBorderBottom"),o=!i):((0,r.IV)(e,"innerBorderBottom"),o=i)}return o}}let tz={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,tO.jW)(tz,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});let tG={getFirstRenderedColumn(){let t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,tO.jW)(tG,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});class tK extends tR{constructor(t,e,i,r){super(t,e,i,r,tw)}}(0,tO.jB)(tK,tz),(0,tO.jB)(tK,tG);class tX extends tB{constructor(t,e,i,r){super(t,e,tw,i,r)}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tK(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,i=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||n&&"horizontal"===n?(o=this.getScrollPosition(),(0,r.WH)(i)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,r.I2)(i,`${o}px`,"0px"));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,(0,r.AQ)(e)),i=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultColumnWidth"),r=t,n=0;for(;r<e;)n+=this.wot.wtTable.getStretchedColumnWidth(r)||i,r+=1;return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:i}=this.domBindings,n=(0,r.np)(e),o=this.clone.wtTable.holder.parentNode,s=o.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"vertical"===l){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),s.height=`${e}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;let a=(0,r.iO)(this.clone.wtTable.TABLE);s.width=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(tW.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style[e]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let i=this.getTableParentOffset(),n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,s=0;if(e){let i=this.wot.wtTable.getColumnWidth(t),r=this.wot.wtViewport.getViewportWidth();i>r&&(e=!1)}return e&&o.offsetWidth!==o.clientWidth&&(s=(0,r.np)(this.domBindings.rootDocument)),e?(i+=this.sumCellSizes(0,t+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),i+=s,this.setScrollPosition(i)}getTableParentOffset(){let t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs((0,r.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){i=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth();i>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=this.wot.wtTable.holder.parentNode,i=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),o=this.wtSettings.getSetting("totalRows");o?(0,r.IV)(e,"emptyRows"):(0,r.cn)(e,"emptyRows");let s=!1;if(n&&!i.length)(0,r.cn)(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&i.length){let i=(0,r.pv)(e,"innerBorderInlineStart");t?((0,r.cn)(e,"innerBorderLeft innerBorderInlineStart"),s=!i):((0,r.IV)(e,"innerBorderLeft innerBorderInlineStart"),s=i)}return s}}class tY extends tR{constructor(t,e,i,r){super(t,e,i,r,tb)}}function tZ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,tO.jB)(tY,tM),(0,tO.jB)(tY,tG);class tq extends tB{constructor(t,e,i,r,n,o){super(t,e,tb,i,r),tZ(this,"topOverlay",void 0),tZ(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tY(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();(0,r.I2)(t,`${e}px`,`${i}px`)}else(0,r.WH)(t);let e=(0,r.Pb)(this.clone.wtTable.TABLE),i=(0,r.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${i}px`,!1}}class tJ extends tR{constructor(t,e,i,r){super(t,e,i,r,ty)}}(0,tO.jB)(tJ,tj),(0,tO.jB)(tJ,tG);class tQ extends tB{constructor(t,e,i,r,n,o){super(t,e,ty,i,r),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tJ(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let t=this.inlineStartOverlay.getOverlayOffset(),i=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${i}px`}else(0,r.WH)(e),this.repositionOverlay();let i=(0,r.Pb)(this.clone.wtTable.TABLE),n=(0,r.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),e.style.height=`${i}px`,e.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,r.np)(i)),n.style.bottom=`${o}px`}}function t0(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t1{constructor(t,e,i,n,o,s){t0(this,"wot",null),t0(this,"topOverlay",null),t0(this,"bottomOverlay",null),t0(this,"inlineStartOverlay",null),t0(this,"topInlineStartCornerOverlay",null),t0(this,"bottomInlineStartCornerOverlay",null),t0(this,"browserLineHeight",void 0),t0(this,"wtSettings",null),t0(this,"resizeObserver",new ResizeObserver(t=>{(0,l.U7)(()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=n,this.domBindings=i,this.facadeGetter=e,this.wtTable=s;let{rootDocument:a,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=(0,r.np)(a);let u="hidden"===h.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=u?s.holder:(0,r.dD)(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){let{rootWindow:t,rootDocument:e}=this.domBindings,i=t.getComputedStyle(e.body),r=parseInt(i.lineHeight,10),n=1.2*parseInt(i.fontSize,10);this.browserLineHeight=r||n}initOverlays(){let t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new tV(...t),this.bottomOverlay=new t$(...t),this.inlineStartOverlay=new tX(...t),this.topInlineStartCornerOverlay=new tq(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new tQ(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let t;let{rootDocument:e,rootWindow:i}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",t=>this.onKeyDown(t)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",t=>this.onTableScroll(t),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",t=>this.onTableScroll(t),{passive:!0});let o=i.devicePixelRatio&&i.devicePixelRatio>1,s=this.scrollableElement===i,l=this.wtSettings.getSetting("preventWheel"),h={passive:s};(l||o||!(0,a.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",t=>this.onCloneWheel(t,l),h);let u=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];u.forEach(t=>{if(t&&t.needFullRender){let{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",t=>this.onCloneWheel(t,l),h)}}),this.eventManager.addEventListener(i,"resize",()=>{clearTimeout(t),t=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){let e=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,n=t.target;(!this.keyPressed||(r===e||n===e||t.target.contains(r))&&(i===e||n===e||t.target.contains(i)))&&this.syncScrollPositions(t)}onCloneWheel(t,e){let{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=t.target,s=n!==i&&o!==i&&!o.contains(n),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(s||l))return;let a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==i&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=(0,O.ot)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,i=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(i+=i*this.browserLineHeight,e+=e*this.browserLineHeight);let r=this.scrollVertically(e),n=this.scrollHorizontally(i);return r||n}scrollVertically(t){let e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){let e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==r||this.lastScrollX!==t.scrollX,this.verticalScrolling=i.scrollTop!==n||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=r;let t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){let t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:i}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=(0,r.dD)(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){let t=this.wtTable.spreader,e=t.clientWidth,i=t.clientHeight,r=e!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=i),r}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtViewport:e}=this.wot,{wtTable:i}=this,r=this.wtSettings.getSetting("totalColumns"),n=this.wtSettings.getSetting("totalRows"),o=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),l=i.hider.style;if(l.width=`${o+this.inlineStartOverlay.sumCellSizes(0,r)}px`,l.height=`${s+this.topOverlay.sumCellSizes(0,n)+1}px`,this.scrollbarSize>0){let{scrollHeight:t,scrollWidth:e}=i.wtRootElement,{scrollHeight:r,scrollWidth:n}=i.holder;this.hasScrollbarRight=t<r,this.hasScrollbarBottom=e<n,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;let e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return(0,R.Bk)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(i=e.clone)}),i}syncOverlayTableClassNames(){let t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,R.Bk)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}}function t2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t9{constructor(t){t2(this,"settings",{}),t2(this,"defaults",Object.freeze(this.getDefaults())),(0,tO._l)(this.defaults,(e,i)=>{if(void 0!==t[i])this.settings[i]=t[i];else if(void 0===e)throw Error(`A required setting "${i}" was not provided`);else this.settings[i]=e})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,i)=>{let n=this.getSetting("data",t,e);(0,r.tT)(i,null==n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?(0,tO._l)(t,(t,e)=>{this.settings[e]=t}):this.settings[t]=e,this}getSetting(t,e,i,r,n){return"function"==typeof this.settings[t]?this.settings[t](e,i,r,n):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class t4 extends tR{constructor(t,e,i,r){super(t,e,i,r,"master")}alignOverlaysWithTrimmingContainer(){let t=(0,r.$g)(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){let t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{let i=t.parentElement,n=(0,r.C2)(t,"height",e),o=(0,r.C2)(t,"overflow",e),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=t,h=t.offsetWidth,u=t.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){let n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?i.insertBefore(n,t.nextElementSibling):i.appendChild(n);let o=parseInt((0,r.Dx)(n,e).height,10);i.removeChild(n),0===o&&(u=0)}u=Math.min(u,a),s.height="auto"===n?"auto":`${u}px`,h=Math.min(h,l),s.width=`${h}px`,s.overflow="",this.hasTableHeight="auto"===s.height||u>0,this.hasTableWidth=h>0}this.isTableVisible=(0,r.pn)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,i="master",r=t.getSetting("columnHeaders"),n=r.length;if(n&&!e.hasOversizedColumnHeadersMarked[i]){let r=t.getSetting("rowHeaders"),o=r.length,s=this.getRenderedColumnsCount();for(let t=0;t<n;t++)for(let t=-1*o;t<s;t++)this.markIfOversizedColumnHeader(t);e.hasOversizedColumnHeadersMarked[i]=!0}}}(0,tO.jB)(t4,tz),(0,tO.jB)(t4,tN);var t8=i(746);function t7(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t3{constructor(t){t7(this,"count",0),t7(this,"startRow",0),t7(this,"endRow",0),t7(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}function t5(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function t6(t,e){var i=et(t,e,"get");return i.get?i.get.call(t):i.value}function et(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}i(3893);var ee=new WeakMap;class ei{static get DEFAULT_HEIGHT(){return 23}constructor(t){t5(this,"count",0),t5(this,"startRow",null),t5(this,"endRow",null),t5(this,"startPosition",null),t5(this,"isVisibleInTrimmingContainer",!1),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,ee),ee.set(this,{writable:!0,value:void 0}),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,et(this,ee,"set"),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:i,rowHeightFn:r,scrollOffset:n,totalRows:o,viewportHeight:s}=t6(this,ee),l=Math.max(t6(this,ee).scrollOffset,0),a=t6(this,ee).horizontalScrollbarHeight||0,h=0,u=!0,c=[],d=0,f=0;for(let i=0;i<o;i++)if(isNaN(t=r(i))&&(t=ei.DEFAULT_HEIGHT),h<=l&&e!==t8.vp&&(this.startRow=i,d=t),h>=l&&h+(e===t8.vp?t:0)<=l+s-a&&(null===this.startRow&&(this.startRow=i,d=t),this.endRow=i),c.push(h),h+=t,f=t,e!==t8.vp&&(this.endRow=i),h>=l+s-a){u=!1;break}let g=e===t8.vp?d:0,m=e===t8.vp?0:f;if(n+s-a<g||n>c.at(-1)+m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&u)for(this.startRow=this.endRow;this.startRow>0;){let i=c[this.endRow]+t-c[this.startRow-1];if((i<=s-a||e!==t8.vp)&&(this.startRow-=1),i>=s-a)break}e===t8.Ii&&null!==this.startRow&&i&&i(this),this.startPosition=c[this.startRow],void 0===this.startPosition&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function er(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class en{constructor(t){er(this,"count",0),er(this,"startColumn",0),er(this,"endColumn",0),er(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}var eo=i(7431);class es{constructor(t,e,i,r,n){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=i,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(e===this.domBindings.rootWindow)i=t.documentElement.clientHeight;else{let t=(0,r.Pb)(e);i=t>0&&e.clientHeight>0?e.clientHeight:1/0}return i}getWorkspaceWidth(){let t,e;let{wtSettings:i}=this,{rootDocument:n,rootWindow:o}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=n.documentElement.offsetWidth,a=i.getSetting("totalColumns"),h=i.getSetting("preventOverflow"),u=i.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),d=u?c.right-l:c.left,f=l-d;if(h)return(0,r.iO)(this.wtTable.wtRootElement);if(t=i.getSetting("freezeOverlays")?Math.min(f,l):Math.min(this.getContainerFillWidth(),f,l),s===o&&a>0&&this.sumColumnWidths(0,a-1)>t)return n.documentElement.clientWidth;if(s!==o&&("scroll"===(e=(0,r.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o))||"hidden"===e||"auto"===e))return Math.max(t,s.clientWidth);let g=i.getSetting("stretchH");return"none"!==g&&g?t:Math.max(t,(0,r.iO)(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let i=0,r=t;for(;r<e;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);let i=e.offsetWidth;return this.containerWidth=i,t.removeChild(e),i}getWorkspaceOffset(){return(0,r.cv)(this.wtTable.TABLE)}getColumnHeaderHeight(){let t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,r.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;let e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){let t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let i=0,r=e.length;i<r;i++)this.rowHeaderWidth+=t[i]||t}if(isNaN(this.rowHeaderWidth)){if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,n=e.length;i<n;i++)t?(this.rowHeaderWidth+=(0,r.iO)(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let t=this.getWorkspaceWidth();if(t===1/0)return t;let e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t8.Ii,{wtSettings:n,wtTable:o}=this;if(n.getSetting("renderAllRows")&&i===t8.Ii)return new t3({totalRows:n.getSetting("totalRows")});let s=this.getViewportHeight();this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,a=n.getSetting("fixedRowsTop"),h=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return a&&l>=0&&(l+=e=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s-=e),h&&this.dataAccessObject.bottomOverlay.clone&&(s-=e=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u)),t=o.holder.clientHeight===o.holder.offsetHeight?0:(0,r.np)(this.domBindings.rootDocument),new ei({viewportHeight:s,scrollOffset:l,totalRows:n.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:i,horizontalScrollbarHeight:t})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t8.Ii,{wtSettings:e,wtTable:i}=this;if(e.getSetting("renderAllColumns")&&t===t8.Ii)return new en({totalColumns:e.getSetting("totalColumns")});let n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=e.getSetting("fixedColumnsStart");if(s&&o>=0){let t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=t,n-=t}return i.holder.clientWidth!==i.holder.offsetWidth&&(n-=(0,r.np)(this.domBindings.rootDocument)),new eo.E({viewportWidth:n,scrollOffset:o,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>i.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){let e=this.createRowsCalculator(t8.vp);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){let e=this.createColumnsCalculator(t8.vp);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(t8.Ii),this.columnsRenderCalculator=this.createColumnsCalculator(t8.Ii)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(t8.vp),this.columnsVisibleCalculator=this.createColumnsCalculator(t8.vp)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:i,isVisibleInTrimmingContainer:r}=t;if(null===e&&null===i)return!r;let{startRow:n,endRow:o}=this.rowsRenderCalculator;return!(e<n)&&(e!==n||!(e>0))&&!(i>o||i===o&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:i,isVisibleInTrimmingContainer:r}=t;if(null===e&&null===i)return!r;let{startColumn:n,endColumn:o}=this.columnsRenderCalculator;return!(e<n)&&(e!==n||!(e>0))&&!(i>o||i===o&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){(0,tO._l)(this.hasOversizedColumnHeadersMarked,(t,e,i)=>{i[e]=void 0})}}function el(t,e,i){ea(t,e),e.set(t,i)}function ea(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eh(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function eu(t,e){var i=ed(t,e,"get");return i.get?i.get.call(t):i.value}function ec(t,e,i){var r=ed(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ed(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}i(921);var ef=new WeakMap,eg=new WeakMap,em=new WeakSet;class ep{constructor(){ea(this,em),em.add(this),el(this,ef,{writable:!0,value:void 0}),el(this,eg,{writable:!0,value:void 0})}setActiveOverlay(t){return ec(this,eg,t),this}setActiveSelection(t){return ec(this,ef,t),this}scan(){let t=eu(this,ef).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"area"===t?this.scanCellsRange(t=>e.add(t)):"focus"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t)),this.scanCellsRange(t=>e.add(t))):"fill"===t?this.scanCellsRange(t=>e.add(t)):"header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"row"===t?(this.scanRowsInHeadersRange(t=>e.add(t)),this.scanRowsInCellsRange(t=>e.add(t))):"column"===t&&(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanColumnsInCellsRange(t=>e.add(t))),e}scanColumnsInHeadersRange(t){let[e,i,r,n]=eu(this,ef).getCorners(),{wtTable:o}=eu(this,eg),s=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount(),a=0;for(let h=-o.getRowHeadersCount();h<s;h++){let s=o.columnFilter.renderedToSource(h);if(!(s<i)&&!(s>n)){for(let h=-l;h<0;h++){if(h<e||h>r)continue;let u=h+l,c=o.getColumnHeader(s,u),d=eu(this,eg).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:eu(this,ef).settings.selectionType,columnCursor:a,selectionWidth:n-i+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,u)),t(c))}a+=1}}}scanRowsInHeadersRange(t){let[e,i,r,n]=eu(this,ef).getCorners(),{wtTable:o}=eu(this,eg),s=o.getRenderedRowsCount(),l=o.getRowHeadersCount(),a=0;for(let h=-o.getColumnHeadersCount();h<s;h++){let s=o.rowFilter.renderedToSource(h);if(!(s<e)&&!(s>r)){for(let h=-l;h<0;h++){if(h<i||h>n)continue;let u=h+l,c=o.getRowHeader(s,u),d=eu(this,eg).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:eu(this,ef).settings.selectionType,rowCursor:a,selectionHeight:r-e+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,u)),t(c))}a+=1}}}scanCellsRange(t){let[e,i,n,o]=eu(this,ef).getCorners(),{wtTable:s}=eu(this,eg);eh(this,em,ev).call(this,(l,a)=>{if(l>=e&&l<=n&&a>=i&&a<=o){let e=s.getCell(eu(this,eg).createCellCoords(l,a)),i=eu(this,eg).getSetting("onAfterDrawSelection",l,a,eu(this,ef).settings.layerLevel);"string"==typeof i&&(0,r.cn)(e,i),t(e)}})}scanRowsInCellsRange(t){let[e,,i]=eu(this,ef).getCorners(),{wtTable:r}=eu(this,eg);eh(this,em,ev).call(this,(n,o)=>{if(n>=e&&n<=i){let e=r.getCell(eu(this,eg).createCellCoords(n,o));t(e)}})}scanColumnsInCellsRange(t){let[,e,,i]=eu(this,ef).getCorners(),{wtTable:r}=eu(this,eg);eh(this,em,ev).call(this,(n,o)=>{if(o>=e&&o<=i){let e=r.getCell(eu(this,eg).createCellCoords(n,o));t(e)}})}}function ev(t){let{wtTable:e}=eu(this,eg),i=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let n=0;n<i;n+=1){let i=e.rowFilter.renderedToSource(n);for(let n=0;n<r;n+=1)t(i,e.columnFilter.renderedToSource(n))}}class ew{constructor(t,e){if(!e)return;this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=tW,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners()}registerListeners(){let t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){let e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),(0,o.mM)(t);let i=this,r=this.wot.rootDocument.body,n=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",function t(o){(function(t){if(t.clientY<Math.floor(n.top)||t.clientY>Math.ceil(n.top+n.height)||t.clientX<Math.floor(n.left)||t.clientX>Math.ceil(n.left+n.width))return!0})(o)&&(i.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")})}createBorders(t){let{rootDocument:e}=this.wot;this.main=e.createElement("div");let i=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let n=0;n<5;n++){let o=i[n],s=e.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(r=s.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color,r.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,r.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,a.K1)()&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:n}=this.wot,o=n.bordersHolder;o||((o=e.createElement("div")).className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let e={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,tO._l)(e,(t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t});let i={position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};(0,tO._l)(i,(t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){let i=this.wot.selectionManager.getAreaSelection();return!!i.cellRange&&(t!==i.cellRange.to.row||e!==i.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,i,r,n,o){let s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",{top:a,topHitArea:h,bottom:u,bottomHitArea:c}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),f=parseInt(a.width,10),g=parseInt(h.width,10),m=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();a.top=`${parseInt(i-f-1,10)}px`,a[l]=`${parseInt(r-f-1,10)}px`,h.top=`${parseInt(i-g/4*3,10)}px`,h[l]=`${parseInt(r-g/4*3,10)}px`;let w=Math.min(parseInt(r+n,10),m-f-2*d),b=Math.min(parseInt(r+n-g/4,10),m-g-2*d);u[l]=`${w}px`,c[l]=`${b}px`;let y=Math.min(parseInt(i+o,10),p-f-2*d),S=Math.min(parseInt(i+o-g/4,10),p-g-2*d);u.top=`${y}px`,c.top=`${S}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",h.display="block",this.isPartRange(t,e)?(u.display="none",c.display="none"):(u.display="block",c.display="block")):(a.display="none",u.display="none",h.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",h.zIndex="9999"):(a.zIndex="",h.zIndex="")}appear(t){let e,i,n,o,s,l;if(this.disabled)return;let{wtTable:h,rootDocument:u,rootWindow:c}=this.wot,d=h.getRenderedRowsCount();for(let i=0;i<d;i+=1){let r=h.rowFilter.renderedToSource(i);if(r>=t[0]&&r<=t[2]){e=r,s=t[0];break}}for(let e=d-1;e>=0;e-=1){let r=h.rowFilter.renderedToSource(e);if(r>=t[0]&&r<=t[2]){i=r;break}}let f=h.getRenderedColumnsCount();for(let e=0;e<f;e+=1){let i=h.columnFilter.renderedToSource(e);if(i>=t[1]&&i<=t[3]){n=i,l=t[1];break}}for(let e=f-1;e>=0;e-=1){let i=h.columnFilter.renderedToSource(e);if(i>=t[1]&&i<=t[3]){o=i;break}}if(void 0===e||void 0===n){this.disappear();return}let g=h.getCell(this.wot.createCellCoords(e,n)),m=e!==i||n!==o,p=m?h.getCell(this.wot.createCellCoords(i,o)):g,w=(0,r.cv)(g),b=m?(0,r.cv)(p):w,y=(0,r.cv)(h.TABLE),S=(0,r.iO)(h.TABLE),C=w.top,E=w.left,T=this.wot.wtSettings.getSetting("rtlMode"),R=0,O=0;if(T){let t=(0,r.iO)(g),e=c.innerWidth-y.left-S;O=E+t-b.left,R=c.innerWidth-E-t-e-1}else O=b.left+(0,r.iO)(p)-E,R=E-y.left-1;if(this.isEntireColumnSelected(e,i)){let t=this.getDimensionsFromHeader("columns",n,o,s,y),e=null;t&&([e,R,O]=t),e&&(g=e)}let M=C-y.top-1,N=b.top+(0,r.Pb)(p)-C;if(this.isEntireRowSelected(n,o)){let t=this.getDimensionsFromHeader("rows",e,i,l,y),r=null;t&&([r,M,N]=t),r&&(g=r)}let I=(0,r.Dx)(g,c);parseInt(I.borderTopWidth,10)>0&&(M+=1,N=N>0?N-1:0),parseInt(I[T?"borderRightWidth":"borderLeftWidth"],10)>0&&(R+=1,O=O>0?O-1:0);let x=T?"right":"left";this.topStyle.top=`${M}px`,this.topStyle[x]=`${R}px`,this.topStyle.width=`${O}px`,this.topStyle.display="block",this.startStyle.top=`${M}px`,this.startStyle[x]=`${R}px`,this.startStyle.height=`${N}px`,this.startStyle.display="block";let k=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${M+N-k}px`,this.bottomStyle[x]=`${R}px`,this.bottomStyle.width=`${O}px`,this.bottomStyle.display="block",this.endStyle.top=`${M}px`,this.endStyle[x]=`${R+O-k}px`,this.endStyle.height=`${N+1}px`,this.endStyle.display="block";let H=this.settings.border.cornerVisible;H="function"==typeof H?H(this.settings.layerLevel):H;let _=this.wot.getSetting("onModifyGetCellCoords",i,o),[A,L]=[i,o];if(_&&Array.isArray(_)&&([,,A,L]=_),(0,a.K1)()||!H||this.isPartRange(A,L))this.cornerStyle.display="none";else{this.cornerStyle.top=`${M+N+this.cornerCenterPointOffset-1}px`,this.cornerStyle[x]=`${R+O+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=(0,r.$g)(h.TABLE),e=t===c;e&&(t=u.documentElement);let n=parseInt(this.cornerDefaultStyle.width,10)/2,s=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){let i=e?p.getBoundingClientRect().left:p.offsetLeft;(T?i-parseInt(this.cornerDefaultStyle.width,10)/2<0:i+(0,r.iO)(p)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,r.x9)(t))&&(this.cornerStyle[x]=`${Math.floor(R+O+this.cornerCenterPointOffset-n)}px`,this.cornerStyle[T?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){let i=e?p.getBoundingClientRect().top:p.offsetTop,n=i+(0,r.Pb)(p)+parseInt(this.cornerDefaultStyle.height,10)/2,o=n>=(0,r.WS)(t);o&&(this.cornerStyle.top=`${Math.floor(M+N+this.cornerCenterPointOffset-s)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}(0,a.K1)()&&this.updateMultipleSelectionHandlesPosition(i,o,M,R,O,N)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,i,n,o){let{wtTable:s}=this.wot,l=s.wtRootElement.parentNode,a=null,h=null,u=null,c=null,d=null,f=null,g=null,m=null;switch(t){case"rows":a=function(){return s.getRowHeader(...arguments)},h=function(){return(0,r.Pb)(...arguments)},u="ht__selection--rows",f="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},h=function(){return(0,r.iO)(...arguments)},u="ht__selection--columns",f="left"}if(l.classList.contains(u)){let t=this.wot.getSetting("columnHeaders").length;if(g=a(e,t-n),m=a(i,t-n),!g||!m)return!1;let s=(0,r.cv)(g),l=(0,r.cv)(m);return g&&m&&(c=s[f]-o[f]-1,d=l[f]+h(m)-s[f]),[g,c,d]}return!1}changeBorderStyle(t,e){let i=this[t].style,n=e[t];!n||n.hide?(0,r.cn)(this[t],"hidden"):((0,r.pv)(this[t],"hidden")&&(0,r.IV)(this[t],"hidden"),i.backgroundColor=n.color,("top"===t||"bottom"===t)&&(i.height=`${n.width}px`),("start"===t||"end"===t)&&(i.width=`${n.width}px`))}changeBorderToDefaultStyle(t){let e={width:1,color:"#000"},i=this[t].style;i.backgroundColor=e.color,i.width=`${e.width}px`,i.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?(0,r.cn)(this[t],"hidden"):(0,r.IV)(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,a.K1)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function eb(t,e,i){ey(t,e),e.set(t,i)}function ey(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eS(t,e){var i=eE(t,e,"get");return i.get?i.get.call(t):i.value}function eC(t,e,i){var r=eE(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function eE(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var eT=new WeakMap,eR=new WeakMap,eO=new WeakMap,eM=new WeakMap,eN=new WeakMap,eI=new WeakMap,ex=new WeakSet;class ek{constructor(t){ey(this,ex),ex.add(this),eb(this,eT,{writable:!0,value:void 0}),eb(this,eR,{writable:!0,value:void 0}),eb(this,eO,{writable:!0,value:new ep}),eb(this,eM,{writable:!0,value:new WeakMap}),eb(this,eN,{writable:!0,value:new WeakSet}),eb(this,eI,{writable:!0,value:new Map}),eC(this,eR,t)}setActiveOverlay(t){return eC(this,eT,t),eS(this,eO).setActiveOverlay(eS(this,eT)),eS(this,eM).has(eS(this,eT))||eS(this,eM).set(eS(this,eT),new Set),this}getFocusSelection(){return null!==eS(this,eR)?eS(this,eR).getFocus():null}getAreaSelection(){return null!==eS(this,eR)?eS(this,eR).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(eS(this,eI).has(t)){let e=eS(this,eI).get(t);if(e.has(eS(this,eT)))return e.get(eS(this,eT));let i=new ew(eS(this,eT),t.settings);return e.set(eS(this,eT),i),i}let e=new ew(eS(this,eT),t.settings);return eS(this,eI).set(t,new Map([[eS(this,eT),e]])),e}getBorderInstances(t){var e,i;return Array.from(null!==(e=null===(i=eS(this,eI).get(t))||void 0===i?void 0:i.values())&&void 0!==e?e:[])}destroyBorders(t){eS(this,eI).get(t).forEach(t=>t.destroy()),eS(this,eI).delete(t)}render(t){if(null===eS(this,eR))return;t&&(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,ex,eH).call(this);let e=Array.from(eS(this,eR)),i=new Map,n=new Map;for(let t=0;t<e.length;t++){let r=e[t],{className:o,headerAttributes:s,createLayers:l,selectionType:a}=r.settings;eS(this,eN).has(r)||(eS(this,eN).add(r),r.addLocalHook("destroy",()=>this.destroyBorders(r)));let h=this.getBorderInstance(r);if(r.isEmpty()){null==h||h.disappear();continue}if(o){let t=eS(this,eO).setActiveSelection(r).scan();t.forEach(t=>{if(i.has(t)){let e=i.get(t);e.has(o)&&!0===l?e.set(o,e.get(o)+1):e.set(o,1)}else i.set(t,new Map([[o,1]]));s&&(n.has(t)||n.set(t,[]),"TH"===t.nodeName&&n.get(t).push(...s))})}let u=r.getCorners();eS(this,eT).getSetting("onBeforeDrawBorders",u,a),null==h||h.appear(u)}i.forEach((t,e)=>{var i;let n=Array.from(t).map(t=>{let[e,i]=t;return 1===i?e:[e,...Array.from({length:i-1},(t,i)=>`${e}-${i+1}`)]}).flat();n.forEach(t=>eS(this,eM).get(eS(this,eT)).add(t)),(0,r.cn)(e,n),"TD"===e.nodeName&&Array.isArray(null===(i=eS(this,eR).options)||void 0===i?void 0:i.cellAttributes)&&(0,r.P$)(e,eS(this,eR).options.cellAttributes)}),Array.from(n.keys()).forEach(t=>{(0,r.P$)(t,[...n.get(t)])})}}function eH(){let t=eS(this,eM).get(eS(this,eT)),e=eS(this,eT).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let i=0;i<e.length;i++)t.add(e[i]);t.forEach(t=>{var e,i;let n=eS(this,eT).wtTable.TABLE.querySelectorAll(`.${t}`),o=[];Array.isArray(null===(e=eS(this,eR).options)||void 0===e?void 0:e.cellAttributes)&&(o=eS(this,eR).options.cellAttributes.map(t=>t[0])),Array.isArray(null===(i=eS(this,eR).options)||void 0===i?void 0:i.headerAttributes)&&(o=[...o,...eS(this,eR).options.headerAttributes.map(t=>t[0])]);for(let e=0,i=n.length;e<i;e++)(0,r.IV)(n[e],t),(0,r.d$)(n[e],o)}),t.clear()}class e_ extends tP{constructor(t,e){super(t,new t9(e));let i=this.wtSettings.getSetting("facade",this);this.wtTable=new t4(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new es(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new ek(this.wtSettings.getSetting("selections")),this.wtEvent=new Event(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new t1(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let t=[],e=[];(0,tO._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(i,r)=>{this.wtSettings.getSetting(r).length&&e.push(i),t.push(i)}),(0,r.IV)(this.wtTable.wtRootElement.parentNode,t),(0,r.cn)(this.wtTable.wtRootElement.parentNode,e)}getViewportDao(){let t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class eA{constructor(t){t instanceof tP?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{let e=new eA(t);return()=>e},this._wot=new e_(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,i){return this._wot.createCellRange(t,e,i)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,i,r,n){return this._wot.scrollViewport(t,e,i,r,n)}scrollViewportHorizontally(t,e,i){return this._wot.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return this._wot.scrollViewportVertically(t,e,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,i,r,n){return this._wot.wtSettings.getSetting(t,e,i,r,n)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function eL(t){let{isShiftKey:e,isLeftClick:i,isRightClick:r,coords:n,selection:o,controller:s,cellCoordsFactory:l}=t,a=o.isSelected()?o.getSelectedRange().current():null,h=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(e&&a)n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(n):(h||u)&&n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(l(n.row,n.col)):h&&n.row<0&&!s.column?o.setRangeEnd(l(a.to.row,n.col)):u&&n.col<0&&!s.row?o.setRangeEnd(l(n.row,a.to.col)):(!h&&!u&&n.col<0||h&&n.col<0)&&!s.row?o.selectRows(Math.max(a.from.row,0),n.row,n.col):(!h&&!u&&n.row<0||u&&n.row<0)&&!s.column&&o.selectColumns(Math.max(a.from.col,0),n.col,n.row);else{let t=!o.inInSelection(n),e=i||r&&t;n.row<0&&n.col>=0&&!s.column?e&&o.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?e&&o.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?e&&o.setRangeStart(n):n.col<0&&n.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}let eP=new Map([["mousedown",eL],["mouseover",function(t){let{isLeftClick:e,coords:i,selection:r,controller:n,cellCoordsFactory:o}=t;if(!e)return;let s=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),a=r.tableProps.countCols(),h=r.tableProps.countRows();l&&!n.column?r.setRangeEnd(o(h-1,i.col)):s&&!n.row?r.setRangeEnd(o(i.row,a-1)):n.cell||r.setRangeEnd(i)}],["touchstart",eL]]);function eD(t,e){let{coords:i,selection:r,controller:n,cellCoordsFactory:s}=e;eP.get(t.type)({coords:i,selection:r,controller:n,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:(0,o.pW)(t)||"touchstart"===t.type,isRightClick:(0,o.dO)(t)})}var eF=i(3732);function eB(t,e){eV(t,e),e.add(t)}function eW(t,e,i){eV(t,e),e.set(t,i)}function eV(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ej(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eU(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function e$(t,e){var i=eG(t,e,"get");return i.get?i.get.call(t):i.value}function ez(t,e,i){var r=eG(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function eG(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var eK=new WeakMap,eX=new WeakMap,eY=new WeakMap,eZ=new WeakMap,eq=new WeakMap,eJ=new WeakMap,eQ=new WeakMap,e0=new WeakSet,e1=new WeakSet;class e2{constructor(t){eB(this,e1),eB(this,e0),ej(this,"hot",void 0),ej(this,"eventManager",void 0),ej(this,"settings",void 0),ej(this,"THEAD",void 0),ej(this,"TBODY",void 0),ej(this,"_wt",void 0),ej(this,"activeWt",void 0),eW(this,eK,{writable:!0,value:0}),eW(this,eX,{writable:!0,value:0}),ej(this,"postponedAdjustElementsSize",!1),eW(this,eY,{writable:!0,value:!1}),eW(this,eZ,{writable:!0,value:void 0}),eW(this,eq,{writable:!0,value:void 0}),eW(this,eJ,{writable:!0,value:0}),eW(this,eQ,{writable:!0,value:0}),this.hot=t,this.eventManager=new n.Z(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){let i=this._wt.getCell(t,e);return i<0?null:i}scrollViewport(t,e,i,r,n){return this._wt.scrollViewport(t,e,i,r,n)}scrollViewportHorizontally(t,e,i){return this._wt.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return this._wt.scrollViewportVertically(t,e,i)}createElements(){let{rootElement:t,rootDocument:e}=this.hot,i=t.getAttribute("style");i&&t.setAttribute("data-originalstyle",i),(0,r.cn)(t,"handsontable"),ez(this,eq,e.createElement("TABLE")),(0,r.cn)(e$(this,eq),"htCore"),this.hot.getSettings().tableClassName&&(0,r.cn)(e$(this,eq),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,r.P$)(e$(this,eq),[(0,V.Rn)()]),(0,r.P$)(t,[(0,V.nO)(),(0,V.a2)(-1),(0,V.Wv)(this.hot.countCols()),(0,V.qt)()])),this.THEAD=e.createElement("THEAD"),e$(this,eq).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),e$(this,eq).appendChild(this.TBODY),this.hot.table=e$(this,eq),this.hot.container.insertBefore(e$(this,eq),this.hot.container.firstChild)}registerEvents(){let{rootElement:t,rootDocument:e,selection:i}=this.hot,n=e.documentElement;this.eventManager.addEventListener(t,"mousedown",t=>{if(ez(this,eY,!0),!this.isTextSelectionAllowed(t.target)){let{rootWindow:e}=this.hot;(0,r.a7)(e),t.preventDefault(),e.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{ez(this,eY,!1)}),this.eventManager.addEventListener(t,"mousemove",t=>{e$(this,eY)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&(0,r.a7)(this.hot.rootWindow),t.preventDefault())}),this.eventManager.addEventListener(n,"keyup",t=>{i.isInProgress()&&!t.shiftKey&&i.finish()}),this.eventManager.addEventListener(n,"mouseup",n=>{i.isInProgress()&&(0,o.pW)(n)&&i.finish(),ez(this,eZ,!1);let s=(0,r.pV)(e.activeElement);(!(0,r.u7)(e.activeElement)||s)&&(!s&&(i.isSelected()||i.isSelectedByAnyHeader()||t.contains(n.target)||(0,o.dO)(n))||this.hot.unlisten())}),this.eventManager.addEventListener(n,"contextmenu",t=>{i.isInProgress()&&(0,o.dO)(t)&&(i.finish(),ez(this,eZ,!1))}),this.eventManager.addEventListener(n,"touchend",()=>{i.isInProgress()&&i.finish(),ez(this,eZ,!1)}),this.eventManager.addEventListener(n,"mousedown",i=>{let o=i.target,s=i.x||i.clientX,l=i.y||i.clientY,a=i.target;if(e$(this,eZ)||!t||!this.hot.view)return;let{holder:h}=this.hot.view._wt.wtTable;if(a===h){let t=(0,r.np)(e);if(e.elementFromPoint(s+t,l)!==h||e.elementFromPoint(s,l+t)!==h)return}else for(;a!==n;){if(null===a){if(i.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}let u="function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(o):this.settings.outsideClickDeselects;u?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e$(this,eq),"selectstart",t=>{this.settings.fragmentSelection||(0,r.u7)(t.target)||t.preventDefault()})}translateFromRenderableToVisualCoords(t){let{row:e,col:i}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,i))}translateFromRenderableToVisualIndex(t,e){let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===i&&(i=t),null===r&&(r=e),[i,r]}countRenderableIndexes(t,e){let i=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(i-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,i,r){if(isNaN(t)||t<0)return 0;let n=i.getNearestNotHiddenIndex(t,e),o=i.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let s=0;return e<0?s=o+1:e>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){let t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){let t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){let t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}countRenderableRowsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){let t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){let t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:e$(this,eq),isDataViewInstance:()=>(0,eF._v)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let t=[];return this.hot.hasRowHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(i,e)}),this.hot.runHooks("afterGetRowHeaderRenderers",t),ez(this,eX,t.length),this.hot.getSettings().ariaTags&&eU(this,e0,e9).call(this)===this.hot.countCols()&&eU(this,e1,e4).call(this,e$(this,eX)),t},columnHeaders:()=>{let t=[];return this.hot.hasColHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(i,e)}),this.hot.runHooks("afterGetColumnHeaderRenderers",t),ez(this,eK,t.length),t},columnWidth:t=>{let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{let e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,i)=>{let[r,n]=this.translateFromRenderableToVisualIndex(t,e),o=this.hot.runHooks("modifyGetCellCoords",r,n),s=r,l=n;Array.isArray(o)&&([s,l]=o);let a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l),u=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,a)),this.hot.runHooks("beforeRenderer",i,r,n,h,u,a),this.hot.getCellRenderer(a)(this.hot,i,r,n,h,u,a),this.hot.runHooks("afterRenderer",i,r,n,h,u,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,r.pn)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,ez(this,eZ,!0),this.hot.runHooks("beforeOnCellMouseDown",t,n,i,s),(0,o.Ty)(t)||(eD(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,n,i),this.activeWt=this._wt)},onCellContextMenu:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,ez(this,eZ,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,n,i),(0,o.Ty)(t)||(this.hot.runHooks("afterOnCellContextMenu",t,n,i),this.activeWt=this._wt)},onCellMouseOut:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",t,n,i),(0,o.Ty)(t)||(this.hot.runHooks("afterOnCellMouseOut",t,n,i),this.activeWt=this._wt)},onCellMouseOver:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",t,n,i,s),(0,o.Ty)(t)||(e$(this,eZ)&&eD(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,n,i),this.activeWt=this._wt)},onCellMouseUp:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",t,n,i),(0,o.Ty)(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,n,i),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{let e=this.hot.rowIndexMapper,i=t<0,r=t;return i||null!==(r=e.getVisualFromRenderableIndex(t))?(r=this.hot.runHooks("beforeViewportScrollVertically",r),this.hot.runHooks("beforeViewportScroll"),i)?r:e.getRenderableFromVisualIndex(r):t},onBeforeViewportScrollHorizontally:t=>{let e=this.hot.columnIndexMapper,i=t<0,r=t;return i||null!==(r=e.getVisualFromRenderableIndex(t))?(r=this.hot.runHooks("beforeViewportScrollHorizontally",r),this.hot.runHooks("beforeViewportScroll"),i)?r:e.getRenderableFromVisualIndex(r):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,i)=>{let r=this.hot.rowIndexMapper,n=t<0,o=t;n||(o=r.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingRowHeader",o,e,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,i)=>{let r=this.hot.columnIndexMapper,n=t<0,o=t;n||(o=r.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingColumnHeader",o,e,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,i)=>{let r;let[n,o]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange(),l=s.size();if(l>0){let t=s.peekByIndex(null!=i?i:0);r=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",n,o,r,i)},onBeforeDrawBorders:(t,e)=>{let[i,r,n,o]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{let i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,i)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,i)=>{let r=this.hot.rowIndexMapper,n=this.hot.columnIndexMapper,o=e>=0?n.getVisualFromRenderableIndex(e):e,s=t>=0?r.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,o,i);if(Array.isArray(l)){let[t,e,i,o]=l;return[t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t,e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,i>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1)):i,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){let i=this.countRenderableRows(),r=t.startRow,n=t.endRow;if("number"==typeof e)t.startRow=Math.max(r-e,0),t.endRow=Math.min(n+e,i-1);else if("auto"===e){let e=Math.ceil(n/i*12);t.startRow=Math.max(r-e,0),t.endRow=Math.min(n+e,i-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){let i=this.countRenderableColumns(),r=t.startColumn,n=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(n+e,i-1)),"auto"===e){let e=Math.ceil(n/i*6);t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(n+e,i-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new eA(t),this.activeWt=this._wt;let e=this._wt.wtTable.spreader,{width:i,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,n),this.eventManager.addEventListener(e,"mousedown",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(e,"contextmenu",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(t){if((0,r.u7)(t))return!0;let e=(0,r.MO)(t,this.hot.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return e$(this,eZ)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){let t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){let i=e.firstChild;if(!(0,r.pv)(i,"relative")){(0,r.cS)(e),this.appendRowHeader(t,e);return}this.updateCellHeader(i.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{let{rootDocument:i,getRowHeader:r}=this.hot,n=i.createElement("div"),o=i.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,t,r),n.appendChild(o),e.appendChild(n)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){let o=e.firstChild;(0,r.pv)(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,i,n):((0,r.cS)(e),this.appendColHeader(t,e,i,n))}else{let{rootDocument:o}=this.hot,s=o.createElement("div"),l=o.createElement("span");s.className="relative",l.className="colHeader",this.settings.ariaTags&&((0,r.P$)(s,...(0,V.Rn)()),(0,r.P$)(l,...(0,V.Rn)())),this.updateCellHeader(l,t,i,n),s.appendChild(l),e.appendChild(s)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&((0,r.pv)(t,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(e):(0,r.pv)(t,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(e))),o>-1?(0,r.uS)(t,i(e,n)):((0,r.tT)(t,String.fromCharCode(160)),(0,r.cn)(t,"cornerHeader"))}maximumVisibleElementWidth(t){let e=this._wt.wtViewport.getWorkspaceWidth(),i=e-t;return i>0?i:0}maximumVisibleElementHeight(t){let e=this._wt.wtViewport.getWorkspaceHeight(),i=e-t;return i>0?i:0}setLastSize(t,e){ez(this,eJ,t),ez(this,eQ,e)}getLastSize(){return{width:e$(this,eJ),height:e$(this,eQ)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return e$(this,eK)}getRowHeadersCount(){return e$(this,eX)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function e9(){return parseInt(this.hot.rootElement.getAttribute((0,V.Wv)()[0]),10)}function e4(t){let e=eU(this,e0,e9).call(this)+t;(0,r.P$)(this.hot.rootElement,...(0,V.Wv)(e))}var e8=e2},9291:function(t,e,i){"use strict";i.d(e,{d:function(){return P}}),i(2954);var r=i(9440),n=i(6301),o=i(7362),s=i(5724);class l extends n.n{constructor(){super(t=>t)}insert(t,e){let i=(0,s.X)(this.indexedValues,e);this.indexedValues=(0,o.S)(i,t,e),super.insert(t,e)}remove(t){let e=(0,o.t)(this.indexedValues,t);this.indexedValues=(0,s.i)(e,t),super.remove(t)}}var a=i(7392),h=i(537),u=i(5843),c=i(6592);let d=new Map([["hiding",a.o],["index",n.n],["linkedPhysicalIndexToValue",h.A],["physicalIndexToValue",u.L],["trimming",c.n]]);i(2916);var f=i(2518),g=i(9488),m=i(3437);let p=0;class w{constructor(){var t,e,i;t="collection",e=new Map,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",()=>this.runLocalHooks("change",e)),p+=1)}unregister(t){let e=this.collection.get(t);(0,f.$K)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),p-=1)}unregisterAll(){this.collection.forEach((t,e)=>this.unregister(e)),this.collection.clear()}get(t){return(0,f.o8)(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,e){this.collection.forEach(i=>{i.insert(t,e)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}function b(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,g.jB)(w,m.Z);class y extends w{constructor(t,e){super(),b(this,"mergedValuesCache",[]),b(this,"aggregationFunction",void 0),b(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];let e=(0,r.Sc)(this.get(),t=>t.getValues()),i=[],n=(0,f.$K)(e[0])&&e[0].length||0;for(let t=0;t<n;t+=1){let r=[];for(let i=0;i<this.getLength();i+=1)r.push(e[i][t]);i.push(r)}return(0,r.Sc)(i,this.aggregationFunction)}getMergedValueAtIndex(t,e){let i=this.getMergedValues(e)[t];return(0,f.$K)(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function S(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var C=new WeakMap;class E{constructor(){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,C),C.set(this,{writable:!0,value:[]})}subscribe(t){var e;return this.addLocalHook("change",t),this._write((e=S(this,C,"get")).get?e.get.call(this):e.value),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){!function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,S(this,C,"set"),t)}}function T(t,e){let i=[],r=0,n=0;for(;r<t.length&&n<e.length;r++,n++)t[r]!==e[n]&&i.push({op:"replace",index:n,oldValue:t[r],newValue:e[n]});for(;r<e.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;n<t.length;n++)i.push({op:"remove",index:n,oldValue:t[n],newValue:void 0});return i}function R(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function O(t,e){var i=N(t,e,"get");return i.get?i.get.call(t):i.value}function M(t,e,i){var r=N(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function N(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}(0,g.jB)(E,m.Z);var I=new WeakMap,x=new WeakMap,k=new WeakMap,H=new WeakMap,_=new WeakMap;class A{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(this,I,{writable:!0,value:new Set}),R(this,x,{writable:!0,value:[]}),R(this,k,{writable:!0,value:[]}),R(this,H,{writable:!0,value:!1}),R(this,_,{writable:!0,value:!1}),M(this,_,null!=t&&t)}createObserver(){let t=new E;return O(this,I).add(t),t.addLocalHook("unsubscribe",()=>{O(this,I).delete(t)}),t._writeInitialChanges(T(O(this,x),O(this,k))),t}emit(t){let e=O(this,k);O(this,H)&&O(this,x).length===t.length||(0===t.length?t=Array(e.length).fill(O(this,_)):M(this,x,Array(t.length).fill(O(this,_))),O(this,H)||(M(this,H,!0),e=O(this,x)));let i=T(e,t);O(this,I).forEach(t=>t._write(i)),M(this,k,t)}}function L(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P{constructor(){L(this,"indexesSequence",new l),L(this,"trimmingMapsCollection",new y(t=>t.some(t=>!0===t),!1)),L(this,"hidingMapsCollection",new y(t=>t.some(t=>!0===t),!1)),L(this,"variousMapsCollection",new w),L(this,"hidingChangesObservable",new A({initialIndexValue:!1})),L(this,"notTrimmedIndexesCache",[]),L(this,"notHiddenIndexesCache",[]),L(this,"isBatched",!1),L(this,"indexesSequenceChanged",!1),L(this,"indexesChangeSource",void 0),L(this,"trimmedIndexesChanged",!1),L(this,"hiddenIndexesChanged",!1),L(this,"renderablePhysicalIndexesCache",[]),L(this,"fromPhysicalToVisualIndexesCache",new Map),L(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",t=>{this.runLocalHooks("change",t,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,i){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!d.has(t))throw Error(`The provided map type ("${t}") does not exist.`);return new(d.get(t))(e)}(e,i))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof c.n?this.trimmingMapsCollection.register(t,e):e instanceof a.o?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);let i=this.getNumberOfIndexes();return i>0&&e.init(i),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){let e=this.notTrimmedIndexesCache[t];return(0,f.$K)(e)?e:null}getPhysicalFromRenderableIndex(t){let e=this.renderablePhysicalIndexesCache[t];return(0,f.$K)(e)?e:null}getVisualFromPhysicalIndex(t){let e=this.fromPhysicalToVisualIndexesCache.get(t);return(0,f.$K)(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){let e=this.fromVisualToRenderableIndexesCache.get(t);return(0,f.$K)(e)?e:null}getNearestNotHiddenIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(t);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;let n=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return -1===(o=e>0?n.findIndex(e=>e>t):n.reverse().findIndex(e=>e<t))?i?this.getNearestNotHiddenIndex(t,-e,!1):null:n[o]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(t).keys()],this.notHiddenIndexesCache=[...Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){let e=this.getNumberOfIndexes();if(t<e){let e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t);this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;let e=this.getIndexesSequence();return e.filter(t=>!1===this.isTrimmed(t))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.notHiddenIndexesCache;let e=this.getIndexesSequence();return e.filter(t=>!1===this.isHidden(t))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;let e=this.getNotTrimmedIndexes();return e.filter(t=>!1===this.isHidden(t))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);let i=(0,r.Sc)(t,t=>this.getPhysicalFromVisualIndex(t)),n=this.getNotTrimmedIndexesLength(),s=t.length,l=(0,o.t)(this.getIndexesSequence(),i),a=l.filter(t=>!1===this.isTrimmed(t)),h=l.indexOf(a[a.length-1])+1;if(e+s<n){let t=a[e];h=l.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence((0,o.S)(l,h,i)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){let i=this.getNotTrimmedIndexes()[t],n=(0,f.$K)(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=(0,r.Sc)(Array(e).fill(n),(t,e)=>t+e);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){let t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromRenderableIndex(e),i=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(i,e)}}}(0,g.jB)(P,m.Z)},7392:function(t,e,i){"use strict";i.d(e,{o:function(){return o}}),i(2916);var r=i(5843),n=i(9440);class o extends r.L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return(0,n.k$)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}},6301:function(t,e,i){"use strict";i.d(e,{n:function(){return a}}),i(2916),i(2954);var r=i(7790),n=i(9488),o=i(8179),s=i(3437);function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,"indexedValues",[]),l(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){let e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,o.mf)(this.initValueOrFn)?(0,r.q4)(t-1,t=>this.indexedValues.push(this.initValueOrFn(t))):(0,r.q4)(t-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,n.jB)(a,s.Z)},537:function(t,e,i){"use strict";i.d(e,{A:function(){return a}}),i(2954);var r=i(6301),n=i(1825),o=i(7362),s=i(5724),l=i(8179);class a extends r.n{constructor(){var t,e,i;super(...arguments),e=[],(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="orderOfIndexes","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}getValues(){return this.orderOfIndexes.map(t=>this.indexedValues[t])}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(i,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=(0,o.t)(this.orderOfIndexes,[t]),(0,l.mf)(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=(0,n.S)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=(0,s.X)(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=(0,n.t)(this.indexedValues,t),this.orderOfIndexes=(0,o.t)(this.orderOfIndexes,t),this.orderOfIndexes=(0,s.i)(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map(t=>[t,this.getValueAtIndex(t)])}}},5843:function(t,e,i){"use strict";i.d(e,{L:function(){return o}});var r=i(6301),n=i(1825);class o extends r.n{insert(t,e){this.indexedValues=(0,n.S)(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=(0,n.t)(this.indexedValues,t),super.remove(t)}}},6592:function(t,e,i){"use strict";i.d(e,{n:function(){return o}}),i(2916);var r=i(5843),n=i(9440);class o extends r.L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return(0,n.k$)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}},5724:function(t,e,i){"use strict";i.d(e,{X:function(){return o},i:function(){return n}});var r=i(9440);function n(t,e){return(0,r.Sc)(t,t=>t-e.filter(e=>e<t).length)}function o(t,e){let i=e[0],n=e.length;return(0,r.Sc)(t,t=>t>=i?t+n:t)}},7362:function(t,e,i){"use strict";i.d(e,{S:function(){return n},t:function(){return o}});var r=i(9440);function n(t,e,i){return[...t.slice(0,e),...i,...t.slice(e)]}function o(t,e){return(0,r.w7)(t,t=>!1===e.includes(t))}},1825:function(t,e,i){"use strict";i.d(e,{S:function(){return o},t:function(){return s}});var r=i(8179),n=i(9440);function o(t,e,i,n){let o=i.length?i[0]:void 0;return[...t.slice(0,o),...i.map((t,e)=>(0,r.mf)(n)?n(t,e):n),...void 0===o?[]:t.slice(o)]}function s(t,e){return(0,n.w7)(t,(t,i)=>!1===e.includes(i))}},2488:function(t,e,i){"use strict";i.d(e,{I:function(){return o}}),i(2954);var r=i(8179);let n=t=>`The id '${t}' is already declared in a map.`;function o(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Map;function i(){return[...e]}function o(t){return e.has(t)}return t=(0,r.mf)(t)?t:n,{addItem:function(i,r){if(o(i))throw Error(t(i));e.set(i,r)},clear:function(){e.clear()},getId:function(t){let[e]=i().find(e=>{let[i,r]=e;return t===r&&i})||[null];return e},getItem:function(t){return e.get(t)},getItems:i,hasItem:o,removeItem:function(t){return e.delete(t)}}}},491:function(t,e,i){"use strict";i.d(e,{M:function(){return n}});var r=i(7790);function n(t){let{initialPage:e=-1,size:i=()=>0,onItemSelect:n=()=>{},onClear:o=()=>{}}=t,s=new Set,l=(0,r.uZ)(e,-1,h()-1);function a(t,e){let i=h()-1;if(t<0&&(t=i),t>i&&(t=0),s.has(t))return -1;s.add(t);let r=n(t,!1);return!1===r&&(t=a(1===e?++t:--t,e)),t}function h(){return Math.max(i(),0)}return{setCurrentPage:function(t){t>-1&&t<h()&&!1!==n(t,!0)&&(l=t)},getCurrentPage:function(){return l},toFirstItem:function(){h()>0&&(s.clear(),l=a(0,1))},toLastItem:function(){h()>0&&(s.clear(),l=a(h()-1,-1))},toNextItem:function(){h()>0&&(s.clear(),l=a(++l,1))},toPreviousItem:function(){h()>0&&(s.clear(),l=a(--l,-1))},getSize:h,clear:function(){s.clear(),l=e,o()}}}},4350:function(t,e,i){"use strict";i.d(e,{BU:function(){return a},bt:function(){return l},vo:function(){return s}}),i(2916);var r=i(2518);let n={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},o=RegExp(Object.keys(n).map(t=>`(${t})`).join("|"),"gi");function s(t){let e=t.hasColHeaders(),i=t.hasRowHeaders(),n=[e?-1:0,i?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...n),s=o.length,l=s>0?o[0].length:0,a=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=i?1:0,d=e?1:0;for(let n=0;n<s;n+=1){let s=e&&0===n,a=[];for(let e=0;e<l;e+=1){let l=!s&&i&&0===e,h="";if(s)h=`<th>${t.getColHeader(e-c)}</th>`;else if(l)h=`<th>${t.getRowHeader(n-d)}</th>`;else{let i=o[n][e],{hidden:s,rowspan:l,colspan:a}=t.getCellMeta(n-d,e-c);if(!s){let t=[];if(l&&t.push(`rowspan="${l}"`),a&&t.push(`colspan="${a}"`),(0,r.xb)(i))h=`<td ${t.join(" ")}></td>`;else{let e=i.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");h=`<td ${t.join(" ")}>${e}</td>`}}}a.push(h)}let f=["<tr>",...a,"</tr>"].join("");s?h.splice(1,0,f):u.splice(-1,0,f)}return a.splice(1,0,h.join(""),u.join("")),a.join("")}function l(t){let e=t.length,i=["<table>"];for(let n=0;n<e;n+=1){let o=t[n],s=o.length,l=[];0===n&&i.push("<tbody>");for(let t=0;t<s;t+=1){let e=o[t],i=(0,r.xb)(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;");l.push(`<td>${i}</td>`)}i.push("<tr>",...l,"</tr>"),n+1===e&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function a(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},s=i.createDocumentFragment(),l=i.createElement("div");s.appendChild(l);let a=t;if("string"==typeof a){let t=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,t=>{let e=t.match(/<td\b[^>]*?>/g)[0],i=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${e}${i}</td>`});l.insertAdjacentHTML("afterbegin",`${t}`),a=l.querySelector("table")}if(!a||"TABLE"!==((e=a)&&e.nodeName||""))return;let h=l.querySelector('meta[name$="enerator"]'),u=null!==a.querySelector("tbody th"),c=a.querySelector("tr"),d=c?Array.from(c.cells).reduce((t,e)=>t+e.colSpan,0)-(u?1:0):0,f=a.tFoot&&Array.from(a.tFoot.rows)||[],g=[],m=!1,p=0,w=0;if(a.tHead){let t=Array.from(a.tHead.rows).filter(t=>{let e=null!==t.querySelector("td");return e&&g.push(t),!e});m=(p=t.length)>0,p>1?r.nestedHeaders=Array.from(t).reduce((t,e)=>{let i=Array.from(e.cells).reduce((t,e,i)=>{if(u&&0===i)return t;let{colSpan:r,innerHTML:n}=e;return t.push(r>1?{label:n,colspan:r}:n),t},[]);return t.push(i),t},[]):m&&(r.colHeaders=Array.from(t[0].children).reduce((t,e,i)=>(u&&0===i||t.push(e.innerHTML),t),[]))}g.length&&(r.fixedRowsTop=g.length),f.length&&(r.fixedRowsBottom=f.length);let b=[...g,...Array.from(a.tBodies).reduce((t,e)=>(t.push(...Array.from(e.rows)),t),[]),...f];w=b.length;let y=Array(w);for(let t=0;t<w;t++)y[t]=Array(d);let S=[],C=[];for(let t=0;t<w;t++){let e=b[t],i=Array.from(e.cells),r=i.length;for(let e=0;e<r;e++){let r=i[e],{nodeName:s,innerHTML:l,rowSpan:a,colSpan:u}=r,c=y[t].findIndex(t=>void 0===t);if("TD"===s){if(a>1||u>1){for(let e=t;e<t+a;e++)if(e<w)for(let t=c;t<c+u;t++)y[e][t]=null;let e=r.getAttribute("style"),i=e&&e.includes("mso-ignore:colspan");i||S.push({col:c,row:t,rowspan:a,colspan:u})}let e="";e=h&&/excel/gi.test(h.content)?l.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):l.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),y[t][c]=e.replace(o,t=>n[t])}else C.push(l)}}return S.length&&(r.mergeCells=S),C.length&&(r.rowHeaders=C),y.length&&(r.data=y),r}},3732:function(t,e,i){"use strict";i.d(e,{IU:function(){return o},_v:function(){return l},dU:function(){return s},mc:function(){return n}});let r=new WeakMap,n=Symbol("rootInstance");function o(t){r.set(t,!0)}function s(t){return t===n}function l(t){return r.has(t)}},2656:function(t,e,i){"use strict";i.d(e,{Z:function(){return n}});let r=new Map;function n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";r.has(t)||r.set(t,new Map);let e=r.get(t);return{register:function(t,i){e.set(t,i)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}},2740:function(t,e,i){"use strict";i.d(e,{Ie:function(){return u},Te:function(){return h},oh:function(){return s}}),i(2954);var r=i(2656);let{register:n,getItem:o,hasItem:s,getNames:l,getValues:a}=(0,r.Z)("validators");function h(t){if("function"==typeof t)return t;if(!s(t))throw Error(`No registered validator found under "${t}" name`);return o(t)}function u(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),n(t,e)}}}]);