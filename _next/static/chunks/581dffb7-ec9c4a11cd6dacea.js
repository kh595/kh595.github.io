"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[66],{3553:function(e,t,o){o.r(t),o.d(t,{default:function(){return B}}),o(2916),o(2954),o(9910);var r=o(5878),n=o(8179),l=o(2518),i=o(2228),s=o(4692),a=o(9773),u=o(9488),c=o(8407),d=o(9440),h=o(4350),f=o(5915),g=o(6903),m=o(7416),p=o(2740),w=o(6411),C=o(7790),y=o(2036),v=o(3891),R=o(7628),S=o(9291),b=o(3732),H=o(7431),A=o(4317),E=o(8444),I=o(1870),_=o(641),M=o(2230),x=o(243),k=o(45),T=o(7830),D=o(8435),V=o(2488),L=o(9949),P=o(9366);let N=null,F=new Map;function B(e,t){let o,B,j,O,K;var Q,$=this;let W=arguments.length>2&&void 0!==arguments[2]&&arguments[2],z=!1,q=this,U=new a.Z(q),Z=!0;(0,b.hasValidParameter)(W)&&(0,b.registerAsRootInstance)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let G=null!==(Q=null==t?void 0:t.layoutDirection)&&void 0!==Q?Q:"inherit",Y=["rtl","ltr"].includes(G)?G:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",Y),this.isRtl=function(){return"rtl"===Y},this.isLtr=function(){return!q.isRtl()},this.getDirectionFactor=function(){return q.isLtr()?1:-1},t.language=(0,E.getValidLanguageCode)(t.language);let J=new M.Z(q,t,[x.$,k._]),X=J.getTableMeta(),ee=J.getGlobalMeta(),et=(0,V.I)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,b.isRootInstance)(this)&&(0,l.ge)(t.licenseKey,e),this.guid=`ht_${(0,w.O1)()}`,F.set(this.guid,this),this.columnIndexMapper=new S.d,this.rowIndexMapper=new S.d,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{q.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{q.runHooks("afterRowSequenceChange",e)}),B=new v.Z(q),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let eo=new _.Z(X,{rowIndexMapper:q.rowIndexMapper,columnIndexMapper:q.columnIndexMapper,countCols:()=>q.countCols(),countRows:()=>q.countRows(),propToCol:e=>o.propToCol(e),isEditorOpened:()=>!!q.getActiveEditor()&&q.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>q.getShortcutManager(),createCellCoords:(e,t)=>q._createCellCoords(e,t),createCellRange:(e,t,o)=>q._createCellRange(e,t,o),visualToRenderableCoords:e=>{let{row:t,col:o}=e;return q._createCellCoords(t>=0?q.rowIndexMapper.getRenderableFromVisualIndex(t):t,o>=0?q.columnIndexMapper.getRenderableFromVisualIndex(o):o)},renderableToVisualCoords:e=>{let{row:t,col:o}=e;return q._createCellCoords(t>=0?q.rowIndexMapper.getVisualFromRenderableIndex(t):t,o>=0?q.columnIndexMapper.getVisualFromRenderableIndex(o):o)},isDisabledCellSelection:(e,t)=>e<0||t<0?q.getSettings().disableVisualSelection:q.getCellMeta(e,t).disableVisualSelection});this.selection=eo;let er=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.refresh()};function en(e,t){let o="className"===e?q.rootElement:q.table;if(Z)(0,r.cn)(o,t);else{let n=[],l=[];ee[e]&&(n=Array.isArray(ee[e])?ee[e]:(0,d.W7)(ee[e])),t&&(l=Array.isArray(t)?t:(0,d.W7)(t));let i=(0,d.o0)(n,l),s=(0,d.o0)(l,n);i.length&&(0,r.IV)(o,i),s.length&&(0,r.cn)(o,s)}ee[e]=t}function el(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function ei(e,t,n){if(!e.length)return;let l=q.getActiveEditor(),i=new el,s=!0;i.onQueueEmpty=e=>{l&&s&&l.cancelChanges(),n(e)};for(let n=e.length-1;n>=0;n--){let[l,a,,u]=e[n],c=o.propToCol(a),d=q.getCellMeta(l,c);"numeric"===d.type&&"string"==typeof u&&(0,C.TR)(u)&&(e[n][3]=function(e){let t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}(u)),q.getCellValidator(d)&&(i.addValidatorToQueue(),q.validateCell(e[n][3],d,function(t,o){return function(n){if("boolean"!=typeof n)throw Error("Validation error: result is not boolean");if(!1===n&&!1===o.allowInvalid){s=!1,e.splice(t,1),o.valid=!0;let n=q.getCell(o.visualRow,o.visualCol);null!==n&&(0,r.IV)(n,X.invalidCellClassName)}i.removeValidatorFormQueue()}}(n,d),t))}i.checkIfQueueIsEmpty()}function es(e,t){let r=e.length-1;if(r<0)return;for(;r>=0;r--){let n=!1;if(null===e[r]){e.splice(r,1);continue}if(null!==e[r][2]&&void 0!==e[r][2]||null!==e[r][3]&&void 0!==e[r][3]){if(X.allowInsertRow)for(;e[r][0]>q.countRows()-1;){let{delta:e}=o.createRow(void 0,void 0,{source:t});if(0===e){n=!0;break}}if("array"===q.dataType&&(!X.columns||0===X.columns.length)&&X.allowInsertColumn)for(;o.propToCol(e[r][1])>q.countCols()-1;){let{delta:e}=o.createCol(void 0,void 0,{source:t});if(0===e){n=!0;break}}n||o.set(e[r][0],e[r][1],e[r][3])}}q.forceFullRender=!0,j.adjustRowsAndCols(),q.runHooks("beforeChangeRender",e,t),O.lockEditor(),q._refreshBorders(null),O.unlockEditor(),q.view.adjustElementsSize(),q.runHooks("afterChange",e,t||"edit");let n=q.getActiveEditor();n&&(0,l.$K)(n.refreshValue)&&n.refreshValue()}function ea(e,t,o){return Array.isArray(e)?e:[[e,t,o]]}function eu(e,t){let o=q.getActiveEditor(),r=q.runHooks("beforeChange",e,t||"edit"),n=e.filter(e=>null!==e);return!1===r||0===n.length?(o&&o.cancelChanges(),[]):n}this.columnIndexMapper.addLocalHook("cacheUpdated",er),this.rowIndexMapper.addLocalHook("cacheUpdated",er),this.selection.addLocalHook("afterSetRangeEnd",e=>{let t=(0,u.sm)(!1),o=this.selection.getSelectedRange(),{from:n,to:l}=o.current(),i=o.size()-1;this.runHooks("afterSelection",n.row,n.col,l.row,l.col,t,i),this.runHooks("afterSelectionByProp",n.row,q.colToProp(n.col),l.row,q.colToProp(l.col),t,i);let s=!0;z&&(s=!1),t.isTouched()&&(s=!t.value);let a=this.selection.selectedRange.current(),c=this.selection.isSelectedByAnyHeader(),d=this.selection.isSelectedByRowHeader(),h=this.selection.isSelectedByColumnHeader();if(!1!==s){if(c)d?this.scrollViewportTo({row:e.row}):h&&this.scrollViewportTo({col:e.col});else if(a&&!this.selection.isMultiple()){let{row:e,col:t}=a.from;e<0&&t>=0?this.scrollViewportTo({col:t}):t<0&&e>=0?this.scrollViewportTo({row:e}):this.scrollViewportTo({row:e,col:t})}else this.scrollViewportTo(e.toObject())}d&&h?(0,r.cn)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):d?((0,r.IV)(this.rootElement,"ht__selection--columns"),(0,r.cn)(this.rootElement,"ht__selection--rows")):h?((0,r.IV)(this.rootElement,"ht__selection--rows"),(0,r.cn)(this.rootElement,"ht__selection--columns")):(0,r.IV)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",e=>{let t=e.length-1,{from:o,to:r}=e[t];this.runHooks("afterSelectionEnd",o.row,o.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",o.row,q.colToProp(o.col),r.row,q.colToProp(r.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{let t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{O.destroyEditor(),this._refreshBorders(),(0,r.IV)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("afterSelectRows",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return $.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),j={alter(e,t){var r,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=e=>{if(0===e.length)return[];let t=[...e];t.sort((e,t)=>{let[o]=e,[r]=t;return o===r?0:o>r?1:-1});let o=(0,d.k$)(t,(e,t)=>{let[o,r]=t,n=e[e.length-1],[l,i]=n,s=l+i;if(o<=s){let e=Math.max(r-(s-o),0);n[1]+=e}else e.push([o,r]);return e},[t[0]]);return o};switch(e){case"insert_row_below":case"insert_row_above":let c=q.countSourceRows();if(X.maxRows===c)return;let h="insert_row_below"===e?"below":"above";t=null!==(r=t)&&void 0!==r?r:"below"===h?c:0;let{delta:f,startPhysicalIndex:g}=o.createRow(t,i,{source:s,mode:h});if(f){let e=eo.selectedRange.current(),t=null==e?void 0:e.from,o=null==t?void 0:t.row,r=q.toVisualRow(g);if(eo.isSelectedByCorner())eo.selectAll(!0,!0,{disableHeadersHighlight:!0});else if((0,l.$K)(o)&&o>=r){let{row:r,col:n}=e.to,l=t.col;eo.isSelectedByRowHeader()&&(l=-1),eo.getSelectedRange().pop(),eo.setRangeStartOnly(q._createCellCoords(o+f,l),!0),eo.setRangeEnd(q._createCellCoords(r+f,n))}else q._refreshBorders()}break;case"insert_col_start":case"insert_col_end":let m="insert_col_end"===e?"end":"start";t=null!==(n=t)&&void 0!==n?n:"end"===m?q.countSourceCols():0;let{delta:p,startPhysicalIndex:w}=o.createCol(t,i,{source:s,mode:m});if(p){if(Array.isArray(X.colHeaders)){let e=[q.toVisualColumn(w),0];e.length+=p,Array.prototype.splice.apply(X.colHeaders,e)}let e=eo.selectedRange.current(),t=null==e?void 0:e.from,o=null==t?void 0:t.col,r=q.toVisualColumn(w);if(eo.isSelectedByCorner())eo.selectAll(!0,!0,{disableHeadersHighlight:!0});else if((0,l.$K)(o)&&o>=r){let{row:r,col:n}=e.to,l=t.row;eo.isSelectedByColumnHeader()&&(l=-1),eo.getSelectedRange().pop(),eo.setRangeStartOnly(q._createCellCoords(l,o+p),!0),eo.setRangeEnd(q._createCellCoords(r,n+p))}else q._refreshBorders()}break;case"remove_row":let C=e=>{let t=0;(0,d.Bk)(e,e=>{let[r,n]=e,i=(0,l.xb)(r)?q.countRows()-1:Math.max(r-t,0);Number.isInteger(r)&&(r=Math.max(r-t,0));let a=o.removeRow(r,n,s);if(!a)return;let u=q.countRows(),c=X.fixedRowsTop;c>=i+1&&(X.fixedRowsTop-=Math.min(n,c-i));let d=X.fixedRowsBottom;d&&i>=u-d&&(X.fixedRowsBottom-=Math.min(n,d)),t+=n})};Array.isArray(t)?C(u(t)):C([[t,i]]),j.adjustRowsAndCols(),q._refreshBorders();break;case"remove_col":let y=e=>{let t=0;(0,d.Bk)(e,e=>{let[r,n]=e,i=(0,l.xb)(r)?q.countCols()-1:Math.max(r-t,0),a=q.toPhysicalColumn(i);Number.isInteger(r)&&(r=Math.max(r-t,0));let u=o.removeCol(r,n,s);if(!u)return;let c=X.fixedColumnsStart;c>=i+1&&(X.fixedColumnsStart-=Math.min(n,c-i)),Array.isArray(X.colHeaders)&&(void 0===a&&(a=-1),X.colHeaders.splice(a,n)),t+=n})};Array.isArray(t)?y(u(t)):y([[t,i]]),j.adjustRowsAndCols(),q._refreshBorders();break;default:throw Error(`There is no such action "${e}"`)}a||j.adjustRowsAndCols()},adjustRowsAndCols(){let e=X.minRows,t=X.minSpareRows,r=X.minCols,n=X.minSpareCols;if(0===q.countRows()&&0===q.countCols()&&eo.deselect(),e){let t=q.countRows();t<e&&o.createRow(t,e-t,{source:"auto"})}if(t){let e=q.countEmptyRows(!0);if(e<t){let r=Math.min(t-e,X.maxRows-q.countSourceRows());o.createRow(q.countRows(),r,{source:"auto"})}}{let e;(r||n)&&(e=q.countEmptyCols(!0));let t=q.countCols();if(r&&!X.columns&&t<r){let n=r-t;e+=n,o.createCol(t,n,{source:"auto"})}if(n&&!X.columns&&"array"===q.dataType&&e<n){t=q.countCols();let r=n-e,l=Math.min(r,X.maxCols-t);o.createCol(t,l,{source:"auto"})}}if(eo.isSelected()){let e=q.countRows(),t=q.countCols();(0,d.Bk)(eo.selectedRange,o=>{let r=!1,n=o.from.row,l=o.from.col,i=o.to.row,s=o.to.col;n>e-1?(r=!0,i>(n=e-1)&&(i=n)):i>e-1&&(r=!0,n>(i=e-1)&&(n=i)),l>t-1?(r=!0,s>(l=t-1)&&(s=l)):s>t-1&&(r=!0,l>(s=t-1)&&(l=s)),r&&(l<0?q.selectRows(n,i,l):n<0?q.selectColumns(l,s,n):q.selectCell(n,l,i,s))})}q.view&&q.view.adjustElementsSize()},populateFromArray(e,t,o,r,n){let l,i,s,a,c;let h=[],f={},g=[],m=e.row,p=e.col;if(0===(i=t.length))return!1;let w=0,C=0;switch((0,u.Kn)(o)&&(w=o.col-p+1,C=o.row-m+1),n){case"shift_down":let y=(0,d.jz)(t),v=y.length,R=Math.max(v,w),S=q.getData().slice(m),b=(0,d.jz)(S).slice(p,p+R);for(s=0;s<R;s+=1)if(s<v){for(l=0,i=y[s].length;l<C-i;l+=1)y[s].push(y[s][l%i]);s<b.length?g.push(y[s].concat(b[s])):g.push(y[s].concat(Array(S.length).fill(null)))}else g.push(y[s%v].concat(b[s]));q.populateFromArray(m,p,(0,d.jz)(g));break;case"shift_right":let H=t.length,A=Math.max(H,C),E=q.getData().slice(m).map(e=>e.slice(p));for(l=0;l<A;l+=1)if(l<H){for(s=0,a=t[l].length;s<w-a;s+=1)t[l].push(t[l][s%a]);if(l<E.length)for(let e=0;e<E[l].length;e+=1)t[l].push(E[l][e]);else t[l].push(...Array(E[0].length).fill(null))}else t.push(t[l%i].slice(0,A).concat(E[l]));q.populateFromArray(m,p,t);break;default:f.row=e.row,f.col=e.col;let I=0,_=0,M=!0,x=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==o?r[o%r.length]:r},k=t.length,T=o?o.row-e.row+1:0;for(l=0,i=o?T:Math.max(k,T);l<i&&!(o&&f.row>o.row&&T>k||!X.allowInsertRow&&f.row>q.countRows()-1)&&!(f.row>=X.maxRows);l++){let t=l-I,n=x(t).length,d=o?o.col-e.col+1:0;if(a=o?d:Math.max(n,d),f.col=e.col,c=q.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipRowOnPaste){I+=1,f.row+=1,i+=1;continue}for(s=0,_=0;s<a&&!(o&&f.col>o.col&&d>n||!X.allowInsertColumn&&f.col>q.countCols()-1)&&!(f.col>=X.maxCols);s++){if(c=q.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipColumnOnPaste){_+=1,f.col+=1,a+=1;continue}if(c.readOnly&&"UndoRedo.undo"!==r){f.col+=1;continue}let e=s-_,o=x(t,e),n=q.getDataAtCell(f.row,f.col);if(null!==o&&"object"==typeof o){if(Array.isArray(o)&&null===n&&(n=[]),null===n||"object"!=typeof n)M=!1;else{let e=(0,u.ie)(Array.isArray(n)?n:n[0]||n),t=(0,u.ie)(Array.isArray(o)?o:o[0]||o);(0,u.Z1)(e,t)||Array.isArray(e)&&Array.isArray(t)?o=(0,u.I8)(o):M=!1}}else null!==n&&"object"==typeof n&&(M=!1);M&&h.push([f.row,f.col,o]),M=!0,f.col+=1}f.row+=1}q.setDataAtCell(h,null,null,r||"populateFromArray")}}},this.init=function(){B.setData(X.data),q.runHooks("beforeInit"),((0,i.K1)()||(0,i.L)())&&(0,r.cn)(q.rootElement,"mobile"),this.updateSettings(X,!0),this.view=new y.Z(this),O=s.Z.getInstance(q,X,eo),K=new c.I(q),(0,b.isRootInstance)(this)&&(0,D.o)(q),q.runHooks("init"),this.forceFullRender=!0,this.view.render(),Z&&null===q.rootElement.offsetParent&&(0,r.TT)(q.rootElement,()=>{q.view._wt.wtOverlays.updateLastSpreaderSize(),q.render(),q.view.adjustElementsSize()}),"object"==typeof Z&&(q.runHooks("afterChange",Z[0],Z[1]),Z=!1),q.runHooks("afterInit")},this._createCellCoords=function(e,t){return q.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,o){return q.view._wt.createCellRange(e,t,o)},this.validateCell=function(e,t,o,r){let i=q.getCellValidator(t);function s(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===t.hidden){o(e);return}let n=t.visualCol,l=t.visualRow,i=q.getCell(l,n,!0);if(i&&"TH"!==i.nodeName){let e=q.rowIndexMapper.getRenderableFromVisualIndex(l),t=q.columnIndexMapper.getRenderableFromVisualIndex(n);q.view._wt.getSetting("cellRenderer",e,t,i)}o(e)}if((0,l.Kj)(i)){var a;a=i,i=function(e,t){t(a.test(e))}}(0,n.mf)(i)?(e=q.runHooks("beforeValidate",e,t.visualRow,t.prop,r),q._registerImmediate(()=>{i.call(t,e,o=>{q&&(o=q.runHooks("afterValidate",o,e,t.visualRow,t.prop,r),t.valid=o,s(o),q.runHooks("postAfterValidate",o,e,t.visualRow,t.prop,r))})})):q._registerImmediate(()=>{t.valid=!0,s(t.valid,!1)})},this.setDataAtCell=function(e,t,r,n){let l,i,s;let a=ea(e,t,r),u=[],c=n;for(l=0,i=a.length;l<i;l++){if("object"!=typeof a[l])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof a[l][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=a[l][1]>=this.countCols()?a[l][1]:o.colToProp(a[l][1]),u.push([a[l][0],s,B.getAtCell(this.toPhysicalRow(a[l][0]),a[l][1]),a[l][2]])}c||"object"!=typeof e||(c=t);let d=eu(u,n);q.runHooks("afterSetDataAtCell",d,c),ei(d,c,()=>{es(d,c)})},this.setDataAtRowProp=function(e,t,o,r){let n,l;let i=ea(e,t,o),s=[],a=r;for(n=0,l=i.length;n<l;n++)s.push([i[n][0],i[n][1],B.getAtCell(this.toPhysicalRow(i[n][0]),i[n][1]),i[n][2]]);a||"object"!=typeof e||(a=t);let u=eu(s,r);q.runHooks("afterSetDataAtRowProp",u,a),ei(u,a,()=>{es(u,a)})},this.listen=function(){q&&!q.isListening()&&(F.forEach(e=>{q!==e&&e.unlisten()}),N=q.guid,q.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(N=null,q.runHooks("afterUnlisten"))},this.isListening=function(){return N===q.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];q._refreshBorders(e,t)},this.populateFromArray=function(e,t,o,r,n,l,i){if(!("object"==typeof o&&"object"==typeof o[0]))throw Error("populateFromArray parameter `input` must be an array of arrays");let s="number"==typeof r?q._createCellCoords(r,n):null;return j.populateFromArray(q._createCellCoords(e,t),o,s,l,i)},this.spliceCol=function(e,t,r){for(var n=arguments.length,l=Array(n>3?n-3:0),i=3;i<n;i++)l[i-3]=arguments[i];return o.spliceCol(e,t,r,...l)},this.spliceRow=function(e,t,r){for(var n=arguments.length,l=Array(n>3?n-3:0),i=3;i<n;i++)l[i-3]=arguments[i];return o.spliceRow(e,t,r,...l)},this.getSelected=function(){if(eo.isSelected())return(0,d.Sc)(eo.getSelectedRange(),e=>{let{from:t,to:o}=e;return[t.row,t.col,o.row,o.col]})},this.getSelectedLast=function(){let e;let t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(eo.isSelected())return Array.from(eo.getSelectedRange())},this.getSelectedRangeLast=function(){let e;let t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){if(!eo.isSelected()||0===this.countRows()||0===this.countCols())return;let t=[];(0,d.Bk)(eo.getSelectedRange(),e=>{if(e.isSingleHeader())return;let o=e.getTopStartCorner(),r=e.getBottomEndCorner();(0,C.q4)(o.row,r.row,e=>{(0,C.q4)(o.col,r.col,o=>{this.getCellMeta(e,o).readOnly||t.push([e,o,null])})})}),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(O.lockEditor(),this._refreshBorders(null),O.unlockEditor()))},this.batchRender=function(e){this.suspendRender();let t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();let o=e();return this.resumeExecution(t),o},this.batch=function(e){this.suspendRender(),this.suspendExecution();let t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!q.view)return;let{width:e,height:t}=q.view.getLastSize(),{width:o,height:r}=q.rootElement.getBoundingClientRect(),n=o!==e||r!==t,l=!1===q.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:o,height:r},n);l||((n||q.view._wt.wtOverlays.scrollableElement===q.rootWindow)&&(q.view.setLastSize(o,r),q.render()),q.runHooks("afterRefreshDimensions",{width:e,height:t},{width:o,height:r},n))},this.updateData=function(e,t){(0,T.o)(e,e=>{o=e},e=>{o=e,q.columnIndexMapper.fitToLength(this.getInitialColumnCount()),q.rowIndexMapper.fitToLength(this.countSourceRows()),j.adjustRowsAndCols()},{hotInstance:q,dataMap:o,dataSource:B,internalSource:"updateData",source:t,metaManager:J,firstRun:Z})},this.loadData=function(e,t){(0,T.o)(e,e=>{o=e},()=>{J.clearCellsCache(),q.initIndexMappers(),j.adjustRowsAndCols(),Z&&(Z=[null,"loadData"])},{hotInstance:q,dataMap:o,dataSource:B,internalSource:"loadData",source:t,metaManager:J,firstRun:Z})},this.getInitialColumnCount=function(){let e=X.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,n.mf)(e)){if("array"===q.dataType){let o=this.countSourceCols();for(let r=0;r<o;r+=1)e(r)&&(t+=1)}else("object"===q.dataType||"function"===q.dataType)&&(t=o.colToPropCache.length)}else if((0,l.$K)(X.dataSchema)){let e=o.getSchema();t=Array.isArray(e)?e.length:(0,u.Q8)(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,l.o8)(e)?o.getAll():o.getRange(q._createCellCoords(e,t),q._createCellCoords(r,n),o.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return o.getCopyableText(q._createCellCoords(e,t),q._createCellCoords(r,n))},this.getCopyableData=function(e,t){return o.getCopyable(e,o.colToProp(t))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(e){let t,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=(Z?q.loadData:q.updateData).bind(this),a=!1;if((0,l.$K)(e.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,l.$K)(e.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,l.$K)(e.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?function(e){let t=(0,I.TH)(e);(0,E.hasLanguageDictionary)(t)?(q.runHooks("beforeLanguageChange",t),ee.language=t,q.runHooks("afterLanguageChange",t)):(0,I.Vn)(e)}(e.language):"className"===t?en("className",e.className):"tableClassName"===t&&q.table?(en("tableClassName",e.tableClassName),q.view._wt.wtOverlays.syncOverlayTableClassNames()):A.default.getSingleton().isRegistered(t)||A.default.getSingleton().isDeprecated(t)?((0,n.mf)(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,q.addHook(t,e[t])):!i&&(0,u.nr)(e,t)&&(ee[t]=e[t]));void 0===e.data&&void 0===X.data?s(null,"updateSettings"):void 0!==e.data?s(e.data,"updateSettings"):void 0!==e.columns&&(o.createMap(),q.initIndexMappers());let c=q.countCols(),d=X.columns;if(d&&(0,n.mf)(d)&&(a=!0),(void 0!==e.cell||void 0!==e.cells||void 0!==e.columns)&&J.clearCache(),c>0)for(t=0,r=0;t<c;t++){if(d){let e=a?d(t):d[r];e&&J.updateColumnMeta(r,e)}r+=1}(0,l.$K)(e.cell)&&(0,u._l)(e.cell,e=>{q.setCellMetaObject(e.row,e.col,e)}),q.runHooks("afterCellMetaReset");let h=q.rootElement.style.height;""!==h&&(h=parseInt(q.rootElement.style.height,10));let f=e.height;if((0,n.mf)(f)&&(f=f()),i){let e=q.rootElement.getAttribute("style");e&&q.rootElement.setAttribute("data-initialstyle",q.rootElement.getAttribute("style"))}if(null===f){let e=q.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?q.rootElement.setAttribute("style",e):(q.rootElement.style.height="",q.rootElement.style.overflow="")}else void 0!==f&&(q.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,q.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;(0,n.mf)(t)&&(t=t()),q.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}i||(q.view&&(q.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),q.view._wt.exportSettingsAsClassNames()),q.runHooks("afterUpdateSettings",e)),j.adjustRowsAndCols(),q.view&&!Z&&(q.forceFullRender=!0,O.lockEditor(),q._refreshBorders(null),q.view._wt.wtOverlays.adjustElementsSize(),O.unlockEditor()),!i&&q.view&&(""===h||""===f||void 0===f)&&h!==f&&q.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let e=q.getSelectedLast();if(X.getValue){if((0,n.mf)(X.getValue))return X.getValue.call(q);if(e)return q.getData()[e[0][0]][X.getValue]}else if(e)return q.getDataAtCell(e[0],e[1])},this.getSettings=function(){return X},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,o,r,n){j.alter(e,t,o,r,n)},this.getCell=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===r?null:q.view.getCellAtCoords(q._createCellCoords(n,r),o)},this.getCoords=function(e){let t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;let{row:o,col:r}=t,n=o,l=r;return o>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(o)),r>=0&&(l=this.columnIndexMapper.getVisualFromRenderableIndex(r)),q._createCellCoords(n,l)},this.colToProp=function(e){return o.colToProp(e)},this.propToCol=function(e){return o.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return o.get(e,o.colToProp(t))},this.getDataAtRowProp=function(e,t){return o.get(e,t)},this.getDataAtCol=function(e){let t=[],r=o.getRange(q._createCellCoords(0,e),q._createCellCoords(X.data.length-1,e),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getDataAtProp=function(e){let t=[],r=o.getRange(q._createCellCoords(0,o.propToCol(e)),q._createCellCoords(X.data.length-1,o.propToCol(e)),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getSourceData=function(e,t,o,r){return void 0===e?B.getData():B.getByRange(q._createCellCoords(e,t),q._createCellCoords(o,r))},this.getSourceDataArray=function(e,t,o,r){return void 0===e?B.getData(!0):B.getByRange(q._createCellCoords(e,t),q._createCellCoords(o,r),!0)},this.getSourceDataAtCol=function(e){return B.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,o,r){let n=ea(e,t,o),i=this.hasHook("afterSetSourceDataAtCell"),s=[];i&&(0,d.Bk)(n,e=>{let[t,o,r]=e;s.push([t,o,B.getAtCell(t,o),r])}),(0,d.Bk)(n,e=>{let[t,o,r]=e;B.setAtCell(t,o,r)}),i&&this.runHooks("afterSetSourceDataAtCell",s,r),this.render();let a=q.getActiveEditor();a&&(0,l.$K)(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(e){return B.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return B.getAtCell(e,t)},this.getDataAtRow=function(e){let t=o.getRange(q._createCellCoords(e,0),q._createCellCoords(e,this.countCols()-1),o.DESTINATION_RENDERER);return t[0]||[]},this.getDataType=function(e,t,o,r){let n=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,o,r],[l,i]=n,[,,s,a]=n,u=null,c=null;void 0===s&&(s=l),void 0===a&&(a=i);let d="mixed";return(0,C.q4)(Math.max(Math.min(l,s),0),Math.max(l,s),e=>{let t=!0;return(0,C.q4)(Math.max(Math.min(i,a),0),Math.max(i,a),o=>{let r=this.getCellMeta(e,o);return c=r.type,u?t=u===c:u=c,t}),d=t?c:"mixed",t}),d},this.removeCellMeta=function(e,t,o){let[r,n]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],l=J.getCellMetaKeyValue(r,n,o),i=q.runHooks("beforeRemoveCellMeta",e,t,o,l);!1!==i&&(J.removeCellMeta(r,n,o),q.runHooks("afterRemoveCellMeta",e,t,o,l))},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,r=Array(o>2?o-2:0),n=2;n<o;n++)r[n-2]=arguments[n];if(r.length>0&&!Array.isArray(r[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&J.removeRow(this.toPhysicalRow(e),t),r.length>0&&(0,d.Bk)(r.reverse(),t=>{J.createRow(this.toPhysicalRow(e)),(0,d.Bk)(t,(t,o)=>this.setCellMetaObject(e,o,t))}),q.render()},this.setCellMetaObject=function(e,t,o){"object"==typeof o&&(0,u._l)(o,(o,r)=>{this.setCellMeta(e,t,r,o)})},this.setCellMeta=function(e,t,o,r){let n=q.runHooks("beforeSetCellMeta",e,t,o,r);if(!1===n)return;let l=e,i=t;e<this.countRows()&&(l=this.toPhysicalRow(e)),t<this.countCols()&&(i=this.toPhysicalColumn(t)),J.setCellMeta(l,i,o,r),q.runHooks("afterSetCellMeta",e,t,o,r)},this.getCellsMeta=function(){return J.getCellsMeta()},this.getCellMeta=function(e,t){let o=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===o&&(o=e),null===r&&(r=t),J.getCellMeta(o,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return J.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===q.dataType||X.columns)},this.getCellRenderer=function(e,t){let o="number"==typeof e?q.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof o?(0,g.Bp)(o):(0,l.o8)(o)?(0,g.Bp)("text"):o},this.getCellEditor=function(e,t){let o="number"==typeof e?q.getCellMeta(e,t).editor:e.editor;return"string"==typeof o?(0,m.y$)(o):(0,l.o8)(o)?(0,m.y$)("text"):o},this.getCellValidator=function(e,t){let o="number"==typeof e?q.getCellMeta(e,t).validator:e.validator;return"string"==typeof o?(0,p.Te)(o):o},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,o){let r=new el;e&&(r.onQueueEmpty=e);let n=q.countRows()-1;for(;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}let e=q.countCols()-1;for(;e>=0;){if(void 0!==o&&-1===o.indexOf(e)){e-=1;continue}r.addValidatorToQueue(),q.validateCell(q.getDataAtCell(n,e),q.getCellMeta(n,e),e=>{if("boolean"!=typeof e)throw Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),e-=1}n-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=X.rowHeaders,o=e;return void 0!==o&&(o=q.runHooks("modifyRowHeader",o)),void 0===o?(t=[],(0,C.q4)(q.countRows()-1,e=>{t.push(q.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[o]?t=t[o]:(0,n.mf)(t)?t=t(o):t&&"string"!=typeof t&&"number"!=typeof t&&(t=o+1),t},this.hasRowHeaders=function(){return!!X.rowHeaders},this.hasColHeaders=function(){if(void 0!==X.colHeaders&&null!==X.colHeaders)return!!X.colHeaders;for(let e=0,t=q.countCols();e<t;e++)if(q.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=q.runHooks("modifyColHeader",e);if(void 0===o){let e=[],t=q.countCols();for(let o=0;o<t;o++)e.push(q.getColHeader(o));return e}let r=X.colHeaders,l=q.toPhysicalColumn(o),i=function(e){let t=[],o=q.countCols(),r=0;for(;r<o;r++)(0,n.mf)(X.columns)&&X.columns(r)&&t.push(r);return t[e]}(l);return!1===X.colHeaders?r=null:X.columns&&(0,n.mf)(X.columns)&&X.columns(i)&&X.columns(i).title?r=X.columns(i).title:X.columns&&X.columns[l]&&X.columns[l].title?r=X.columns[l].title:Array.isArray(X.colHeaders)&&void 0!==X.colHeaders[l]?r=X.colHeaders[l]:(0,n.mf)(X.colHeaders)?r=X.colHeaders(l):X.colHeaders&&"string"!=typeof X.colHeaders&&"number"!=typeof X.colHeaders&&(r=(0,R.Yl)(o)),r=q.runHooks("modifyColumnHeaderValue",r,e,t)},this._getColWidthFromSettings=function(e){let t;if(e>=0){let o=q.getCellMeta(0,e);t=o.width}if((void 0===t||t===X.width)&&(t=X.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){let t=q._getColWidthFromSettings(e);return void 0===(t=q.runHooks("modifyColWidth",t,e))&&(t=H.E.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){let t=X.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){let t=q._getRowHeightFromSettings(e);return q.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return B.countRows()},this.countSourceCols=function(){return B.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){let e=X.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return q.view._wt.drawn?q.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return q.view._wt.drawn?q.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return q.view._wt.drawn?q.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return q.view._wt.drawn?q.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.yh)(q.countRows()-1,o=>{if(q.isEmptyRow(o))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.yh)(q.countCols()-1,o=>{if(q.isEmptyCol(o))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return X.isEmptyRow.call(q,e)},this.isEmptyCol=function(e){return X.isEmptyCol.call(q,e)},this.selectCell=function(e,t,o,r){let n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,l.o8)(e)||(0,l.o8)(t))&&this.selectCells([[e,t,o,r]],n,i)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===t&&(z=!0);let r=eo.selectCells(e);return r&&o&&q.listen(),z=!1,r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return eo.selectColumns(e,t,o)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return eo.selectRows(e,t,o)},this.deselectCell=function(){eo.deselect()},this.selectAll=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;z=!0,eo.selectAll(e,t,o),z=!1};let ec=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t,o;let r,n,l,i;"number"==typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(o=arguments[4])||void 0===o||o});let{row:s,col:a,verticalSnap:u,horizontalSnap:c,considerHiddenIndexes:d}=null!==(t=e)&&void 0!==t?t:{};void 0!==u&&(n=!(r="top"===u)),void 0!==c&&(i=!(l="start"===c));let h=s,f=a;if(void 0===d||d){let e=Number.isInteger(s)&&s>=0,t=Number.isInteger(a)&&a>=0,o=e?ec(this.rowIndexMapper,s):void 0,r=t?ec(this.columnIndexMapper,a):void 0;if(null===o||null===r)return!1;h=e?q.rowIndexMapper.getRenderableFromVisualIndex(o):s,f=t?q.columnIndexMapper.getRenderableFromVisualIndex(r):a}let g=Number.isInteger(h),m=Number.isInteger(f);return g&&h>=0&&m&&f>=0?q.view.scrollViewport(q._createCellCoords(h,f),r,i,n,l):g&&h>=0&&(m&&f<0||!m)?q.view.scrollViewportVertically(h,r,n):!!m&&f>=0&&(!!g&&h<0||!g)&&q.view.scrollViewportHorizontally(f,i,l)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);let{highlight:t}=this.getSelectedRangeLast(),o=this.scrollViewportTo(t.toObject());o?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate(()=>e()))},this.destroy=function(){if(q._clearTimeouts(),q._clearImmediates(),q.view&&q.view.destroy(),B&&B.destroy(),B=null,this.getShortcutManager().destroy(),J.clearCache(),F.delete(this.guid),(0,b.isRootInstance)(q)){let e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,r.cS)(q.rootElement),U.destroy(),O&&O.destroy(),q.batchExecution(()=>{q.rowIndexMapper.unregisterAll(),q.columnIndexMapper.unregisterAll(),et.getItems().forEach(e=>{let[,t]=e;t.destroy()}),et.clear(),q.runHooks("afterDestroy")},!0),A.default.getSingleton().destroy(q),(0,u._l)(q,(e,t,o)=>{(0,n.mf)(e)?o[t]=()=>{throw Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}:"guid"!==t&&(o[t]=null)}),q.isDestroyed=!0,o&&o.destroy(),o=null,j=null,eo=null,O=null,q=null},this.getActiveEditor=function(){return O.getActiveEditor()},this.getPlugin=function(e){let t=(0,w.ct)(e);return"UndoRedo"===t?this.undoRedo:et.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:et.getId(e)},this.getInstance=function(){return q},this.addHook=function(e,t){A.default.getSingleton().add(e,t,q)},this.hasHook=function(e){return A.default.getSingleton().has(e,q)||A.default.getSingleton().has(e)},this.addHookOnce=function(e,t){A.default.getSingleton().once(e,t,q)},this.removeHook=function(e,t){A.default.getSingleton().remove(e,t,q)},this.runHooks=function(e,t,o,r,n,l,i){return A.default.getSingleton().run(q,e,t,o,r,n,l,i)},this.getTranslatedPhrase=function(e,t){return(0,E.getTranslatedPhrase)(X.language,e,t)},this.toHTML=()=>(0,h.vo)(this),this.toTableElement=()=>{let e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,h.vo)(this)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e;"function"==typeof o&&(o=setTimeout(o,t)),this.timeouts.push(o)},this._clearTimeouts=function(){(0,d.Bk)(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,d.Bk)(this.immediates,e=>{clearImmediate(e)})},this._refreshBorders=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];O.destroyEditor(e),q.view.render(),t&&eo.isSelected()&&O.prepareEditor()},this._getEditorManager=function(){return O},this.isRtl=function(){return"rtl"===q.rootWindow.getComputedStyle(q.rootElement).direction},this.isLtr=function(){return!q.isRtl()},this.getDirectionFactor=function(){return q.isLtr()?1:-1};let ed=(0,L.U)({handleEvent:()=>q.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||q.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&ed.releasePressedKeys()}),this.getShortcutManager=function(){return ed},this.getFocusManager=function(){return K},(0,f.a9)().forEach(e=>{let t=(0,f.s3)(e);et.addItem(e,new t(this))}),(0,P.xg)(q),ed.setActiveContextName("grid"),A.default.getSingleton().run(q,"construct")}}}]);