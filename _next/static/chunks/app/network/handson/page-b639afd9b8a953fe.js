(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376],{1184:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(2265),n=r(4887),o=r(3274);function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l=s(i),a=s(n),u=s(o);function h(t,e,r){return e=b(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return S(t)}(t,c()?Reflect.construct(e,r||[],b(t).constructor):e.apply(t,r))}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(c=function(){return!!t})()}function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function f(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,f(i.key),i)}}function w(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return(C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function S(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}var T=null,R="global";function O(t,e){var r=l.default.Children.toArray(t),i=l.default.Children.count(t),n=null;return 0!==i&&(n=1===i&&r[0].props[e]?r[0]:r.find(function(t){return void 0!==t.props[e]})),n||null}function M(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function I(t,e){if(void 0===t||null===e)return null;var r=x(e.props,!1);return r.className="".concat("hot-wrapper-editor-container"," ").concat(r.className),a.default.createPortal(l.default.createElement("div",Object.assign({},r),e),t.body)}function N(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R,i=O(t,"hot-editor"),n=M(i);return i?l.default.cloneElement(i,{emitEditorInstance:function(t,r){e.get(n)||e.set(n,new Map),e.get(n).set(null!=r?r:R,t)},editorColumnScope:r,isEditor:!0}):null}function x(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var k=function(){function t(){p(this,t)}return w(t,null,[{key:"getSettings",value:function(t){var e={};if(t.settings){var r=t.settings;for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}for(var n in t)"settings"!==n&&"children"!==n&&t.hasOwnProperty(n)&&(e[n]=t[n]);return e}}]),t}(),H=function(t){function e(){return p(this,e),h(this,e,arguments)}return y(e,t),w(e,[{key:"getSettingsProps",value:function(){var t=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(e){return!t.internalProps.includes(e)}).reduce(function(e,r){return e[r]=t.props[r],e},{})}},{key:"getLocalEditorElement",value:function(){return N(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var t=this.props._getChildElementByType(this.props.children,"hot-renderer"),e=this.getLocalEditorElement();this.columnSettings=k.getSettings(this.getSettingsProps()),null!==t&&(this.columnSettings.renderer=this.props._getRendererWrapper(t),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==e&&(this.columnSettings.editor=this.props._getEditorClass(e,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var t=I(this.props._getOwnerDocument(),this.getLocalEditorElement());return l.default.createElement(l.default.Fragment,null,t)}}]),e}(l.default.Component),_=function(t){function e(){var t;return p(this,e),t=h(this,e,arguments),t.state={portals:[]},t}return y(e,t),w(e,[{key:"render",value:function(){return l.default.createElement(l.default.Fragment,null,this.state.portals)}}]),e}(l.default.Component);function A(t,e){return t(e={exports:{}},e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L="function"==typeof Symbol&&Symbol.for,P=L?Symbol.for("react.element"):60103,D=L?Symbol.for("react.portal"):60106,B=L?Symbol.for("react.fragment"):60107,F=L?Symbol.for("react.strict_mode"):60108,W=L?Symbol.for("react.profiler"):60114,V=L?Symbol.for("react.provider"):60109,j=L?Symbol.for("react.context"):60110,U=L?Symbol.for("react.async_mode"):60111,$=L?Symbol.for("react.concurrent_mode"):60111,z=L?Symbol.for("react.forward_ref"):60112,G=L?Symbol.for("react.suspense"):60113,K=L?Symbol.for("react.suspense_list"):60120,X=L?Symbol.for("react.memo"):60115,Y=L?Symbol.for("react.lazy"):60116,q=L?Symbol.for("react.block"):60121,Z=L?Symbol.for("react.fundamental"):60117,Q=L?Symbol.for("react.responder"):60118,J=L?Symbol.for("react.scope"):60119;function tt(t){if("object"===g(t)&&null!==t){var e=t.$$typeof;switch(e){case P:switch(t=t.type){case U:case $:case B:case W:case F:case G:return t;default:switch(t=t&&t.$$typeof){case j:case z:case Y:case X:case V:return t;default:return e}}case D:return e}}}function te(t){return tt(t)===$}var tr={AsyncMode:U,ConcurrentMode:$,ContextConsumer:j,ContextProvider:V,Element:P,ForwardRef:z,Fragment:B,Lazy:Y,Memo:X,Portal:D,Profiler:W,StrictMode:F,Suspense:G,isAsyncMode:function(t){return te(t)||tt(t)===U},isConcurrentMode:te,isContextConsumer:function(t){return tt(t)===j},isContextProvider:function(t){return tt(t)===V},isElement:function(t){return"object"===g(t)&&null!==t&&t.$$typeof===P},isForwardRef:function(t){return tt(t)===z},isFragment:function(t){return tt(t)===B},isLazy:function(t){return tt(t)===Y},isMemo:function(t){return tt(t)===X},isPortal:function(t){return tt(t)===D},isProfiler:function(t){return tt(t)===W},isStrictMode:function(t){return tt(t)===F},isSuspense:function(t){return tt(t)===G},isValidElementType:function(t){return"string"==typeof t||"function"==typeof t||t===B||t===$||t===W||t===F||t===G||t===K||"object"===g(t)&&null!==t&&(t.$$typeof===Y||t.$$typeof===X||t.$$typeof===V||t.$$typeof===j||t.$$typeof===z||t.$$typeof===Z||t.$$typeof===Q||t.$$typeof===J||t.$$typeof===q)},typeOf:tt},ti=A(function(t,e){});function tn(){}function to(){}ti.AsyncMode,ti.ConcurrentMode,ti.ContextConsumer,ti.ContextProvider,ti.Element,ti.ForwardRef,ti.Fragment,ti.Lazy,ti.Memo,ti.Portal,ti.Profiler,ti.StrictMode,ti.Suspense,ti.isAsyncMode,ti.isConcurrentMode,ti.isContextConsumer,ti.isContextProvider,ti.isElement,ti.isForwardRef,ti.isFragment,ti.isLazy,ti.isMemo,ti.isPortal,ti.isProfiler,ti.isStrictMode,ti.isSuspense,ti.isValidElementType,ti.typeOf,A(function(t){t.exports=tr}),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var i=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==i.join(""))return!1;var n={};"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}(),Function.call.bind(Object.prototype.hasOwnProperty),to.resetWarningCache=tn;var ts=function(){function t(t,e,r,i,n,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:to,resetWarningCache:tn};return r.PropTypes=r,r},tl=A(function(t){t.exports=ts()}),ta=function(t){function e(){var t;return p(this,e),t=h(this,e,arguments),t.id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCacheArray=[],t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return y(e,t),w(e,[{key:"hotInstance",get:function(){return this.__hotInstance&&(!this.__hotInstance||this.__hotInstance.isDestroyed)?(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null):this.__hotInstance},set:function(t){this.__hotInstance=t}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!=typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(t){this.hotElementRef=t}},{key:"getRendererWrapper",value:function(t){var e=this;return function(r,i,n,o,s,u,h){var c=e.getRenderedCellCache();if(c.has("".concat(n,"-").concat(o))&&(i.innerHTML=c.get("".concat(n,"-").concat(o)).innerHTML),i&&!i.getAttribute("ghost-table")){for(var g=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;r||(r=document),T||(T=r.createDocumentFragment());var i=r.createElement("DIV");T.appendChild(i);var n=l.default.cloneElement(t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach(function(e){var i,n;i=e,n=r[e],(i=f(i))in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:a.default.createPortal(n,i,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:i}}(t,{TD:i,row:n,col:o,prop:s,value:u,cellProperties:h,isRenderer:!0},i.ownerDocument),p=g.portal,m=g.portalContainer;i.firstChild;)i.removeChild(i.firstChild);i.appendChild(m),e.portalCacheArray.push(p)}return c.set("".concat(n,"-").concat(o),i),i}}},{key:"getEditorClass",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R,i=M(t),n=null===(e=this.getEditorCache().get(i))||void 0===e?void 0:e.get(r);return this.makeEditorClass(n)}},{key:"makeEditorClass",value:function(t){var e=function(e){function r(e){var i;return p(this,r),i=h(this,r,[e]),t.hotCustomEditorInstance=S(i),i.editorComponent=t,i}return y(r,e),w(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(u.default.editors.BaseEditor);return Object.getOwnPropertyNames(u.default.editors.BaseEditor.prototype).forEach(function(r){"constructor"!==r&&(e.prototype[r]=function(){for(var e,i=arguments.length,n=Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t[r]).call.apply(e,[t].concat(n))})}),e}},{key:"getGlobalRendererElement",value:function(){return O(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return N(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var t=k.getSettings(this.props),e=this.getGlobalRendererElement(),r=this.getGlobalEditorElement();return t.columns=this.columnSettings.length?this.columnSettings:t.columns,r?t.editor=this.getEditorClass(r,R):t.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),e?(t.renderer=this.getRendererWrapper(e),this.componentRendererColumns.set("global",!0)):t.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),t}},{key:"displayAutoSizeWarning",value:function(t){var e,r;this.hotInstance&&(null!==(e=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==e&&e.enabled||null!==(r=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==r&&r.enabled)&&this.componentRendererColumns.size>0&&function(){if("undefined"!=typeof console){var t;(t=console).warn.apply(t,arguments)}}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(t,e){this.columnSettings[e]=t}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var t,e=this;this.renderersPortalManager.setState({portals:function(t){if(Array.isArray(t))return E(t)}(t=this.portalCacheArray)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},function(){e.portalCacheArray=[]})}},{key:"updateHot",value:function(t){this.hotInstance&&this.hotInstance.updateSettings(t,!1)}},{key:"setRenderersPortalManagerRef",value:function(t){this.renderersPortalManager=t}},{key:"componentDidMount",value:function(){var t=this,e=this.createNewGlobalSettings();this.hotInstance=new u.default.Core(this.hotElementRef,e),this.hotInstance.addHook("beforeViewRender",function(){return t.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return t.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(e)}},{key:"componentDidUpdate",value:function(){this.clearCache();var t=this.createNewGlobalSettings();this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var t=this,e=l.default.Children.toArray(this.props.children).filter(function(t){return t.type===H}).map(function(e,r){return l.default.cloneElement(e,{_componentRendererColumns:t.componentRendererColumns,_emitColumnSettings:t.setHotColumnSettings.bind(t),_columnIndex:r,_getChildElementByType:O.bind(t),_getRendererWrapper:t.getRendererWrapper.bind(t),_getEditorClass:t.getEditorClass.bind(t),_getOwnerDocument:t.getOwnerDocument.bind(t),_getEditorCache:t.getEditorCache.bind(t),children:e.props.children})}),r=x(this.props),i=I(this.getOwnerDocument(),this.getGlobalEditorElement());return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},r),e),l.default.createElement(_,{ref:this.setRenderersPortalManagerRef.bind(this)}),i)}}],[{key:"version",get:function(){return"14.1.0"}}]),e}(l.default.Component);ta.propTypes={style:tl.object,id:tl.string,className:tl.string};var tu=["children"],th=l.default.forwardRef(function(t,e){var r,i=t.children,n=function(t,e){if(null==t)return{};var r,i,n=function(t,e){if(null==t)return{};var r,i,n={},o=Object.keys(t);for(i=0;i<o.length;i++)r=o[i],e.indexOf(r)>=0||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}(t,tu),o="function"==typeof l.default.useId?l.default.useId():void 0,s=null!==(r=n.id)&&void 0!==r?r:o;return l.default.createElement(ta,Object.assign({id:s},n,{ref:e}),i)});th.version=ta.version;var tc=function(t){function e(){var t;return p(this,e),t=h(this,e,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hotInstance=null,t.hotCustomEditorInstance=null,t.hot=null,t}return y(e,t),w(e,[{key:"componentDidMount",value:function(){this.props.emitEditorInstance&&this.props.emitEditorInstance(this,this.props.editorColumnScope)}},{key:"componentDidUpdate",value:function(){this.props.emitEditorInstance&&this.props.emitEditorInstance(this,this.props.editorColumnScope)}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];(t=u.default.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"close",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.close).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"extend",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.extend).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"focus",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.focus).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"getValue",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.getValue).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"init",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.init).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"open",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.open).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"prepare",value:function(t,e,r,i,n,o){return this.hotInstance=o.instance,this.row=t,this.col=e,this.prop=r,this.TD=i,this.originalValue=n,this.cellProperties=o,u.default.editors.BaseEditor.prototype.prepare.call(this.hotCustomEditorInstance,t,e,r,i,n,o)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"setValue",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.setValue).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"addHook",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.addHook).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.hotCustomEditorInstance].concat(r))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=u.default.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.hotCustomEditorInstance].concat(r))}}]),e}(l.default.Component);e.BaseEditorComponent=tc,e.HotColumn=H,e.HotTable=th,e.default=th},3571:function(t){/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,r){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,r)}function r(t,i,n){return(r=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,r,i){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(t,n));return i&&e(o,i.prototype),o}:Reflect.construct).apply(null,arguments)}function i(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}var o,s=Object.hasOwnProperty,l=Object.setPrototypeOf,a=Object.isFrozen,u=Object.getPrototypeOf,h=Object.getOwnPropertyDescriptor,c=Object.freeze,d=Object.seal,f=Object.create,g="undefined"!=typeof Reflect&&Reflect,p=g.apply,m=g.construct;p||(p=function(t,e,r){return t.apply(e,r)}),c||(c=function(t){return t}),d||(d=function(t){return t}),m||(m=function(t,e){return r(t,i(e))});var w=N(Array.prototype.forEach),y=N(Array.prototype.pop),b=N(Array.prototype.push),C=N(String.prototype.toLowerCase),S=N(String.prototype.toString),E=N(String.prototype.match),T=N(String.prototype.replace),R=N(String.prototype.indexOf),O=N(String.prototype.trim),M=N(RegExp.prototype.test),I=(o=TypeError,function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return m(o,e)});function N(t){return function(e){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return p(t,e,i)}}function x(t,e,r){r=null!==(i=r)&&void 0!==i?i:C,l&&l(t,null);for(var i,n=e.length;n--;){var o=e[n];if("string"==typeof o){var s=r(o);s!==o&&(a(e)||(e[n]=s),o=s)}t[o]=!0}return t}function k(t){var e,r=f(null);for(e in t)!0===p(s,t,[e])&&(r[e]=t[e]);return r}function H(t,e){for(;null!==t;){var r=h(t,e);if(r){if(r.get)return N(r.get);if("function"==typeof r.value)return N(r.value)}t=u(t)}return function(t){return console.warn("fallback value for",t),null}}var _=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),A=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),P=c(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),B=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=c(["#text"]),W=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),V=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),j=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=d(/<%[\w\W]*|[\w\W]*%>/gm),G=d(/\${[\w\W]*}/gm),K=d(/^data-[\-\w.\u00B7-\uFFFF]/),X=d(/^aria-[\-\w]+$/),Y=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q=d(/^(?:\w+script|data):/i),Z=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=d(/^html$/i),J=function(e,r){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var i=null,n="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(n)&&(i=r.currentScript.getAttribute(n));var o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var r,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,s=function(t){return e(t)};if(s.version="2.4.7",s.removed=[],!o||!o.document||9!==o.document.nodeType)return s.isSupported=!1,s;var l=o.document,a=o.document,DocumentFragment=o.DocumentFragment,HTMLTemplateElement=o.HTMLTemplateElement,Node=o.Node,Element=o.Element,NodeFilter=o.NodeFilter,u=o.NamedNodeMap,NamedNodeMap=void 0===u?o.NamedNodeMap||o.MozNamedAttrMap:u,HTMLFormElement=o.HTMLFormElement,DOMParser=o.DOMParser,h=o.trustedTypes,d=Element.prototype,f=H(d,"cloneNode"),g=H(d,"nextSibling"),p=H(d,"childNodes"),m=H(d,"parentNode");if("function"==typeof HTMLTemplateElement){var N=a.createElement("template");N.content&&N.content.ownerDocument&&(a=N.content.ownerDocument)}var tt=J(h,l),te=tt?tt.createHTML(""):"",tr=a,ti=tr.implementation,tn=tr.createNodeIterator,to=tr.createDocumentFragment,ts=tr.getElementsByTagName,tl=l.importNode,ta={};try{ta=k(a).documentMode?a.documentMode:{}}catch(t){}var tu={};s.isSupported="function"==typeof m&&ti&&void 0!==ti.createHTMLDocument&&9!==ta;var th=Y,tc=null,td=x({},[].concat(i(_),i(A),i(L),i(D),i(F))),tf=null,tg=x({},[].concat(i(W),i(V),i(j),i(U))),tp=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tm=null,tv=null,tw=!0,ty=!0,tb=!1,tC=!0,tS=!1,tE=!1,tT=!1,tR=!1,tO=!1,tM=!1,tI=!1,tN=!0,tx=!1,tk=!0,tH=!1,t_={},tA=null,tL=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tP=null,tD=x({},["audio","video","img","source","image","track"]),tB=null,tF=x({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tW="http://www.w3.org/1998/Math/MathML",tV="http://www.w3.org/2000/svg",tj="http://www.w3.org/1999/xhtml",tU=tj,t$=!1,tz=null,tG=x({},[tW,tV,tj],S),tK=["application/xhtml+xml","text/html"],tX=null,tY=a.createElement("form"),tq=function(t){return t instanceof RegExp||t instanceof Function},tZ=function(e){tX&&tX===e||(e&&"object"===t(e)||(e={}),e=k(e),n="application/xhtml+xml"===(r=r=-1===tK.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?S:C,tc="ALLOWED_TAGS"in e?x({},e.ALLOWED_TAGS,n):td,tf="ALLOWED_ATTR"in e?x({},e.ALLOWED_ATTR,n):tg,tz="ALLOWED_NAMESPACES"in e?x({},e.ALLOWED_NAMESPACES,S):tG,tB="ADD_URI_SAFE_ATTR"in e?x(k(tF),e.ADD_URI_SAFE_ATTR,n):tF,tP="ADD_DATA_URI_TAGS"in e?x(k(tD),e.ADD_DATA_URI_TAGS,n):tD,tA="FORBID_CONTENTS"in e?x({},e.FORBID_CONTENTS,n):tL,tm="FORBID_TAGS"in e?x({},e.FORBID_TAGS,n):{},tv="FORBID_ATTR"in e?x({},e.FORBID_ATTR,n):{},t_="USE_PROFILES"in e&&e.USE_PROFILES,tw=!1!==e.ALLOW_ARIA_ATTR,ty=!1!==e.ALLOW_DATA_ATTR,tb=e.ALLOW_UNKNOWN_PROTOCOLS||!1,tC=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,tS=e.SAFE_FOR_TEMPLATES||!1,tE=e.WHOLE_DOCUMENT||!1,tO=e.RETURN_DOM||!1,tM=e.RETURN_DOM_FRAGMENT||!1,tI=e.RETURN_TRUSTED_TYPE||!1,tR=e.FORCE_BODY||!1,tN=!1!==e.SANITIZE_DOM,tx=e.SANITIZE_NAMED_PROPS||!1,tk=!1!==e.KEEP_CONTENT,tH=e.IN_PLACE||!1,th=e.ALLOWED_URI_REGEXP||th,tU=e.NAMESPACE||tj,tp=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&tq(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tp.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&tq(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tp.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(tp.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tS&&(ty=!1),tM&&(tO=!0),t_&&(tc=x({},i(F)),tf=[],!0===t_.html&&(x(tc,_),x(tf,W)),!0===t_.svg&&(x(tc,A),x(tf,V),x(tf,U)),!0===t_.svgFilters&&(x(tc,L),x(tf,V),x(tf,U)),!0===t_.mathMl&&(x(tc,D),x(tf,j),x(tf,U))),e.ADD_TAGS&&(tc===td&&(tc=k(tc)),x(tc,e.ADD_TAGS,n)),e.ADD_ATTR&&(tf===tg&&(tf=k(tf)),x(tf,e.ADD_ATTR,n)),e.ADD_URI_SAFE_ATTR&&x(tB,e.ADD_URI_SAFE_ATTR,n),e.FORBID_CONTENTS&&(tA===tL&&(tA=k(tA)),x(tA,e.FORBID_CONTENTS,n)),tk&&(tc["#text"]=!0),tE&&x(tc,["html","head","body"]),tc.table&&(x(tc,["tbody"]),delete tm.tbody),c&&c(e),tX=e)},tQ=x({},["mi","mo","mn","ms","mtext"]),tJ=x({},["foreignobject","desc","title","annotation-xml"]),t0=x({},["title","style","font","a","script"]),t1=x({},A);x(t1,L),x(t1,P);var t2=x({},D);x(t2,B);var t9=function(t){var e=m(t);e&&e.tagName||(e={namespaceURI:tU,tagName:"template"});var i=C(t.tagName),n=C(e.tagName);return!!tz[t.namespaceURI]&&(t.namespaceURI===tV?e.namespaceURI===tj?"svg"===i:e.namespaceURI===tW?"svg"===i&&("annotation-xml"===n||tQ[n]):!!t1[i]:t.namespaceURI===tW?e.namespaceURI===tj?"math"===i:e.namespaceURI===tV?"math"===i&&tJ[n]:!!t2[i]:t.namespaceURI===tj?(e.namespaceURI!==tV||!!tJ[n])&&(e.namespaceURI!==tW||!!tQ[n])&&!t2[i]&&(t0[i]||!t1[i]):"application/xhtml+xml"===r&&!!tz[t.namespaceURI])},t4=function(t){b(s.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=te}catch(e){t.remove()}}},t8=function(t,e){try{b(s.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){b(s.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!tf[t]){if(tO||tM)try{t4(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}}},t7=function(t){if(tR)t="<remove></remove>"+t;else{var e,i,n=E(t,/^[\r\n\t ]+/);i=n&&n[0]}"application/xhtml+xml"===r&&tU===tj&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=tt?tt.createHTML(t):t;if(tU===tj)try{e=new DOMParser().parseFromString(o,r)}catch(t){}if(!e||!e.documentElement){e=ti.createDocument(tU,"template",null);try{e.documentElement.innerHTML=t$?te:o}catch(t){}}var s=e.body||e.documentElement;return(t&&i&&s.insertBefore(a.createTextNode(i),s.childNodes[0]||null),tU===tj)?ts.call(e,tE?"html":"body")[0]:tE?e.documentElement:s},t3=function(t){return tn.call(t.ownerDocument||t,t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT,null,!1)},t5=function(e){return"object"===t(Node)?e instanceof Node:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},t6=function(t,e,r){tu[t]&&w(tu[t],function(t){t.call(s,e,r,tX)})},et=function(t){if(t6("beforeSanitizeElements",t,null),t instanceof HTMLFormElement&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof NamedNodeMap)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)||M(/[\u0080-\uFFFF]/,t.nodeName))return t4(t),!0;var e,r=n(t.nodeName);if(t6("uponSanitizeElement",t,{tagName:r,allowedTags:tc}),t.hasChildNodes()&&!t5(t.firstElementChild)&&(!t5(t.content)||!t5(t.content.firstElementChild))&&M(/<[/\w]/g,t.innerHTML)&&M(/<[/\w]/g,t.textContent)||"select"===r&&M(/<template/i,t.innerHTML))return t4(t),!0;if(!tc[r]||tm[r]){if(!tm[r]&&er(r)&&(tp.tagNameCheck instanceof RegExp&&M(tp.tagNameCheck,r)||tp.tagNameCheck instanceof Function&&tp.tagNameCheck(r)))return!1;if(tk&&!tA[r]){var i=m(t)||t.parentNode,o=p(t)||t.childNodes;if(o&&i)for(var l=o.length,a=l-1;a>=0;--a)i.insertBefore(f(o[a],!0),g(t))}return t4(t),!0}return t instanceof Element&&!t9(t)||("noscript"===r||"noembed"===r||"noframes"===r)&&M(/<\/no(script|embed|frames)/i,t.innerHTML)?(t4(t),!0):(tS&&3===t.nodeType&&(e=T(e=t.textContent,$," "),e=T(e,z," "),e=T(e,G," "),t.textContent!==e&&(b(s.removed,{element:t.cloneNode()}),t.textContent=e)),t6("afterSanitizeElements",t,null),!1)},ee=function(t,e,r){if(tN&&("id"===e||"name"===e)&&(r in a||r in tY))return!1;if(ty&&!tv[e]&&M(K,e));else if(tw&&M(X,e));else if(!tf[e]||tv[e]){if(!(er(t)&&(tp.tagNameCheck instanceof RegExp&&M(tp.tagNameCheck,t)||tp.tagNameCheck instanceof Function&&tp.tagNameCheck(t))&&(tp.attributeNameCheck instanceof RegExp&&M(tp.attributeNameCheck,e)||tp.attributeNameCheck instanceof Function&&tp.attributeNameCheck(e))||"is"===e&&tp.allowCustomizedBuiltInElements&&(tp.tagNameCheck instanceof RegExp&&M(tp.tagNameCheck,r)||tp.tagNameCheck instanceof Function&&tp.tagNameCheck(r))))return!1}else if(tB[e]);else if(M(th,T(r,Z,"")));else if(("src"===e||"xlink:href"===e||"href"===e)&&"script"!==t&&0===R(r,"data:")&&tP[t]);else if(tb&&!M(q,T(r,Z,"")));else if(r)return!1;return!0},er=function(t){return t.indexOf("-")>0},ei=function(e){t6("beforeSanitizeAttributes",e,null);var r,i,o,l,a=e.attributes;if(a){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:tf};for(l=a.length;l--;){var c=(r=a[l]).name,d=r.namespaceURI;if(i="value"===c?r.value:O(r.value),o=n(c),u.attrName=o,u.attrValue=i,u.keepAttr=!0,u.forceKeepAttr=void 0,t6("uponSanitizeAttribute",e,u),i=u.attrValue,!u.forceKeepAttr&&(t8(c,e),u.keepAttr)){if(!tC&&M(/\/>/i,i)){t8(c,e);continue}tS&&(i=T(i,$," "),i=T(i,z," "),i=T(i,G," "));var f=n(e.nodeName);if(ee(f,o,i)){if(tx&&("id"===o||"name"===o)&&(t8(c,e),i="user-content-"+i),tt&&"object"===t(h)&&"function"==typeof h.getAttributeType){if(d);else switch(h.getAttributeType(f,o)){case"TrustedHTML":i=tt.createHTML(i);break;case"TrustedScriptURL":i=tt.createScriptURL(i)}}try{d?e.setAttributeNS(d,c,i):e.setAttribute(c,i),y(s.removed)}catch(t){}}}}t6("afterSanitizeAttributes",e,null)}},en=function t(e){var r,i=t3(e);for(t6("beforeSanitizeShadowDOM",e,null);r=i.nextNode();)t6("uponSanitizeShadowNode",r,null),et(r)||(r.content instanceof DocumentFragment&&t(r.content),ei(r));t6("afterSanitizeShadowDOM",e,null)};return s.sanitize=function(e){var r,i,a,u,h,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((t$=!e)&&(e="<!-->"),"string"!=typeof e&&!t5(e)){if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw I("dirty is not a string, aborting")}else throw I("toString is not a function")}if(!s.isSupported){if("object"===t(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof e)return o.toStaticHTML(e);if(t5(e))return o.toStaticHTML(e.outerHTML)}return e}if(tT||tZ(c),s.removed=[],"string"==typeof e&&(tH=!1),tH){if(e.nodeName){var d=n(e.nodeName);if(!tc[d]||tm[d])throw I("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof Node)1===(i=(r=t7("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===i.nodeName?r=i:"HTML"===i.nodeName?r=i:r.appendChild(i);else{if(!tO&&!tS&&!tE&&-1===e.indexOf("<"))return tt&&tI?tt.createHTML(e):e;if(!(r=t7(e)))return tO?null:tI?te:""}r&&tR&&t4(r.firstChild);for(var f=t3(tH?e:r);a=f.nextNode();)3===a.nodeType&&a===u||et(a)||(a.content instanceof DocumentFragment&&en(a.content),ei(a),u=a);if(u=null,tH)return e;if(tO){if(tM)for(h=to.call(r.ownerDocument);r.firstChild;)h.appendChild(r.firstChild);else h=r;return(tf.shadowroot||tf.shadowrootmod)&&(h=tl.call(l,h,!0)),h}var g=tE?r.outerHTML:r.innerHTML;return tE&&tc["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&M(Q,r.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+g),tS&&(g=T(g,$," "),g=T(g,z," "),g=T(g,G," ")),tt&&tI?tt.createHTML(g):g},s.setConfig=function(t){tZ(t),tT=!0},s.clearConfig=function(){tX=null,tT=!1},s.isValidAttribute=function(t,e,r){return tX||tZ({}),ee(n(t),n(e),r)},s.addHook=function(t,e){"function"==typeof e&&(tu[t]=tu[t]||[],b(tu[t],e))},s.removeHook=function(t){if(tu[t])return y(tu[t])},s.removeHooks=function(t){tu[t]&&(tu[t]=[])},s.removeAllHooks=function(){tu={}},s}()}()},3274:function(t,e,r){"use strict";e.__esModule=!0;var i=d(r(3553)),n=r(3732),o=r(4072),s=d(r(4317)),l=r(8444),a=r(6324),u=r(2551),h=r(6557),c=r(5048);function d(t){return t&&t.__esModule?t:{default:t}}function f(t,e){let r=new i.default(t,e||{},n.rootInstanceSymbol);return r.init(),r}e.CellCoords=c.CellCoords,e.CellRange=c.CellRange,(0,a.registerCellType)(u.TextCellType),f.editors={BaseEditor:h.BaseEditor},f.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new i.default(t,e,n.rootInstanceSymbol)},f.DefaultSettings=(0,o.metaSchemaFactory)(),f.hooks=s.default.getSingleton(),f.CellCoords=c.CellCoords,f.CellRange=c.CellRange,f.packageName="handsontable",f.buildDate="16/01/2024 10:27:11",f.version="14.1.0",f.languages={dictionaryKeys:l.dictionaryKeys,getLanguageDictionary:l.getLanguageDictionary,getLanguagesDictionaries:l.getLanguagesDictionaries,registerLanguageDictionary:l.registerLanguageDictionary,getTranslatedPhrase:l.getTranslatedPhrase},e.default=f},9514:function(t,e,r){Promise.resolve().then(r.bind(r,9784))},9784:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return so}});var i=r(7437),n=r(5915);r(2916),r(2954);var o=r(9488),s=r(9440),l=r(6324),a=r(7416),u=r(6903),h=r(2740),c=r(9773);function d(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function f(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t,e){var r=function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e,0);return r.get?r.get.call(t):r.value}let p=new Map([["plugin",n._j],["cell-type",l.hasCellType],["editor",a.Wu],["renderer",u.Y3],["validator",h.oh]]),m=[],w=null;var y=new WeakMap,b=new WeakSet;class C{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){d(this,b),b.add(this),f(this,"eventManager",new c.Z(this)),f(this,"pluginName",null),f(this,"pluginsInitializedCallbacks",[]),f(this,"isPluginsReady",!1),f(this,"enabled",!1),f(this,"initialized",!1),d(this,y),y.set(this,{writable:!0,value:{}}),(0,o.jW)(this,"hot",t,{writable:!1}),w=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){let t=[];if(e.forEach(e=>{let[r,i]=e.split(":");if(!p.has(r))throw Error(`Unknown plugin dependency type "${r}" was found.`);p.get(r)(i)||t.push(` - ${i} (${r})`)}),t.length>0){let e=`The ${this.pluginName} plugin requires the following modules:
${t.join("\n")}
`;m.push(e)}}w||(w=(0,n.a9)()),w.indexOf("UndoRedo")>=0&&w.splice(w.indexOf("UndoRedo"),1),w.indexOf(this.pluginName)>=0&&w.splice(w.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});let r=0===w.length;if(r){if(m.length>0){let t=`${m.join("\n")}
You have to import and register them manually.`;throw Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){g(this,y)[t]=g(this,y)[t]||[];let r=g(this,y)[t];this.hot.addHook(t,e),r.push(e),g(this,y)[t]=r}removeHooks(t){(0,s.Bk)(g(this,y)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){let t=g(this,y);(0,o._l)(t,(t,e)=>this.removeHooks(e)),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){(0,s.Bk)(this.pluginsInitializedCallbacks,t=>t()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){let e=(function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r})(this,b,S).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),(0,o._l)(this,(t,e)=>{"hot"!==e&&(this[e]=null)}),delete this.t,delete this.hot}}function S(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let r=0;r<e.length;r++)if(void 0!==t[e[r]])return!0;return!1}var E=r(973),T=r(5878);function R(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class O{constructor(t){R(this,"hot",null),R(this,"container",null),R(this,"injected",!1),R(this,"rows",[]),R(this,"columns",[]),R(this,"samples",null),R(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let r={row:t};this.rows.push(r),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(t){let e=this.hot.getColHeader(0);if(null!=e){let e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let r={col:t};this.columns.push(r),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,s.Bk)(this.rows,e=>{t(e.row,(0,T.Pb)(e.table)-1)})}getWidths(t){this.injected||this.injectTable(),(0,s.Bk)(this.columns,e=>{let{width:r}=e.table.getBoundingClientRect();t(e.col,Math.ceil(r))})}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){let e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{(0,s.Bk)(r.strings,r=>{e.appendChild(this.createColElement(r.col,t))})}),e}createRow(t){let{rootDocument:e}=this.hot,r=e.createDocumentFragment(),i=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,i),r.appendChild(i)),this.samples.forEach(i=>{(0,s.Bk)(i.strings,i=>{let n=i.col,o=this.hot.getCellMeta(t,n);o.col=n,o.row=t;let s=this.hot.getCellRenderer(o),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,n,this.hot.colToProp(n),i.value,o),r.appendChild(l)})}),r}appendColumnHeadersRow(){let{rootDocument:t}=this.hot,e=t.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){let i=t.createElement("th");r.push([-1,i]),e.appendChild(i)}this.samples.forEach(i=>{(0,s.Bk)(i.strings,i=>{let n=i.col,o=t.createElement("th");r.push([n,o]),e.appendChild(o)})}),this.table.tHead.appendChild(e),(0,s.Bk)(r,t=>{let[e,r]=t;this.hot.view.appendColHeader(e,r)})}createCol(t){let{rootDocument:e}=this.hot,r=e.createDocumentFragment();return this.samples.forEach(i=>{(0,s.Bk)(i.strings,i=>{let n=i.row,o=this.hot.getCellMeta(n,t);o.col=t,o.row=n;let s=this.hot.getCellRenderer(o),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,n,t,this.hot.colToProp(t),i.value,o),a.appendChild(l),r.appendChild(a)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){let r=this.hot.rootDocument.createElement("col"),i=0;e>=0&&t>=0&&(i=this.hot.getCellMeta(e,t).colspan);let n=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(i>1)for(let e=t+1;e<t+i;e++)n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);return r.style.width=`${n}px`,r}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,r=e.createDocumentFragment(),i=e.createElement("table"),n=e.createElement("thead"),o=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(l.appendChild(a),n.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(n),this.isVertical()&&o.appendChild(l),i.appendChild(o),(0,T.cn)(i,t),r.appendChild(i),{fragment:r,table:i,tHead:n,tBody:o,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,r=e.createDocumentFragment(),i=e.createElement("div"),n=`htGhostTable htAutoSize ${t.trim()}`;return(0,T.cn)(i,n),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}var M=r(4317),I=r(7790),N=r(2518);function x(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class k{static get SAMPLE_COUNT(){return 3}constructor(t){x(this,"samples",null),x(this,"dataFactory",null),x(this,"customSampleCount",null),x(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:k.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,r){let i=new Map,{from:n,to:o}="number"==typeof r?{from:r,to:r}:r;return(0,I.q4)(n,o,r=>{let n=this.generateSample(t,e,r);i.set(r,n)}),i}generateSample(t,e,r){if("row"!==t&&"col"!==t)throw Error("Unsupported sample type");let i=new Map,n="row"===t?"col":"row",s=[];return(0,I.q4)(e.from,e.to,e=>{let l;let a="row"===t?this.dataFactory(r,e):this.dataFactory(e,r);if(!1===a)return;let{value:u,bundleSeed:h}=a,c="string"==typeof h&&h.length>0;l=c?h:(0,o.Kn)(u)?`${Object.keys(u).length}`:Array.isArray(u)?`${u.length}`:`${(0,N.Pz)(u).length}`,i.has(l)||i.set(l,{needed:this.getSampleCount(),strings:[]});let d=i.get(l);if(d.needed){let t=s.indexOf(u)>-1;(!t||this.allowDuplicates||c)&&(d.strings.push({value:u,[n]:e}),s.push(u),d.needed-=1)}}),i}}var H=r(6411),_=r(7431),A=r(5843);function L(t,e){P(t,e),e.add(t)}function P(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function D(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B(t,e){var r=F(t,e,"get");return r.get?r.get.call(t):r.value}function F(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function W(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}M.default.getSingleton().register("modifyAutoColumnSizeSeed");let V="autoColumnSize";var j=new WeakMap,U=new WeakSet,$=new WeakSet,z=new WeakSet,G=new WeakSet,K=new WeakSet,X=new WeakSet;class Y extends C{static get PLUGIN_KEY(){return V}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),L(this,X),L(this,K),L(this,G),L(this,z),L(this,$),L(this,U),D(this,"ghostTable",new O(this.hot)),D(this,"samplesGenerator",new k((t,e)=>{let r=this.hot.getCellMeta(t,e),i="";r.spanned||(i=this.hot.getDataAtCell(t,e));let n="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(n=this.hot.runHooks("modifyAutoColumnSizeSeed",n,r,i)),{value:i,bundleSeed:n}})),D(this,"firstCalculation",!0),D(this,"inProgress",!1),D(this,"measuredColumns",0),D(this,"columnWidthsMap",new A.L),P(this,j),j.set(this,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(t,e,r)=>W(this,G,J).call(this,t,e,r))}isEnabled(){return!1!==this.hot.getSettings()[V]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[V];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return W(t,$,Z).call(t,...r)}),this.addHook("beforeChangeRender",t=>W(this,z,Q).call(this,t)),this.addHook("afterFormulasValuesUpdate",t=>W(this,X,te).call(this,t)),this.addHook("beforeViewRender",t=>W(this,U,q).call(this,t)),this.addHook("modifyColWidth",(t,e)=>this.getColumnWidth(e,t)),this.addHook("afterInit",()=>W(this,K,tt).call(this)),super.enablePlugin()}updatePlugin(){let t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,e,r)=>W(this,G,J).call(this,t,e,r))}calculateVisibleColumnsWidth(){let t=this.hot.countRows();if(!t)return;let e=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();-1!==r&&-1!==i&&this.calculateColumnsWidth({from:r,to:i},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="number"==typeof t?{from:t,to:t}:t,n="number"==typeof e?{from:e,to:e}:e;(0,I.q4)(i.from,i.to,t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),r||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){let e=this.samplesGenerator.generateColumnSamples(t,n);(0,s.Bk)(e,t=>{let[e,r]=t;return this.ghostTable.addColumn(e,r)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{let r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0,r=this.hot.countCols()-1,i=null;this.inProgress=!0;let n=()=>{if(!this.hot){(0,E.Wx)(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:e,to:Math.min(e+Y.CALCULATION_STEP,r)},t),(e=e+Y.CALCULATION_STEP+1)<r?i=(0,E.U7)(n):((0,E.Wx)(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateColumnsWidth({from:0,to:o},t),this.firstCalculation=!1,e=o+1),e<r?n():this.inProgress=!1}setSamplingOptions(){let t=this.hot.getSettings()[V],e=t&&(0,o.nr)(t,"samplingRatio")?t.samplingRatio:void 0,r=t&&(0,o.nr)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let t=this.hot.getSettings()[V],e=Y.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return(0,o.Kn)(t)&&(e=t.syncLimit,(0,H.wK)(e)?e=(0,I.N1)(r,e):e>>=0),Math.min(e,r)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=e;return void 0===i&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),r&&"number"==typeof i&&(i=Math.max(i,_.E.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}getLastVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}findColumnsWhereHeaderWasChanged(){let t=this.hot.getColHeader(),e=(0,s.k$)(t,(t,e,r)=>{let i=B(this,j).length;return(i-1<r||B(this,j)[r]!==e)&&t.push(r),i-1<r?B(this,j).push(e):B(this,j)[r]=e,t},[]);return e}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution(()=>{(0,s.Bk)(t,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!(0,s.w7)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function q(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function Z(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function Q(t){let e=(0,s.Sc)(t,t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))});this.clearCache(Array.from(new Set(e)))}function J(t,e,r){let i=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function tt(){var t;t=this.hot.getColHeader(),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,F(this,j,"set"),t)}function te(t){let e=(0,s.w7)(t,t=>{var e;return(0,N.$K)(null===(e=t.address)||void 0===e?void 0:e.col)}),r=(0,s.Sc)(e,t=>t.address.col);this.clearCache(Array.from(new Set(r)))}let tr={horizontal:"horizontal",vertical:"vertical"};function ti(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function tn(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function to(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}M.default.getSingleton().register("modifyAutofillRange"),M.default.getSingleton().register("beforeAutofill"),M.default.getSingleton().register("afterAutofill");let ts="autofill",tl=["fillHandle"];var ta=new WeakSet,tu=new WeakSet,th=new WeakSet,tc=new WeakSet,td=new WeakSet;class tf extends C{constructor(){super(...arguments),ti(this,td),ti(this,tc),ti(this,th),ti(this,tu),ti(this,ta),tn(this,"addingStarted",!1),tn(this,"mouseDownOnCellCorner",!1),tn(this,"mouseDragOutside",!1),tn(this,"handleDraggedCells",0),tn(this,"directions",[]),tn(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return ts}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[ts,...tl]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",t=>to(this,tu,tp).call(this,t)),this.addHook("afterOnCellCornerDblClick",t=>to(this,ta,tg).call(this,t)),this.addHook("beforeOnCellMouseOver",(t,e)=>to(this,th,tm).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let t=this.hot.getSelectedRangeLast(),{row:e,col:r}=t.getTopStartCorner(),{row:i,col:n}=t.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:r,endRow:i,endCol:n}]),l=[],a=[],u=[];return(0,s.Bk)(o,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===l.indexOf(e)&&l.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===a.indexOf(e)&&a.push(e)}),(0,s.Bk)(l,t=>{let e=[];(0,s.Bk)(a,r=>{e.push(this.hot.getCopyableData(t,r))}),u.push(e)}),u}fillIn(){var t;let e,r,i;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[n,o,s,l]=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.getSelectedRangeLast(),u=a.getTopStartCorner(),h=a.getBottomEndCorner();this.resetSelectionOfDraggedArea();let c=[u.row,u.col,h.row,h.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(u.row,n),Math.min(u.col,o),Math.max(h.row,s),Math.max(h.col,l)],c),{directionOfDrag:f,startOfDragCoords:g,endOfDragCoords:p}=(t=(t,e)=>this.hot._createCellCoords(t,e),d[0]===c[0]&&d[1]<c[1]?(i="left",e=t(d[0],d[1]),r=t(d[2],c[1]-1)):d[2]===c[2]&&d[0]===c[0]&&d[3]>c[3]?(i="right",e=t(d[0],c[3]+1),r=t(d[2],d[3])):d[0]<c[0]&&d[1]===c[1]?(i="up",e=t(d[0],d[1]),r=t(c[0]-1,d[3])):d[2]>c[2]&&d[1]===c[1]&&(i="down",e=t(c[2]+1,d[1]),r=t(d[2],d[3])),e&&e.normalize(),r&&r.normalize(),{directionOfDrag:i,startOfDragCoords:e,endOfDragCoords:r});if(g&&g.row>-1&&g.col>-1){let t=this.getSelectionData(),e=a.clone(),r=this.hot._createCellRange(g,g,p),i=this.hot.runHooks("beforeAutofill",t,e,r,f);if(!1===i)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let n=i;if(["up","left"].indexOf(f)>-1&&!(1===i.length&&0===i[0].length)){if(n=[],"up"===f){let t=p.row-g.row+1,e=t%i.length;for(let r=0;r<t;r++)n.push(i[(r+(i.length-e))%i.length])}else{let t=p.col-g.col+1,e=t%i[0].length;for(let r=0;r<i.length;r++){n.push([]);for(let o=0;o<t;o++)n[r].push(i[r][(o+(i[r].length-e))%i[r].length])}}}this.hot.populateFromArray(g.row,g.col,n,p.row,p.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",n,e,r,f),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){let e=this.hot.getSelectedRangeLast(),r=e.getBottomEndCorner(),i=t;if(this.directions.includes(tr.vertical)&&this.directions.includes(tr.horizontal)){let n=e.getTopStartCorner();(r.col<=t.col||n.col>=t.col)&&(i=this.hot._createCellCoords(r.row,t.col)),(r.row<t.row||n.row>t.row)&&(i=this.hot._createCellCoords(t.row,r.col))}else if(this.directions.includes(tr.vertical))i=this.hot._createCellCoords(t.row,r.col);else{if(!this.directions.includes(tr.horizontal))return;i=this.hot._createCellCoords(r.row,t.col)}return this.reduceSelectionAreaIfNeeded(i)}showBorder(t){let e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();t[2]<r-1&&e[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){let e;let r=this.hot.getData(),i=this.hot.countRows();for(let n=t[2]+1;n<i;n++){for(let e=t[1];e<=t[3];e++){let t=r[n][e];if(t)return -1}let i=r[n][t[1]-1],o=r[n][t[3]+1];(i||o)&&(e=n)}return e}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...(0,s.Sc)(t,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){let t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return -1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){let{documentElement:e}=this.hot.rootDocument,r=(0,T.cv)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+(0,T.Pb)(this.hot.table),i=(0,T.cv)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+(0,T.iO)(this.hot.table);return t.clientY>r&&t.clientX<=i}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",()=>to(this,tc,tv).call(this)),this.eventManager.addEventListener(t,"mousemove",t=>to(this,td,tw).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let t=function(t){let e={};return!0===t?(e.directions=Object.keys(tr),e.autoInsertRow=!0):(0,o.Kn)(t)?((0,N.$K)(t.autoInsertRow)?t.direction===tr.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,(0,N.$K)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(tr)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function tg(){let t=this.selectAdjacent();t&&this.fillIn()}function tp(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function tm(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function tv(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function tw(t){let e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ty(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(4247);class tb{constructor(t){ty(this,"hot",void 0),ty(this,"commands",{}),ty(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){let e;for(var r,i=arguments.length,n=Array(i>1?i-1:0),l=1;l<i;l++)n[l-1]=arguments[l];let a=t.split(":"),u=a[0],h=2===a.length?a[1]:null,c=this.commands[u];if(!c)throw Error(`Menu command '${u}' not exists.`);if(h&&c.submenu&&(r=c.submenu.items,(0,s.Bk)(r,t=>{let r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===h)return e=t,!1}),c=e),!0===c.disabled||"function"==typeof c.disabled&&!0===c.disabled.call(this.hot)||(0,o.nr)(c,"submenu"))return;let d=[];"function"==typeof c.callback&&d.push(c.callback),"function"==typeof this.commonCallback&&d.push(this.commonCallback),n.unshift(a.join(":")),(0,s.Bk)(d,t=>t.apply(this.hot,n))}}function tC(t,e){let r={};return(0,s.Bk)(t,t=>{t.forAll((t,i)=>{t>=0&&i>=0&&(r[t]||(r[t]=[]),r[t][i]=e(t,i))})}),r}function tS(t,e,r,i,n){(0,s.Bk)(t,t=>{t.forAll((t,o)=>{t>=0&&o>=0&&function(t,e,r,i,n,o){let s=n(t,e),l=i;s.className&&(l="vertical"===r?function(t,e){if(-1!==t.indexOf(e))return t;let r=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${r} ${e}`}(s.className,i):function(t,e){if(-1!==t.indexOf(e))return t;let r=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${r} ${e}`}(s.className,i)),o(t,e,"className",l)}(t,o,e,r,i,n)})})}function tE(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function tT(t,e){let r=!1;return Array.isArray(t)&&(0,s.Bk)(t,t=>(t.forAll((t,i)=>{if(t>=0&&i>=0&&e(t,i))return r=!0,!1}),r)),r}function tR(t,e){let r={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:t}=e.defaultView,{top:i,left:n}=t.getBoundingClientRect();r.top=i,r.left=n}return r}let tO="---------";var tM=r(2855);let tI="alignment",tN="clear_column",tx="col_left",tk="col_right",tH="make_read_only",t_="redo";var tA=r(855);let tL="remove_col",tP="remove_row",tD="row_above",tB="row_below",tF="no_items",tW="undo",tV=[tD,tB,tx,tk,tN,tP,tL,tW,t_,tH,tI,tO,tF],tj={[tO]:function(){return{name:tO}},[tF]:function(){return{key:tF,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}},[tD]:function(){return{key:tD,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){let t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[tB]:function(){return{key:tB,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[tx]:function(){return{key:tx,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){let t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[tk]:function(){return{key:tk,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[tN]:function(){return{key:tN,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(t,e){let r=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}},[tP]:function(){return{key:tP,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[r,,i]=t[0];r-i!=0&&(e=1)}}return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",(0,tA.I8)(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[tL]:function(){return{key:tL,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[,r,,i]=t[0];r-i!=0&&(e=1)}}return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",(0,tA.X8)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[tW]:function(){return{key:tW,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[t_]:function(){return{key:t_,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[tH]:function(){return{key:tH,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_READ_ONLY),e=tT(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly);return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tT(t,(t,e)=>this.getCellMeta(t,e).readOnly);(0,s.Bk)(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&this.setCellMeta(t,r,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}},[tI]:function(){return{key:tI,name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${tI}:left`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htLeft"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1},{key:`${tI}:center`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htCenter"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1},{key:`${tI}:right`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htRight"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1},{key:`${tI}:justify`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htJustify"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1},{name:tO},{key:`${tI}:top`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_TOP),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htTop"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1},{key:`${tI}:middle`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htMiddle"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1},{key:`${tI}:bottom`,name(){let t=this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM),e=tT(this.getSelectedRange(),(t,e)=>{let r=this.getCellMeta(t,e).className;if(r&&-1!==r.indexOf("htBottom"))return!0});return e&&(t=tE(t)),t},callback(){let t=this.getSelectedRange(),e=tC(t,(t,e)=>this.getCellMeta(t,e).className),r="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,r,i),tS(t,r,i,(t,e)=>this.getCellMeta(t,e),(t,e,r,i)=>this.setCellMeta(t,e,r,i)),this.render()},disabled:!1}]}}}};function tU(){let t={};return(0,o._l)(tj,(e,r)=>{t[r]=e()}),t}function t$(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tz{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t$(this,"hot",void 0),t$(this,"predefinedItems",tU()),t$(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){let e={};this.defaultOrderPattern.length=0,(0,o._l)(t,(t,r)=>{let i="";t.name===tO?(e[tO]=t,i=tO):(isNaN(parseInt(r,10))?(t.key=void 0===t.key?r:t.key,e[r]=t):e[t.key]=t,i=t.key),this.defaultOrderPattern.push(i)}),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],n=t;return n&&n.items?n=n.items:Array.isArray(n)||(n=e),(0,o.Kn)(n)?(0,o._l)(n,(t,e)=>{let n=r["string"==typeof t?t:e];n||(n=t),(0,o.Kn)(t)?(0,o.l7)(n,t):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=e),i.push(n)}):(0,s.Bk)(n,(t,e)=>{let n=r[t];!n&&tV.indexOf(t)>=0||(n||(n={name:t,key:`${e}`}),(0,o.Kn)(t)&&(0,o.l7)(n,t),void 0===n.key&&(n.key=e),i.push(n))}),i}(t,this.defaultOrderPattern,this.predefinedItems)}}function tG(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tK{constructor(t,e){let r,i,n,o,s,l;tG(this,"top",void 0),tG(this,"topRelative",void 0),tG(this,"left",void 0),tG(this,"leftRelative",void 0),tG(this,"scrollTop",void 0),tG(this,"scrollLeft",void 0),tG(this,"cellHeight",void 0),tG(this,"cellWidth",void 0);let a=e.scrollY,u=e.scrollX;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(r=parseInt(t.top,10),n=parseInt(t.left,10),s=t.height||0,l=t.width||0,i=r,o=n,r+=a,n+=u):"event"===this.type&&(r=parseInt(t.pageY,10),n=parseInt(t.pageX,10),s=t.target.clientHeight,l=t.target.clientWidth,i=r-a,o=n-u),this.top=r,this.topRelative=i,this.left=n,this.leftRelative=o,this.scrollTop=a,this.scrollLeft=u,this.cellHeight=s,this.cellWidth=l}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function tX(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function tY(t,e){var r=tZ(t,e,"get");return r.get?r.get.call(t):r.value}function tq(t,e,r){var i=tZ(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function tZ(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var tQ=new WeakMap,tJ=new WeakMap,t0=new WeakMap,t1=new WeakMap,t2=new WeakMap;class t9{constructor(t){tX(this,tQ,{writable:!0,value:void 0}),tX(this,tJ,{writable:!0,value:void 0}),tX(this,t0,{writable:!0,value:void 0}),tX(this,t1,{writable:!0,value:!1}),tX(this,t2,{writable:!0,value:{above:0,below:0,left:0,right:0}}),tq(this,t1,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return tY(this,t2)[t]=e,this}setElement(t){return tq(this,tQ,t),this}setParentElement(t){return tq(this,tJ,t),this}updatePosition(t){tq(this,t0,new tK(t,tY(this,tQ).ownerDocument.defaultView)),tY(this,t1)?(tY(this,t0).fitsBelow(tY(this,tQ))?this.setPositionBelowCursor():tY(this,t0).fitsAbove(tY(this,tQ))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===tY(this,tQ).dir?tY(this,t0).fitsOnLeft(tY(this,tQ))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():tY(this,t0).fitsOnRight(tY(this,tQ))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=tY(this,t2).above+tY(this,t0).top-tY(this,tQ).offsetHeight;tY(this,tJ)&&(t=tY(this,t0).top+tY(this,t0).cellHeight-tY(this,tQ).offsetHeight+3),tY(this,tQ).style.top=`${t}px`}setPositionBelowCursor(){let t=tY(this,t2).below+tY(this,t0).top+1;tY(this,tJ)&&(t=tY(this,t0).top-1),tY(this,tQ).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=tY(this,t0).left;if(tY(this,tJ)){let{right:e}=tY(this,tJ).getBoundingClientRect();t+=tY(this,t0).cellWidth+e-(tY(this,t0).left+tY(this,t0).cellWidth)}else t+=tY(this,t2).right;tY(this,tQ).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=tY(this,t2).left+tY(this,t0).left-tY(this,tQ).offsetWidth;if(tY(this,tJ)){let{left:e}=tY(this,tJ).getBoundingClientRect();t-=tY(this,t0).left-e}tY(this,tQ).style.left=`${t}px`}}function t4(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:i=()=>{},onClear:n=()=>{}}=t,o=new Set,s=(0,I.uZ)(e,-1,a()-1);function l(t,e){let r=a()-1;if(t<0&&(t=r),t>r&&(t=0),o.has(t))return -1;o.add(t);let n=i(t,!1);return!1===n&&(t=l(1===e?++t:--t,e)),t}function a(){return Math.max(r(),0)}return{setCurrentPage:function(t){t>-1&&t<a()&&!1!==i(t,!0)&&(s=t)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(o.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(o.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(o.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(o.clear(),s=l(--s,-1))},getSize:a,clear:function(){o.clear(),s=e,n()}}}function t8(t){return(0,o.nr)(t,"submenu")}function t7(t){return RegExp(tO,"i").test(t.name)}function t3(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function t5(t){return(0,o.nr)(t,"disableSelection")}function t6(t,e){let r=t.slice(0);for(;0<r.length;)if(r[0].name===e)r.shift();else break;return r}let et="menu";var ee=r(2228),er=r(7687),ei=r(8179),en=r(3437),eo=r(8200);function es(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function el(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ea(t,e,r){var i=eh(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function eu(t,e){var r=eh(t,e,"get");return r.get?r.get.call(t):r.value}function eh(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var ec=new WeakMap,ed=new WeakMap;class ef{constructor(t,e){var r=this;el(this,"hot",void 0),el(this,"options",void 0),el(this,"eventManager",new c.Z(this)),el(this,"container",void 0),el(this,"positioner",void 0),el(this,"hotMenu",null),el(this,"hotSubMenus",{}),el(this,"parentMenu",void 0),el(this,"menuItems",null),el(this,"origOutsideClickDeselects",null),es(this,ec,{writable:!0,value:void 0}),es(this,ed,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new t9(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.parentMenu.runLocalHooks("afterSelectionChange",...e)})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"contextmenu",t=>this.onDocumentContextMenu(t)),t=(0,T.f5)(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return eu(this,ec)}getKeyboardShortcutsCtrl(){return eu(this,ed)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var t,e;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let r=(0,ei.Ds)(t=>this.openSubMenu(t),300),i=this.options.minWidth||215,n=!1,o=(0,s.w7)(this.menuItems,t=>{var e;return t.key===tF&&(n=!0),e=this.hot,!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))});if(o.length<1&&!n)o.push(tU()[tF]);else if(0===o.length)return;o=function(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tO,i=t.slice(0);return(e=(i=t6(i,r)).slice(0)).reverse(),(e=t6(e,r)).reverse(),i=function(t){let e=[];return(0,s.Bk)(t,(t,r)=>{r>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(i=e)}(o,tO);let l=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>(0,N.$K)(t)&&t<i?i:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(t=this.hot,(e,r,i,n,o,s)=>{if(r.hasAttribute("ghost-table"))return;let l=e.getSourceDataAtRow(i),a=t.rootDocument.createElement("div"),u="function"==typeof s?s.call(t):s;if((0,T.cS)(r),(0,T.cn)(a,"htItemWrapper"),t.getSettings().ariaTags){let e=!t3(l,t)&&!t5(l)&&!t7(l);(0,T.P$)(r,[(0,eo.rQ)(),(0,eo.QK)(u),...e?[(0,eo.Qk)(-1)]:[],...t3(l,t)?[(0,eo.gw)()]:[],...t8(l)?[(0,eo.JV)(!1)]:[]])}r.className="",r.appendChild(a),t7(l)?(0,T.cn)(r,"htSeparator"):"function"==typeof l.renderer?((0,T.cn)(r,"htCustomMenuRenderer"),r.appendChild(l.renderer(e,a,i,n,o,u))):(0,T.uS)(a,u),t3(l,t)?(0,T.cn)(r,"htDisabled"):t5(l)?(0,T.cn)(r,"htSelectionDisabled"):t8(l)&&(0,T.cn)(r,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{eu(this,ec).setCurrentPage(e.row)},afterOnCellMouseOver:(t,e)=>{this.isAllSubMenusClosed()?r(e.row):this.openSubMenu(e.row)},rowHeights:t=>o[t].name===tO?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),(0,ee.uM)()&&l&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,r,i,n)=>{this.hotMenu.view.isMouseDown()&&(n.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(l=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{(!(0,ee.uM)()||!(0,er.dO)(t))&&l&&this.hasSelectedItem()&&((0,ee.K1)()||(0,ee.L)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),ea(this,ec,(e=this.hotMenu,t4({size:()=>e.countRows(),onItemSelect(t,r){let i=e.getCell(t,0);if(!i||(0,T.pv)(i,"htSeparator")||(0,T.pv)(i,"htDisabled")||(0,T.pv)(i,"htSelectionDisabled"))return!1;e.selectCell(t,0,...r?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}}))),ea(this,ed,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];function i(t,e){s(e).addShortcuts(t,{group:et})}function n(t,e){let n=s(e);t.forEach(t=>{let{keys:e}=t;e.forEach(t=>n.removeShortcutsByKeys(t))}),r.push({shortcuts:t,contextName:e}),i(t,e)}function o(t){return t?`${et}:${t}`:et}function s(e){var r;let i=t.hotMenu.getShortcutManager(),n=o(e);return null!==(r=i.getContext(n))&&void 0!==r?r:i.addContext(n)}return i([{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let e=t.hotMenu.getSelectedLast();if(e){let r=t.openSubMenu(e[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{let r=t.hotMenu.getSelectedLast();r&&(t.hotMenu.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]),e.forEach(t=>{let{shortcuts:e,contextName:r}=t;n(e,r)}),{addCustomShortcuts:n,getCustomShortcuts:function(){return[...r]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(o(e))}}}(this)),eu(this,ed).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(eu(this,ec).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let t=this.parentMenu.hotMenu.getSelectedLast();if(t){let e=this.parentMenu.hotMenu.getCell(t[0],0);(0,T.P$)(e,[(0,eo.JV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;let e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!(0,T.pv)(e,"htSubmenu"))return!1;let r=this.hotMenu.getSourceDataAtRow(t),i=new ef(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(e.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&(0,T.P$)(e,[(0,eo.JV)(!0)]),i}closeSubMenu(t){let e=this.hotMenu.getSourceDataAtRow(t),r=this.hotSubMenus[e.key];if(r){r.destroy(),delete this.hotSubMenus[e.key];let i=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&(0,T.P$)(i,[(0,eo.JV)(!1)])}}closeAllSubMenus(){(0,s.Bk)(this.hotMenu.getData(),(t,e)=>this.closeSubMenu(e))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;let e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;let r=this.hot.getSelectedRange(),i=r?(0,s.Sc)(r,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",e.key,i,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,i,t)}isCommandPassive(t){return!1===t.isCommand||t7(t)||t3(t,this.hot)||t8(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this.options.container.ownerDocument,i=e;return i&&((0,ei.mf)(i)&&(i=null===(i=i.call(this.hot))||(0,N.o8)(i)?"":i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,t=r.querySelector(`.${this.options.className}.${i}`)),t||(t=r.createElement("div"),(0,T.cn)(t,`htMenu ${this.options.className}`),i&&(0,T.cn)(t,i),this.options.container.appendChild(t)),t}onAfterInit(){let{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,r=t.hider.style,i=t.holder.style,n=parseInt(r.width,10),o=(0,s.k$)(e,(t,e)=>t+(e.name===tO?1:26),0);i.width=`${n+3}px`,i.height=`${o+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&(0,T.P$)(this.hotMenu.rootElement,[(0,eo.tm)(),(0,eo.Qk)(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,T.MO)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,T.MO)(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&(0,T.pv)(t.target,"htCore")&&(0,T.MO)(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function eg(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function ep(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function em(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}(0,o.jB)(ef,en.Z);let ev="contextMenu";M.default.getSingleton().register("afterContextMenuDefaultOptions"),M.default.getSingleton().register("beforeContextMenuShow"),M.default.getSingleton().register("afterContextMenuShow"),M.default.getSingleton().register("afterContextMenuHide"),M.default.getSingleton().register("afterContextMenuExecute");var ew=new WeakSet,ey=new WeakSet,eb=new WeakSet,eC=new WeakSet;class eS extends C{constructor(){super(...arguments),eg(this,eC),eg(this,eb),eg(this,ey),eg(this,ew),ep(this,"commandExecutor",new tb(this.hot)),ep(this,"itemsFactory",null),ep(this,"menu",null)}static get PLUGIN_KEY(){return ev}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[tD,tB,tO,tx,tk,tO,tP,tL,tO,tW,t_,tO,tH,tO,tI]}isEnabled(){return!!this.hot.getSettings()[ev]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[ev];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new ef(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>em(this,ey,eT).call(this)),this.menu.addLocalHook("afterOpen",()=>em(this,eb,eR).call(this)),this.menu.addLocalHook("afterClose",()=>em(this,eC,eO).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.executeCommand.call(t,...r)}),this.addHook("afterOnCellContextMenu",t=>em(this,ew,eE).call(this,t)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),r=tR(this.menu.container,this.hot.rootDocument);this.open({left:e.left+r.left,top:e.top+r.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:ev})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ev)}open(t){var e;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),(0,o._l)(r,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];this.commandExecutor.execute(t,...r)}prepareMenuItems(){this.itemsFactory=new tz(this.hot,eS.DEFAULT_ITEMS);let t=this.hot.getSettings()[ev],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);let r=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),(0,s.Bk)(r,t=>this.commandExecutor.registerCommand(t.key,t))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function eE(t){let e=this.hot.getSettings(),r=e.rowHeaders,i=e.colHeaders,n=t.target;if(this.close(),(0,T.pv)(n,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||i)&&!("TD"===n.nodeName||"TD"===n.parentNode.nodeName)&&!((0,T.pv)(n,"current")&&(0,T.pv)(n,"wtBorder"))))return;let o=tR(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function eT(){this.hot.runHooks("beforeContextMenuShow",this)}function eR(){this.hot.runHooks("afterContextMenuShow",this)}function eO(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}eS.SEPARATOR={name:tO};var eM=r(292);class eI{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class eN{constructor(){this.clipboardData=new eI}}function ex(t,e){eH(t,e),e.add(t)}function ek(t,e,r){eH(t,e),e.set(t,r)}function eH(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function e_(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function eA(t,e){var r=eP(t,e,"get");return r.get?r.get.call(t):r.value}function eL(t,e,r){var i=eP(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function eP(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var eD=new WeakMap,eB=new WeakMap,eF=new WeakMap,eW=new WeakMap,eV=new WeakMap,ej=new WeakMap,eU=new WeakSet,e$=new WeakSet;class ez{constructor(t){let{countRows:e,countColumns:r,rowsLimit:i,columnsLimit:n,countColumnHeaders:o}=t;ex(this,e$),ex(this,eU),ek(this,eD,{writable:!0,value:void 0}),ek(this,eB,{writable:!0,value:void 0}),ek(this,eF,{writable:!0,value:void 0}),ek(this,eW,{writable:!0,value:void 0}),ek(this,eV,{writable:!0,value:void 0}),ek(this,ej,{writable:!0,value:void 0}),eL(this,eB,e),eL(this,eF,r),eL(this,eW,i),eL(this,eV,n),eL(this,ej,o)}setSelectedRange(t){eL(this,eD,t)}getCellsRange(){if(0===eA(this,eB).call(this)||0===eA(this,eF).call(this))return null;let{row:t,col:e}=eA(this,eD).getTopStartCorner(),{row:r,col:i}=eA(this,eD).getBottomEndCorner(),n=e_(this,e$,eK).call(this,t,r),o=e_(this,eU,eG).call(this,e,i),s=r!==n||i!==o;return{isRangeTrimmed:s,startRow:t,startCol:e,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(0===eA(this,eF).call(this)||0===eA(this,ej).call(this))return null;let{col:t}=eA(this,eD).getTopStartCorner(),{col:e}=eA(this,eD).getBottomEndCorner(),r=e_(this,eU,eG).call(this,t,e),i=e!==r;return{isRangeTrimmed:i,startRow:-1,startCol:t,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(0===eA(this,eF).call(this)||0===eA(this,ej).call(this))return null;let{col:t}=eA(this,eD).getTopStartCorner(),{col:e}=eA(this,eD).getBottomEndCorner(),r=e_(this,eU,eG).call(this,t,e),i=e!==r;return{isRangeTrimmed:i,startRow:-eA(this,ej).call(this),startCol:t,endRow:-1,endCol:r}}}function eG(t,e){return Math.min(e,Math.max(t+eA(this,eV).call(this)-1,t))}function eK(t,e){return Math.min(e,Math.max(t+eA(this,eW).call(this)-1,t))}function eX(t){let e=[],r=[];return(0,s.Bk)(t,t=>{let i=Math.min(t.startRow,t.endRow),n=Math.max(t.startRow,t.endRow);(0,I.q4)(i,n,t=>{-1===e.indexOf(t)&&e.push(t)});let o=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);(0,I.q4)(o,s,t=>{-1===r.indexOf(t)&&r.push(t)})}),{rows:e,columns:r}}var eY=r(4350);function eq(t,e){eQ(t,e),e.add(t)}function eZ(t,e,r){eQ(t,e),e.set(t,r)}function eQ(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eJ(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e0(t,e){var r=e9(t,e,"get");return r.get?r.get.call(t):r.value}function e1(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function e2(t,e,r){var i=e9(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function e9(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}M.default.getSingleton().register("afterCopyLimit"),M.default.getSingleton().register("modifyCopyableRange"),M.default.getSingleton().register("beforeCut"),M.default.getSingleton().register("afterCut"),M.default.getSingleton().register("beforePaste"),M.default.getSingleton().register("afterPaste"),M.default.getSingleton().register("beforeCopy"),M.default.getSingleton().register("afterCopy");let e4="copyPaste",e8=["fragmentSelection"],e7='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var e3=new WeakMap,e5=new WeakMap,e6=new WeakMap,rt=new WeakMap,re=new WeakMap,rr=new WeakMap,ri=new WeakMap,rn=new WeakMap,ro=new WeakSet,rs=new WeakSet,rl=new WeakSet,ra=new WeakSet,ru=new WeakSet,rh=new WeakSet,rc=new WeakSet,rd=new WeakSet,rf=new WeakSet,rg=new WeakSet;class rp extends C{constructor(){super(...arguments),eq(this,rg),eq(this,rf),eq(this,rd),eq(this,rc),eq(this,rh),eq(this,ru),eq(this,ra),eq(this,rl),eq(this,rs),eq(this,ro),eJ(this,"columnsLimit",1/0),eJ(this,"rowsLimit",1/0),eJ(this,"pasteMode","overwrite"),eJ(this,"uiContainer",this.hot.rootDocument.body),eZ(this,e3,{writable:!0,value:!1}),eZ(this,e5,{writable:!0,value:!1}),eZ(this,e6,{writable:!0,value:!1}),eZ(this,rt,{writable:!0,value:"cells-only"}),eZ(this,re,{writable:!0,value:!1}),eZ(this,rr,{writable:!0,value:!1}),eZ(this,ri,{writable:!0,value:new ez({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),eZ(this,rn,{writable:!0,value:!1}),eJ(this,"copyableRanges",[])}static get PLUGIN_KEY(){return e4}static get SETTING_KEYS(){return[e4,...e8]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[e4]}enablePlugin(){var t,e,r=this;if(this.enabled)return;let{[e4]:i}=this.hot.getSettings();"object"==typeof i&&(this.pasteMode=null!==(t=i.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,e2(this,e3,!!i.copyColumnHeaders),e2(this,e5,!!i.copyColumnGroupHeaders),e2(this,e6,!!i.copyColumnHeadersOnly),this.uiContainer=null!==(e=i.uiContainer)&&void 0!==e?e:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",t=>e1(this,ru,rb).call(this,t)),this.addHook("afterSelection",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return e1(r,rh,rC).call(r,...e)}),this.addHook("afterSelectionEnd",()=>e1(this,rc,rS).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),(0,ee.G6)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return e1(r,rd,rE).call(r,...e)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return e1(r,rf,rT).call(r,...e)}),this.addHook("afterSelection",()=>e1(this,rg,rR).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";e2(this,rt,t),e2(this,re,!0),e1(this,ro,rm).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){e2(this,rr,!0),e1(this,ro,rm).call(this,"cut")}getRangedCopyableData(t){return(0,eM.P)(this.getRangedData(t))}getRangedData(t){let e=[],{rows:r,columns:i}=eX(t);return(0,s.Bk)(r,t=>{let r=[];(0,s.Bk)(i,e=>{t<0?r.push(this.hot.getColHeader(e,t)):r.push(this.hot.getCopyableData(t,e))}),e.push(r)}),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;let r=new eN;t&&r.clipboardData.setData("text/plain",t),e&&r.clipboardData.setData("text/html",e),this.onPaste(r)}setCopyableText(){let t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader()){this.copyableRanges=[];return}e0(this,ri).setSelectedRange(t);let e=new Map([["headers",null],["cells",null]]);"column-headers-only"===e0(this,rt)?e.set("headers",e0(this,ri).getMostBottomColumnHeadersRange()):("with-column-headers"===e0(this,rt)?e.set("headers",e0(this,ri).getMostBottomColumnHeadersRange()):"with-column-group-headers"===e0(this,rt)&&e.set("headers",e0(this,ri).getAllColumnHeadersRange()),e.set("cells",e0(this,ri).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter(t=>null!==t).map(t=>{let{startRow:e,startCol:r,endRow:i,endCol:n}=t;return{startRow:e,startCol:r,endRow:i,endCol:n}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let r=e.get("cells");if(null!==r&&r.isRangeTrimmed){let{startRow:t,startCol:e,endRow:i,endCol:n}=r;this.hot.runHooks("afterCopyLimit",i-t+1,n-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;let r=t.length,i=t[0].length,n=[],{row:o,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner(),u=o,h=s,c=o,d=s;for(;n.length<r||u<=l;){let{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(u,s);if(u=l+1,!0===e)continue;c=l,h=s;let f=[],g=n.length%r;for(;f.length<i||h<=a;){let{skipColumnOnPaste:e,visualCol:r}=this.hot.getCellMeta(o,h);if(h=r+1,!0===e)continue;d=r;let n=f.length%i;f.push(t[g][n])}n.push(f)}return e2(this,rn,!0),this.hot.populateFromArray(o,s,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(t){if(!this.hot.isListening()&&!e0(this,re)||this.isEditorOpened())return;this.setCopyableText(),e2(this,re,!1);let e=this.getRangedData(this.copyableRanges),r=e1(this,rs,rv).call(this,this.copyableRanges),i=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,r);if(i){let i=(0,eM.P)(e);if(t&&t.clipboardData){let r=(0,eY.bt)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[e7,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.runHooks("afterCopy",e,this.copyableRanges,r)}e2(this,rt,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!e0(this,rr)||this.isEditorOpened())return;this.setCopyableText(),e2(this,rr,!1);let e=this.getRangedData(this.copyableRanges),r=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(r){let r=(0,eM.P)(e);if(t&&t.clipboardData){let i=(0,eY.bt)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[e7,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){let e;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){let r=(0,H.Nw)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(r&&/(<table)|(<TABLE)/g.test(r)){let t=(0,eY.BU)(r,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=(0,eM.Q)(e)),void 0===e||e&&0===e.length||!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;let[r,i,n,o]=this.populateValues(e);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,n),Math.min(this.hot.countCols()-1,o)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function rm(t){if((0,ee.G6)()){let e=this.hot.getSelectedRangeLast();if(e){let{row:r,col:i}=e.highlight,n=this.hot.getCell(r,i,!0);n&&(0,T.lq)(n,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function rv(t){let{rows:e}=eX(t),r=0;for(let t=0;t<e.length&&!(e[t]>=0);t++)r+=1;return{columnHeadersCount:r}}function rw(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i&&(0,T.l2)(i)}}}function ry(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);null!=i&&i.hasAttribute("contenteditable")&&(0,T.yY)(i)}}}function rb(t){var e,r,i,n,o;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),e0(this,e3)&&t.items.push((r=this,{key:"copy_with_column_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,I.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback(){r.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),e0(this,e5)&&t.items.push((i=this,{key:"copy_with_column_group_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,I.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback(){i.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),e0(this,e6)&&t.items.push((n=this,{key:"copy_column_headers_only",name(){let t=this.getSelectedRangeLast(),e=t?(0,I.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),t.items.push((o=this,{key:"cut",name(){return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_CUT)},callback(){o.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}))}function rC(t,e,r,i,n){e0(this,rn)&&(n.value=!0),e2(this,rn,!1)}function rS(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function rE(){e1(this,ra,ry).call(this)}function rT(){e1(this,rl,rw).call(this)}function rR(){e1(this,ra,ry).call(this)}function rO(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function rM(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rI(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}M.default.getSingleton().register("afterDropdownMenuDefaultOptions"),M.default.getSingleton().register("beforeDropdownMenuShow"),M.default.getSingleton().register("afterDropdownMenuShow"),M.default.getSingleton().register("afterDropdownMenuHide"),M.default.getSingleton().register("afterDropdownMenuExecute");let rN="dropdownMenu",rx="changeType";var rk=new WeakSet,rH=new WeakSet,r_=new WeakSet,rA=new WeakSet,rL=new WeakSet,rP=new WeakSet,rD=new WeakSet;class rB extends C{static get PLUGIN_KEY(){return rN}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[tx,tk,tO,tL,tO,tN,tO,tH,tO,tI]}constructor(t){super(t),rO(this,rD),rO(this,rP),rO(this,rL),rO(this,rA),rO(this,r_),rO(this,rH),rO(this,rk),rM(this,"commandExecutor",new tb(this.hot)),rM(this,"itemsFactory",null),rM(this,"menu",null),this.hot.addHook("afterGetColHeader",(t,e)=>rI(this,r_,rV).call(this,t,e))}isEnabled(){return this.hot.getSettings()[rN]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new tz(this.hot,rB.DEFAULT_ITEMS);let e=this.hot.getSettings()[rN],r={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);let i=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new ef(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>rI(this,rA,rj).call(this)),this.menu.addLocalHook("afterOpen",()=>rI(this,rL,rU).call(this)),this.menu.addLocalHook("afterSubmenuOpen",t=>rI(this,rP,r$).call(this,t)),this.menu.addLocalHook("afterClose",()=>rI(this,rD,rz).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.executeCommand.call(t,...r)}),(0,s.Bk)(i,t=>this.commandExecutor.registerCommand(t.key,t))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("grid"),e=()=>{let{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);let{from:e}=this.hot.getSelectedRangeLast(),r=tR(this.menu.container,this.hot.rootDocument),i=this.hot.getCell(-1,e.col,!0),n=i.getBoundingClientRect();this.open({left:n.left+r.left,top:n.top+i.offsetHeight+r.top},{left:n.width}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:rN},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:rN}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rN)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>rI(this,rH,rW).call(this,t))}open(t){var e;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),(0,o._l)(r,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];this.commandExecutor.execute(t,...r)}setListening(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function rF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function rW(t){if(t.stopPropagation(),(0,T.pv)(t.target,rx)){let e=tR(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+3+e.top},{left:r.width})}}function rV(t,e){let r=e.parentNode;if(!r)return;let i=r.parentNode.childNodes,n=Array.prototype.indexOf.call(i,r);if(t<0||n!==i.length-1)return;let o=e.querySelector(`.${rx}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}let s=this.hot.rootDocument.createElement("button");s.className=rx,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,T.P$)(s,[(0,eo.cV)(),(0,eo.QK)(" ")]),(0,T.P$)(e,[(0,eo.fv)("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function rj(){this.hot.runHooks("beforeDropdownMenuShow",this)}function rU(){this.hot.runHooks("afterDropdownMenuShow",this),rI(this,rk,rF).call(this,this.menu)}function r$(t){rI(this,rk,rF).call(this,t)}function rz(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}rB.SEPARATOR={name:tO},r(921);var rG=r(2836),rK=r(4748),rX=r(6678),rY=r(537);function rq(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class rZ{constructor(t,e){let{id:r,stateless:i=!0}=e;rq(this,"hot",void 0),rq(this,"id",void 0),rq(this,"elements",[]),rq(this,"hidden",!1),rq(this,"stateId",""),rq(this,"state",void 0),this.hot=t,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new rY.A)}getElements(){return this.elements}reset(){(0,s.Bk)(this.elements,t=>t.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,s.Bk)(this.elements,t=>t.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,o.jB)(rZ,en.Z);let rQ={};function rJ(t,e){if(!rQ[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:r,descriptor:i}=rQ[t],n=e;return i.inputValuesDecorator&&(n=i.inputValuesDecorator(n)),function(t){return r.apply(t.meta.instance,[].concat([t],[n]))}}function r0(t){if(!rQ[t])throw Error(`Filter condition "${t}" does not exist.`);return rQ[t].descriptor}function r1(t,e,r){r.key=t,rQ[t]={condition:e,descriptor:r}}let r2="none";r1(r2,function(){return!0},{name:tM.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});let r9="empty";r1(r9,function(t){return(0,N.xb)(t.value)},{name:tM.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});let r4="not_empty";r1(r4,function(t,e){return!rJ(r9,e)(t)},{name:tM.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0}),r1("eq",function(t,e){let[r]=e;return(0,N.Pz)(t.value).toLocaleLowerCase(t.meta.locale)===(0,N.Pz)(r)},{name:tM.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0}),r1("neq",function(t,e){return!rJ("eq",e)(t)},{name:tM.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0}),r1("gt",function(t,e){let[r]=e,i=r;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value>i},{name:tM.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0}),r1("gte",function(t,e){let[r]=e,i=r;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value>=i},{name:tM.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0}),r1("lt",function(t,e){let[r]=e,i=r;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value<i},{name:tM.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0}),r1("lte",function(t,e){let[r]=e,i=r;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value<=i},{name:tM.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var r8=r(2067);let r7="date_after";r1(r7,function(t,e){let[r]=e,i=r8(t.value,t.meta.dateFormat),n=r8(r,t.meta.dateFormat);return!!(i.isValid()&&n.isValid())&&i.diff(n)>=0},{name:tM.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});let r3="date_before";r1(r3,function(t,e){let[r]=e,i=r8(t.value,t.meta.dateFormat),n=r8(r,t.meta.dateFormat);return!!(i.isValid()&&n.isValid())&&0>=i.diff(n)},{name:tM.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});let r5="between";r1(r5,function(t,e){let[r,i]=e,n=r,o=i;if("numeric"===t.meta.type){let t=parseFloat(n,10),e=parseFloat(o,10);n=Math.min(t,e),o=Math.max(t,e)}else if("date"===t.meta.type){let e=rJ(r3,[o]),r=rJ(r7,[n]);return e(t)&&r(t)}return t.value>=n&&t.value<=o},{name:tM.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});let r6="not_between";r1(r6,function(t,e){return!rJ(r5,e)(t)},{name:tM.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});let it="begins_with";r1(it,function(t,e){let[r]=e;return(0,N.Pz)(t.value).toLocaleLowerCase(t.meta.locale).startsWith((0,N.Pz)(r))},{name:tM.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});let ie="ends_with";r1(ie,function(t,e){let[r]=e;return(0,N.Pz)(t.value).toLocaleLowerCase(t.meta.locale).endsWith((0,N.Pz)(r))},{name:tM.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});let ir="contains";r1(ir,function(t,e){let[r]=e;return(0,N.Pz)(t.value).toLocaleLowerCase(t.meta.locale).indexOf((0,N.Pz)(r))>=0},{name:tM.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});let ii="not_contains";r1(ii,function(t,e){return!rJ(ir,e)(t)},{name:tM.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});let io="date_tomorrow";r1(io,function(t){let e=r8(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(r8().subtract(-1,"days").startOf("day"),"d")},{name:tM.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});let is="date_today";r1(is,function(t){let e=r8(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(r8().startOf("day"),"d")},{name:tM.FILTERS_CONDITIONS_TODAY,inputsCount:0});let il="date_yesterday";r1(il,function(t){let e=r8(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(r8().subtract(1,"days").startOf("day"),"d")},{name:tM.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});let ia="text",iu={numeric:[r2,tO,r9,r4,tO,"eq","neq",tO,"gt","gte","lt","lte",r5,r6],[ia]:[r2,tO,r9,r4,tO,"eq","neq",tO,it,ie,tO,ir,ii],date:[r2,tO,r9,r4,tO,"eq","neq",tO,r3,r7,r5,tO,io,is,il]};function ih(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}let ic="built",id="building",ig=["click","input","keydown","keypress","keyup","focus","blur","change"];class ip{static get DEFAULTS(){return(0,o.d9)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){ih(this,"hot",void 0),ih(this,"eventManager",new c.Z(this)),ih(this,"options",void 0),ih(this,"_element",void 0),ih(this,"buildState",void 0),this.hot=t,this.options=(0,o.l7)(ip.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===id||(this.buildState===ic?this.update():(this.buildState=id,this.build(),this.buildState=ic)),this._element}isBuilt(){return this.buildState===ic}translateIfPossible(t){return"string"==typeof t&&t.startsWith(tM.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}build(){let t=(t,e)=>{this.eventManager.addEventListener(t,e,t=>this.runLocalHooks(e,t,this))};if(this.buildState||(this.buildState=id),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,T.cn)(this._element,this.options.className),this.options.children.length)(0,s.Bk)(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){let e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),(0,o._l)(this.options,(t,r)=>{void 0!==e[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(e[r]=this.translateIfPossible(t))}),this._element.appendChild(e),(0,s.Bk)(ig,r=>t(e,r))}else(0,s.Bk)(ig,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function im(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function iv(t,e){var r=iw(t,e,"get");return r.get?r.get.call(t):r.value}function iw(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}(0,o.jB)(ip,en.Z);var iy=new WeakMap,ib=new WeakSet;class iC extends ip{static get DEFAULTS(){return(0,o.d9)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,(0,o.l7)(iC.DEFAULTS,e)),im(this,ib),ib.add(this),im(this,iy),iy.set(this,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>(function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r})(this,ib,iS).call(this,t))}build(){var t;super.build();let e=this.hot.rootDocument.createElement("div");t=this._element.firstChild,function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,iw(this,iy,"set"),t),(0,T.cn)(this._element,"htUIInput"),(0,T.cn)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(iv(this,iy).type=this.options.type,iv(this,iy).placeholder=this.translateIfPossible(this.options.placeholder),iv(this,iy).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&iv(this,iy).focus()}}function iS(t){this.options.value=t.target.value}function iE(t,e){iR(t,e),e.add(t)}function iT(t,e,r){iR(t,e),e.set(t,r)}function iR(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function iO(t,e,r){var i=iN(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function iM(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function iI(t,e){var r=iN(t,e,"get");return r.get?r.get.call(t):r.value}function iN(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var ix=new WeakMap,ik=new WeakMap,iH=new WeakMap,i_=new WeakMap,iA=new WeakMap,iL=new WeakSet,iP=new WeakSet,iD=new WeakSet;class iB extends ip{static get DEFAULTS(){return(0,o.d9)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,(0,o.l7)(iB.DEFAULTS,e)),iE(this,iD),iE(this,iP),iE(this,iL),iT(this,ix,{writable:!0,value:null}),iT(this,ik,{writable:!0,value:[]}),iT(this,iH,{writable:!0,value:void 0}),iT(this,i_,{writable:!0,value:void 0}),iT(this,iA,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return iI(this,ix)}registerHooks(){this.addLocalHook("click",()=>iM(this,iD,iV).call(this))}setItems(t){iO(this,ik,this.translateNames(t)),iI(this,ix)&&iI(this,ix).setMenuItems(iI(this,ik))}translateNames(t){return(0,s.Bk)(t,t=>{t.name=this.translateIfPossible(t.name)}),t}build(){super.build(),iO(this,ix,new ef(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),iI(this,ix).setMenuItems(iI(this,ik));let t=new ip(this.hot,{className:"htUISelectCaption"}),e=new ip(this.hot,{className:"htUISelectDropdown"});iO(this,iH,t),iO(this,i_,t.element),iO(this,iA,e),this.hot.getSettings().ariaTags&&((0,T.P$)(e.element,[(0,eo.cV)()]),(0,T.P$)(this._element,[(0,eo.a6)()])),(0,s.Bk)([t,e],t=>this._element.appendChild(t.element)),iI(this,ix).addLocalHook("select",t=>iM(this,iL,iF).call(this,t)),iI(this,ix).addLocalHook("afterClose",()=>iM(this,iP,iW).call(this)),this.update()}update(){let t;this.isBuilt()&&(t=this.options.value?this.options.value.name:iI(this,ix).hot.getTranslatedPhrase(tM.FILTERS_CONDITIONS_NONE),iI(this,i_).textContent=t,super.update())}openOptions(){let t=this.element.getBoundingClientRect();iI(this,ix)&&(iI(this,ix).open(),iI(this,ix).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),iI(this,ix).getNavigator().toFirstItem(),iI(this,ix).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){iI(this,ix)&&iI(this,ix).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){iI(this,ix)&&(iI(this,ix).destroy(),iO(this,ix,null)),iI(this,iH)&&iI(this,iH).destroy(),iI(this,iA)&&iI(this,iA).destroy(),super.destroy()}}function iF(t){t.name!==tO&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function iW(){this.runLocalHooks("afterClose")}function iV(){this.openOptions()}function ij(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function iU(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i$(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}var iz=new WeakSet,iG=new WeakSet;class iK extends rZ{constructor(t,e){super(t,{id:e.id,stateless:!1}),ij(this,iG),ij(this,iz),iU(this,"name",""),iU(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new iB(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new iC(this.hot,{placeholder:tM.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new iC(this.hot,{placeholder:tM.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",t=>i$(this,iz,iX).call(this,t)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",t=>this.runLocalHooks("selectTabKeydown",t)),(0,s.Bk)(this.getInputElements(),t=>{t.addLocalHook("keydown",t=>i$(this,iG,iY).call(this,t))})}setState(t){if(this.reset(),!t)return;let e=(0,o.d9)(t.command);e.name.startsWith(tM.FILTERS_CONDITIONS_NAMESPACE)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),(0,s.Bk)(t.args,(t,r)=>{if(r>e.inputsCount-1)return!1;let i=this.getInputElement(r);i.setValue(t),i[e.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>i.focus(),10)})}getState(){let t=this.getSelectElement().getValue()||r0(r2),e=[];return(0,s.Bk)(this.getInputElements(),(r,i)=>{t.inputsCount>i&&e.push(r.getValue())}),{command:t,args:e}}updateState(t,e){let r=t?r0(t.name):r0(r2);this.state.setValueAtIndex(e,{command:r,args:t?t.args:[]}),t||(0,s.Bk)(this.getInputElements(),t=>t.setValue(null))}getSelectElement(){return this.elements.filter(t=>t instanceof iB)[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter(t=>t instanceof iC)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,r,i,n,o)=>{(0,T.cn)(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,T.cn)(e.parentNode,"border");let l=this.hot.rootDocument.createElement("div");return(0,T.cn)(l,"htFiltersMenuLabel"),l.textContent=o,e.appendChild(l),(0,s.Bk)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getPlugin("filters").getSelectedColumn(),e=[r0(r2)];if(null!==t){let{visualIndex:r}=t;e=function(t){let e=[],r=t;return iu[r]||(r=ia),(0,s.Bk)(iu[r],t=>{let r;r=t===tO?{name:tO}:(0,o.d9)(r0(t)),e.push(r)}),e}(this.hot.getDataType(0,r,this.hot.countRows(),r))}(0,s.Bk)(this.getInputElements(),t=>t.hide()),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function iX(t){(0,s.Bk)(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),0===r&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function iY(t){(0,rX.ot)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,er.mM)(t))}let iq={};function iZ(t,e,r){iq[t]={name:e,func:r}}let iQ="conjunction",iJ=tM.FILTERS_LABELS_CONJUNCTION;iZ(iQ,iJ,function(t,e){return t.every(t=>t.func(e))});let i0="disjunction",i1=tM.FILTERS_LABELS_DISJUNCTION;iZ(i0,i1,function(t,e){return t.some(t=>t.func(e))});let i2="disjunctionWithExtraCondition",i9=tM.FILTERS_LABELS_DISJUNCTION;function i4(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function i8(t,e){var r=i3(t,e,"get");return r.get?r.get.call(t):r.value}function i7(t,e,r){var i=i3(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function i3(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}iZ(i2,i9,function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(t=>t.func(e))&&t[t.length-1].func(e)});var i5=new WeakMap,i6=new WeakMap;class nt extends ip{static get DEFAULTS(){return(0,o.d9)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,(0,o.l7)(nt.DEFAULTS,e)),i4(this,i5,{writable:!0,value:void 0}),i4(this,i6,{writable:!0,value:void 0})}build(){super.build();let t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i7(this,i6,t),i7(this,i5,this._element.firstChild),i8(this,i5).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(i8(this,i6).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&i8(this,i5).checked}setChecked(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(i8(this,i5).checked=t)}focus(){this.isBuilt()&&i8(this,i5).focus()}}var ne=new WeakSet;class nr extends rZ{constructor(t,e){var r,i;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,ne),ne.add(this),(r="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r="name","string"))?i:String(i))in this?Object.defineProperty(this,r,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[r]="",this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,T.cn)(e.parentNode,"htFiltersMenuOperators"),(0,s.Bk)(this.elements,t=>e.appendChild(t.element)),e)}}buildOperatorsElement(){let t=[iQ,i0];(0,s.Bk)(t,e=>{let r=new nt(this.hot,{name:"operator",label:{htmlFor:e,textContent:iq[e].name},value:e,checked:e===t[0],id:e});r.addLocalHook("change",t=>(function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r})(this,ne,ni).call(this,t)),this.elements.push(r)})}setChecked(t){if(this.elements.length<t)throw Error(rG.e`Radio button with index ${t} doesn't exist.`);(0,s.Bk)(this.elements,(e,r)=>{e.setChecked(r===t)})}getActiveOperationId(){let t=this.elements.find(t=>t instanceof nt&&t.isChecked());return t?t.getValue():iQ}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,s.Bk)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iQ,e=arguments.length>1?arguments[1]:void 0,r=t;r===i2&&(r=i0),this.state.setValueAtIndex(e,r)}reset(){this.setChecked(0)}}function ni(t){this.setState(t.target.value)}(0,E.sx)();let nn=new Set([1]).has(1),no=nn&&"function"==typeof Array.from;function ns(t){let e=t;return nn&&(e=new Set(e)),function(t){return nn?e.has(t):!!~e.indexOf(t)}}function nl(t){return null==t?"":t}function na(t){let e=t;return(e=no?Array.from(new Set(e)):(0,s.uW)(e)).sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)}function nu(t,e,r,i){let n;let o=[],l=t===e;return l||(n=ns(e)),(0,s.Bk)(t,t=>{let e,s=!1;(l||n(t))&&(s=!0);let a={checked:s,value:t,visualValue:(""===(e=t)&&(e=`(${r})`),e)};i&&i(a),o.push(a)}),o}var nh=r(7628);function nc(t,e){var r=nd(t,e,"get");return r.get?r.get.call(t):r.value}function nd(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var nf=new WeakMap;class ng extends ip{static get DEFAULTS(){return(0,o.d9)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,(0,o.l7)(ng.DEFAULTS,e)),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,nf),nf.set(this,{writable:!0,value:void 0})}build(){var t;super.build(),t=this._element.firstChild,function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,nd(this,nf,"set"),t)}update(){this.isBuilt()&&(nc(this,nf).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&nc(this,nf).focus()}activate(){nc(this,nf).click()}}function np(t,e){nv(t,e),e.add(t)}function nm(t,e,r){nv(t,e),e.set(t,r)}function nv(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function nw(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function ny(t,e){var r=nC(t,e,"get");return r.get?r.get.call(t):r.value}function nb(t,e,r){var i=nC(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function nC(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}let nS="multipleSelect.itemBox";var nE=new WeakMap,nT=new WeakMap,nR=new WeakMap,nO=new WeakMap,nM=new WeakMap,nI=new WeakMap,nN=new WeakSet,nx=new WeakSet,nk=new WeakSet,nH=new WeakSet;class n_ extends ip{static get DEFAULTS(){return(0,o.d9)({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,(0,o.l7)(n_.DEFAULTS,e)),np(this,nH),np(this,nk),np(this,nx),np(this,nN),nm(this,nE,{writable:!0,value:[]}),nm(this,nT,{writable:!0,value:void 0}),nm(this,nR,{writable:!0,value:void 0}),nm(this,nO,{writable:!0,value:void 0}),nm(this,nM,{writable:!0,value:void 0}),nm(this,nI,{writable:!0,value:void 0}),nb(this,nO,new iC(this.hot,{placeholder:tM.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),nb(this,nM,new ng(this.hot,{textContent:tM.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),nb(this,nI,new ng(this.hot,{textContent:tM.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ny(this,nT)}registerHooks(){ny(this,nO).addLocalHook("keydown",t=>nw(this,nx,nL).call(this,t)),ny(this,nO).addLocalHook("input",t=>nw(this,nN,nA).call(this,t)),ny(this,nM).addLocalHook("click",t=>nw(this,nk,nP).call(this,t)),ny(this,nI).addLocalHook("click",t=>nw(this,nH,nD).call(this,t))}setItems(t){nb(this,nE,t),ny(this,nT)&&ny(this,nT).loadData(ny(this,nE))}setLocale(t){nb(this,nR,t)}getLocale(){return ny(this,nR)}getItems(){return[...ny(this,nE)]}getValue(){return function(t){let e=[];return(0,s.Bk)(t,t=>{t.checked&&e.push(t.value)}),e}(ny(this,nE))}getSearchInputElement(){return ny(this,nO)}getSelectAllElement(){return ny(this,nM)}getClearAllElement(){return ny(this,nI)}isSelectedAllValues(){return ny(this,nE).length===this.getValue().length}build(){super.build();let{rootDocument:t}=this.hot,e=t.createElement("div"),r=new ip(this.hot,{className:"htUISelectionControls",children:[ny(this,nM),ny(this,nI)]});this._element.appendChild(ny(this,nO).element),this._element.appendChild(r.element),this._element.appendChild(e);let i=e=>{if(!this._element)return;ny(this,nT)&&ny(this,nT).destroy(),(0,T.cn)(e,"htUIMultipleSelectHot"),nb(this,nT,new this.hot.constructor(e,{data:ny(this,nE),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,r,i,n,o)=>{t.title=o.instance.getDataAtRowProp(e,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ny(this,nT).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>ny(this,nT).container.scrollWidth-(0,T.np)(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ny(this,nT).init();let r=ny(this,nT).getShortcutManager(),i=r.getContext("grid");i.removeShortcutsByKeys(["Tab"]),i.removeShortcutsByKeys(["Shift","Tab"]),i.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:nS}),i.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{ny(this,nT).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:nS})};i(e),this.hot._registerTimeout(()=>i(e),100)}focus(){this.isBuilt()&&ny(this,nT).listen()}reset(){ny(this,nO).reset(),ny(this,nM).reset(),ny(this,nI).reset()}update(){this.isBuilt()&&(ny(this,nT).loadData(function(t,e){let r=ns(e);return(0,s.Sc)(t,t=>(t.checked=r(t.value),t))}(ny(this,nE),this.options.value)),super.update())}destroy(){ny(this,nT)&&ny(this,nT).destroy(),ny(this,nO).destroy(),ny(this,nI).destroy(),ny(this,nM).destroy(),nb(this,nO,null),nb(this,nI,null),nb(this,nM,null),nb(this,nT,null),nb(this,nE,null),super.destroy()}}function nA(t){let e;let r=t.target.value.toLocaleLowerCase(this.getLocale());e=""===r?[...ny(this,nE)]:(0,s.w7)(ny(this,nE),t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(r)>=0),ny(this,nT).loadData(e)}function nL(t){this.runLocalHooks("keydown",t,this);let e=(0,ei.r$)(rX.ot,t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),(0,er.mM)(t),ny(this,nT).listen(),ny(this,nT).selectCell(0,0))}function nP(t){let e=[];t.preventDefault(),(0,s.Bk)(ny(this,nT).getSourceData(),(t,r)=>{t.checked=!0,e.push((0,nh.ec)(t,r)[0])}),ny(this,nT).setSourceDataAtCell(e)}function nD(t){let e=[];t.preventDefault(),(0,s.Bk)(ny(this,nT).getSourceData(),(t,r)=>{t.checked=!1,e.push((0,nh.ec)(t,r)[0])}),ny(this,nT).setSourceDataAtCell(e)}let nB="by_value";r1(nB,function(t,e){let[r]=e;return r(t.value)},{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[ns(e)]},showOperators:!1});var nF=new WeakSet;class nW extends rZ{constructor(t,e){var r,i;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,nF),nF.add(this),(r="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r="name","string"))?i:String(i))in this?Object.defineProperty(this,r,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[r]="",this.name=e.name,this.elements.push(new n_(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",t=>(function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r})(this,nF,nV).call(this,t)).addLocalHook("listTabKeydown",t=>this.runLocalHooks("listTabKeydown",t))}getElements(){let t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===nB){let e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){let t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?r2:nB},args:[t.getValue()],itemsSnapshot:e}}updateState(t){let e=(e,r,i,n,o)=>{let[l]=(0,s.w7)(r,t=>t.name===nB),a={},u=this.hot.getTranslatedPhrase(tM.FILTERS_VALUES_BLANK_CELLS);if(l){let r=na((0,s.Sc)(n(e,o),t=>t.value));i&&(l.args[0]=i);let h=[],c=nu(r,l.args[0],u,t=>{t.checked&&h.push(t.value)}),d=t.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,d).locale,a.args=[h],a.command=r0(nB),a.itemsSnapshot=c}else a.args=[],a.command=r0(r2);this.state.setValueAtIndex(e,a)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(t=>t instanceof n_)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,r,i,n,o)=>{(0,T.cn)(e.parentNode,"htFiltersMenuValue");let l=this.hot.rootDocument.createElement("div");return(0,T.cn)(l,"htFiltersMenuLabel"),l.textContent=o,e.appendChild(l),(0,s.Bk)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getTranslatedPhrase(tM.FILTERS_VALUES_BLANK_CELLS),e=na(this._getColumnVisibleValues()),r=nu(e,e,t);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(e);let i=this.hot.getPlugin("filters").getSelectedColumn();null!==i&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){let t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:(0,s.Sc)(this.hot.getDataAtCol(t.visualIndex),t=>nl(t))}}function nV(t){(0,rX.ot)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,er.mM)(t))}var nj=new WeakSet;class nU extends rZ{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){var r,i;super(t,{id:e.id,stateless:!0}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,nj),nj.add(this),(r="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r="name","string"))?i:String(i))in this?Object.defineProperty(this,r,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[r]="",this.name=e.name,this.elements.push(new iC(this.hot,{type:"button",value:tM.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:nU.BUTTON_OK})),this.elements.push(new iC(this.hot,{type:"button",value:tM.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:nU.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,s.Bk)(this.elements,t=>{t.addLocalHook("click",(t,e)=>(function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r})(this,nj,n$).call(this,t,e))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,T.cn)(e.parentNode,"htFiltersMenuActionBar"),(0,s.Bk)(this.elements,t=>e.appendChild(t.element)),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function n$(t,e){e.options.identifier===nU.BUTTON_OK?this.accept():this.cancel()}function nz(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}let nG="ConditionCollection.filteringStates";class nK{constructor(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];nz(this,"hot",void 0),nz(this,"isMapRegistrable",void 0),nz(this,"filteringStates",new rY.A),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(nG,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var r;let i=this.filteringStates.getValueAtIndex(e),n=null!==(r=null==i?void 0:i.conditions)&&void 0!==r?r:[],o=null==i?void 0:i.operation;return this.isMatchInConditions(n,t,o)}isMatchInConditions(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iQ;return!t.length||(function(t){if(!iq[t])throw Error(`Operation with id "${t}" does not exist.`);let e=iq[t].func;return function(t,r){return e(t,r)}})(r)(t,e)}addCondition(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iQ,i=arguments.length>3?arguments[3]:void 0,n=this.hot.getCellMeta(0,t).locale,o=(0,s.Sc)(e.args,t=>"string"==typeof t?t.toLocaleLowerCase(n):t),l=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);let a=this.getOperation(t);if(a){if(a!==r)throw Error(rG.e`The column of index ${t} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,N.o8)(iq[r]))throw Error(rG.e`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let u=this.getConditions(t);0===u.length?this.filteringStates.setValueAtIndex(t,{operation:r,conditions:[{name:l,args:o,func:rJ(l,o)}]},i):u.push({name:l,args:o,func:rJ(l,o)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,r;return null!==(e=null===(r=this.filteringStates.getValueAtIndex(t))||void 0===r?void 0:r.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(t=>{let[e]=t;return e})}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return(0,s.k$)(this.filteringStates.getEntries(),(t,e)=>{let[r,{operation:i,conditions:n}]=e;return t.push({column:r,operation:i,conditions:(0,s.Sc)(n,t=>{let{name:e,args:r}=t;return{name:e,args:r}})}),t},[])}importAllConditions(t){this.clean(),(0,s.Bk)(t,t=>{(0,s.Bk)(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){let r=this.getConditions(t);return e?r.some(t=>t.name===e):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(nG),this.filteringStates=null,this.clearLocalHooks()}}function nX(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}(0,o.jB)(nK,en.Z);class nY{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];nX(this,"conditionCollection",void 0),nX(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return(0,s.Bk)(this.conditionCollection.getFilteredColumns(),(e,r)=>{let i=this.columnDataFactory(e);r&&(i=this._getIntersectData(i,t)),t=this.filterByColumn(e,i)}),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return(0,s.Bk)(e,e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&r.push(e)}),r}_getIntersectData(t,e){let r=[];return(0,s.Bk)(e,e=>{let i=e.meta.visualRow;void 0!==t[i]&&(r[i]=t[i])}),r}}function nq(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function nZ(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nQ(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}var nJ=new WeakSet,n0=new WeakSet,n1=new WeakSet;class n2{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];nq(this,n1),nq(this,n0),nq(this,nJ),nZ(this,"hot",void 0),nZ(this,"conditionCollection",void 0),nZ(this,"columnDataFactory",void 0),nZ(this,"changes",[]),nZ(this,"grouping",!1),nZ(this,"latestEditedColumnPosition",-1),nZ(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",t=>nQ(this,nJ,n9).call(this,t)),this.conditionCollection.addLocalHook("afterRemove",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("afterAdd",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("beforeClean",()=>nQ(this,n0,n4).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>nQ(this,n1,n8).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,s.Bk)(this.changes,t=>{this.updateStatesAtColumn(t)}),this.changes.length=0}updateStatesAtColumn(t,e){var r=this;if(this.grouping){-1===this.changes.indexOf(t)&&this.changes.push(t);return}let i=this.conditionCollection.exportAllConditions(),n=this.conditionCollection.getColumnStackPosition(t);-1===n&&(n=this.latestEditedColumnPosition);let o=i.slice(0,n),l=i.slice(n);l.length&&l[0].column===t&&l.shift();let a=(0,ei.WA)(function(t,e){let i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new nK(r.hot,!1),l=[].concat(t,n);o.importAllConditions(l);let a=r.columnDataFactory(e);i=o.isEmpty()?a:new nY(o,t=>r.columnDataFactory(t)).filter(),i=(0,s.Sc)(i,t=>t.meta.visualRow);let u=ns(i);return o.destroy(),(0,s.w7)(a,t=>u(t.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:u},dependentConditionStacks:l,filteredRowsFactory:a,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),(0,o._l)(this,(t,e)=>{this[e]=null})}}function n9(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function n4(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function n8(){(0,s.Bk)(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}(0,o.jB)(n2,en.Z);let n7="filters";var n3=r(6592);function n5(t,e){n6(t,e),e.add(t)}function n6(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ot(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oe(t,e){var r=or(t,e,"get");return r.get?r.get.call(t):r.value}function or(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function oi(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}let on="filters";var oo=new WeakMap,os=new WeakSet,ol=new WeakSet,oa=new WeakSet,ou=new WeakSet,oh=new WeakSet,oc=new WeakSet,od=new WeakSet,of=new WeakSet,og=new WeakSet;class op extends C{static get PLUGIN_KEY(){return on}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),n5(this,og),n5(this,of),n5(this,od),n5(this,oc),n5(this,oh),n5(this,ou),n5(this,oa),n5(this,ol),n5(this,os),ot(this,"dropdownMenuPlugin",null),ot(this,"conditionCollection",null),ot(this,"conditionUpdateObserver",null),ot(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ot(this,"filtersRowsMap",null),n6(this,oo),oo.set(this,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(t,e)=>oi(this,of,oE).call(this,t,e))}isEnabled(){return!!this.hot.getSettings()[on]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new n3.n),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,r=t=>(t.addLocalHook("accept",()=>oi(this,oh,ob).call(this,"accept")),t.addLocalHook("cancel",()=>oi(this,oh,ob).call(this,"cancel")),t.addLocalHook("change",e=>oi(this,oc,oC).call(this,t,e)),t);if(!this.components.get("filter_by_condition")){let t=new iK(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(tM.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",()=>oi(this,od,oS).call(this)),this.components.set("filter_by_condition",r(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new nr(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let t=new iK(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",()=>oi(this,od,oS).call(this)),this.components.set("filter_by_condition2",r(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new nW(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(tM.FILTERS_DIVS_FILTER_BY_VALUE)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new nU(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new nK(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new n2(this.hot,this.conditionCollection,t=>this.getDataMapAtColumn(t)),this.conditionUpdateObserver.addLocalHook("update",t=>oi(this,og,oT).call(this,t))),this.components.forEach(t=>t.show()),this.addHook("afterDropdownMenuDefaultOptions",t=>oi(this,ou,oy).call(this,t)),this.addHook("afterDropdownMenuShow",()=>oi(this,ol,ov).call(this)),this.addHook("afterDropdownMenuHide",()=>oi(this,oa,ow).call(this)),this.addHook("afterChange",t=>oi(this,os,om).call(this,t)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!oe(this,oo)&&this.dropdownMenuPlugin.enabled){var i;let t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{let e=t.getNavigator(),r=oe(this,oo).getLastMenuPage();t.focus(),r>0?e.setCurrentPage(r):e.toFirstItem()}},...Array.from(this.components).map(t=>{let[,e]=t;return e.getElements()}).flat()];i=function(t,e){let r=-1,i=function(t){let e=t4({initialPage:0,size:()=>t.length,onItemSelect:(e,r)=>{let i=t[e];return i instanceof n_?r:(!i.element||!!(0,T.pn)(i.element))&&void i.focus()}});return e}(e),n=r=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(n7),i.setCurrentPage(e.indexOf(r))};function o(n){let o=t.getKeyboardShortcutsCtrl(),s=n.getKeyboardShortcutsCtrl();i.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(n7),callback:()=>{n.isSubMenu()&&n.close(),o.listen(n7)}}]),n.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{let n=t.getNavigator();n.getCurrentPage()>-1&&(r=n.getCurrentPage()),n.clear(),e.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{let r=e[i.getCurrentPage()];r instanceof iB&&(r.openOptions(),t.preventDefault()),r instanceof ng&&(r.activate(),t.preventDefault()),r instanceof ip||t.preventDefault()}}],n7)}return e.forEach(t=>{t instanceof ip&&(t.addLocalHook("click",n(t)),t.addLocalHook("focus",n(t)),t.addLocalHook("afterClose",n(t)))}),t.addLocalHook("afterSelectionChange",t=>{t.key.startsWith("filter_")||i.clear()}),t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o),{...i,listen:function(){t.focus(),t.getKeyboardShortcutsCtrl().listen(n7)},getLastMenuPage:function(){return r}}}(t,e),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,or(this,oo,"set"),i);let r=t=>{oe(this,oo).listen(),t.preventDefault(),(0,rX.ot)(t.keyCode,"TAB")&&(t.shiftKey?oe(this,oo).toPreviousItem():oe(this,oo).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",r),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",r)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var t;null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,e)=>{t.destroy(),this.components.set(e,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:on})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(on)}addCondition(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:iQ,n=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(n,{command:{key:e},args:r},i)}removeConditions(t){let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){let{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),r=!this.conditionCollection.isEmpty(),i=[],n=this.conditionCollection.exportAllConditions(),o=this.hot.runHooks("beforeFilter",n);if(!1!==o){if(r){let r=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=(0,s.Sc)(e.filter(),t=>t.meta.visualRow);let t=ns(i);(0,I.q4)(this.hot.countSourceRows()-1,e=>{t(e)||r.push(e)}),(0,s.Bk)(r,t=>{this.filtersRowsMap.setValueAtIndex(t,!0)})},!0),t||i.length||this.hot.deselectCell()}else this.filtersRowsMap.clear()}this.hot.runHooks("afterFilter",n),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){let e=this.hot.toVisualColumn(t),r=[];return(0,s.Bk)(this.hot.getSourceDataAtCol(e),(t,i)=>{var n;let{row:o,col:s,visualCol:l,visualRow:a,type:u,instance:h,dateFormat:c,locale:d}=this.hot.getCellMeta(i,e),f=null!==(n=this.hot.getDataAtCell(this.hot.toVisualRow(i),e))&&void 0!==n?n:t;r.push({meta:{row:o,col:s,visualCol:l,visualRow:a,type:u,instance:h,dateFormat:c,locale:d},value:nl(f)})}),r}updateValueComponentCondition(t){let e=this.hot.getDataAtCol(t),r=na(e);this.conditionUpdateObserver.updateStatesAtColumn(t,r)}restoreComponents(t){var e;let r=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach(t=>{t.isHidden()||t.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,r,i){let n=t;return n===i0&&e.command.key!==r2&&r.command.key!==r2&&i.command.key!==r2?n=i2:i.command.key!==r2&&(e.command.key===r2||r.command.key===r2)&&(n=iQ),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let t=this.components.get("filter_by_condition"),{command:e}=t.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new nY(t,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){let t=[];if(!this.dropdownMenuPlugin)return t;let e=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];return(0,s.Bk)(i,r=>{(0,s.Bk)(e.menuItems,(e,i)=>{e.key===r.getMenuItemDescriptor().key&&t.push(i)})}),t}changeComponentsVisibility(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let e=this.dropdownMenuPlugin.menu,r=e.hotMenu,i=r.getPlugin("hiddenRows");for(var n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];let l=this.getIndexesOfComponents(...o);t?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function om(t){t&&(0,s.Bk)(t,t=>{let[,e]=t,r=this.hot.propToCol(e);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function ov(){this.restoreComponents(Array.from(this.components.values()))}function ow(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function oy(t){t.items.push({name:tO}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function ob(t){var e,r;if("accept"===t){let t=this.getSelectedColumn();if(null===t){null===(r=this.dropdownMenuPlugin)||void 0===r||r.close();return}let{physicalIndex:e}=t,i=this.components.get("filter_by_condition").getState(),n=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,n,o);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),i.command.key!==r2&&(this.conditionCollection.addCondition(e,i,s,l),n.command.key!==r2&&this.conditionCollection.addCondition(e,n,s,l)),o.command.key!==r2&&this.conditionCollection.addCondition(e,o,s,l),this.conditionUpdateObserver.flush(),this.components.forEach(t=>t.saveState(e)),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function oC(t,e){this.updateDependentComponentsVisibility(),t.constructor!==iK||e.inputsCount||this.setListeningDropdownMenu()}function oS(){this.setListeningDropdownMenu()}function oE(t,e){let r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)?(0,T.cn)(e,"htFiltersActive"):(0,T.IV)(e,"htFiltersActive")}function oT(t){var e;if(!(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled))return;let{editedConditionStack:{conditions:r,column:i}}=t,n=r.filter(t=>t.name===nB),o=r.filter(t=>t.name!==nB);if(n.length>=2||o.length>=3)(0,rK.ZK)(rG.e`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let e=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(e,i),this.components.get("filter_by_value").updateState(t)}}var oR=r(7392);function oO(t,e){oI(t,e),e.add(t)}function oM(t,e,r){oI(t,e),e.set(t,r)}function oI(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function oN(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function ox(t,e){var r=oH(t,e,"get");return r.get?r.get.call(t):r.value}function ok(t,e,r){var i=oH(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function oH(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}M.default.getSingleton().register("beforeHideRows"),M.default.getSingleton().register("afterHideRows"),M.default.getSingleton().register("beforeUnhideRows"),M.default.getSingleton().register("afterUnhideRows");let o_="hiddenRows";var oA=new WeakMap,oL=new WeakMap,oP=new WeakSet,oD=new WeakSet,oB=new WeakSet,oF=new WeakSet,oW=new WeakSet,oV=new WeakSet;class oj extends C{constructor(){super(...arguments),oO(this,oV),oO(this,oW),oO(this,oF),oO(this,oB),oO(this,oD),oO(this,oP),oM(this,oA,{writable:!0,value:{}}),oM(this,oL,{writable:!0,value:null})}static get PLUGIN_KEY(){return o_}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[o_]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[o_];(0,o.Kn)(e)&&(ok(this,oA,e),(0,N.o8)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),ok(this,oL,new oR.o),ox(this,oL).addLocalHook("init",()=>oN(this,oV,oX).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ox(this,oL)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return oN(t,oW,oK).call(t,...r)}),this.addHook("afterGetCellMeta",(t,e,r)=>oN(this,oD,o$).call(this,t,e,r)),this.addHook("modifyRowHeight",(t,e)=>oN(this,oP,oU).call(this,t,e)),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return oN(t,oF,oG).call(t,...r)}),this.addHook("modifyCopyableRange",t=>oN(this,oB,oz).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ok(this,oA,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){let e=this.getHiddenRows(),r=this.isValidConfig(t),i=e,n=ox(this,oL).getValues().slice(),o=t.length>0;if(r&&o){let e=t.map(t=>this.hot.toPhysicalRow(t));(0,s.Bk)(e,t=>{n[t]=!1}),i=(0,s.k$)(n,(t,e,r)=>(e&&t.push(this.hot.toVisualRow(r)),t),[])}let l=this.hot.runHooks("beforeUnhideRows",e,i,r&&o);!1!==l&&(r&&o&&ox(this,oL).setValues(n),this.hot.runHooks("afterUnhideRows",e,i,r&&o,r&&i.length<e.length))}showRow(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.showRows(e)}hideRows(t){let e=this.getHiddenRows(),r=this.isValidConfig(t),i=e;r&&(i=Array.from(new Set(e.concat(t))));let n=this.hot.runHooks("beforeHideRows",e,i,r);!1!==n&&(r&&this.hot.batchExecution(()=>{(0,s.Bk)(t,t=>{ox(this,oL).setValueAtIndex(this.hot.toPhysicalRow(t),!0)})},!0),this.hot.runHooks("afterHideRows",e,i,r,r&&i.length>e.length))}hideRow(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.hideRows(e)}getHiddenRows(){return(0,s.Sc)(ox(this,oL).getHiddenIndexes(),t=>this.hot.toVisualRow(t))}isHidden(t){return ox(this,oL).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){let e=this.hot.countRows();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,s.Bk)(this.hot.getCellsMeta(),t=>{t&&(t.skipRowOnPaste=!1)})}destroy(){ok(this,oA,null),ok(this,oL,null),super.destroy()}}function oU(t,e){return this.isHidden(e)?0:t}function o$(t,e,r){if(!1===ox(this,oA).copyPasteEnabled&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",-1===r.className.indexOf("afterHiddenRow")&&(r.className+=" afterHiddenRow");else if(r.className){let t=r.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),r.className=t.join(" ")}}}function oz(t){if(ox(this,oA).copyPasteEnabled)return t;let e=[],r=(t,r,i,n)=>{e.push({startRow:t,endRow:r,startCol:i,endCol:n})};return(0,s.Bk)(t,t=>{let e=!0,i=0;(0,I.q4)(t.startRow,t.endRow,n=>{this.isHidden(n)?(e||r(i,n-1,t.startCol,t.endCol),e=!0):(e&&(i=n),n===t.endRow&&r(i,n,t.startCol,t.endCol),e=!1)})}),e}function oG(t,e){if(!ox(this,oA).indicators||t<0)return;let r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),(0,T.cn)(e,r)}function oK(t){var e;t.items.push({name:tO},(e=this,{key:"hidden_rows_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[r,,i]=t;r-i!=0&&(e=1)}return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback(){let{from:t,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(t.row,r.row),0),n=Math.max(t.row,r.row),o=[];for(let t=i;t<=n;t+=1)o.push(t);e.hideRows(o);let s=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_rows_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(tM.CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var r,i;if(0===e.length)return;let n=e[0],o=e[e.length-1];n=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==r?r:0,o=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==i?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);let s=o-n+1===this.countRows();s||this.selectRows(n,o)},disabled:!1,hidden(){let r=(0,s.Sc)(t.getHiddenRows(),t=>this.toPhysicalRow(t));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;let i=this.getSelectedRangeLast(),n=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,l=this.rowIndexMapper,a=l.getRenderableFromVisualIndex(n),u=l.getRenderableFromVisualIndex(o),h=l.getNotTrimmedIndexes(),c=[];if(n!==o){let t=o-n+1;if(t>u-a+1){let t=h.slice(n,o+1);c.push(...t.filter(t=>r.includes(t)))}}else if(0===a&&a<n)c.push(...h.slice(0,n));else if(null===a)c.push(...h.slice(0,this.countRows()));else{let t=this.countRows()-1,e=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(t,-1));u===e&&t>o&&c.push(...h.slice(o+1))}return(0,s.Bk)(c,t=>{e.push(this.toVisualRow(t))}),0===e.length}}}(this))}function oX(){Array.isArray(ox(this,oA).rows)&&this.hideRows(ox(this,oA).rows)}var oY=r(8422);class oq extends oY.Hf{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type){let t=this.TD.querySelector('input[type="checkbox"]');(0,T.pv)(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var oZ=r(1881),oQ=r(2659);let oJ=new WeakMap,o0=new WeakMap,o1="data-row",o2="data-col",o9="checkbox";function o4(t,e,r,i,n,o,s){let{rootDocument:l}=t,a=t.getSettings().ariaTags;oZ.Z.apply(this,[t,e,r,i,n,o,s]),function(t){let e=o0.get(t);if(!e){let{rootElement:r}=t;(e=new c.Z(t)).addEventListener(r,"click",e=>(function(t,e){let{target:r}=t;if(!o8(r)||!r.hasAttribute(o1)||!r.hasAttribute(o2))return;let i=parseInt(r.getAttribute(o1),10),n=parseInt(r.getAttribute(o2),10),o=e.getCellMeta(i,n);o.readOnly&&t.preventDefault()})(e,t)),e.addEventListener(r,"mouseup",e=>(function(t,e){let{target:r}=t;o8(r)&&r.hasAttribute(o1)&&r.hasAttribute(o2)&&setTimeout(e.listen,10)})(e,t)),e.addEventListener(r,"change",e=>(function(t,e){let{target:r}=t;if(!o8(r)||!r.hasAttribute(o1)||!r.hasAttribute(o2))return;let i=parseInt(r.getAttribute(o1),10),n=parseInt(r.getAttribute(o2),10),o=e.getCellMeta(i,n);if(!o.readOnly){let r=null;r=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(i,n,r)}})(e,t)),o0.set(t,e)}}(t);let u=function(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(l),h=s.label,d=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),(0,T.cS)(e),o===s.checkedTemplate||(0,N.Pz)(o).toLocaleLowerCase(s.locale)===(0,N.Pz)(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||(0,N.Pz)(o).toLocaleLowerCase(s.locale)===(0,N.Pz)(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:(0,N.xb)(o)?(0,T.cn)(u,"noValue"):(u.style.display="none",(0,T.cn)(u,"htBadValue"),d=!0),(0,T.P$)(u,[[o1,r],[o2,i]]),a&&(0,T.P$)(u,[(0,eo.QK)(u.checked?t.getTranslatedPhrase(tM.CHECKBOX_CHECKED):t.getTranslatedPhrase(tM.CHECKBOX_UNCHECKED)),(0,eo.Pn)(u.checked),(0,eo.wt)()]),!d&&h){let s="";if(h.value)s="function"==typeof h.value?h.value.call(this,r,i,n,o):h.value;else if(h.property){let e=t.getDataAtRowProp(r,h.property);s=null!==e?e:""}let a=function(t,e,r){let i=t.createElement("label");return i.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,i.appendChild(t.createTextNode(e)),i.cloneNode(!0)}(l,s,!0!==h.separated);"before"===h.position?h.separated?(e.appendChild(a),e.appendChild(u)):(a.appendChild(u),u=a):h.position&&"after"!==h.position||(h.separated?(e.appendChild(u),e.appendChild(a)):(a.insertBefore(u,a.firstChild),u=a))}function f(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=t.getSelectedRange();if(r)for(let i=0;i<r.length;i++){let{row:n,col:o}=r[i].getTopStartCorner(),{row:s,col:l}=r[i].getBottomEndCorner(),a=[];for(let r=n;r<=s;r+=1)for(let i=o;i<=l;i+=1){let n=t.getCellMeta(r,i);if("checkbox"!==n.type)return;if(!0===n.readOnly)continue;void 0===n.checkedTemplate&&(n.checkedTemplate=!0),void 0===n.uncheckedTemplate&&(n.uncheckedTemplate=!1);let o=t.getDataAtCell(r,i);!1===e?[n.checkedTemplate,n.checkedTemplate.toString()].includes(o)?a.push([r,i,n.uncheckedTemplate]):[n.uncheckedTemplate,n.uncheckedTemplate.toString(),null,void 0].includes(o)&&a.push([r,i,n.checkedTemplate]):a.push([r,i,n.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function g(){let e=t.getSelectedRange();if(e){for(let r=0;r<e.length;r++){let i=e[r].getTopStartCorner(),n=e[r].getBottomEndCorner();for(let e=i.row;e<=n.row;e++)for(let r=i.col;r<=n.col;r++){let i=t.getCellMeta(e,r);if("checkbox"!==i.type)return!1;let n=t.getCell(e,r);if(null==n)return!0;{let t=n.querySelectorAll("input[type=checkbox]");if(t.length>0&&!i.readOnly)return!0}}}return!1}}h&&(!h||h.separated)||e.appendChild(u),d&&e.appendChild(l.createTextNode("#bad-value#")),oJ.has(t)||(oJ.set(t,!0),function(){let e=t.getShortcutManager(),r=e.getContext("grid");r.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g())},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),relativeToGroup:oQ.I,position:"before"}],{group:"checkboxRenderer"})}())}function o8(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}M.default.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){let{label:i,type:n,row:o,column:s,prop:l}=e;if(n===o9){if(i){let{value:e,property:n}=i,a=r;if(e)a="function"==typeof e?e(o,s,l,r):e;else if(n){let t=this.getDataAtRowProp(o,n);a=null!==t?t:r}t=a}return t}}),o4.RENDERER_TYPE=o9;var o7=r(2694);class o3 extends o7.H{static get EDITOR_TYPE(){return"numeric"}}var o5=r(4695),o6=r(9275);function st(t,e,r,i,n,o,s){let l=o;if((0,I.kE)(l)){let t=s.numericFormat,r=t&&t.culture||"-",i=t&&t.pattern,n=s.className||"",o=n.length?n.split(" "):[];if(void 0!==r&&!o5.languages()[r]){let t=r.replace("-",""),e=o5.allLanguages?o5.allLanguages[r]:o5[t];e&&o5.registerLanguage(e)}o5.setLanguage(r),l=o5(l).format(i||"0"),0>o.indexOf("htLeft")&&0>o.indexOf("htCenter")&&0>o.indexOf("htRight")&&0>o.indexOf("htJustify")&&o.push("htRight"),0>o.indexOf("htNumeric")&&o.push("htNumeric"),s.className=o.join(" "),e.dir="ltr"}(0,o6.V)(t,e,r,i,n,l,s)}function se(t,e){let r=t;null==r&&(r=""),e(!!this.allowEmpty&&""===r||""!==r&&(0,I.kE)(t))}st.RENDERER_TYPE="numeric",se.VALIDATOR_TYPE="numeric",r(6800);var sr=r(5938);let{HotTable:si}=r(1184);function sn(t){let{data:e}=t;return(0,i.jsx)(si,{data:e,columns:[{data:1},{data:2},{data:3},{data:5},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,readOnly:!0,className:"htMiddle"},{data:9,readOnly:!0,className:"htCenter"}],colWidths:[140,126,192,100,100,90,90,110,97],colHeaders:["Company name","Country","Name","Sell date","Order ID","In stock","Qty","Progress","Rating"],dropdownMenu:!0,contextMenu:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,navigableHeaders:!0,autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation"})}function so(){return(0,i.jsx)(sn,{data:sr})}(0,l.registerCellType)({CELL_TYPE:"checkbox",editor:oq,renderer:o4}),(0,l.registerCellType)({CELL_TYPE:"numeric",editor:o3,renderer:st,validator:se,dataType:"number"}),(0,n.fo)(Y),(0,n.fo)(tf),(0,n.fo)(eS),(0,n.fo)(rp),(0,n.fo)(rB),(0,n.fo)(op),(0,n.fo)(oj)},6800:function(){},622:function(t,e,r){"use strict";var i=r(2265),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,r){var i,o={},u=null,h=null;for(i in void 0!==r&&(u=""+r),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(h=e.ref),e)s.call(e,i)&&!a.hasOwnProperty(i)&&(o[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps)void 0===o[i]&&(o[i]=e[i]);return{$$typeof:n,type:t,key:u,ref:h,props:o,_owner:l.current}}e.Fragment=o,e.jsx=u,e.jsxs=u},7437:function(t,e,r){"use strict";t.exports=r(622)},4695:function(t){t.exports=(function t(e,r,i){function n(s,l){if(!r[s]){if(!e[s]){if(o)return o(s,!0);var a=Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){return n(e[s][1][t]||t)},u,u.exports,t,e,r,i)}return r[s].exports}for(var o=void 0,s=0;s<i.length;s++)n(i[s]);return n})({1:[function(t,e,r){!function(t){"use strict";var r,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,o=Math.floor,s="[BigNumber Error] ",l=s+"Number primitive has more than 15 significant digits: ",a=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function u(t){var e=0|t;return 0<t||t===e?e:e-1}function h(t){for(var e,r,i=1,n=t.length,o=t[0]+"";i<n;){for(r=14-(e=t[i++]+"").length;r--;e="0"+e);o+=e}for(n=o.length;48===o.charCodeAt(--n););return o.slice(0,n+1||1)}function c(t,e){var r,i,n=t.c,o=e.c,s=t.s,l=e.s,a=t.e,u=e.e;if(!s||!l)return null;if(r=n&&!n[0],i=o&&!o[0],r||i)return r?i?0:-l:s;if(s!=l)return s;if(r=s<0,i=a==u,!n||!o)return i?0:!n^r?1:-1;if(!i)return u<a^r?1:-1;for(l=(a=n.length)<(u=o.length)?a:u,s=0;s<l;s++)if(n[s]!=o[s])return n[s]>o[s]^r?1:-1;return a==u?0:u<a^r?1:-1}function d(t,e,r,i){if(t<e||r<t||t!==(t<0?n(t):o(t)))throw Error(s+(i||"Argument")+("number"==typeof t?t<e||r<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function f(t){var e=t.c.length-1;return u(t.e/14)==e&&t.c[e]%2!=0}function g(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function p(t,e,r){var i,n;if(e<0){for(n=r+".";++e;n+=r);t=n+t}else if(++e>(i=t.length)){for(n=r,e-=i;--e;n+=r);t+=n}else e<i&&(t=t.slice(0,e)+"."+t.slice(e));return t}(r=function t(e){var r,m,w,y,b,C,S,E,T,R=B.prototype={constructor:B,toString:null,valueOf:null},O=new B(1),M=20,I=4,N=-7,x=21,k=-1e7,H=1e7,_=!1,A=1,L=0,P={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},D="0123456789abcdefghijklmnopqrstuvwxyz";function B(t,e){var r,n,s,a,u,h,c,f,g=this;if(!(g instanceof B))return new B(t,e);if(null==e){if(t instanceof B)return g.s=t.s,g.e=t.e,void(g.c=(t=t.c)?t.slice():t);if((h="number"==typeof t)&&0*t==0){if(g.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,u=t;10<=u;u/=10,a++);return g.e=a,void(g.c=[t])}f=String(t)}else{if(f=String(t),!i.test(f))return w(g,f,h);g.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}-1<(a=f.indexOf("."))&&(f=f.replace(".","")),0<(u=f.search(/e/i))?(a<0&&(a=u),a+=+f.slice(u+1),f=f.substring(0,u)):a<0&&(a=f.length)}else{if(d(e,2,D.length,"Base"),f=String(t),10==e)return j(g=new B(t instanceof B?t:f),M+g.e+1,I);if(h="number"==typeof t){if(0*t!=0)return w(g,f,h,e);if(g.s=1/t<0?(f=f.slice(1),-1):1,B.DEBUG&&15<f.replace(/^0\.0*|\./,"").length)throw Error(l+t);h=!1}else g.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(r=D.slice(0,e),a=u=0,c=f.length;u<c;u++)if(0>r.indexOf(n=f.charAt(u))){if("."==n){if(a<u){a=c;continue}}else if(!s&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){s=!0,u=-1,a=0;continue}return w(g,String(t),h,e)}-1<(a=(f=m(f,e,10,g.s)).indexOf("."))?f=f.replace(".",""):a=f.length}for(u=0;48===f.charCodeAt(u);u++);for(c=f.length;48===f.charCodeAt(--c););if(f=f.slice(u,++c)){if(c-=u,h&&B.DEBUG&&15<c&&(9007199254740991<t||t!==o(t)))throw Error(l+g.s*t);if(H<(a=a-u-1))g.c=g.e=null;else if(a<k)g.c=[g.e=0];else{if(g.e=a,g.c=[],u=(a+1)%14,a<0&&(u+=14),u<c){for(u&&g.c.push(+f.slice(0,u)),c-=14;u<c;)g.c.push(+f.slice(u,u+=14));u=14-(f=f.slice(u)).length}else u-=c;for(;u--;f+="0");g.c.push(+f)}}else g.c=[g.e=0]}function F(t,e,r,i){var n,o,s,l,a;if(null==r?r=I:d(r,0,8),!t.c)return t.toString();if(n=t.c[0],s=t.e,null==e)a=h(t.c),a=1==i||2==i&&(s<=N||x<=s)?g(a,s):p(a,s,"0");else if(o=(t=j(new B(t),e,r)).e,l=(a=h(t.c)).length,1==i||2==i&&(e<=o||o<=N)){for(;l<e;a+="0",l++);a=g(a,o)}else if(e-=s,a=p(a,o,"0"),l<o+1){if(0<--e)for(a+=".";e--;a+="0");}else if(0<(e+=o-l))for(o+1==l&&(a+=".");e--;a+="0");return t.s<0&&n?"-"+a:a}function W(t,e){for(var r,i=1,n=new B(t[0]);i<t.length;i++){if(!(r=new B(t[i])).s){n=r;break}e.call(n,r)&&(n=r)}return n}function V(t,e,r){for(var i=1,n=e.length;!e[--n];e.pop());for(n=e[0];10<=n;n/=10,i++);return(r=i+14*r-1)>H?t.c=t.e=null:t.c=r<k?[t.e=0]:(t.e=r,e),t}function j(t,e,r,i){var s,l,u,h,c,d,f,g=t.c;if(g){t:{for(s=1,h=g[0];10<=h;h/=10,s++);if((l=e-s)<0)l+=14,u=e,f=(c=g[d=0])/a[s-u-1]%10|0;else if((d=n((l+1)/14))>=g.length){if(!i)break t;for(;g.length<=d;g.push(0));c=f=0,u=(l%=14)-14+(s=1)}else{for(c=h=g[d],s=1;10<=h;h/=10,s++);f=(u=(l%=14)-14+s)<0?0:c/a[s-u-1]%10|0}if(i=i||e<0||null!=g[d+1]||(u<0?c:c%a[s-u-1]),i=r<4?(f||i)&&(0==r||r==(t.s<0?3:2)):5<f||5==f&&(4==r||i||6==r&&(0<l?0<u?c/a[s-u]:0:g[d-1])%10&1||r==(t.s<0?8:7)),e<1||!g[0])return g.length=0,i?(e-=t.e+1,g[0]=a[(14-e%14)%14],t.e=-e||0):g[0]=t.e=0,t;if(0==l?(g.length=d,h=1,d--):(g.length=d+1,h=a[14-l],g[d]=0<u?o(c/a[s-u]%a[u])*h:0),i)for(;;){if(0==d){for(l=1,u=g[0];10<=u;u/=10,l++);for(u=g[0]+=h,h=1;10<=u;u/=10,h++);l!=h&&(t.e++,1e14==g[0]&&(g[0]=1));break}if(g[d]+=h,1e14!=g[d])break;g[d--]=0,h=1}for(l=g.length;0===g[--l];g.pop());}t.e>H?t.c=t.e=null:t.e<k&&(t.c=[t.e=0])}return t}function U(t){var e,r=t.e;return null===r?t.toString():(e=h(t.c),e=r<=N||x<=r?g(e,r):p(e,r,"0"),t.s<0?"-"+e:e)}return B.clone=t,B.ROUND_UP=0,B.ROUND_DOWN=1,B.ROUND_CEIL=2,B.ROUND_FLOOR=3,B.ROUND_HALF_UP=4,B.ROUND_HALF_DOWN=5,B.ROUND_HALF_EVEN=6,B.ROUND_HALF_CEIL=7,B.ROUND_HALF_FLOOR=8,B.EUCLID=9,B.config=B.set=function(t){var e,r;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(d(r=t[e],0,1e9,e),M=r),t.hasOwnProperty(e="ROUNDING_MODE")&&(d(r=t[e],0,8,e),I=r),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((r=t[e])&&r.pop?(d(r[0],-1e9,0,e),d(r[1],0,1e9,e),N=r[0],x=r[1]):(d(r,-1e9,1e9,e),N=-(x=r<0?-r:r))),t.hasOwnProperty(e="RANGE")){if((r=t[e])&&r.pop)d(r[0],-1e9,-1,e),d(r[1],1,1e9,e),k=r[0],H=r[1];else{if(d(r,-1e9,1e9,e),!r)throw Error(s+e+" cannot be zero: "+r);k=-(H=r<0?-r:r)}}if(t.hasOwnProperty(e="CRYPTO")){if((r=t[e])!==!!r)throw Error(s+e+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw _=!r,Error(s+"crypto unavailable");_=r}else _=r}if(t.hasOwnProperty(e="MODULO_MODE")&&(d(r=t[e],0,9,e),A=r),t.hasOwnProperty(e="POW_PRECISION")&&(d(r=t[e],0,1e9,e),L=r),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(r=t[e]))throw Error(s+e+" not an object: "+r);P=r}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(r=t[e])||/^.$|[+-.\s]|(.).*\1/.test(r))throw Error(s+e+" invalid: "+r);D=r}}return{DECIMAL_PLACES:M,ROUNDING_MODE:I,EXPONENTIAL_AT:[N,x],RANGE:[k,H],CRYPTO:_,MODULO_MODE:A,POW_PRECISION:L,FORMAT:P,ALPHABET:D}},B.isBigNumber=function(t){return t instanceof B||t&&!0===t._isBigNumber||!1},B.maximum=B.max=function(){return W(arguments,R.lt)},B.minimum=B.min=function(){return W(arguments,R.gt)},B.random=(y=9007199254740992*Math.random()&2097151?function(){return o(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,r,i,l,u,h=0,c=[],f=new B(O);if(null==t?t=M:d(t,0,1e9),l=n(t/14),_){if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(l*=2));h<l;)9e15<=(u=131072*e[h]+(e[h+1]>>>11))?(r=crypto.getRandomValues(new Uint32Array(2)),e[h]=r[0],e[h+1]=r[1]):(c.push(u%1e14),h+=2);h=l/2}else{if(!crypto.randomBytes)throw _=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(l*=7);h<l;)9e15<=(u=281474976710656*(31&e[h])+1099511627776*e[h+1]+4294967296*e[h+2]+16777216*e[h+3]+(e[h+4]<<16)+(e[h+5]<<8)+e[h+6])?crypto.randomBytes(7).copy(e,h):(c.push(u%1e14),h+=7);h=l/7}}if(!_)for(;h<l;)(u=y())<9e15&&(c[h++]=u%1e14);for(l=c[--h],t%=14,l&&t&&(u=a[14-t],c[h]=o(l/u)*u);0===c[h];c.pop(),h--);if(h<0)c=[i=0];else{for(i=-1;0===c[0];c.splice(0,1),i-=14);for(h=1,u=c[0];10<=u;u/=10,h++);h<14&&(i-=14-h)}return f.e=i,f.c=c,f}),B.sum=function(){for(var t=1,e=arguments,r=new B(e[0]);t<e.length;)r=r.plus(e[t++]);return r},m=function(){var t="0123456789";function e(t,e,r,i){for(var n,o,s=[0],l=0,a=t.length;l<a;){for(o=s.length;o--;s[o]*=e);for(s[0]+=i.indexOf(t.charAt(l++)),n=0;n<s.length;n++)s[n]>r-1&&(null==s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/r|0,s[n]%=r)}return s.reverse()}return function(i,n,o,s,l){var a,u,c,d,f,g,m,w,y=i.indexOf("."),b=M,C=I;for(0<=y&&(d=L,L=0,i=i.replace(".",""),g=(w=new B(n)).pow(i.length-y),L=d,w.c=e(p(h(g.c),g.e,"0"),10,o,t),w.e=w.c.length),c=d=(m=e(i,n,o,l?(a=D,t):(a=t,D))).length;0==m[--d];m.pop());if(!m[0])return a.charAt(0);if(y<0?--c:(g.c=m,g.e=c,g.s=s,m=(g=r(g,w,b,C,o)).c,f=g.r,c=g.e),y=m[u=c+b+1],d=o/2,f=f||u<0||null!=m[u+1],f=C<4?(null!=y||f)&&(0==C||C==(g.s<0?3:2)):d<y||y==d&&(4==C||f||6==C&&1&m[u-1]||C==(g.s<0?8:7)),u<1||!m[0])i=f?p(a.charAt(1),-b,a.charAt(0)):a.charAt(0);else{if(m.length=u,f)for(--o;++m[--u]>o;)m[u]=0,u||(++c,m=[1].concat(m));for(d=m.length;!m[--d];);for(y=0,i="";y<=d;i+=a.charAt(m[y++]));i=p(i,c,a.charAt(0))}return i}}(),r=function(){function t(t,e,r){var i,n,o,s,l=0,a=t.length,u=e%1e7,h=e/1e7|0;for(t=t.slice();a--;)l=((n=u*(o=t[a]%1e7)+(i=h*o+(s=t[a]/1e7|0)*u)%1e7*1e7+l)/r|0)+(i/1e7|0)+h*s,t[a]=n%r;return l&&(t=[l].concat(t)),t}function e(t,e,r,i){var n,o;if(r!=i)o=i<r?1:-1;else for(n=o=0;n<r;n++)if(t[n]!=e[n]){o=t[n]>e[n]?1:-1;break}return o}function r(t,e,r,i){for(var n=0;r--;)t[r]-=n,n=t[r]<e[r]?1:0,t[r]=n*i+t[r]-e[r];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(i,n,s,l,a){var h,c,d,f,g,p,m,w,y,b,C,S,E,T,R,O,M,I=i.s==n.s?1:-1,N=i.c,x=n.c;if(!(N&&N[0]&&x&&x[0]))return new B(i.s&&n.s&&(N?!x||N[0]!=x[0]:x)?N&&0==N[0]||!x?0*I:I/0:NaN);for(y=(w=new B(I)).c=[],I=s+(c=i.e-n.e)+1,a||(a=1e14,c=u(i.e/14)-u(n.e/14),I=I/14|0),d=0;x[d]==(N[d]||0);d++);if(x[d]>(N[d]||0)&&c--,I<0)y.push(1),f=!0;else{for(T=N.length,O=x.length,I+=2,1<(g=o(a/(x[d=0]+1)))&&(x=t(x,g,a),N=t(N,g,a),O=x.length,T=N.length),E=O,C=(b=N.slice(0,O)).length;C<O;b[C++]=0);M=[0].concat(M=x.slice()),R=x[0],x[1]>=a/2&&R++;do{if(g=0,(h=e(x,b,O,C))<0){if(S=b[0],O!=C&&(S=S*a+(b[1]||0)),1<(g=o(S/R)))for(a<=g&&(g=a-1),m=(p=t(x,g,a)).length,C=b.length;1==e(p,b,m,C);)g--,r(p,O<m?M:x,m,a),m=p.length,h=1;else 0==g&&(h=g=1),m=(p=x.slice()).length;if(m<C&&(p=[0].concat(p)),r(b,p,C,a),C=b.length,-1==h)for(;1>e(x,b,O,C);)g++,r(b,O<C?M:x,C,a),C=b.length}else 0===h&&(g++,b=[0]);y[d++]=g,b[0]?b[C++]=N[E]||0:(b=[N[E]],C=1)}while((E++<T||null!=b[0])&&I--);f=null!=b[0],y[0]||y.splice(0,1)}if(1e14==a){for(d=1,I=y[0];10<=I;I/=10,d++);j(w,s+(w.e=d+14*c-1)+1,l,f)}else w.e=c,w.r=+f;return w}}(),b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,S=/^\.([^.]+)$/,E=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(t,e,r,i){var n,o=r?e:e.replace(T,"");if(E.test(o))t.s=isNaN(o)?null:o<0?-1:1,t.c=t.e=null;else{if(!r&&(o=o.replace(b,function(t,e,r){return n="x"==(r=r.toLowerCase())?16:"b"==r?2:8,i&&i!=n?t:e}),i&&(n=i,o=o.replace(C,"$1").replace(S,"0.$1")),e!=o))return new B(o,n);if(B.DEBUG)throw Error(s+"Not a"+(i?" base "+i:"")+" number: "+e);t.c=t.e=t.s=null}},R.absoluteValue=R.abs=function(){var t=new B(this);return t.s<0&&(t.s=1),t},R.comparedTo=function(t,e){return c(this,new B(t,e))},R.decimalPlaces=R.dp=function(t,e){var r,i,n;if(null!=t)return d(t,0,1e9),null==e?e=I:d(e,0,8),j(new B(this),t+this.e+1,e);if(!(r=this.c))return null;if(i=((n=r.length-1)-u(this.e/14))*14,n=r[n])for(;n%10==0;n/=10,i--);return i<0&&(i=0),i},R.dividedBy=R.div=function(t,e){return r(this,new B(t,e),M,I)},R.dividedToIntegerBy=R.idiv=function(t,e){return r(this,new B(t,e),0,1)},R.exponentiatedBy=R.pow=function(t,e){var r,i,l,a,u,h,c,d,g=this;if((t=new B(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+U(t));if(null!=e&&(e=new B(e)),u=14<t.e,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!t.c||!t.c[0])return d=new B(Math.pow(+U(g),u?2-f(t):+U(t))),e?d.mod(e):d;if(h=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new B(NaN);(i=!h&&g.isInteger()&&e.isInteger())&&(g=g.mod(e))}else{if(9<t.e&&(0<g.e||g.e<-1||(0==g.e?1<g.c[0]||u&&24e7<=g.c[1]:g.c[0]<8e13||u&&g.c[0]<=9999975e7)))return a=g.s<0&&f(t)?-0:0,-1<g.e&&(a=1/a),new B(h?1/a:a);L&&(a=n(L/14+2))}for(c=u?(r=new B(.5),h&&(t.s=1),f(t)):(l=Math.abs(+U(t)))%2,d=new B(O);;){if(c){if(!(d=d.times(g)).c)break;a?d.c.length>a&&(d.c.length=a):i&&(d=d.mod(e))}if(l){if(0===(l=o(l/2)))break;c=l%2}else if(j(t=t.times(r),t.e+1,1),14<t.e)c=f(t);else{if(0==(l=+U(t)))break;c=l%2}g=g.times(g),a?g.c&&g.c.length>a&&(g.c.length=a):i&&(g=g.mod(e))}return i?d:(h&&(d=O.div(d)),e?d.mod(e):a?j(d,L,I,void 0):d)},R.integerValue=function(t){var e=new B(this);return null==t?t=I:d(t,0,8),j(e,e.e+1,t)},R.isEqualTo=R.eq=function(t,e){return 0===c(this,new B(t,e))},R.isFinite=function(){return!!this.c},R.isGreaterThan=R.gt=function(t,e){return 0<c(this,new B(t,e))},R.isGreaterThanOrEqualTo=R.gte=function(t,e){return 1===(e=c(this,new B(t,e)))||0===e},R.isInteger=function(){return!!this.c&&u(this.e/14)>this.c.length-2},R.isLessThan=R.lt=function(t,e){return 0>c(this,new B(t,e))},R.isLessThanOrEqualTo=R.lte=function(t,e){return -1===(e=c(this,new B(t,e)))||0===e},R.isNaN=function(){return!this.s},R.isNegative=function(){return this.s<0},R.isPositive=function(){return 0<this.s},R.isZero=function(){return!!this.c&&0==this.c[0]},R.minus=function(t,e){var r,i,n,o,s=this.s;if(e=(t=new B(t,e)).s,!s||!e)return new B(NaN);if(s!=e)return t.s=-e,this.plus(t);var l=this.e/14,a=t.e/14,h=this.c,c=t.c;if(!l||!a){if(!h||!c)return h?(t.s=-e,t):new B(c?this:NaN);if(!h[0]||!c[0])return c[0]?(t.s=-e,t):new B(h[0]?this:3==I?-0:0)}if(l=u(l),a=u(a),h=h.slice(),s=l-a){for((n=(o=s<0)?(s=-s,h):(a=l,c)).reverse(),e=s;e--;n.push(0));n.reverse()}else for(i=(o=(s=h.length)<(e=c.length))?s:e,s=e=0;e<i;e++)if(h[e]!=c[e]){o=h[e]<c[e];break}if(o&&(n=h,h=c,c=n,t.s=-t.s),0<(e=(i=c.length)-(r=h.length)))for(;e--;h[r++]=0);for(e=1e14-1;s<i;){if(h[--i]<c[i]){for(r=i;r&&!h[--r];h[r]=e);--h[r],h[i]+=1e14}h[i]-=c[i]}for(;0==h[0];h.splice(0,1),--a);return h[0]?V(t,h,a):(t.s=3==I?-1:1,t.c=[t.e=0],t)},R.modulo=R.mod=function(t,e){var i,n;return t=new B(t,e),this.c&&t.s&&(!t.c||t.c[0])?t.c&&(!this.c||this.c[0])?(9==A?(n=t.s,t.s=1,i=r(this,t,0,3),t.s=n,i.s*=n):i=r(this,t,0,A),(t=this.minus(i.times(t))).c[0]||1!=A||(t.s=this.s),t):new B(this):new B(NaN)},R.multipliedBy=R.times=function(t,e){var r,i,n,o,s,l,a,h,c,d,f,g,p,m=this.c,w=(t=new B(t,e)).c;if(!(m&&w&&m[0]&&w[0]))return this.s&&t.s&&(!m||m[0]||w)&&(!w||w[0]||m)?(t.s*=this.s,m&&w?(t.c=[0],t.e=0):t.c=t.e=null):t.c=t.e=t.s=null,t;for(i=u(this.e/14)+u(t.e/14),t.s*=this.s,(a=m.length)<(d=w.length)&&(p=m,m=w,w=p,n=a,a=d,d=n),n=a+d,p=[];n--;p.push(0));for(n=d;0<=--n;){for(r=0,f=w[n]%1e7,g=w[n]/1e7|0,o=n+(s=a);n<o;)r=((h=f*(h=m[--s]%1e7)+(l=g*h+(c=m[s]/1e7|0)*f)%1e7*1e7+p[o]+r)/1e14|0)+(l/1e7|0)+g*c,p[o--]=h%1e14;p[o]=r}return r?++i:p.splice(0,1),V(t,p,i)},R.negated=function(){var t=new B(this);return t.s=-t.s||null,t},R.plus=function(t,e){var r,i=this.s;if(e=(t=new B(t,e)).s,!i||!e)return new B(NaN);if(i!=e)return t.s=-e,this.minus(t);var n=this.e/14,o=t.e/14,s=this.c,l=t.c;if(!n||!o){if(!s||!l)return new B(i/0);if(!s[0]||!l[0])return l[0]?t:new B(s[0]?this:0*i)}if(n=u(n),o=u(o),s=s.slice(),i=n-o){for((r=0<i?(o=n,l):(i=-i,s)).reverse();i--;r.push(0));r.reverse()}for((i=s.length)-(e=l.length)<0&&(r=l,l=s,s=r,e=i),i=0;e;)i=(s[--e]=s[e]+l[e]+i)/1e14|0,s[e]=1e14===s[e]?0:s[e]%1e14;return i&&(s=[i].concat(s),++o),V(t,s,o)},R.precision=R.sd=function(t,e){var r,i,n;if(null!=t&&!!t!==t)return d(t,1,1e9),null==e?e=I:d(e,0,8),j(new B(this),t,e);if(!(r=this.c))return null;if(i=14*(n=r.length-1)+1,n=r[n]){for(;n%10==0;n/=10,i--);for(n=r[0];10<=n;n/=10,i++);}return t&&this.e+1>i&&(i=this.e+1),i},R.shiftedBy=function(t){return d(t,-9007199254740991,9007199254740991),this.times("1e"+t)},R.squareRoot=R.sqrt=function(){var t,e,i,n,o,s=this.c,l=this.s,a=this.e,c=M+4,d=new B("0.5");if(1!==l||!s||!s[0])return new B(!l||l<0&&(!s||s[0])?NaN:s?this:1/0);if((i=0==(l=Math.sqrt(+U(this)))||l==1/0?(((e=h(s)).length+a)%2==0&&(e+="0"),l=Math.sqrt(+e),a=u((a+1)/2)-(a<0||a%2),new B(e=l==1/0?"1e"+a:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+a)):new B(l+"")).c[0]){for((l=(a=i.e)+c)<3&&(l=0);;)if(o=i,i=d.times(o.plus(r(this,o,c,1))),h(o.c).slice(0,l)===(e=h(i.c)).slice(0,l)){if(i.e<a&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(j(i,i.e+M+2,1),t=!i.times(i).eq(this));break}if(!n&&(j(o,o.e+M+2,0),o.times(o).eq(this))){i=o;break}c+=4,l+=4,n=1}}return j(i,i.e+M+1,I,t)},R.toExponential=function(t,e){return null!=t&&(d(t,0,1e9),t++),F(this,t,e,1)},R.toFixed=function(t,e){return null!=t&&(d(t,0,1e9),t=t+this.e+1),F(this,t,e)},R.toFormat=function(t,e,r){var i;if(null==r)null!=t&&e&&"object"==typeof e?(r=e,e=null):t&&"object"==typeof t?(r=t,t=e=null):r=P;else if("object"!=typeof r)throw Error(s+"Argument not an object: "+r);if(i=this.toFixed(t,e),this.c){var n,o=i.split("."),l=+r.groupSize,a=+r.secondaryGroupSize,u=r.groupSeparator||"",h=o[0],c=o[1],d=this.s<0,f=d?h.slice(1):h,g=f.length;if(a&&(n=l,l=a,g-=a=n),0<l&&0<g){for(n=g%l||l,h=f.substr(0,n);n<g;n+=l)h+=u+f.substr(n,l);0<a&&(h+=u+f.slice(n)),d&&(h="-"+h)}i=c?h+(r.decimalSeparator||"")+((a=+r.fractionGroupSize)?c.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):c):h}return(r.prefix||"")+i+(r.suffix||"")},R.toFraction=function(t){var e,i,n,o,l,u,c,d,f,g,p,m,w=this.c;if(null!=t&&(!(c=new B(t)).isInteger()&&(c.c||1!==c.s)||c.lt(O)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+U(c));if(!w)return new B(this);for(e=new B(O),f=i=new B(O),n=d=new B(O),m=h(w),l=e.e=m.length-this.e-1,e.c[0]=a[(u=l%14)<0?14+u:u],t=!t||0<c.comparedTo(e)?0<l?e:f:c,u=H,H=1/0,c=new B(m),d.c[0]=0;g=r(c,e,0,1),1!=(o=i.plus(g.times(n))).comparedTo(t);)i=n,n=o,f=d.plus(g.times(o=f)),d=o,e=c.minus(g.times(o=e)),c=o;return o=r(t.minus(i),n,0,1),d=d.plus(o.times(f)),i=i.plus(o.times(n)),d.s=f.s=this.s,p=1>r(f,n,l*=2,I).minus(this).abs().comparedTo(r(d,i,l,I).minus(this).abs())?[f,n]:[d,i],H=u,p},R.toNumber=function(){return+U(this)},R.toPrecision=function(t,e){return null!=t&&d(t,1,1e9),F(this,t,e,2)},R.toString=function(t){var e,r=this,i=r.s,n=r.e;return null===n?i?(e="Infinity",i<0&&(e="-"+e)):e="NaN":(e=null==t?n<=N||x<=n?g(h(r.c),n):p(h(r.c),n,"0"):10===t?p(h((r=j(new B(r),M+n+1,I)).c),r.e,"0"):(d(t,2,D.length,"Base"),m(p(h(r.c),n,"0"),10,t,i,!0)),i<0&&r.c[0]&&(e="-"+e)),e},R.valueOf=R.toJSON=function(){return U(this)},R._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(R[Symbol.toStringTag]="BigNumber",R[Symbol.for("nodejs.util.inspect.custom")]=R.valueOf),null!=e&&B.set(e),B}()).default=r.BigNumber=r,void 0!==e&&e.exports?e.exports=r:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=r)}(this)},{}],2:[function(t,e,r){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,r){"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],i=!0,n=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done)&&(r.push(s.value),!e||r.length!==e);i=!0);}catch(t){n=!0,o=t}finally{try{i||null==l.return||l.return()}finally{if(n)throw o}}return r}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance")}()}var n=t("./globalState"),o=t("./validating"),s=t("./parsing"),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:l,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:l,marker:"d"}},u={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!o.validateFormat(e))return"ERROR: invalid format";var i=e.prefix||"",l=e.postfix||"",h=function(t,e,r){var i,o,s,l,h,d,p,m,w,y,b,C,S,E,T,R,O,M,I,N,x,k,H,_,A,L,P,D;switch(e.output){case"currency":return R=e=g(e,n.currentCurrencyDefaultFormat()),O=n.currentCurrency(),M=Object.assign({},u,R),I=void 0,N="",x=!!M.totalLength||!!M.forceAverage||M.average,k=R.currencyPosition||O.position,H=R.currencySymbol||O.symbol,M.spaceSeparated&&(N=" "),"infix"===k&&(I=N+H+N),_=f({instance:t,providedFormat:R,state:n,decimalSeparator:I}),"prefix"===k&&(_=t._value<0&&"sign"===M.negative?"-".concat(N).concat(H).concat(_.slice(1)):H+N+_),k&&"postfix"!==k||(_=_+(N=x?"":N)+H),_;case"percent":return L=(A=e=g(e,n.currentPercentageDefaultFormat())).prefixSymbol,P=f({instance:r(100*t._value),providedFormat:A,state:n}),D=Object.assign({},u,A),L?"%".concat(D.spaceSeparated?" ":"").concat(P):"".concat(P).concat(D.spaceSeparated?" ":"","%");case"byte":return y=a[(w=e=g(e,n.currentByteDefaultFormat())).base||"binary"],C=(b=c(t._value,y.suffixes,y.scale)).value,S=b.suffix,E=f({instance:r(C),providedFormat:w,state:n,defaults:n.currentByteDefaultFormat()}),T=n.currentAbbreviations(),"".concat(E).concat(T.spaced?" ":"").concat(S);case"time":return e=g(e,n.currentTimeDefaultFormat()),d=Math.floor(t._value/60/60),p=Math.floor((t._value-60*d*60)/60),m=Math.round(t._value-60*d*60-60*p),"".concat(d,":").concat(p<10?"0":"").concat(p,":").concat(m<10?"0":"").concat(m);case"ordinal":return i=e=g(e,n.currentOrdinalDefaultFormat()),o=n.currentOrdinal(),s=Object.assign({},u,i),l=f({instance:t,providedFormat:i,state:n}),h=o(t._value),"".concat(l).concat(s.spaceSeparated?" ":"").concat(h);default:return f({instance:t,providedFormat:e,numbro:r})}}(t,e,r);return(h=i+h)+l}function c(t,e,r){var i=e[0],n=Math.abs(t);if(r<=n){for(var o=1;o<e.length;++o){var s=Math.pow(r,o),l=Math.pow(r,o+1);if(s<=n&&n<l){i=e[o],t/=s;break}}i===e[0]&&(t/=Math.pow(r,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function d(t){for(var e="",r=0;r<t;r++)e+="0";return e}function f(t){var e,r,o,s,l,a,h,c,f,g=t.instance,p=t.providedFormat,m=t.state,w=void 0===m?n:m,y=t.decimalSeparator,b=t.defaults,C=void 0===b?w.currentDefaults():b,S=g._value;if(0===S&&w.hasZeroFormat())return w.getZeroFormat();if(!isFinite(S))return S.toString();var E,T,R,O,M,I,N,x,k=Object.assign({},u,C,p),H=k.totalLength,_=H?0:k.characteristic,A=k.optionalCharacteristic,L=k.forceAverage,P=!!H||!!L||k.average,D=H?-1:P&&void 0===p.mantissa?0:k.mantissa,B=!H&&(void 0===p.optionalMantissa?-1===D:k.optionalMantissa),F=k.trimMantissa,W=k.thousandSeparated,V=k.spaceSeparated,j=k.negative,U=k.forceSign,$=k.exponential,z="";if(P){var G,K,X,Y,q,Z,Q,J,tt,te,tr=(K=(G={value:S,forceAverage:L,abbreviations:w.currentAbbreviations(),spaceSeparated:V,totalLength:H}).value,X=G.forceAverage,Y=G.abbreviations,q=G.spaceSeparated,Q=void 0===(Z=G.totalLength)?0:Z,J="",te=-1,(tt=Math.abs(K))>=1e12&&!X||"trillion"===X?(J=Y.trillion,K/=1e12):tt<1e12&&tt>=1e9&&!X||"billion"===X?(J=Y.billion,K/=1e9):tt<1e9&&tt>=1e6&&!X||"million"===X?(J=Y.million,K/=1e6):(tt<1e6&&tt>=1e3&&!X||"thousand"===X)&&(J=Y.thousand,K/=1e3),J&&(J=(void 0!==q&&q?" ":"")+J),Q&&(te=Math.max(Q-K.toString().split(".")[0].length,0)),{value:K,abbreviation:J,mantissaPrecision:te});S=tr.value,z+=tr.abbreviation,H&&(D=tr.mantissaPrecision)}if($){var ti=(T=(E={value:S,characteristicPrecision:_}).value,O=void 0===(R=E.characteristicPrecision)?0:R,I=(M=i(T.toExponential().split("e"),2))[0],N=M[1],x=+I,O&&1<O&&(x*=Math.pow(10,O-1),N=0<=(N=+N-(O-1))?"+".concat(N):N),{value:x,abbreviation:"e".concat(N)});S=ti.value,z=ti.abbreviation+z}var tn,to,ts=function(t,e,r,n,o){if(-1===n)return t;var s=-1!==e.toString().indexOf("e")?function(t,e){var r=t.toString(),n=i(r.split("e"),2),o=n[0],s=n[1],l=i(o.split("."),2),a=l[0],u=l[1],h=void 0===u?"":u;if(0<+s)r=a+h+d(s-h.length);else{var c=".";c=0>+a?"-0".concat(c):"0".concat(c);var f=(d(-s-1)+Math.abs(a)+h).substr(0,e);f.length<e&&(f+=d(e-f.length)),r=c+f}return 0<+s&&0<e&&(r+=".".concat(d(e))),r}(e,n):(Math.round(+"".concat(e,"e+").concat(n))/Math.pow(10,n)).toFixed(n),l=i(s.toString().split("."),2),a=l[0],u=l[1],h=void 0===u?"":u;if(h.match(/^0+$/)&&(r||o))return a;var c=h.match(/0+$/);return o&&c?"".concat(a,".").concat(h.toString().slice(0,c.index)):s.toString()}(S.toString(),S,B,D,F);return e=ts=function(t,e,r,n){var o=t,s=i(o.toString().split("."),2),l=s[0],a=s[1];if(l.match(/^-?0$/)&&r)return a?"".concat(l.replace("0",""),".").concat(a):l.replace("0","");if(l.length<n)for(var u=n-l.length,h=0;h<u;h++)o="0".concat(o);return o.toString()}(ts,0,A,_),r=S,o=y,l=(s=w.currentDelimiters()).thousands,o=o||s.decimal,a=s.thousandsSize||3,c=(h=e.toString()).split(".")[0],f=h.split(".")[1],W&&(r<0&&(c=c.slice(1)),(function(t,e){for(var r=[],i=0,n=t;0<n;n--)i===e&&(r.unshift(n),i=0),i++;return r})(c.length,a).forEach(function(t,e){c=c.slice(0,t+e)+l+c.slice(t+e)}),r<0&&(c="-".concat(c))),ts=h=f?c+o+f:c,(P||$)&&(ts+=z),(U||S<0)&&(tn=ts,ts=0===(to=S)?tn:0==+tn?tn.replace("-",""):0<to?"+".concat(tn):"sign"===j?tn:"(".concat(tn.replace("-",""),")")),ts}function g(t,e){if(!t)return e;var r=Object.keys(t);return 1===r.length&&"output"===r[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return h.apply(void 0,r.concat([t]))},getByteUnit:function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(function(t){var e=a.general;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,r.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(function(t){var e=a.binary;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,r.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return(function(t){var e=a.decimal;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,r.concat([t]))},formatOrDefault:g}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,r){"use strict";var i=t("./en-US"),n=t("./validating"),o=t("./parsing"),s={},l=void 0,a={},u=null,h={};function c(){return a[l]}s.languages=function(){return Object.assign({},a)},s.currentLanguage=function(){return l},s.currentCurrency=function(){return c().currency},s.currentAbbreviations=function(){return c().abbreviations},s.currentDelimiters=function(){return c().delimiters},s.currentOrdinal=function(){return c().ordinal},s.currentDefaults=function(){return Object.assign({},c().defaults,h)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().timeFormat)},s.setDefaults=function(t){t=o.parseFormat(t),n.validateFormat(t)&&(h=t)},s.getZeroFormat=function(){return u},s.setZeroFormat=function(t){return u="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==u},s.languageData=function(t){if(t){if(a[t])return a[t];throw Error('Unknown tag "'.concat(t,'"'))}return c()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!n.validateLanguage(t))throw Error("Invalid language data");a[t.languageTag]=t,e&&(l=t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!a[t]){var r=t.split("-")[0],n=Object.keys(a).find(function(t){return t.split("-")[0]===r});return a[n]?void(l=n):void(l=e)}l=t},s.registerLanguage(i),l=i.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,r){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(r){r.forEach(function(r){var i=void 0;try{i=t("../languages/".concat(r))}catch(t){console.error('Unable to load "'.concat(r,'". No matching language file found.'))}i&&e.registerLanguage(i)})}}}},{}],6:[function(t,e,r){"use strict";var i=t("bignumber.js");function n(t,e,r){var n=new i(t._value),o=e;return r.isNumbro(e)&&(o=e._value),o=new i(o),t._value=n.minus(o).toNumber(),t}e.exports=function(t){return{add:function(e,r){var n,o;return n=new i(e._value),o=r,t.isNumbro(r)&&(o=r._value),o=new i(o),e._value=n.plus(o).toNumber(),e},subtract:function(e,r){return n(e,r,t)},multiply:function(e,r){var n,o;return n=new i(e._value),o=r,t.isNumbro(r)&&(o=r._value),o=new i(o),e._value=n.times(o).toNumber(),e},divide:function(e,r){var n,o;return n=new i(e._value),o=r,t.isNumbro(r)&&(o=r._value),o=new i(o),e._value=n.dividedBy(o).toNumber(),e},set:function(e,r){var i;return i=r,t.isNumbro(r)&&(i=r._value),e._value=i,e},difference:function(e,r){var i;return n(i=t(e._value),r,t),Math.abs(i._value)}}}},{"bignumber.js":1}],7:[function(t,e,r){"use strict";function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var n=t("./globalState"),o=t("./validating"),s=t("./loading")(f),l=t("./unformatting"),a=t("./formatting")(f),u=t("./manipulating")(f),h=t("./parsing"),c=function(){var t,e;function r(t){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,r),this._value=t}return t=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=h.parseFormat(t)),(t=a.formatOrDefault(t,n.currentCurrencyDefaultFormat())).output="currency",a.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",a.format(this,t)}},{key:"binaryByteUnits",value:function(){return a.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return a.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return a.getByteUnit(this)}},{key:"difference",value:function(t){return u.difference(this,t)}},{key:"add",value:function(t){return u.add(this,t)}},{key:"subtract",value:function(t){return u.subtract(this,t)}},{key:"multiply",value:function(t){return u.multiply(this,t)}},{key:"divide",value:function(t){return u.divide(this,t)}},{key:"set",value:function(t){return u.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}],i(r.prototype,t),e&&i(r,e),r}();function d(t){var e=t;return f.isNumbro(t)?e=t._value:"string"==typeof t?e=f.unformat(t):isNaN(t)&&(e=NaN),e}function f(t){return new c(d(t))}f.version="2.1.2",f.isNumbro=function(t){return t instanceof c},f.language=n.currentLanguage,f.registerLanguage=n.registerLanguage,f.setLanguage=n.setLanguage,f.languages=n.languages,f.languageData=n.languageData,f.zeroFormat=n.setZeroFormat,f.defaultFormat=n.currentDefaults,f.setDefaults=n.setDefaults,f.defaultCurrencyFormat=n.currentCurrencyDefaultFormat,f.validate=o.validate,f.loadLanguagesInNode=s.loadLanguagesInNode,f.unformat=l.unformat,e.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,r){"use strict";e.exports={parseFormat:function(t){var e,r,i,n,o,s,l,a,u,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return -1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(n=(i=t=(r=(e=t).match(/^{([^}]*)}/))?(h.prefix=r[1],e.slice(r[0].length)):e).match(/{([^}]*)}$/))?(h.postfix=n[1],i.slice(0,-n[0].length)):i,h),(o=t.match(/[1-9]+[0-9]*/))&&(h.totalLength=+o[0]),(s=t.split(".")[0].match(/0+/))&&(h.characteristic=s[0].length),function(t,e){if(-1!==t.indexOf(".")){var r=t.split(".")[0];e.optionalCharacteristic=-1===r.indexOf("0")}}(t,h),-1!==t.indexOf("a")&&(h.average=!0),-1!==(l=t).indexOf("K")?h.forceAverage="thousand":-1!==l.indexOf("M")?h.forceAverage="million":-1!==l.indexOf("B")?h.forceAverage="billion":-1!==l.indexOf("T")&&(h.forceAverage="trillion"),function(t,e){var r=t.split(".")[1];if(r){var i=r.match(/0+/);i&&(e.mantissa=i[0].length)}}(t,h),(a=t).match(/\[\.]/)?h.optionalMantissa=!0:a.match(/\./)&&(h.optionalMantissa=!1),-1!==t.indexOf(",")&&(h.thousandSeparated=!0),-1!==t.indexOf(" ")&&(h.spaceSeparated=!0),(u=t).match(/^\+?\([^)]*\)$/)&&(h.negative="parenthesis"),u.match(/^\+?-/)&&(h.negative="sign"),t.match(/^\+/)&&(h.forceSign=!0),h)}}},{}],9:[function(t,e,r){"use strict";var i=[{key:"ZiB",factor:11805916207174113e5},{key:"ZB",factor:1e21},{key:"YiB",factor:12089258196146292e8},{key:"YB",factor:1e24},{key:"TiB",factor:1099511627776},{key:"TB",factor:1e12},{key:"PiB",factor:0x4000000000000},{key:"PB",factor:1e15},{key:"MiB",factor:1048576},{key:"MB",factor:1e6},{key:"KiB",factor:1024},{key:"KB",factor:1e3},{key:"GiB",factor:1073741824},{key:"GB",factor:1e9},{key:"EiB",factor:0x1000000000000000},{key:"EB",factor:1e18},{key:"B",factor:1}];function n(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,r){var o,s,l,a=t("./globalState"),u=a.currentDelimiters(),h=a.currentCurrency().symbol,c=a.currentOrdinal(),d=a.getZeroFormat(),f=a.currentAbbreviations(),g=void 0;if("string"==typeof e)g=!function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var r=t.split(":");if(3!==r.length)return!1;var i=+r[0],n=+r[1],o=+r[2];return!isNaN(i)&&!isNaN(n)&&!isNaN(o)}(e,u)?function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,r){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,l=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var h="",c=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==e)return -1*t(c,r,o,s,l,a,u);for(var d=0;d<i.length;d++){var f=i[d];if((h=e.replace(f.key,""))!==e)return t(h,r,o,s,l,a,u)*f.factor}if((h=e.replace("%",""))!==e)return t(h,r,o,s,l,a,u)/100;var g=parseFloat(e);if(!isNaN(g)){var p=s(g);if(p&&"."!==p&&(h=e.replace(new RegExp("".concat(n(p),"$")),""))!==e)return t(h,r,o,s,l,a,u);var m={};Object.keys(a).forEach(function(t){m[a[t]]=t});for(var w=Object.keys(m).sort().reverse(),y=w.length,b=0;b<y;b++){var C=w[b],S=m[C];if((h=e.replace(C,""))!==e){var E=void 0;switch(S){case"thousand":E=1e3;break;case"million":E=1e6;break;case"billion":E=1e9;break;case"trillion":E=1e12}return t(h,r,o,s,l,a,u)*E}}}}(function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=t.replace(r,"");return(i=i.replace(RegExp("([0-9])".concat(n(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,r),e,r,o,s,l,a)}(e,u,h,c,d,f,r):(s=+(o=e.split(":"))[0],l=+o[1],+o[2]+60*l+3600*s);else{if("number"!=typeof e)return;g=e}if(void 0!==g)return g}}},{"./globalState":4}],10:[function(t,e,r){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=t("./unformatting"),o=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(o)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function a(t){return!!n.unformat(t)}function u(t,e,r){var n,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=Object.keys(t).map(function(n){if(!e[n])return console.error("".concat(r," Invalid key: ").concat(n)),!1;var o=t[n],l=e[n];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!u(o,s,"[Validate ".concat(n,"]"),!0))return!1}else if(i(o)!==l.type)return console.error("".concat(r," ").concat(n,' type mismatched: "').concat(l.type,'" expected, "').concat(i(o),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var a=l.restrictions.length,h=0;h<a;h++){var c=l.restrictions[h],d=c.restriction,f=c.message;if(!d(o,t))return console.error("".concat(r," ").concat(n," invalid value: ").concat(f)),!1}return l.restriction&&!l.restriction(o,t)?(console.error("".concat(r," ").concat(n," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(o)?(console.error("".concat(r," ").concat(n," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(o,'" provided')),!1):!l.children||!!u(o,l.children,"[Validate ".concat(n,"]"))});return o||l.push.apply(l,function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(n=Object.keys(e).map(function(i){var n=e[i];if("string"==typeof n&&(n={type:n}),n.mandatory){var o=n.mandatory;if("function"==typeof o&&(o=o(t)),o&&void 0===t[i])return console.error("".concat(r,' Missing mandatory key "').concat(i,'"')),!1}return!0}))||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}()),l.reduce(function(t,e){return t&&e},!0)}function h(t){return u(t,s,"[Validate format]")}e.exports={validate:function(t,e){var r=a(t),i=h(e);return r&&i},validateFormat:h,validateInput:a,validateLanguage:function(t){return u(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},6308:function(t,e,r){"use strict";var i=r(9851),n=r(6124),o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(n(t)+" is not a function")}},182:function(t,e,r){"use strict";var i=r(3892),n=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o("Can't set "+n(t)+" as a prototype")}},2834:function(t,e,r){"use strict";var i=r(3237),n=r(4558),o=r(5742).f,s=i("unscopables"),l=Array.prototype;void 0===l[s]&&o(l,s,{configurable:!0,value:n(null)}),t.exports=function(t){l[s][t]=!0}},5396:function(t,e,r){"use strict";var i=r(2264),n=String,o=TypeError;t.exports=function(t){if(i(t))return t;throw new o(n(t)+" is not an object")}},8842:function(t,e,r){"use strict";var i=r(753),n=r(5585),o=r(4058),s=function(t){return function(e,r,s){var l,a=i(e),u=o(a),h=n(s,u);if(t&&r!=r){for(;u>h;)if((l=a[h++])!=l)return!0}else for(;u>h;h++)if((t||h in a)&&a[h]===r)return t||h||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},1856:function(t,e,r){"use strict";var i=r(4839),n=r(52),o=TypeError,s=Object.getOwnPropertyDescriptor,l=i&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(n(t)&&!s(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},151:function(t,e,r){"use strict";var i=r(1192);t.exports=i([].slice)},3947:function(t,e,r){"use strict";var i=r(1192),n=i({}.toString),o=i("".slice);t.exports=function(t){return o(n(t),8,-1)}},4569:function(t,e,r){"use strict";var i=r(9744),n=r(9851),o=r(3947),s=r(3237)("toStringTag"),l=Object,a="Arguments"===o(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(t){}};t.exports=i?o:function(t){var e,r,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(e=l(t),s))?r:a?o(e):"Object"===(i=o(e))&&n(e.callee)?"Arguments":i}},7994:function(t,e,r){"use strict";var i=r(8795),n=r(4166),o=r(6317),s=r(5742);t.exports=function(t,e,r){for(var l=n(e),a=s.f,u=o.f,h=0;h<l.length;h++){var c=l[h];i(t,c)||r&&i(r,c)||a(t,c,u(e,c))}}},7581:function(t,e,r){"use strict";var i=r(4839),n=r(5742),o=r(6999);t.exports=i?function(t,e,r){return n.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},6999:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},8803:function(t,e,r){"use strict";var i=r(9851),n=r(5742),o=r(1416),s=r(8079);t.exports=function(t,e,r,l){l||(l={});var a=l.enumerable,u=void 0!==l.name?l.name:e;if(i(r)&&o(r,u,l),l.global)a?t[e]=r:s(e,r);else{try{l.unsafe?t[e]&&(a=!0):delete t[e]}catch(t){}a?t[e]=r:n.f(t,e,{value:r,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t}},8079:function(t,e,r){"use strict";var i=r(9532),n=Object.defineProperty;t.exports=function(t,e){try{n(i,t,{value:e,configurable:!0,writable:!0})}catch(r){i[t]=e}return e}},7551:function(t,e,r){"use strict";var i=r(6124),n=TypeError;t.exports=function(t,e){if(!delete t[e])throw new n("Cannot delete property "+i(e)+" of "+i(t))}},4839:function(t,e,r){"use strict";var i=r(8742);t.exports=!i(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},7072:function(t,e,r){"use strict";var i=r(9532),n=r(2264),o=i.document,s=n(o)&&n(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},2399:function(t){"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6589:function(t){"use strict";t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},8642:function(t,e,r){"use strict";var i=r(1246);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},4935:function(t,e,r){"use strict";var i=r(9532),n=r(3947);t.exports="process"===n(i.process)},1246:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},8305:function(t,e,r){"use strict";var i,n,o=r(9532),s=r(1246),l=o.process,a=o.Deno,u=l&&l.versions||a&&a.version,h=u&&u.v8;h&&(n=(i=h.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!n&&s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(n=+i[1]),t.exports=n},5830:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6374:function(t,e,r){"use strict";var i=r(1192),n=Error,o=i("".replace),s=String(new n("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,a=l.test(s);t.exports=function(t,e){if(a&&"string"==typeof t&&!n.prepareStackTrace)for(;e--;)t=o(t,l,"");return t}},5906:function(t,e,r){"use strict";var i=r(7581),n=r(6374),o=r(4776),s=Error.captureStackTrace;t.exports=function(t,e,r,l){o&&(s?s(t,e):i(t,"stack",n(r,l)))}},4776:function(t,e,r){"use strict";var i=r(8742),n=r(6999);t.exports=!i(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)})},8060:function(t,e,r){"use strict";var i=r(9532),n=r(6317).f,o=r(7581),s=r(8803),l=r(8079),a=r(7994),u=r(3103);t.exports=function(t,e){var r,h,c,d,f,g=t.target,p=t.global,m=t.stat;if(r=p?i:m?i[g]||l(g,{}):i[g]&&i[g].prototype)for(h in e){if(d=e[h],c=t.dontCallGetSet?(f=n(r,h))&&f.value:r[h],!u(p?h:g+(m?".":"#")+h,t.forced)&&void 0!==c){if(typeof d==typeof c)continue;a(d,c)}(t.sham||c&&c.sham)&&o(d,"sham",!0),s(r,h,d,t)}}},8742:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},4311:function(t,e,r){"use strict";var i=r(3922),n=Function.prototype,o=n.apply,s=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(i?s.bind(o):function(){return s.apply(o,arguments)})},2332:function(t,e,r){"use strict";var i=r(1273),n=r(6308),o=r(3922),s=i(i.bind);t.exports=function(t,e){return n(t),void 0===e?t:o?s(t,e):function(){return t.apply(e,arguments)}}},3922:function(t,e,r){"use strict";var i=r(8742);t.exports=!i(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},173:function(t,e,r){"use strict";var i=r(3922),n=Function.prototype.call;t.exports=i?n.bind(n):function(){return n.apply(n,arguments)}},5081:function(t,e,r){"use strict";var i=r(4839),n=r(8795),o=Function.prototype,s=i&&Object.getOwnPropertyDescriptor,l=n(o,"name"),a=l&&(!i||i&&s(o,"name").configurable);t.exports={EXISTS:l,PROPER:l&&"something"===(function(){}).name,CONFIGURABLE:a}},781:function(t,e,r){"use strict";var i=r(1192),n=r(6308);t.exports=function(t,e,r){try{return i(n(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(t){}}},1273:function(t,e,r){"use strict";var i=r(3947),n=r(1192);t.exports=function(t){if("Function"===i(t))return n(t)}},1192:function(t,e,r){"use strict";var i=r(3922),n=Function.prototype,o=n.call,s=i&&n.bind.bind(o,o);t.exports=i?s:function(t){return function(){return o.apply(t,arguments)}}},2969:function(t,e,r){"use strict";var i=r(9532),n=r(9851);t.exports=function(t,e){var r;return arguments.length<2?n(r=i[t])?r:void 0:i[t]&&i[t][e]}},3251:function(t,e,r){"use strict";var i=r(1192),n=r(52),o=r(9851),s=r(3947),l=r(6679),a=i([].push);t.exports=function(t){if(o(t))return t;if(n(t)){for(var e=t.length,r=[],i=0;i<e;i++){var u=t[i];"string"==typeof u?a(r,u):("number"==typeof u||"Number"===s(u)||"String"===s(u))&&a(r,l(u))}var h=r.length,c=!0;return function(t,e){if(c)return c=!1,e;if(n(this))return e;for(var i=0;i<h;i++)if(r[i]===t)return e}}}},3652:function(t,e,r){"use strict";var i=r(6308),n=r(8355);t.exports=function(t,e){var r=t[e];return n(r)?void 0:i(r)}},9532:function(t,e,r){"use strict";var i=function(t){return t&&t.Math===Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r.g&&r.g)||i("object"==typeof this&&this)||function(){return this}()||Function("return this")()},8795:function(t,e,r){"use strict";var i=r(1192),n=r(9087),o=i({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(n(t),e)}},4305:function(t){"use strict";t.exports={}},5132:function(t,e,r){"use strict";var i=r(2969);t.exports=i("document","documentElement")},9299:function(t,e,r){"use strict";var i=r(4839),n=r(8742),o=r(7072);t.exports=!i&&!n(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},4419:function(t,e,r){"use strict";var i=r(1192),n=r(8742),o=r(3947),s=Object,l=i("".split);t.exports=n(function(){return!s("z").propertyIsEnumerable(0)})?function(t){return"String"===o(t)?l(t,""):s(t)}:s},6348:function(t,e,r){"use strict";var i=r(9851),n=r(2264),o=r(9391);t.exports=function(t,e,r){var s,l;return o&&i(s=e.constructor)&&s!==r&&n(l=s.prototype)&&l!==r.prototype&&o(t,l),t}},5229:function(t,e,r){"use strict";var i=r(1192),n=r(9851),o=r(8947),s=i(Function.toString);n(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource},8832:function(t,e,r){"use strict";var i=r(2264),n=r(7581);t.exports=function(t,e){i(e)&&"cause"in e&&n(t,"cause",e.cause)}},7555:function(t,e,r){"use strict";var i,n,o,s=r(230),l=r(9532),a=r(2264),u=r(7581),h=r(8795),c=r(8947),d=r(1158),f=r(4305),g="Object already initialized",TypeError=l.TypeError,WeakMap=l.WeakMap;if(s||c.state){var p=c.state||(c.state=new WeakMap);p.get=p.get,p.has=p.has,p.set=p.set,i=function(t,e){if(p.has(t))throw new TypeError(g);return e.facade=t,p.set(t,e),e},n=function(t){return p.get(t)||{}},o=function(t){return p.has(t)}}else{var m=d("state");f[m]=!0,i=function(t,e){if(h(t,m))throw new TypeError(g);return e.facade=t,u(t,m,e),e},n=function(t){return h(t,m)?t[m]:{}},o=function(t){return h(t,m)}}t.exports={set:i,get:n,has:o,enforce:function(t){return o(t)?n(t):i(t,{})},getterFor:function(t){return function(e){var r;if(!a(e)||(r=n(e)).type!==t)throw new TypeError("Incompatible receiver, "+t+" required");return r}}}},52:function(t,e,r){"use strict";var i=r(3947);t.exports=Array.isArray||function(t){return"Array"===i(t)}},9851:function(t){"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},3103:function(t,e,r){"use strict";var i=r(8742),n=r(9851),o=/#|\.prototype\./,s=function(t,e){var r=a[l(t)];return r===h||r!==u&&(n(e)?i(e):!!e)},l=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},a=s.data={},u=s.NATIVE="N",h=s.POLYFILL="P";t.exports=s},8355:function(t){"use strict";t.exports=function(t){return null==t}},2264:function(t,e,r){"use strict";var i=r(9851);t.exports=function(t){return"object"==typeof t?null!==t:i(t)}},3892:function(t,e,r){"use strict";var i=r(2264);t.exports=function(t){return i(t)||null===t}},8420:function(t){"use strict";t.exports=!1},7701:function(t,e,r){"use strict";var i=r(2969),n=r(9851),o=r(7883),s=r(6293),l=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=i("Symbol");return n(e)&&o(e.prototype,l(t))}},4058:function(t,e,r){"use strict";var i=r(2466);t.exports=function(t){return i(t.length)}},1416:function(t,e,r){"use strict";var i=r(1192),n=r(8742),o=r(9851),s=r(8795),l=r(4839),a=r(5081).CONFIGURABLE,u=r(5229),h=r(7555),c=h.enforce,d=h.get,f=String,g=Object.defineProperty,p=i("".slice),m=i("".replace),w=i([].join),y=l&&!n(function(){return 8!==g(function(){},"length",{value:8}).length}),b=String(String).split("String"),C=t.exports=function(t,e,r){"Symbol("===p(f(e),0,7)&&(e="["+m(f(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(l?g(t,"name",{value:e,configurable:!0}):t.name=e),y&&r&&s(r,"arity")&&t.length!==r.arity&&g(t,"length",{value:r.arity});try{r&&s(r,"constructor")&&r.constructor?l&&g(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var i=c(t);return s(i,"source")||(i.source=w(b,"string"==typeof e?e:"")),t};Function.prototype.toString=C(function(){return o(this)&&d(this).source||u(this)},"toString")},4532:function(t){"use strict";var e=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(t){var i=+t;return(i>0?r:e)(i)}},2949:function(t,e,r){"use strict";var i=r(6679);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:i(t)}},4558:function(t,e,r){"use strict";var i,n=r(5396),o=r(4809),s=r(5830),l=r(4305),a=r(5132),u=r(7072),h=r(1158),c="prototype",d="script",f=h("IE_PROTO"),g=function(){},p=function(t){return"<"+d+">"+t+"</"+d+">"},m=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},w=function(){var t,e=u("iframe");return e.style.display="none",a.appendChild(e),e.src=String("java"+d+":"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F},y=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}y="undefined"!=typeof document?document.domain&&i?m(i):w():m(i);for(var t=s.length;t--;)delete y[c][s[t]];return y()};l[f]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(g[c]=n(t),r=new g,g[c]=null,r[f]=t):r=y(),void 0===e?r:o.f(r,e)}},4809:function(t,e,r){"use strict";var i=r(4839),n=r(7747),o=r(5742),s=r(5396),l=r(753),a=r(2208);e.f=i&&!n?Object.defineProperties:function(t,e){s(t);for(var r,i=l(e),n=a(e),u=n.length,h=0;u>h;)o.f(t,r=n[h++],i[r]);return t}},5742:function(t,e,r){"use strict";var i=r(4839),n=r(9299),o=r(7747),s=r(5396),l=r(5007),a=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",f="writable";e.f=i?o?function(t,e,r){if(s(t),e=l(e),s(r),"function"==typeof t&&"prototype"===e&&"value"in r&&f in r&&!r[f]){var i=h(t,e);i&&i[f]&&(t[e]=r.value,r={configurable:d in r?r[d]:i[d],enumerable:c in r?r[c]:i[c],writable:!1})}return u(t,e,r)}:u:function(t,e,r){if(s(t),e=l(e),s(r),n)try{return u(t,e,r)}catch(t){}if("get"in r||"set"in r)throw new a("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},6317:function(t,e,r){"use strict";var i=r(4839),n=r(173),o=r(8076),s=r(6999),l=r(753),a=r(5007),u=r(8795),h=r(9299),c=Object.getOwnPropertyDescriptor;e.f=i?c:function(t,e){if(t=l(t),e=a(e),h)try{return c(t,e)}catch(t){}if(u(t,e))return s(!n(o.f,t,e),t[e])}},2066:function(t,e,r){"use strict";var i=r(9915),n=r(5830).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,n)}},2198:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},7883:function(t,e,r){"use strict";var i=r(1192);t.exports=i({}.isPrototypeOf)},9915:function(t,e,r){"use strict";var i=r(1192),n=r(8795),o=r(753),s=r(8842).indexOf,l=r(4305),a=i([].push);t.exports=function(t,e){var r,i=o(t),u=0,h=[];for(r in i)!n(l,r)&&n(i,r)&&a(h,r);for(;e.length>u;)n(i,r=e[u++])&&(~s(h,r)||a(h,r));return h}},2208:function(t,e,r){"use strict";var i=r(9915),n=r(5830);t.exports=Object.keys||function(t){return i(t,n)}},8076:function(t,e){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,n=i&&!r.call({1:2},1);e.f=n?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},9391:function(t,e,r){"use strict";var i=r(781),n=r(5396),o=r(182);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=i(Object.prototype,"__proto__","set"))(r,[]),e=r instanceof Array}catch(t){}return function(r,i){return n(r),o(i),e?t(r,i):r.__proto__=i,r}}():void 0)},3465:function(t,e,r){"use strict";var i=r(173),n=r(9851),o=r(2264),s=TypeError;t.exports=function(t,e){var r,l;if("string"===e&&n(r=t.toString)&&!o(l=i(r,t))||n(r=t.valueOf)&&!o(l=i(r,t))||"string"!==e&&n(r=t.toString)&&!o(l=i(r,t)))return l;throw new s("Can't convert object to primitive value")}},4166:function(t,e,r){"use strict";var i=r(2969),n=r(1192),o=r(2066),s=r(2198),l=r(5396),a=n([].concat);t.exports=i("Reflect","ownKeys")||function(t){var e=o.f(l(t)),r=s.f;return r?a(e,r(t)):e}},403:function(t,e,r){"use strict";var i=r(5742).f;t.exports=function(t,e,r){r in t||i(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},5834:function(t,e,r){"use strict";var i=r(8355),n=TypeError;t.exports=function(t){if(i(t))throw new n("Can't call method on "+t);return t}},2178:function(t,e,r){"use strict";var i,n=r(9532),o=r(4311),s=r(9851),l=r(6589),a=r(1246),u=r(151),h=r(2517),Function=n.Function,c=/MSIE .\./.test(a)||l&&((i=n.Bun.version.split(".")).length<3||"0"===i[0]&&(i[1]<3||"3"===i[1]&&"0"===i[2]));t.exports=function(t,e){var r=e?2:1;return c?function(i,n){var l=h(arguments.length,1)>r,a=s(i)?i:Function(i),c=l?u(arguments,r):[],d=l?function(){o(a,this,c)}:a;return e?t(d,n):t(d)}:t}},1158:function(t,e,r){"use strict";var i=r(3108),n=r(6934),o=i("keys");t.exports=function(t){return o[t]||(o[t]=n(t))}},8947:function(t,e,r){"use strict";var i=r(9532),n=r(8079),o="__core-js_shared__",s=i[o]||n(o,{});t.exports=s},3108:function(t,e,r){"use strict";var i=r(8420),n=r(8947);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.35.1",mode:i?"pure":"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.1/LICENSE",source:"https://github.com/zloirock/core-js"})},4726:function(t,e,r){"use strict";var i=r(8305),n=r(8742),o=r(9532).String;t.exports=!!Object.getOwnPropertySymbols&&!n(function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t) instanceof Symbol)||!Symbol.sham&&i&&i<41})},7815:function(t,e,r){"use strict";var i,n,o,s,l=r(9532),a=r(4311),u=r(2332),h=r(9851),c=r(8795),d=r(8742),f=r(5132),g=r(151),p=r(7072),m=r(2517),w=r(8642),y=r(4935),b=l.setImmediate,C=l.clearImmediate,S=l.process,E=l.Dispatch,Function=l.Function,MessageChannel=l.MessageChannel,String=l.String,T=0,R={},O="onreadystatechange";d(function(){i=l.location});var M=function(t){if(c(R,t)){var e=R[t];delete R[t],e()}},I=function(t){return function(){M(t)}},N=function(t){M(t.data)},x=function(t){l.postMessage(String(t),i.protocol+"//"+i.host)};b&&C||(b=function(t){m(arguments.length,1);var e=h(t)?t:Function(t),r=g(arguments,1);return R[++T]=function(){a(e,void 0,r)},n(T),T},C=function(t){delete R[t]},y?n=function(t){S.nextTick(I(t))}:E&&E.now?n=function(t){E.now(I(t))}:MessageChannel&&!w?(s=(o=new MessageChannel).port2,o.port1.onmessage=N,n=u(s.postMessage,s)):l.addEventListener&&h(l.postMessage)&&!l.importScripts&&i&&"file:"!==i.protocol&&!d(x)?(n=x,l.addEventListener("message",N,!1)):n=O in p("script")?function(t){f.appendChild(p("script"))[O]=function(){f.removeChild(this),M(t)}}:function(t){setTimeout(I(t),0)}),t.exports={set:b,clear:C}},5585:function(t,e,r){"use strict";var i=r(1662),n=Math.max,o=Math.min;t.exports=function(t,e){var r=i(t);return r<0?n(r+e,0):o(r,e)}},753:function(t,e,r){"use strict";var i=r(4419),n=r(5834);t.exports=function(t){return i(n(t))}},1662:function(t,e,r){"use strict";var i=r(4532);t.exports=function(t){var e=+t;return e!=e||0===e?0:i(e)}},2466:function(t,e,r){"use strict";var i=r(1662),n=Math.min;t.exports=function(t){var e=i(t);return e>0?n(e,9007199254740991):0}},9087:function(t,e,r){"use strict";var i=r(5834),n=Object;t.exports=function(t){return n(i(t))}},547:function(t,e,r){"use strict";var i=r(173),n=r(2264),o=r(7701),s=r(3652),l=r(3465),a=r(3237),u=TypeError,h=a("toPrimitive");t.exports=function(t,e){if(!n(t)||o(t))return t;var r,a=s(t,h);if(a){if(void 0===e&&(e="default"),!n(r=i(a,t,e))||o(r))return r;throw new u("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(t,e)}},5007:function(t,e,r){"use strict";var i=r(547),n=r(7701);t.exports=function(t){var e=i(t,"string");return n(e)?e:e+""}},9744:function(t,e,r){"use strict";var i=r(3237)("toStringTag"),n={};n[i]="z",t.exports="[object z]"===String(n)},6679:function(t,e,r){"use strict";var i=r(4569),n=String;t.exports=function(t){if("Symbol"===i(t))throw TypeError("Cannot convert a Symbol value to a string");return n(t)}},6124:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6934:function(t,e,r){"use strict";var i=r(1192),n=0,o=Math.random(),s=i(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++n+o,36)}},6293:function(t,e,r){"use strict";var i=r(4726);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7747:function(t,e,r){"use strict";var i=r(4839),n=r(8742);t.exports=i&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},2517:function(t){"use strict";var e=TypeError;t.exports=function(t,r){if(t<r)throw new e("Not enough arguments");return t}},230:function(t,e,r){"use strict";var i=r(9532),n=r(9851),WeakMap=i.WeakMap;t.exports=n(WeakMap)&&/native code/.test(String(WeakMap))},3237:function(t,e,r){"use strict";var i=r(9532),n=r(3108),o=r(8795),s=r(6934),l=r(4726),a=r(6293),Symbol=i.Symbol,u=n("wks"),h=a?Symbol.for||Symbol:Symbol&&Symbol.withoutSetter||s;t.exports=function(t){return o(u,t)||(u[t]=l&&o(Symbol,t)?Symbol[t]:h("Symbol."+t)),u[t]}},3328:function(t,e,r){"use strict";var i=r(2969),n=r(8795),o=r(7581),s=r(7883),l=r(9391),a=r(7994),u=r(403),h=r(6348),c=r(2949),d=r(8832),f=r(5906),g=r(4839),p=r(8420);t.exports=function(t,e,r,m){var w="stackTraceLimit",y=m?2:1,b=t.split("."),C=b[b.length-1],S=i.apply(null,b);if(S){var E=S.prototype;if(!p&&n(E,"cause")&&delete E.cause,!r)return S;var T=i("Error"),R=e(function(t,e){var r=c(m?e:t,void 0),i=m?new S(t):new S;return void 0!==r&&o(i,"message",r),f(i,R,i.stack,2),this&&s(E,this)&&h(i,this,R),arguments.length>y&&d(i,arguments[y]),i});if(R.prototype=E,"Error"!==C?l?l(R,T):a(R,T,{name:!0}):g&&w in S&&(u(R,S,w),u(R,S,"prepareStackTrace")),a(R,S),!p)try{E.name!==C&&o(E,"name",C),E.constructor=R}catch(t){}return R}}},3893:function(t,e,r){"use strict";var i=r(8060),n=r(9087),o=r(4058),s=r(1662),l=r(2834);i({target:"Array",proto:!0},{at:function(t){var e=n(this),r=o(e),i=s(t),l=i>=0?i:r+i;return l<0||l>=r?void 0:e[l]}}),l("at")},2916:function(t,e,r){"use strict";var i=r(8060),n=r(9087),o=r(4058),s=r(1856),l=r(2399);i({target:"Array",proto:!0,arity:1,forced:r(8742)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=n(this),r=o(e),i=arguments.length;l(r+i);for(var a=0;a<i;a++)e[r]=arguments[a],r++;return s(e,r),r}})},921:function(t,e,r){"use strict";r(2834)("flat")},4247:function(t,e,r){"use strict";var i=r(8060),n=r(9087),o=r(4058),s=r(1856),l=r(7551),a=r(2399);i({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=n(this),r=o(e),i=arguments.length;if(i){a(r+i);for(var u=r;u--;){var h=u+i;u in e?e[h]=e[u]:l(e,h)}for(var c=0;c<i;c++)e[c]=arguments[c]}return s(e,r+i)}})},2954:function(t,e,r){"use strict";var i=r(8060),n=r(9532),o=r(4311),s=r(3328),l="WebAssembly",WebAssembly=n[l],a=7!==Error("e",{cause:7}).cause,u=function(t,e){var r={};r[t]=s(t,e,a),i({global:!0,constructor:!0,arity:1,forced:a},r)},h=function(t,e){if(WebAssembly&&WebAssembly[t]){var r={};r[t]=s(l+"."+t,e,a),i({target:l,stat:!0,constructor:!0,arity:1,forced:a},r)}};u("Error",function(t){return function(e){return o(t,this,arguments)}}),u("EvalError",function(t){return function(e){return o(t,this,arguments)}}),u("RangeError",function(t){return function(e){return o(t,this,arguments)}}),u("ReferenceError",function(t){return function(e){return o(t,this,arguments)}}),u("SyntaxError",function(t){return function(e){return o(t,this,arguments)}}),u("TypeError",function(t){return function(e){return o(t,this,arguments)}}),u("URIError",function(t){return function(e){return o(t,this,arguments)}}),h("CompileError",function(t){return function(e){return o(t,this,arguments)}}),h("LinkError",function(t){return function(e){return o(t,this,arguments)}}),h("RuntimeError",function(t){return function(e){return o(t,this,arguments)}})},7277:function(t,e,r){"use strict";var i=r(8060),n=r(2969),o=r(4311),s=r(173),l=r(1192),a=r(8742),u=r(9851),h=r(7701),c=r(151),d=r(3251),f=r(4726),g=String,p=n("JSON","stringify"),m=l(/./.exec),w=l("".charAt),y=l("".charCodeAt),b=l("".replace),C=l(1..toString),S=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,T=/^[\uDC00-\uDFFF]$/,R=!f||a(function(){var t=n("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))}),O=a(function(){return'"\udf06\ud834"'!==p("\uDF06\uD834")||'"\udead"'!==p("\uDEAD")}),M=function(t,e){var r=c(arguments),i=d(e);if(!(!u(i)&&(void 0===t||h(t))))return r[1]=function(t,e){if(u(i)&&(e=s(i,this,g(t),e)),!h(e))return e},o(p,null,r)},I=function(t,e,r){var i=w(r,e-1),n=w(r,e+1);return m(E,t)&&!m(T,n)||m(T,t)&&!m(E,i)?"\\u"+C(y(t,0),16):t};p&&i({target:"JSON",stat:!0,arity:3,forced:R||O},{stringify:function(t,e,r){var i=c(arguments),n=o(R?M:p,null,i);return O&&"string"==typeof n?b(n,S,I):n}})},3839:function(t,e,r){"use strict";var i=r(8060),n=r(9532),o=r(7815).clear;i({global:!0,bind:!0,enumerable:!0,forced:n.clearImmediate!==o},{clearImmediate:o})},9910:function(t,e,r){"use strict";r(3839),r(3562)},3562:function(t,e,r){"use strict";var i=r(8060),n=r(9532),o=r(7815).set,s=r(2178),l=n.setImmediate?s(o,!1):o;i({global:!0,bind:!0,enumerable:!0,forced:n.setImmediate!==l},{setImmediate:l})},292:function(t,e,r){"use strict";r.d(e,{P:function(){return l},Q:function(){return s}});let i=/^(\r\n|\n\r|\r|\n)/,n=/^[^\t\r\n]+/,o=/^\t/;function s(t){let e;let r=[[""]];if(0===t.length)return r;let s=0,l=0;for(;t.length>0&&e!==t.length;)if(e=t.length,t.match(o))t=t.replace(o,""),s+=1,r[l][s]="";else if(t.match(i))t=t.replace(i,""),s=0,r[l+=1]=[""];else{let e="";if(t.startsWith('"')){let r=0,i=!0;for(;i;){let n=t.slice(0,1);'"'===n&&(r+=1),e+=n,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&r%2==0)&&(i=!1)}e=e.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join(""))}else{let r=t.match(n);e=r?r[0]:"",t=t.slice(e.length)}r[l][s]=e}return r}function l(t){let e,r,i,n,o;let s="";for(e=0,r=t.length;e<r;e+=1){for(i=0,n=t[e].length;i<n;i+=1)i>0&&(s+="	"),"string"==typeof(o=t[e][i])?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:null==o?s+="":s+=o;e!==r-1&&(s+="\n")}return s}},746:function(t,e,r){"use strict";r.d(e,{Ii:function(){return i},vp:function(){return n}});let i=1,n=2},7431:function(t,e,r){"use strict";r.d(e,{E:function(){return a}}),r(2916),r(3893),r(2954);var i=r(746);function n(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=s(t,e,"get");return r.get?r.get.call(t):r.value}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{static get DEFAULT_WIDTH(){return 50}constructor(t){n(this,"count",0),n(this,"startColumn",null),n(this,"endColumn",null),n(this,"startPosition",null),n(this,"isVisibleInTrimmingContainer",!1),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:void 0}),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,s(this,l,"set"),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:r,scrollOffset:n,totalColumns:s,viewportWidth:a}=o(this,l),u=Math.max(o(this,l).scrollOffset,0),h=u>0?a+1:a,c=0,d=!0,f=[],g=0,p=0;for(let r=0;r<s;r++)if(t=this._getColumnWidth(r),c<=u&&e!==i.vp&&(this.startColumn=r,g=t),c>=u&&c+(e===i.vp?t:0)<=u+h&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=r,g=t),this.endColumn=r),f.push(c),c+=t,p=t,e!==i.vp&&(this.endColumn=r),c>=u+a){d=!1;break}let m=e===i.vp?0:p,w=e===i.vp?g:0;if(n+a-h<-1*o(this,l).inlineStartOffset||n>f.at(-1)+m||-1*o(this,l).scrollOffset-o(this,l).viewportWidth>-1*w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===s-1&&d)for(this.startColumn=this.endColumn;this.startColumn>0;){let r=f[this.endColumn]+t-f[this.startColumn-1];if((r<=a||e!==i.vp)&&(this.startColumn-=1),r>a)break}e===i.Ii&&null!==this.startColumn&&r&&r(this),this.startPosition=f[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=o(this,l).columnWidthFn(t);return isNaN(e)&&(e=a.DEFAULT_WIDTH),e}}},3391:function(t,e,r){"use strict";r.d(e,{U:function(){return a}}),r(2916),r(3893),r(2954);var i=r(746);function n(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=s(t,e,"get");return r.get?r.get.call(t):r.value}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{static get DEFAULT_HEIGHT(){return 23}constructor(t){n(this,"count",0),n(this,"startRow",null),n(this,"endRow",null),n(this,"startPosition",null),n(this,"isVisibleInTrimmingContainer",!1),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:void 0}),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,s(this,l,"set"),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:r,rowHeightFn:n,scrollOffset:s,totalRows:u,viewportHeight:h}=o(this,l),c=Math.max(o(this,l).scrollOffset,0),d=o(this,l).horizontalScrollbarHeight||0,f=0,g=!0,p=[],m=0,w=0;for(let r=0;r<u;r++)if(isNaN(t=n(r))&&(t=a.DEFAULT_HEIGHT),f<=c&&e!==i.vp&&(this.startRow=r,m=t),f>=c&&f+(e===i.vp?t:0)<=c+h-d&&(null===this.startRow&&(this.startRow=r,m=t),this.endRow=r),p.push(f),f+=t,w=t,e!==i.vp&&(this.endRow=r),f>=c+h-d){g=!1;break}let y=e===i.vp?m:0,b=e===i.vp?0:w;if(s+h-d<y||s>p.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===u-1&&g)for(this.startRow=this.endRow;this.startRow>0;){let r=p[this.endRow]+t-p[this.startRow-1];if((r<=h-d||e!==i.vp)&&(this.startRow-=1),r>=h-d)break}e===i.Ii&&null!==this.startRow&&r&&r(this),this.startPosition=p[this.startRow],void 0===this.startPosition&&(this.startPosition=null),u<this.endRow&&(this.endRow=u-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}},1070:function(t,e,r){"use strict";function i(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){var r=s(t,e,"get");return r.get?r.get.call(t):r.value}function o(t,e,r){var i=s(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}r(2954);var l=new WeakMap;class a{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i(this,"row",null),i(this,"col",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),o(this,l,r),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){let{countRows:e,countCols:r,countRowHeaders:i,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-n)&&!(this.col<-i)&&!(this.row>=e)&&!(this.col>=r)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return n(this,l)}isSouthEastOf(t){return this.row>=t.row&&(n(this,l)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(n(this,l)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(n(this,l)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(n(this,l)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof a&&o(this,l,t.isRtl()),this}clone(){return new a(this.row,this.col,n(this,l))}toObject(){return{row:this.row,col:this.col}}}e.Z=a},1648:function(t,e,r){"use strict";r(2916),r(2954);var i=r(1070);function n(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=s(t,e,"get");return r.get?r.get.call(t):r.value}function s(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n(this,"highlight",null),n(this,"from",null),n(this,"to",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=r.clone(),function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,s(this,l,"set"),i)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){let{row:e,col:r}=t,i=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return i.row<=e&&n.row>=e&&i.col<=r&&n.col>=r}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){let e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>r.row||t.col>r.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(r.row,t.row),Math.max(r.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;let e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),n=t.getOuterTopStartCorner(),o=t.getOuterBottomEndCorner(),s=Math.min(e.row,n.row),l=Math.min(e.col,n.col),a=Math.max(r.row,o.row),u=Math.max(r.col,o.col),h=this._createCellCoords(s,l),c=this._createCellCoords(a,u);return this.from=h,this.to=c,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){let t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){let t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return o(this,l)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return o(this,l)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return o(this,l)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return o(this,l)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return o(this,l)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return o(this,l)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return o(this,l)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return o(this,l)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof i.Z&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];let e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},i=[];return e.top===r.top&&i.push("top"),e.right===r.right&&i.push(o(this,l)?"left":"right"),e.bottom===r.bottom&&i.push("bottom"),e.left===r.left&&i.push(o(this,l)?"right":"left"),i}getInner(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),r=[];for(let i=t.row;i<=e.row;i++)for(let n=t.col;n<=e.col;n++)this.from.row===i&&this.from.col===n||this.to.row===i&&this.to.col===n||r.push(this._createCellCoords(i,n));return r}getAll(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),r=[];for(let i=t.row;i<=e.row;i++)for(let n=t.col;n<=e.col;n++)t.row===i&&t.col===n?r.push(t):e.row===i&&e.col===n?r.push(e):r.push(this._createCellCoords(i,n));return r}forAll(t){let e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=e.row;i<=r.row;i++)for(let n=e.col;n<=r.col;n++){let e=t(i,n);if(!1===e)return}}clone(){return new a(this.highlight,this.from,this.to,o(this,l))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new i.Z(t,e,o(this,l))}}e.Z=a},6352:function(t,e,r){"use strict";r.d(e,{Z:function(){return ea}}),r(2916),r(2954);var i=r(5878),n=r(8179),o=r(973),s=r(2228),l=r(2518);function a(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function u(t,e){var r=c(t,e,"get");return r.get?r.get.call(t):r.value}function h(t,e,r){var i=c(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function c(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var d=new WeakMap,f=new WeakMap,g=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,C=new WeakMap,S=new WeakMap;class Event{constructor(t,e,r,i,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;a(this,d,{writable:!0,value:void 0}),a(this,f,{writable:!0,value:void 0}),a(this,g,{writable:!0,value:void 0}),a(this,p,{writable:!0,value:void 0}),a(this,m,{writable:!0,value:void 0}),a(this,w,{writable:!0,value:void 0}),a(this,y,{writable:!0,value:void 0}),a(this,b,{writable:!0,value:void 0}),a(this,C,{writable:!0,value:[null,null]}),a(this,S,{writable:!0,value:[null,null]}),h(this,d,r),h(this,f,e),h(this,g,n),h(this,p,o),h(this,m,s),h(this,w,i),h(this,y,t),this.registerEvents()}registerEvents(){u(this,w).addEventListener(u(this,g).holder,"contextmenu",t=>this.onContextMenu(t)),u(this,w).addEventListener(u(this,g).TABLE,"mouseover",t=>this.onMouseOver(t)),u(this,w).addEventListener(u(this,g).TABLE,"mouseout",t=>this.onMouseOut(t));let t=()=>{u(this,w).addEventListener(u(this,g).holder,"touchstart",t=>this.onTouchStart(t)),u(this,w).addEventListener(u(this,g).holder,"touchend",t=>this.onTouchEnd(t)),this.momentumScrolling||(this.momentumScrolling={}),u(this,w).addEventListener(u(this,g).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||u(this,d).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,u(this,d).getSetting("onAfterMomentumScroll"))},200)})};(0,s.K1)()?t():((0,o.JS)()&&t(),(()=>{u(this,w).addEventListener(u(this,g).holder,"mouseup",t=>this.onMouseUp(t)),u(this,w).addEventListener(u(this,g).holder,"mousedown",t=>this.onMouseDown(t))})())}selectedCellWasTouched(t){let e=this.parentCell(t),r=e.coords;if(u(this,b)&&r){let[t,e]=[r.row,u(this,b).from.row],[i,n]=[r.col,u(this,b).from.col];return t===e&&i===n}return!1}parentCell(t){let e={},r=u(this,g).TABLE,n=(0,i.W6)(t,["TD","TH"],r);return n?(e.coords=u(this,g).getCoords(n),e.TD=n):(0,i.pv)(t,"wtBorder")&&(0,i.pv)(t,"current")?(e.coords=u(this,p).getFocusSelection().cellRange.highlight,e.TD=u(this,g).getCell(e.coords)):(0,i.pv)(t,"wtBorder")&&(0,i.pv)(t,"area")&&u(this,p).getAreaSelection().cellRange&&(e.coords=u(this,p).getAreaSelection().cellRange.to,e.TD=u(this,g).getCell(e.coords)),e}onMouseDown(t){let e=u(this,f).rootDocument.activeElement,r=(0,n.r$)(i.G_,t.target),o=t.target;if(!["TD","TH"].includes(e.nodeName)&&(o===e||r(0)===e||r(1)===e))return;let s=this.parentCell(o);(0,i.pv)(o,"corner")?u(this,d).getSetting("onCellCornerMouseDown",t,o):s.TD&&u(this,d).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,s.coords,s.TD),(0===t.button||this.touchApplied)&&s.TD&&(u(this,S)[0]=s.TD,clearTimeout(u(this,C)[0]),u(this,C)[0]=setTimeout(()=>{u(this,S)[0]=null},1e3))}onContextMenu(t){if(u(this,d).has("onCellContextMenu")){let e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!u(this,d).has("onCellMouseOver"))return;let e=u(this,g).TABLE,r=(0,i.W6)(t.target,["TD","TH"],e),n=u(this,m)||this;r&&r!==n.lastMouseOver&&(0,i.MO)(r,e)&&(n.lastMouseOver=r,this.callListener("onCellMouseOver",t,u(this,g).getCoords(r),r))}onMouseOut(t){if(!u(this,d).has("onCellMouseOut"))return;let e=u(this,g).TABLE,r=(0,i.W6)(t.target,["TD","TH"],e),n=(0,i.W6)(t.relatedTarget,["TD","TH"],e),o=u(this,m)||this;r&&r!==n&&(0,i.MO)(r,e)&&(this.callListener("onCellMouseOut",t,u(this,g).getCoords(r),r),null===n&&(o.lastMouseOver=null))}onMouseUp(t){let e=this.parentCell(t.target);e.TD&&u(this,d).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===u(this,S)[0]&&e.TD===u(this,S)[1]?((0,i.pv)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),u(this,S)[0]=null,u(this,S)[1]=null):e.TD===u(this,S)[0]&&(u(this,S)[1]=e.TD,clearTimeout(u(this,C)[1]),u(this,C)[1]=setTimeout(()=>{u(this,S)[1]=null},500)))}onTouchStart(t){h(this,b,u(this,p).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;let r=t.target,i=null===(e=this.parentCell(r))||void 0===e?void 0:e.coords,n=(0,l.$K)(i)&&i.row>=0&&i.col>=0,o=t.cancelable&&n&&u(this,d).getSetting("isDataViewInstance");o&&((0,s.gn)()&&((0,s.E6)()||(0,s.iF)())&&this.selectedCellWasTouched(r)&&!["A","BUTTON","INPUT"].includes(r.tagName)?t.preventDefault():this.selectedCellWasTouched(r)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,r,i){let n=u(this,d).getSettingPure(t);n&&n(e,r,i,u(this,y).call(this))}destroy(){clearTimeout(u(this,C)[0]),clearTimeout(u(this,C)[1]),u(this,w).destroy()}}var E=r(9440),T=r(6678);function R(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class O{constructor(t,e,r){R(this,"offset",void 0),R(this,"total",void 0),R(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=r}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}function M(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class I{constructor(t,e,r){M(this,"offset",void 0),M(this,"total",void 0),M(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=r}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var N=r(8489);function x(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function k(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H(t,e){var r=A(t,e,"get");return r.get?r.get.call(t):r.value}function _(t,e,r){var i=A(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function A(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var L=new WeakMap,P=new WeakMap,D=new WeakMap,B=new WeakMap,F=new WeakMap;class W{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:n}=t;k(this,"stretchAllRatio",0),k(this,"stretchLastWidth",0),k(this,"stretchAllColumnsWidth",[]),x(this,L,{writable:!0,value:0}),k(this,"needVerifyLastColumnWidth",!0),x(this,P,{writable:!0,value:()=>0}),x(this,D,{writable:!0,value:t=>t}),x(this,B,{writable:!0,value:t=>t}),x(this,F,{writable:!0,value:()=>"none"}),_(this,P,e),_(this,F,r),_(this,D,null!=i?i:H(this,D)),_(this,B,null!=n?n:H(this,B))}refreshStretching(t){if("none"===H(this,F).call(this))return;_(this,L,t);let e=0;for(let r=0;r<H(this,P).call(this);r++){let i=this._getColumnWidth(r),n=H(this,D).call(this,void 0,r);"number"==typeof n?t-=n:e+=i}let r=t-e;if("all"===H(this,F).call(this)&&r>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===H(this,F).call(this)&&t!==1/0){let t=this._getColumnWidth(H(this,P).call(this)-1),e=r+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let r=null;return"all"===H(this,F).call(this)&&0!==this.stretchAllRatio?r=this._getStretchedAllColumnWidth(t,e):"last"===H(this,F).call(this)&&0!==this.stretchLastWidth&&(r=this._getStretchedLastColumnWidth(t)),r}_getStretchedAllColumnWidth(t,e){let r=0;if(!this.stretchAllColumnsWidth[t]){let r=Math.round(e*this.stretchAllRatio),i=H(this,D).call(this,r,t);void 0===i?this.stretchAllColumnsWidth[t]=r:this.stretchAllColumnsWidth[t]=isNaN(i)?this._getColumnWidth(t):i}if(this.stretchAllColumnsWidth.length===H(this,P).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)r+=this.stretchAllColumnsWidth[t];r!==H(this,L)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=H(this,L)-r)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===H(this,P).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=H(this,B).call(this,t);return isNaN(e)&&(e=W.DEFAULT_WIDTH),e}}function V(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class j{constructor(t,e){V(this,"dataAccessObject",void 0),V(this,"wtSettings",void 0),V(this,"headerWidths",new Map),V(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new W({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t),r=this.stretching.getStretchedColumnWidth(t,e);return r&&(e=r),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight"),r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==r&&(e=e?Math.max(e,r):r),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){let{wtTable:t,wtViewport:e,cloneSource:r}=this.dataAccessObject,n=r?r.wtTable.holder:t.holder,o=n.offsetHeight<n.scrollHeight?(0,i.np)():0;this.stretching.refreshStretching(e.getViewportWidth()-o)}calculateWidths(){let{wtSettings:t}=this,e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),null!=(e=t.getSetting("onModifyRowHeaderWidth",e))){let r=t.getSetting("rowHeaders").length,i=t.getSetting("defaultColumnWidth");for(let t=0;t<r;t++){let r=Array.isArray(e)?e[t]:e;r=null==r?i:r,this.headerWidths.set(t,r)}}}}function U(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class ${constructor(t,e){U(this,"dataAccessObject",void 0),U(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t),r=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==r&&(e=void 0===e?r:Math.max(e,r)),e}}let z="bottom",G="inline_start",K="top_inline_start_corner",X="bottom_inline_start_corner",Y=["top",z,G,K,X],q=new Map([["top","ht_clone_top"],[z,`ht_clone_${z}`],[G,`ht_clone_${G} ht_clone_left`],[K,`ht_clone_${K} ht_clone_top_left_corner`],[X,`ht_clone_${X} ht_clone_bottom_left_corner`]]);var Z=r(8200);function Q(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class J{constructor(t,e,r,n,o){Q(this,"wtSettings",null),Q(this,"domBindings",void 0),Q(this,"TBODY",null),Q(this,"THEAD",null),Q(this,"COLGROUP",null),Q(this,"hasTableHeight",!0),Q(this,"hasTableWidth",!0),Q(this,"isTableVisible",!1),Q(this,"tableOffset",0),Q(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,(0,i.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new $(this.dataAccessObject,this.wtSettings),this.columnUtils=new j(this.dataAccessObject,this.wtSettings),this.tableRenderer=new N.Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){let t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){let e;let r=t.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&(0,i.pv)(r,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",r&&r.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,i.P$)(e,[(0,Z.Rn)()]),e}createHider(t){let e;let r=t.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&(0,i.pv)(r,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",r&&r.insertBefore(e,t),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,i.P$)(e,[(0,Z.Rn)()]),e}createHolder(t){let e;let r=t.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&(0,i.pv)(r,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",r&&r.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,i.P$)(e.parentNode,[(0,Z.Rn)()])),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,i.P$)(e,[(0,Z.Rn)()]),e}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this,{wtOverlays:r,wtViewport:n}=this.dataAccessObject,o=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),l=e.getSetting("rowHeaders"),a=l.length,u=e.getSetting("columnHeaders"),h=u.length,c=!1,d=t;if(this.isMaster&&(this.holderOffset=(0,i.cv)(this.holder),d=n.createRenderCalculators(d),a&&!e.getSetting("fixedColumnsStart"))){let t=r.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(c=r.updateStateOfRendering()),d)this.isMaster&&n.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=(0,i.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let t=o>0?this.getFirstRenderedRow():0,e=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new I(t,o,h),this.columnFilter=new O(e,s,a);let r=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let t={};this.wtSettings.getSetting("beforeDraw",!0,t),r=!0!==t.skipRender}if(r){let t;if(this.tableRenderer.setHeaderContentRenderers(l,u),(this.is(z)||this.is(X))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(z))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();let e=(0,i.iO)(this.hider),r=(0,i.iO)(this.TABLE);0!==e&&r!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(z)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(f=r.bottomOverlay.resetFixedPosition()||f),f=r.inlineStartOverlay.resetFixedPosition()||f,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),c&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){let e,r,n;let o=this.columnFilter.renderedToSource(t),s=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,e=this.getColumnHeaderHeight(s),(r=this.getColumnHeader(o,s))&&(n=(0,i.WS)(r),(!e&&l<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=n),Array.isArray(a)?null!==a[s]&&void 0!==a[s]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(a[s]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]||a))}adjustColumnHeaderHeights(){let{wtSettings:t}=this,e=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=t.getSetting("columnHeaders");for(let t=0,n=i.length;t<n;t++)if(r[t]){if(!e[t]||0===e[t].childNodes.length)return;e[t].childNodes[0].style.height=`${r[t]}px`}}resetOversizedRows(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(z))&&!t.getSetting("externalRowCalculator")){let t=this.getRenderedRowsCount();for(let r=0;r<t;r++){let t=this.rowFilter.renderedToSource(r);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,r=t.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",e,r);if(i&&Array.isArray(i)&&([e,r]=i),this.isRowBeforeRenderedRows(e))return -1;if(this.isRowAfterRenderedRows(e))return -2;if(this.isColumnBeforeRenderedColumns(r))return -3;if(this.isColumnAfterRenderedColumns(r))return -4;let n=this.getRow(e);if(!n&&e>=0)throw Error("TR was expected to be rendered but is not");let o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw Error("TD or TH was expected to be rendered but is not");return o}getRow(t){var e,r;let i=null,n=null;return t<0?(i=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(i=null===(r=this.rowFilter)||void 0===r?void 0:r.sourceToRendered(t),n=this.TBODY),void 0!==i&&void 0!==n&&!(n.childNodes.length<i+1)&&n.childNodes[i]}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.THEAD.childNodes[e];return null==r?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){let e=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(t=>{let i=t.childNodes[r];i&&e.push(i)}),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.wtSettings.getSetting("rowHeaders").length;if(e>=r)return;let i=this.rowFilter.sourceToRendered(t),n=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):i,o=i<0?this.THEAD:this.TBODY,s=o.childNodes[n];return null==s?void 0:s.childNodes[e]}getRowHeaders(t){let e=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){let r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],n=null==r?void 0:r.childNodes[i];n&&e.push(n)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,i.oq)(e,["TD","TH"])),null===e)return null;let r=e.parentNode,n=r.parentNode,o=(0,i.Kz)(r),s=e.cellIndex;if((0,i.mK)(K,e,this.wtRootElement)||(0,i.mK)("top",e,this.wtRootElement))"THEAD"===n.nodeName&&(o-=n.childNodes.length);else if((0,i.mK)(X,e,this.wtRootElement)||(0,i.mK)(z,e,this.wtRootElement)){let t=this.wtSettings.getSetting("totalRows");o=t-n.childNodes.length+o}else o=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return s=(0,i.mK)(K,e,this.wtRootElement)||(0,i.mK)(G,e,this.wtRootElement)||(0,i.mK)(X,e,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){let t,e,r,n,o;if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length,l=s*this.wtSettings.getSetting("defaultRowHeight"),a=(0,i.WS)(this.TBODY)-1;if(l!==a||this.wtSettings.getSetting("fixedRowsBottom"))for(;s;)s-=1,r=this.rowFilter.renderedToSource(s),t=this.getRowHeight(r),e=(o=(n=this.getTrForRow(r)).querySelector("th"))?(0,i.WS)(o):(0,i.WS)(n)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=e)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;let e=this.wtSettings.getSetting("rowHeaders"),r=e.length;return Math.abs(t)<=r}isRowHeaderRendered(t){if(t>=0)return!1;let e=this.wtSettings.getSetting("columnHeaders"),r=e.length;return Math.abs(t)<=r}isRowBeforeRenderedRows(t){let e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){let e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,i.iO)(this.TABLE)}getHeight(){return(0,i.Pb)(this.TABLE)}getTotalWidth(){let t=(0,i.iO)(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){let t=(0,i.Pb)(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return(0,i.pn)(this.TABLE)}_modifyRowHeaderWidth(t){let e=(0,n.mf)(t)?t():null;return Array.isArray(e)?(e=[...e])[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var tt=J,te=r(9488);let tr={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,te.jW)(tr,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});let ti={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,te.jW)(ti,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});class tn extends tt{constructor(t,e,r,i){super(t,e,r,i,"top")}}(0,te.jB)(tn,tr),(0,te.jB)(tn,ti);var to=r(4748),ts=r(6411),tl=r(9773);function ta(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tu{constructor(t){ta(this,"dataAccessObject",void 0),ta(this,"lastScrolledColumnPos",-1),ta(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,r,i,n){let o=this.scrollViewportHorizontally(t.col,r,n),s=this.scrollViewportVertically(t.row,e,i);return o||s}scrollViewportHorizontally(t,e,r){let{drawn:i,totalColumns:n}=this.dataAccessObject;if(!i||!Number.isInteger(t)||t<0||t>n)return!1;let o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn(),l=void 0===e&&void 0===r,{fixedColumnsStart:a,inlineStartOverlay:u}=this.dataAccessObject;if(l&&t<a)return!1;let h=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===o?h=u.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<o||t>s)||!l)&&(h=u.scrollTo(t,l?t>s:e)),h&&(this.lastScrolledColumnPos=t),h}scrollViewportVertically(t,e,r){let{drawn:i,totalRows:n}=this.dataAccessObject;if(!i||!Number.isInteger(t)||t<0||t>n)return!1;let o=this.getFirstVisibleRow(),s=this.getLastVisibleRow(),l=void 0===e&&void 0===r,{fixedRowsBottom:a,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject;if(l&&(t<u||t>n-a-1))return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===o?c=h.scrollTo(t,l?t>this.lastScrolledRowPos:r):(l&&(t<o||t>s)||!l)&&(c=h.scrollTo(t,l?t>s:r)),c&&(this.lastScrolledRowPos=t),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){let{topOverlay:t,wtTable:e,wtViewport:r,totalRows:n,rootWindow:o}=this.dataAccessObject,s=e.getLastVisibleRow();if(t.mainTableScrollableElement===o){let l=(0,i.cv)(e.wtRootElement),a=(0,i.cx)(o,o);if(l.top>a){let e=(0,i.WS)(o),u=r.getColumnHeaderHeight();for(let r=1;r<=n;r++)if(u+=t.sumCellSizes(r-1,r),l.top+u-a>=e){s=r-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){let{wtSettings:t,inlineStartOverlay:e,wtTable:r,wtViewport:n,totalColumns:o,rootWindow:s}=this.dataAccessObject,l=r.getLastVisibleColumn();if(e.mainTableScrollableElement===s){let a=t.getSetting("rtlMode"),u=null;if(a){let t=r.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,i=e.documentElement.offsetWidth;u=Math.abs(t.right-i)}else{let t=(0,i.cv)(r.wtRootElement);u=t.left}let h=Math.abs((0,i.vj)(s,s));if(u>h){let t=(0,i.x9)(s),r=n.getRowHeaderWidth();for(let i=1;i<=o;i++)if(u+(r+=e.sumCellSizes(i-1,i))-h>=t){l=i-2;break}}}return l}}var th=r(1070),tc=r(1648);function td(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tf{get eventManager(){return new tl.Z(this)}constructor(t,e){td(this,"wtTable",void 0),td(this,"wtScroll",void 0),td(this,"wtViewport",void 0),td(this,"wtOverlays",void 0),td(this,"selectionManager",void 0),td(this,"wtEvent",void 0),td(this,"guid",`wt_${(0,ts.O1)()}`),td(this,"drawInterrupted",!1),td(this,"drawn",!1),td(this,"domBindings",void 0),td(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new tu(this.createScrollDao())}findOriginalHeaders(){let t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;e<r;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,r){(0,i.tT)(r,t[e])}])}}createCellCoords(t,e){return new th.Z(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,r){return new tc.Z(t,e,r,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);let r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<i&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=r-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);else if(t.row<r&&t.row>=r-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t);return this.wtTable.getCell(t)}scrollViewport(t,e,r,i,n){return!(t.col<0)&&!(t.row<0)&&this.wtScroll.scrollViewport(t,e,r,i,n)}scrollViewportHorizontally(t,e,r){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,r)}scrollViewportVertically(t,e,r){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(v){t.drawn=v},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function tg(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tp extends tf{constructor(t,e,r){super(t,e),tg(this,"cloneSource",void 0),tg(this,"cloneOverlay",void 0);let i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new Event(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}class tm{constructor(t,e,r,n,o){var s,l;(s="symbol"==typeof(l=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s="wtSettings","string"))?l:String(l))in this?Object.defineProperty(this,s,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[s]=null,(0,te.jW)(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=e,this.wtSettings=n;let{TABLE:a,hider:u,spreader:h,holder:c,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=u,this.spreader=h,this.holder=c,this.wtRootElement=d,this.trimmingContainer=(0,i.$g)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){let t=this.needFullRender;this.needFullRender=this.shouldBeRendered();let e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,i.$g)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,i.dD)(t.TABLE)}getRelativeCellPosition(t,e,r){if(!1===this.clone.wtTable.holder.contains(t)){(0,to.ZK)(`The provided element is not a child of the ${this.type} overlay`);return}let i=this.mainTableScrollableElement===this.domBindings.rootWindow,n=r<this.wtSettings.getSetting("fixedColumnsStart"),o=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(t),top:t.offsetTop};return i?this.getRelativeCellPositionWithinWindow(o,n,u,a):this.getRelativeCellPositionWithinHolder(o,s,n,u,a)}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,r,n){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(e){let t=o.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(o.left+o.width+(0,i.np)())),s=t<=0?-1*t:0}else s=n.start;if(t){let t=this.clone.wtTable.TABLE.getBoundingClientRect();l=t.top-o.top}else l=n.top;return{start:r.start+s,top:r.top+l}}getRelativeCellPositionWithinHolder(t,e,r,i,n){let o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(r||(s=o.horizontal-n.start),e){let t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=o.vertical-n.top);return{start:i.start-s,top:i.top-l}}makeClone(){if(-1===Y.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:t,wtSettings:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),l=t.wtRootElement.parentNode;o.className=`${q.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,e.getSetting("ariaTags")&&(0,i.P$)(o,[(0,Z.Rn)()]),s.className=t.TABLE.className;let a=t.TABLE.getAttribute("role");a&&s.setAttribute("role",t.TABLE.getAttribute("role")),o.appendChild(s),l.appendChild(o);let u=this.wtSettings.getSetting("preventOverflow");return!0===u||"horizontal"===u&&"top"===this.type||"vertical"===u&&this.type===G?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=(0,i.dD)(t.TABLE),new tp(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;let t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,r=t.style,i=e.style,n=t.parentNode.style;(0,E.Bk)([r,i,n],t=>{t.width="",t.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}let tv=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});class tw extends tm{constructor(t,e,r,i){var n,o;super(t,e,"top",r,i),(n="symbol"==typeof(o=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n="cachedFixedRowsTop","string"))?o:String(o))in this?Object.defineProperty(this,n,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[n]=-1,this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return new tn(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer!==e||r&&"vertical"===r)n=this.getScrollPosition(),(0,i.WH)(t);else{let{wtTable:e}=this.wot,r=e.hider.getBoundingClientRect(),s=Math.ceil(r.bottom),l=t.offsetHeight;o=s===l,n=this.getOverlayOffset(),(0,i.I2)(t,"0px",`${n}px`)}let s=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),s}setScrollPosition(t){let e=this.domBindings.rootWindow,r=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo((0,i.DZ)(e),t),r=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let r=this.wtSettings.getSetting("defaultRowHeight"),i=t,n=0;for(;i<e;){let t=this.wot.wtTable.getRowHeight(i);n+=void 0===t?r:t,i+=1}return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:r}=this.domBindings,n=(0,i.np)(e),o=this.clone.wtTable.holder.parentNode,s=o.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===l){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),s.width=`${e}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=(0,i.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(tv.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let{wot:r,wtSettings:n}=this,o=r.cloneSource?r.cloneSource:r,s=o.wtTable.holder,l=this.getTableParentOffset(),a=0;if(e){let r=this.wot.wtTable.getRowHeight(t),i=this.wot.wtViewport.getViewportHeight();r>i&&(e=!1)}if(e&&s.offsetHeight!==s.clientHeight&&(a=(0,i.np)(this.domBindings.rootDocument)),e){let e=n.getSetting("fixedRowsBottom"),i=n.getSetting("totalRows");l+=this.sumCellSizes(0,t+1),l-=r.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),l+=1}else l+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return l+=a,this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,i.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight();(r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>t-e&&(r=0)}return r}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?(0,i.IV)(r,"emptyColumns"):(0,i.cn)(r,"emptyColumns");let o=!1;if(!e){let e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,s=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&s.length>0){let e=(0,i.pv)(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?((0,i.cn)(r,"innerBorderTop"),o=!e):((0,i.IV)(r,"innerBorderTop"),o=e)}}return o}}let ty={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return 0===t||0===e?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,te.jW)(ty,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});class tb extends tt{constructor(t,e,r,i){super(t,e,r,i,z)}}(0,te.jB)(tb,ty),(0,te.jB)(tb,ti);class tC extends tm{constructor(t,e,r,i){var n,o;super(t,e,z,r,i),(n="symbol"==typeof(o=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n="cachedFixedRowsBottom","string"))?o:String(o))in this?Object.defineProperty(this,n,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[n]=-1,this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return new tb(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let r=0,i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||i&&"vertical"===i?(r=this.getScrollPosition(),this.repositionOverlay()):(r=this.getOverlayOffset(),e.style.bottom=`${r}px`);let n=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),n}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,i.np)(r)),n.style.bottom=`${o}px`}setScrollPosition(t){let{rootWindow:e}=this.domBindings,r=!1;return this.mainTableScrollableElement===e?(e.scrollTo((0,i.DZ)(e),t),r=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let{wtTable:r,wtSettings:i}=this.wot,n=i.getSetting("defaultRowHeight"),o=t,s=0;for(;o<e;){let t=r.getRowHeight(o);s+=void 0===t?n:t,o+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,o=(0,i.np)(r),s=this.clone.wtTable.holder.parentNode,l=s.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){let r=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(r-=o),r=Math.min(r,t.wtRootElement.scrollWidth),l.width=`${r}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let u=(0,i.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),l.height=`${u}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let r=this.getTableParentOffset(),n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,s=0;e&&o.offsetHeight!==o.clientHeight&&(s=(0,i.np)(this.domBindings.rootDocument)),e?(r+=this.sumCellSizes(0,t+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,i.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),i=this.domBindings.rootDocument.documentElement.clientHeight;(r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0))>t-e&&(r=0)}return r}adjustHeaderBordersPosition(t){let e=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders"),o=!1;if((r||0===e)&&n.length>0){let e=this.wot.wtTable.holder.parentNode,r=(0,i.pv)(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?((0,i.cn)(e,"innerBorderBottom"),o=!r):((0,i.IV)(e,"innerBorderBottom"),o=r)}return o}}let tS={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,te.jW)(tS,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});let tE={getFirstRenderedColumn(){let t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,te.jW)(tE,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});class tT extends tt{constructor(t,e,r,i){super(t,e,r,i,G)}}(0,te.jB)(tT,tS),(0,te.jB)(tT,tE);class tR extends tm{constructor(t,e,r,i){super(t,e,G,r,i)}createTable(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return new tT(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||n&&"horizontal"===n?(o=this.getScrollPosition(),(0,i.WH)(r)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,i.I2)(r,`${o}px`,"0px"));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(t){let{rootWindow:e}=this.domBindings,r=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,(0,i.AQ)(e)),r=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){let r=this.wtSettings.getSetting("defaultColumnWidth"),i=t,n=0;for(;i<e;)n+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:r}=this.domBindings,n=(0,i.np)(e),o=this.clone.wtTable.holder.parentNode,s=o.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===l){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),s.height=`${e}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;let a=(0,i.iO)(this.clone.wtTable.TABLE);s.width=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(tv.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style[e]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let r=this.getTableParentOffset(),n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,s=0;if(e){let r=this.wot.wtTable.getColumnWidth(t),i=this.wot.wtViewport.getViewportWidth();r>i&&(e=!1)}return e&&o.offsetWidth!==o.clientWidth&&(s=(0,i.np)(this.domBindings.rootDocument)),e?(r+=this.sumCellSizes(0,t+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),r+=s,this.setScrollPosition(r)}getTableParentOffset(){let t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs((0,i.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){r=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth();r>t-e&&(r=0)}return r}adjustHeaderBordersPosition(t){let e=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),o=this.wtSettings.getSetting("totalRows");o?(0,i.IV)(e,"emptyRows"):(0,i.cn)(e,"emptyRows");let s=!1;if(n&&!r.length)(0,i.cn)(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&r.length){let r=(0,i.pv)(e,"innerBorderInlineStart");t?((0,i.cn)(e,"innerBorderLeft innerBorderInlineStart"),s=!r):((0,i.IV)(e,"innerBorderLeft innerBorderInlineStart"),s=r)}return s}}class tO extends tt{constructor(t,e,r,i){super(t,e,r,i,K)}}function tM(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}(0,te.jB)(tO,tr),(0,te.jB)(tO,tE);class tI extends tm{constructor(t,e,r,i,n,o){super(t,e,K,r,i),tM(this,"topOverlay",void 0),tM(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return new tO(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),r=this.topOverlay.getOverlayOffset();(0,i.I2)(t,`${e}px`,`${r}px`)}else(0,i.WH)(t);let e=(0,i.Pb)(this.clone.wtTable.TABLE),r=(0,i.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${r}px`,!1}}class tN extends tt{constructor(t,e,r,i){super(t,e,r,i,X)}}(0,te.jB)(tN,ty),(0,te.jB)(tN,tE);class tx extends tm{constructor(t,e,r,i,n,o){super(t,e,X,r,i),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return new tN(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let t=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${r}px`}else(0,i.WH)(e),this.repositionOverlay();let r=(0,i.Pb)(this.clone.wtTable.TABLE),n=(0,i.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,i.np)(r)),n.style.bottom=`${o}px`}}function tk(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tH{constructor(t,e,r,n,s,l){tk(this,"wot",null),tk(this,"topOverlay",null),tk(this,"bottomOverlay",null),tk(this,"inlineStartOverlay",null),tk(this,"topInlineStartCornerOverlay",null),tk(this,"bottomInlineStartCornerOverlay",null),tk(this,"browserLineHeight",void 0),tk(this,"wtSettings",null),tk(this,"resizeObserver",new ResizeObserver(t=>{(0,o.U7)(()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=n,this.domBindings=r,this.facadeGetter=e,this.wtTable=l;let{rootDocument:a,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=(0,i.np)(a);let h="hidden"===u.getComputedStyle(l.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=h?l.holder:(0,i.dD)(l.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){let{rootWindow:t,rootDocument:e}=this.domBindings,r=t.getComputedStyle(e.body),i=parseInt(r.lineHeight,10),n=1.2*parseInt(r.fontSize,10);this.browserLineHeight=i||n}initOverlays(){let t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new tw(...t),this.bottomOverlay=new tC(...t),this.inlineStartOverlay=new tR(...t),this.topInlineStartCornerOverlay=new tI(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new tx(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let t;let{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",t=>this.onKeyDown(t)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",t=>this.onTableScroll(t),{passive:!0}),i!==n&&this.eventManager.addEventListener(n,"scroll",t=>this.onTableScroll(t),{passive:!0});let o=r.devicePixelRatio&&r.devicePixelRatio>1,l=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),u={passive:l};(a||o||!(0,s.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",t=>this.onCloneWheel(t,a),u);let h=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];h.forEach(t=>{if(t&&t.needFullRender){let{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",t=>this.onCloneWheel(t,a),u)}}),this.eventManager.addEventListener(r,"resize",()=>{clearTimeout(t),t=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){let e=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,n=t.target;(!this.keyPressed||(i===e||n===e||t.target.contains(i))&&(r===e||n===e||t.target.contains(r)))&&this.syncScrollPositions(t)}onCloneWheel(t,e){let{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=t.target,s=n!==r&&o!==r&&!o.contains(n),l=i!==r&&o!==r&&!o.contains(i);if(this.keyPressed&&(s||l))return;let a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==r&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=(0,T.ot)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,r=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(r+=r*this.browserLineHeight,e+=e*this.browserLineHeight);let i=this.scrollVertically(e),n=this.scrollHorizontally(r);return i||n}scrollVertically(t){let e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){let e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==i||this.lastScrollX!==t.scrollX,this.verticalScrolling=r.scrollTop!==n||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=i;let t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){let t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:r}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=(0,i.dD)(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){let t=this.wtTable.spreader,e=t.clientWidth,r=t.clientHeight,i=e!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=r),i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtViewport:e}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),n=this.wtSettings.getSetting("totalRows"),o=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${o+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${s+this.topOverlay.sumCellSizes(0,n)+1}px`,this.scrollbarSize>0){let{scrollHeight:t,scrollWidth:e}=r.wtRootElement,{scrollHeight:i,scrollWidth:n}=r.holder;this.hasScrollbarRight=t<i,this.hasScrollbarBottom=e<n,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;let e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],r=null;return(0,E.Bk)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(r=e.clone)}),r}syncOverlayTableClassNames(){let t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,E.Bk)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}}function t_(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tA{constructor(t){t_(this,"settings",{}),t_(this,"defaults",Object.freeze(this.getDefaults())),(0,te._l)(this.defaults,(e,r)=>{if(void 0!==t[r])this.settings[r]=t[r];else if(void 0===e)throw Error(`A required setting "${r}" was not provided`);else this.settings[r]=e})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,r)=>{let n=this.getSetting("data",t,e);(0,i.tT)(r,null==n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?(0,te._l)(t,(t,e)=>{this.settings[e]=t}):this.settings[t]=e,this}getSetting(t,e,r,i,n){return"function"==typeof this.settings[t]?this.settings[t](e,r,i,n):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class tL extends tt{constructor(t,e,r,i){super(t,e,r,i,"master")}alignOverlaysWithTrimmingContainer(){let t=(0,i.$g)(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){let t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{let r=t.parentElement,n=(0,i.C2)(t,"height",e),o=(0,i.C2)(t,"overflow",e),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=t,u=t.offsetWidth,h=t.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){let n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?r.insertBefore(n,t.nextElementSibling):r.appendChild(n);let o=parseInt((0,i.Dx)(n,e).height,10);r.removeChild(n),0===o&&(h=0)}h=Math.min(h,a),s.height="auto"===n?"auto":`${h}px`,u=Math.min(u,l),s.width=`${u}px`,s.overflow="",this.hasTableHeight="auto"===s.height||h>0,this.hasTableWidth=u>0}this.isTableVisible=(0,i.pn)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,r="master",i=t.getSetting("columnHeaders"),n=i.length;if(n&&!e.hasOversizedColumnHeadersMarked[r]){let i=t.getSetting("rowHeaders"),o=i.length,s=this.getRenderedColumnsCount();for(let t=0;t<n;t++)for(let t=-1*o;t<s;t++)this.markIfOversizedColumnHeader(t);e.hasOversizedColumnHeadersMarked[r]=!0}}}(0,te.jB)(tL,tS),(0,te.jB)(tL,ti);var tP=r(746);function tD(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tB{constructor(t){tD(this,"count",0),tD(this,"startRow",0),tD(this,"endRow",0),tD(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}var tF=r(3391);function tW(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class tV{constructor(t){tW(this,"count",0),tW(this,"startColumn",0),tW(this,"endColumn",0),tW(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}var tj=r(7431);class tU{constructor(t,e,r,i,n){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=r,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer,r=0;if(e===this.domBindings.rootWindow)r=t.documentElement.clientHeight;else{let t=(0,i.Pb)(e);r=t>0&&e.clientHeight>0?e.clientHeight:1/0}return r}getWorkspaceWidth(){let t,e;let{wtSettings:r}=this,{rootDocument:n,rootWindow:o}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=n.documentElement.offsetWidth,a=r.getSetting("totalColumns"),u=r.getSetting("preventOverflow"),h=r.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),d=h?c.right-l:c.left,f=l-d;if(u)return(0,i.iO)(this.wtTable.wtRootElement);if(t=r.getSetting("freezeOverlays")?Math.min(f,l):Math.min(this.getContainerFillWidth(),f,l),s===o&&a>0&&this.sumColumnWidths(0,a-1)>t)return n.documentElement.clientWidth;if(s!==o&&("scroll"===(e=(0,i.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o))||"hidden"===e||"auto"===e))return Math.max(t,s.clientWidth);let g=r.getSetting("stretchH");return"none"!==g&&g?t:Math.max(t,(0,i.iO)(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let r=0,i=t;for(;i<e;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);let r=e.offsetWidth;return this.containerWidth=r,t.removeChild(e),r}getWorkspaceOffset(){return(0,i.cv)(this.wtTable.TABLE)}getColumnHeaderHeight(){let t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,i.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;let e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){let t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let r=0,i=e.length;r<i;r++)this.rowHeaderWidth+=t[r]||t}if(isNaN(this.rowHeaderWidth)){if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,n=e.length;r<n;r++)t?(this.rowHeaderWidth+=(0,i.iO)(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let t=this.getWorkspaceWidth();if(t===1/0)return t;let e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tP.Ii,{wtSettings:n,wtTable:o}=this;if(n.getSetting("renderAllRows")&&r===tP.Ii)return new tB({totalRows:n.getSetting("totalRows")});let s=this.getViewportHeight();this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,a=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),h=n.getSetting("totalRows");return a&&l>=0&&(l+=e=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s-=e),u&&this.dataAccessObject.bottomOverlay.clone&&(s-=e=this.dataAccessObject.bottomOverlay.sumCellSizes(h-u,h)),t=o.holder.clientHeight===o.holder.offsetHeight?0:(0,i.np)(this.domBindings.rootDocument),new tF.U({viewportHeight:s,scrollOffset:l,totalRows:n.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,horizontalScrollbarHeight:t})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tP.Ii,{wtSettings:e,wtTable:r}=this;if(e.getSetting("renderAllColumns")&&t===tP.Ii)return new tV({totalColumns:e.getSetting("totalColumns")});let n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=e.getSetting("fixedColumnsStart");if(s&&o>=0){let t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=t,n-=t}return r.holder.clientWidth!==r.holder.offsetWidth&&(n-=(0,i.np)(this.domBindings.rootDocument)),new tj.E({viewportWidth:n,scrollOffset:o,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>r.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){let e=this.createRowsCalculator(tP.vp);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){let e=this.createColumnsCalculator(tP.vp);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(tP.Ii),this.columnsRenderCalculator=this.createColumnsCalculator(tP.Ii)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(tP.vp),this.columnsVisibleCalculator=this.createColumnsCalculator(tP.vp)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:r,isVisibleInTrimmingContainer:i}=t;if(null===e&&null===r)return!i;let{startRow:n,endRow:o}=this.rowsRenderCalculator;return!(e<n)&&(e!==n||!(e>0))&&!(r>o||r===o&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:r,isVisibleInTrimmingContainer:i}=t;if(null===e&&null===r)return!i;let{startColumn:n,endColumn:o}=this.columnsRenderCalculator;return!(e<n)&&(e!==n||!(e>0))&&!(r>o||r===o&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){(0,te._l)(this.hasOversizedColumnHeadersMarked,(t,e,r)=>{r[e]=void 0})}}function t$(t,e,r){tz(t,e),e.set(t,r)}function tz(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function tG(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function tK(t,e){var r=tY(t,e,"get");return r.get?r.get.call(t):r.value}function tX(t,e,r){var i=tY(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function tY(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}r(921);var tq=new WeakMap,tZ=new WeakMap,tQ=new WeakSet;class tJ{constructor(){tz(this,tQ),tQ.add(this),t$(this,tq,{writable:!0,value:void 0}),t$(this,tZ,{writable:!0,value:void 0})}setActiveOverlay(t){return tX(this,tZ,t),this}setActiveSelection(t){return tX(this,tq,t),this}scan(){let t=tK(this,tq).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"area"===t?this.scanCellsRange(t=>e.add(t)):"focus"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t)),this.scanCellsRange(t=>e.add(t))):"fill"===t?this.scanCellsRange(t=>e.add(t)):"header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"row"===t?(this.scanRowsInHeadersRange(t=>e.add(t)),this.scanRowsInCellsRange(t=>e.add(t))):"column"===t&&(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanColumnsInCellsRange(t=>e.add(t))),e}scanColumnsInHeadersRange(t){let[e,r,i,n]=tK(this,tq).getCorners(),{wtTable:o}=tK(this,tZ),s=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount(),a=0;for(let u=-o.getRowHeadersCount();u<s;u++){let s=o.columnFilter.renderedToSource(u);if(!(s<r)&&!(s>n)){for(let u=-l;u<0;u++){if(u<e||u>i)continue;let h=u+l,c=o.getColumnHeader(s,h),d=tK(this,tZ).getSetting("onBeforeHighlightingColumnHeader",s,h,{selectionType:tK(this,tq).settings.selectionType,columnCursor:a,selectionWidth:n-r+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,h)),t(c))}a+=1}}}scanRowsInHeadersRange(t){let[e,r,i,n]=tK(this,tq).getCorners(),{wtTable:o}=tK(this,tZ),s=o.getRenderedRowsCount(),l=o.getRowHeadersCount(),a=0;for(let u=-o.getColumnHeadersCount();u<s;u++){let s=o.rowFilter.renderedToSource(u);if(!(s<e)&&!(s>i)){for(let u=-l;u<0;u++){if(u<r||u>n)continue;let h=u+l,c=o.getRowHeader(s,h),d=tK(this,tZ).getSetting("onBeforeHighlightingRowHeader",s,h,{selectionType:tK(this,tq).settings.selectionType,rowCursor:a,selectionHeight:i-e+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,h)),t(c))}a+=1}}}scanCellsRange(t){let[e,r,n,o]=tK(this,tq).getCorners(),{wtTable:s}=tK(this,tZ);tG(this,tQ,t0).call(this,(l,a)=>{if(l>=e&&l<=n&&a>=r&&a<=o){let e=s.getCell(tK(this,tZ).createCellCoords(l,a)),r=tK(this,tZ).getSetting("onAfterDrawSelection",l,a,tK(this,tq).settings.layerLevel);"string"==typeof r&&(0,i.cn)(e,r),t(e)}})}scanRowsInCellsRange(t){let[e,,r]=tK(this,tq).getCorners(),{wtTable:i}=tK(this,tZ);tG(this,tQ,t0).call(this,(n,o)=>{if(n>=e&&n<=r){let e=i.getCell(tK(this,tZ).createCellCoords(n,o));t(e)}})}scanColumnsInCellsRange(t){let[,e,,r]=tK(this,tq).getCorners(),{wtTable:i}=tK(this,tZ);tG(this,tQ,t0).call(this,(n,o)=>{if(o>=e&&o<=r){let e=i.getCell(tK(this,tZ).createCellCoords(n,o));t(e)}})}}function t0(t){let{wtTable:e}=tK(this,tZ),r=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let n=0;n<r;n+=1){let r=e.rowFilter.renderedToSource(n);for(let n=0;n<i;n+=1)t(r,e.columnFilter.renderedToSource(n))}}var t1=r(7687);class t2{constructor(t,e){if(!e)return;this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=tv,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners()}registerListeners(){let t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){let e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),(0,t1.mM)(t);let r=this,i=this.wot.rootDocument.body,n=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(i,"mousemove",function t(o){(function(t){if(t.clientY<Math.floor(n.top)||t.clientY>Math.ceil(n.top+n.height)||t.clientX<Math.floor(n.left)||t.clientX>Math.ceil(n.left+n.width))return!0})(o)&&(r.eventManager.removeEventListener(i,"mousemove",t),e.style.display="block")})}createBorders(t){let{rootDocument:e}=this.wot;this.main=e.createElement("div");let r=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let n=0;n<5;n++){let o=r[n],s=e.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(i=s.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color,i.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,i.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,s.K1)()&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:n}=this.wot,o=n.bordersHolder;o||((o=e.createElement("div")).className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let e={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,te._l)(e,(t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t});let r={position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};(0,te._l)(r,(t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){let r=this.wot.selectionManager.getAreaSelection();return!!r.cellRange&&(t!==r.cellRange.to.row||e!==r.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,r,i,n,o){let s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",{top:a,topHitArea:u,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),f=parseInt(a.width,10),g=parseInt(u.width,10),p=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();a.top=`${parseInt(r-f-1,10)}px`,a[l]=`${parseInt(i-f-1,10)}px`,u.top=`${parseInt(r-g/4*3,10)}px`,u[l]=`${parseInt(i-g/4*3,10)}px`;let w=Math.min(parseInt(i+n,10),p-f-2*d),y=Math.min(parseInt(i+n-g/4,10),p-g-2*d);h[l]=`${w}px`,c[l]=`${y}px`;let b=Math.min(parseInt(r+o,10),m-f-2*d),C=Math.min(parseInt(r+o-g/4,10),m-g-2*d);h.top=`${b}px`,c.top=`${C}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",u.display="block",this.isPartRange(t,e)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(a.display="none",h.display="none",u.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",u.zIndex="9999"):(a.zIndex="",u.zIndex="")}appear(t){let e,r,n,o,l,a;if(this.disabled)return;let{wtTable:u,rootDocument:h,rootWindow:c}=this.wot,d=u.getRenderedRowsCount();for(let r=0;r<d;r+=1){let i=u.rowFilter.renderedToSource(r);if(i>=t[0]&&i<=t[2]){e=i,l=t[0];break}}for(let e=d-1;e>=0;e-=1){let i=u.rowFilter.renderedToSource(e);if(i>=t[0]&&i<=t[2]){r=i;break}}let f=u.getRenderedColumnsCount();for(let e=0;e<f;e+=1){let r=u.columnFilter.renderedToSource(e);if(r>=t[1]&&r<=t[3]){n=r,a=t[1];break}}for(let e=f-1;e>=0;e-=1){let r=u.columnFilter.renderedToSource(e);if(r>=t[1]&&r<=t[3]){o=r;break}}if(void 0===e||void 0===n){this.disappear();return}let g=u.getCell(this.wot.createCellCoords(e,n)),p=e!==r||n!==o,m=p?u.getCell(this.wot.createCellCoords(r,o)):g,w=(0,i.cv)(g),y=p?(0,i.cv)(m):w,b=(0,i.cv)(u.TABLE),C=(0,i.iO)(u.TABLE),S=w.top,E=w.left,T=this.wot.wtSettings.getSetting("rtlMode"),R=0,O=0;if(T){let t=(0,i.iO)(g),e=c.innerWidth-b.left-C;O=E+t-y.left,R=c.innerWidth-E-t-e-1}else O=y.left+(0,i.iO)(m)-E,R=E-b.left-1;if(this.isEntireColumnSelected(e,r)){let t=this.getDimensionsFromHeader("columns",n,o,l,b),e=null;t&&([e,R,O]=t),e&&(g=e)}let M=S-b.top-1,I=y.top+(0,i.Pb)(m)-S;if(this.isEntireRowSelected(n,o)){let t=this.getDimensionsFromHeader("rows",e,r,a,b),i=null;t&&([i,M,I]=t),i&&(g=i)}let N=(0,i.Dx)(g,c);parseInt(N.borderTopWidth,10)>0&&(M+=1,I=I>0?I-1:0),parseInt(N[T?"borderRightWidth":"borderLeftWidth"],10)>0&&(R+=1,O=O>0?O-1:0);let x=T?"right":"left";this.topStyle.top=`${M}px`,this.topStyle[x]=`${R}px`,this.topStyle.width=`${O}px`,this.topStyle.display="block",this.startStyle.top=`${M}px`,this.startStyle[x]=`${R}px`,this.startStyle.height=`${I}px`,this.startStyle.display="block";let k=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${M+I-k}px`,this.bottomStyle[x]=`${R}px`,this.bottomStyle.width=`${O}px`,this.bottomStyle.display="block",this.endStyle.top=`${M}px`,this.endStyle[x]=`${R+O-k}px`,this.endStyle.height=`${I+1}px`,this.endStyle.display="block";let H=this.settings.border.cornerVisible;H="function"==typeof H?H(this.settings.layerLevel):H;let _=this.wot.getSetting("onModifyGetCellCoords",r,o),[A,L]=[r,o];if(_&&Array.isArray(_)&&([,,A,L]=_),(0,s.K1)()||!H||this.isPartRange(A,L))this.cornerStyle.display="none";else{this.cornerStyle.top=`${M+I+this.cornerCenterPointOffset-1}px`,this.cornerStyle[x]=`${R+O+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=(0,i.$g)(u.TABLE),e=t===c;e&&(t=h.documentElement);let n=parseInt(this.cornerDefaultStyle.width,10)/2,s=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){let r=e?m.getBoundingClientRect().left:m.offsetLeft;(T?r-parseInt(this.cornerDefaultStyle.width,10)/2<0:r+(0,i.iO)(m)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,i.x9)(t))&&(this.cornerStyle[x]=`${Math.floor(R+O+this.cornerCenterPointOffset-n)}px`,this.cornerStyle[T?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){let r=e?m.getBoundingClientRect().top:m.offsetTop,n=r+(0,i.Pb)(m)+parseInt(this.cornerDefaultStyle.height,10)/2,o=n>=(0,i.WS)(t);o&&(this.cornerStyle.top=`${Math.floor(M+I+this.cornerCenterPointOffset-s)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}(0,s.K1)()&&this.updateMultipleSelectionHandlesPosition(r,o,M,R,O,I)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,r,n,o){let{wtTable:s}=this.wot,l=s.wtRootElement.parentNode,a=null,u=null,h=null,c=null,d=null,f=null,g=null,p=null;switch(t){case"rows":a=function(){return s.getRowHeader(...arguments)},u=function(){return(0,i.Pb)(...arguments)},h="ht__selection--rows",f="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},u=function(){return(0,i.iO)(...arguments)},h="ht__selection--columns",f="left"}if(l.classList.contains(h)){let t=this.wot.getSetting("columnHeaders").length;if(g=a(e,t-n),p=a(r,t-n),!g||!p)return!1;let s=(0,i.cv)(g),l=(0,i.cv)(p);return g&&p&&(c=s[f]-o[f]-1,d=l[f]+u(p)-s[f]),[g,c,d]}return!1}changeBorderStyle(t,e){let r=this[t].style,n=e[t];!n||n.hide?(0,i.cn)(this[t],"hidden"):((0,i.pv)(this[t],"hidden")&&(0,i.IV)(this[t],"hidden"),r.backgroundColor=n.color,("top"===t||"bottom"===t)&&(r.height=`${n.width}px`),("start"===t||"end"===t)&&(r.width=`${n.width}px`))}changeBorderToDefaultStyle(t){let e={width:1,color:"#000"},r=this[t].style;r.backgroundColor=e.color,r.width=`${e.width}px`,r.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?(0,i.cn)(this[t],"hidden"):(0,i.IV)(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,s.K1)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function t9(t,e,r){t4(t,e),e.set(t,r)}function t4(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function t8(t,e){var r=t3(t,e,"get");return r.get?r.get.call(t):r.value}function t7(t,e,r){var i=t3(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function t3(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var t5=new WeakMap,t6=new WeakMap,et=new WeakMap,ee=new WeakMap,er=new WeakMap,ei=new WeakMap,en=new WeakSet;class eo{constructor(t){t4(this,en),en.add(this),t9(this,t5,{writable:!0,value:void 0}),t9(this,t6,{writable:!0,value:void 0}),t9(this,et,{writable:!0,value:new tJ}),t9(this,ee,{writable:!0,value:new WeakMap}),t9(this,er,{writable:!0,value:new WeakSet}),t9(this,ei,{writable:!0,value:new Map}),t7(this,t6,t)}setActiveOverlay(t){return t7(this,t5,t),t8(this,et).setActiveOverlay(t8(this,t5)),t8(this,ee).has(t8(this,t5))||t8(this,ee).set(t8(this,t5),new Set),this}getFocusSelection(){return null!==t8(this,t6)?t8(this,t6).getFocus():null}getAreaSelection(){return null!==t8(this,t6)?t8(this,t6).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(t8(this,ei).has(t)){let e=t8(this,ei).get(t);if(e.has(t8(this,t5)))return e.get(t8(this,t5));let r=new t2(t8(this,t5),t.settings);return e.set(t8(this,t5),r),r}let e=new t2(t8(this,t5),t.settings);return t8(this,ei).set(t,new Map([[t8(this,t5),e]])),e}getBorderInstances(t){var e,r;return Array.from(null!==(e=null===(r=t8(this,ei).get(t))||void 0===r?void 0:r.values())&&void 0!==e?e:[])}destroyBorders(t){t8(this,ei).get(t).forEach(t=>t.destroy()),t8(this,ei).delete(t)}render(t){if(null===t8(this,t6))return;t&&(function(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r})(this,en,es).call(this);let e=Array.from(t8(this,t6)),r=new Map,n=new Map;for(let t=0;t<e.length;t++){let i=e[t],{className:o,headerAttributes:s,createLayers:l,selectionType:a}=i.settings;t8(this,er).has(i)||(t8(this,er).add(i),i.addLocalHook("destroy",()=>this.destroyBorders(i)));let u=this.getBorderInstance(i);if(i.isEmpty()){null==u||u.disappear();continue}if(o){let t=t8(this,et).setActiveSelection(i).scan();t.forEach(t=>{if(r.has(t)){let e=r.get(t);e.has(o)&&!0===l?e.set(o,e.get(o)+1):e.set(o,1)}else r.set(t,new Map([[o,1]]));s&&(n.has(t)||n.set(t,[]),"TH"===t.nodeName&&n.get(t).push(...s))})}let h=i.getCorners();t8(this,t5).getSetting("onBeforeDrawBorders",h,a),null==u||u.appear(h)}r.forEach((t,e)=>{var r;let n=Array.from(t).map(t=>{let[e,r]=t;return 1===r?e:[e,...Array.from({length:r-1},(t,r)=>`${e}-${r+1}`)]}).flat();n.forEach(t=>t8(this,ee).get(t8(this,t5)).add(t)),(0,i.cn)(e,n),"TD"===e.nodeName&&Array.isArray(null===(r=t8(this,t6).options)||void 0===r?void 0:r.cellAttributes)&&(0,i.P$)(e,t8(this,t6).options.cellAttributes)}),Array.from(n.keys()).forEach(t=>{(0,i.P$)(t,[...n.get(t)])})}}function es(){let t=t8(this,ee).get(t8(this,t5)),e=t8(this,t5).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(t=>{var e,r;let n=t8(this,t5).wtTable.TABLE.querySelectorAll(`.${t}`),o=[];Array.isArray(null===(e=t8(this,t6).options)||void 0===e?void 0:e.cellAttributes)&&(o=t8(this,t6).options.cellAttributes.map(t=>t[0])),Array.isArray(null===(r=t8(this,t6).options)||void 0===r?void 0:r.headerAttributes)&&(o=[...o,...t8(this,t6).options.headerAttributes.map(t=>t[0])]);for(let e=0,r=n.length;e<r;e++)(0,i.IV)(n[e],t),(0,i.d$)(n[e],o)}),t.clear()}class el extends tf{constructor(t,e){super(t,new tA(e));let r=this.wtSettings.getSetting("facade",this);this.wtTable=new tL(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new tU(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new eo(this.wtSettings.getSetting("selections")),this.wtEvent=new Event(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new tH(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let t=[],e=[];(0,te._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(r,i)=>{this.wtSettings.getSetting(i).length&&e.push(r),t.push(r)}),(0,i.IV)(this.wtTable.wtRootElement.parentNode,t),(0,i.cn)(this.wtTable.wtRootElement.parentNode,e)}getViewportDao(){let t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class ea{constructor(t){t instanceof tf?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{let e=new ea(t);return()=>e},this._wot=new el(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,r){return this._wot.createCellRange(t,e,r)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,r,i,n){return this._wot.scrollViewport(t,e,r,i,n)}scrollViewportHorizontally(t,e,r){return this._wot.scrollViewportHorizontally(t,e,r)}scrollViewportVertically(t,e,r){return this._wot.scrollViewportVertically(t,e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,r,i,n){return this._wot.wtSettings.getSetting(t,e,r,i,n)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}},5048:function(t,e,r){"use strict";r.r(e),r.d(e,{CellCoords:function(){return o.Z},CellRange:function(){return s.Z},Core:function(){return l.Z},HIGHLIGHT_ACTIVE_HEADER_TYPE:function(){return u.CD},HIGHLIGHT_AREA_TYPE:function(){return u.AI},HIGHLIGHT_COLUMN_TYPE:function(){return u.BA},HIGHLIGHT_CUSTOM_SELECTION_TYPE:function(){return u.$7},HIGHLIGHT_FILL_TYPE:function(){return u.P$},HIGHLIGHT_FOCUS_TYPE:function(){return u.t8},HIGHLIGHT_HEADER_TYPE:function(){return u.Nc},HIGHLIGHT_ROW_TYPE:function(){return u.Os},OrderView:function(){return c.Z},Renderer:function(){return h},Selection:function(){return a.Z},SharedOrderView:function(){return d.Z},ViewportColumnsCalculator:function(){return i.E},ViewportRowsCalculator:function(){return n.U},default:function(){return l.Z},getListenersCounter:function(){return f.k}});var i=r(7431),n=r(3391),o=r(1070),s=r(1648),l=r(6352),a=r(7682),u=r(8352),h=r(8489),c=r(1665),d=r(1084),f=r(9773)},8489:function(t,e,r){"use strict";r.r(e),r.d(e,{CellsRenderer:function(){return C},ColGroupRenderer:function(){return p},ColumnHeadersRenderer:function(){return c},Renderer:function(){return T},RowHeadersRenderer:function(){return h},RowsRenderer:function(){return y},TableRenderer:function(){return E}}),r(2954);var i=r(1084);class n{constructor(t){var e,r,i;r=void 0,(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="nodeType","string"))?i:String(i))in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r,this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function o(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class s{constructor(t,e){o(this,"nodesPool",null),o(this,"nodeType",void 0),o(this,"rootNode",void 0),o(this,"table",null),o(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new n(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}var l=r(5878),a=r(8200);function u(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class h extends s{constructor(){super("TH"),u(this,"orderViews",new WeakMap),u(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new i.Z(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:r,rows:i,cells:n}=this.table;for(let o=0;o<t;o++){let t=this.table.renderedRowToSource(o),s=i.getRenderedNode(o);this.sourceRowIndex=t;let u=this.obtainOrderView(s),h=n.obtainOrderView(s);u.appendView(h).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let i=0;i<r;i++){u.render();let r=u.getCurrentNode();r.className="",r.removeAttribute("style"),(0,l.d$)(r,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,l.P$)(r,[(0,a.iL)(),(0,a.Pp)(),(0,a.yz)(i+1),(0,a.Qk)(-1)]),e[i](t,r,i)}u.end()}}}class c extends s{constructor(t){super(null,t)}adjust(){let{columnHeadersCount:t,rowHeadersCount:e}=this.table,r=this.rootNode.firstChild;if(t){let{columnsToRender:i}=this.table,n=i+e;for(let e=0;e<t;e++){for((r=this.rootNode.childNodes[e])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<n;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)r.removeChild(r.lastChild),this.renderedNodes-=1}let o=this.rootNode.childNodes.length;if(o>t)for(let e=t;e<o;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&(0,l.cS)(r)}render(){let{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&(0,l.P$)(this.rootNode,[(0,a.Ct)()]);for(let e=0;e<t;e+=1){let{columnHeaderFunctions:t,columnsToRender:r,rowHeadersCount:i}=this.table,n=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&(0,l.P$)(n,[(0,a.f3)(),(0,a.d5)(e+1)]);for(let o=-1*i;o<r;o+=1){let r=this.table.renderedColumnToSource(o),s=n.childNodes[o+i];s.className="",s.removeAttribute("style"),(0,l.d$)(s,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,l.P$)(s,[(0,a.yz)(o+1+this.table.rowHeadersCount),(0,a.Qk)(-1),(0,a.Ng)(),...o>=0?[(0,a.iJ)()]:[(0,a.f3)()]]),t[e](r,s,e)}}}}var d=r(4748),f=r(2836);let g=!1;class p extends s{constructor(t){super(null,t)}adjust(){let{columnsToRender:t,rowHeadersCount:e}=this.table,r=t+e;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:t,rowHeadersCount:e}=this.table;!g&&t>1e3&&(g=!0,(0,d.ZK)(f.e`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let t=0;t<e;t++){let e=this.table.renderedColumnToSource(t),r=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[t].style.width=`${r}px`}for(let r=0;r<t;r++){let t=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[r+e].style.width=`${i}px`}let r=this.rootNode.firstChild;r&&(0,l.cn)(r,"rowHeader")}}var m=r(1665);let w=!1;class y extends s{constructor(t){var e,r,i;super("TR",t),r=void 0,(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="orderView","string"))?i:String(i))in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r,this.orderView=new m.Z(t,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){let{rowsToRender:t}=this.table;!w&&t>1e3&&(w=!0,(0,d.ZK)(f.e`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,l.P$)(this.rootNode,[(0,a.Ct)()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<t;i++){this.orderView.render();let t=this.orderView.getCurrentNode(),n=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var e,r;(0,l.P$)(t,[(0,a.f3)(),(0,a.d5)(n+(null!==(e=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.columnHeaders.length)&&void 0!==e?e:0)+1)])}}this.orderView.end()}}function b(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class C extends s{constructor(){super("TD"),b(this,"orderViews",new WeakMap),b(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new i.Z(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,columnsToRender:e,rows:r,rowHeaders:i}=this.table;for(let s=0;s<t;s++){let t=this.table.renderedRowToSource(s),u=r.getRenderedNode(s);this.sourceRowIndex=t;let h=this.obtainOrderView(u),c=i.obtainOrderView(u);h.prependView(c).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let r=0;r<e;r++){h.render();let e=h.getCurrentNode(),i=this.table.renderedColumnToSource(r);if((0,l.pv)(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),(0,l.d$)(e,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(t,i,e),this.table.isAriaEnabled()){var n,o;(0,l.P$)(e,[...e.hasAttribute("role")?[]:[(0,a.Qz)()],(0,a.Qk)(-1),(0,a.yz)(i+(null!==(n=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.rowHeaders.length)&&void 0!==n?n:0)+1)])}}h.end()}}}function S(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class E{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(this,"rootNode",void 0),S(this,"rootDocument",void 0),S(this,"rowHeaders",null),S(this,"columnHeaders",null),S(this,"colGroup",null),S(this,"rows",null),S(this,"cells",null),S(this,"rowFilter",null),S(this,"columnFilter",null),S(this,"rowUtils",null),S(this,"columnUtils",null),S(this,"rowsToRender",0),S(this,"columnsToRender",0),S(this,"rowHeaderFunctions",[]),S(this,"rowHeadersCount",0),S(this,"columnHeaderFunctions",[]),S(this,"columnHeadersCount",0),S(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:r,rows:i,cells:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),r.setTable(this),i.setTable(this),n.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=r,this.rows=i,this.cells=n}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:t,rows:e}=this;for(let r=0;r<t;r++){let t=e.getRenderedNode(r);if(t.firstChild){let e=this.renderedRowToSource(r),i=this.rowUtils.getHeight(e);i?t.firstChild.style.height=`${i-1}px`:t.firstChild.style.height=""}}}}class T{constructor(){let{TABLE:t,THEAD:e,COLGROUP:r,TBODY:i,rowUtils:n,columnUtils:o,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new E(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new h,columnHeaders:new c(e),colGroup:new p(r),rows:new y(i),cells:new C}),this.renderer.setAxisUtils(n,o)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}},8352:function(t,e,r){"use strict";r.d(e,{$7:function(){return h},AI:function(){return o},BA:function(){return u},CD:function(){return i},Nc:function(){return n},Os:function(){return a},P$:function(){return l},t8:function(){return s}});let i="active-header",n="header",o="area",s="focus",l="fill",a="row",u="column",h="custom-selection"},7682:function(t,e,r){"use strict";var i=r(9488),n=r(3437);class Selection{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}(0,i.jB)(Selection,n.Z),e.Z=Selection},1084:function(t,e,r){"use strict";r.d(e,{Z:function(){return n}});var i=r(1665);class n extends i.Z{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}},1665:function(t,e,r){"use strict";function i(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Z:function(){return a}}),r(2916),r(2954);class n{constructor(){i(this,"currentSize",0),i(this,"nextSize",0),i(this,"currentOffset",0),i(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function o(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class s{constructor(){o(this,"size",new n),o(this,"workingSpace",0),o(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof n}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function l(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class a{constructor(t,e,r){l(this,"rootNode",void 0),l(this,"nodesPool",void 0),l(this,"sizeSet",new s),l(this,"childNodeType",void 0),l(this,"visualIndex",0),l(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=r.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){let t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){let{rootNode:t,sizeSet:e}=this,r=0;if(this.isSharedViewSet()){let i=t.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(e.isPlaceOn(1))break;i=i.nextElementSibling}}else r=t.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:t,sizeSet:e}=this,r=this.isSharedViewSet(),{nextSize:i}=e.getViewSize(),n=this.getRenderedChildCount();for(;n<i;){let i=this.nodesPool();!r||r&&e.isPlaceOn(2)?t.appendChild(i):t.insertBefore(i,t.firstChild),n+=1}let o=r&&e.isPlaceOn(1);for(;n>i;)t.removeChild(o?t.firstChild:t.lastChild),n-=1}render(){let{rootNode:t,sizeSet:e}=this,r=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(r+=e.sharedSize.nextSize);let i=t.childNodes[r];if(i.tagName!==this.childNodeType){let e=this.nodesPool();t.replaceChild(e,i),i=e}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}},6324:function(t,e,r){"use strict";r.r(e),r.d(e,{getCellType:function(){return d},getRegisteredCellTypeNames:function(){return h},getRegisteredCellTypes:function(){return c},hasCellType:function(){return u},registerCellType:function(){return f}}),r(2954);var i=r(2656),n=r(7416),o=r(6903),s=r(2740);let{register:l,getItem:a,hasItem:u,getNames:h,getValues:c}=(0,i.Z)("cellTypes");function d(t){if(!u(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return a(t)}function f(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);let{editor:r,renderer:i,validator:a}=e;r&&(0,n.qm)(t,r),i&&(0,o.zn)(t,i),a&&(0,s.Ie)(t,a),l(t,e)}},2551:function(t,e,r){"use strict";r.r(e),r.d(e,{CELL_TYPE:function(){return o},TextCellType:function(){return s}});var i=r(2694),n=r(9275);let o="text",s={CELL_TYPE:o,editor:i.H,renderer:n.V}},8435:function(t,e,r){"use strict";r.d(e,{o:function(){return l}});var i=r(2659),n=r(5878),o=r(8200);function s(t){let e=t.rootDocument,r=e.createElement("input");return r.type="text",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&(0,n.P$)(r,[(0,o.Rn)(),(0,o.cV)()]),r}function l(t){let e;let r=e=>{if(!e)return null;let r=a(t),i=u(t);return e.col<r.col&&(e.col=r.col),e.col>i.col&&(e.col=i.col),e.row<r.row&&(e.row=r.row),e.row>i.row&&(e.row=i.row),e},{activate:n,deactivate:o}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.rootElement,i=s(t),n=s(t);return i.addEventListener("focus",()=>null==e?void 0:e.onFocusFromTop()),n.addEventListener("focus",()=>null==e?void 0:e.onFocusFromBottom()),r.firstChild.before(i),r.lastChild.after(n),{activate(){t._registerTimeout(()=>{i.tabIndex=0,n.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,n.tabIndex=-1},10)}}}(t,{onFocusFromTop(){var i;let n=null!==(i=r(e))&&void 0!==i?i:a(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_above",n),t.selectCell(n.row,n.col)),t.listen()},onFocusFromBottom(){var i;let n=null!==(i=r(e))&&void 0!==i?i:u(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_below",n),t.selectCell(n.row,n.col)),t.listen()}}),l={wrapped:!1,flipped:!1},h=!0,c=!1,d=!1;t.addHook("afterListen",()=>o()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(r,i,n,o,s)=>{if(c&&(l.wrapped&&l.flipped||d)&&(d=!1,s.value=!0),h){var a;e=null===(a=t.getSelectedRangeLast())||void 0===a?void 0:a.highlight}}),t.addHook("beforeRowWrap",(t,e,r)=>{l.wrapped=!0,l.flipped=r});let f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:i.W,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{let{tabNavigation:e}=t.getSettings();c=!0,t.getSelectedRangeLast()&&!e&&(h=!1),e||(d=!0)},position:"before"},{...f,callback:r=>{let{tabNavigation:i,autoWrapRow:n}=t.getSettings();if(c=!1,h=!0,!i||!t.selection.isSelected()||n&&l.wrapped&&l.flipped||!n&&l.wrapped)return n&&l.wrapped&&l.flipped&&(e=r.shiftKey?a(t):u(t)),l.wrapped=!1,l.flipped=!1,t.deselectCell(),t.unlisten(),!1;r.preventDefault()},position:"after"}])}function a(t){let{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:i}=t.getSettings(),n=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return(0===n&&(n=e.getVisualFromRenderableIndex(n)),0===o&&(o=r.getVisualFromRenderableIndex(o)),null===n||null===o)?null:t._createCellCoords(n,o)}function u(t){var e,r;let{rowIndexMapper:i,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings(),s=i.getRenderableIndexesLength()-1,l=n.getRenderableIndexesLength()-1;if(s<0){if(!o||0===t.countColHeaders())return null;s=-1}if(l<0){if(!o||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=i.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(r=n.getVisualFromRenderableIndex(l))&&void 0!==r?r:l)}},8902:function(t,e,r){"use strict";r(2954),r(2916);var i=r(292),n=r(7628),o=r(9488),s=r(9440),l=r(7790),a=r(2518);function u(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class h{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,r){u(this,"hot",void 0),u(this,"metaManager",void 0),u(this,"tableMeta",void 0),u(this,"dataSource",void 0),u(this,"duckSchema",void 0),u(this,"colToPropCache",void 0),u(this,"propToColCache",void 0),this.hot=t,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let t;let e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let r=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,n=0,s=!1;if("function"==typeof r){let t=(0,o.Q8)(e);i=t>0?t:this.countFirstRowKeys(),s=!0}else{let t=this.tableMeta.maxCols;i=Math.min(t,r.length)}for(t=0;t<i;t++){let e=s?r(t):r[t];if((0,o.Kn)(e)){if(void 0!==e.data){let r=s?n:t;this.colToPropCache[r]=e.data,this.propToColCache.set(e.data,r)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return(0,n.Eb)(this.dataSource)}recursiveDuckColumns(t,e,r){let i,n=e,s=r;return void 0===n&&(n=0,s=""),"object"!=typeof t||Array.isArray(t)||(0,o._l)(t,(t,e)=>{null===t?(i=s+e,this.colToPropCache.push(i),this.propToColCache.set(i,n),n+=1):n=this.recursiveDuckColumns(t,n,`${e}.`)}),n}colToProp(t){if(!1===Number.isInteger(t))return t;let e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&(0,a.$K)(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){let e=this.propToColCache.get(t);if((0,a.$K)(e))return this.hot.toVisualColumn(e);let r=this.hot.toVisualColumn(t);return null===r?t:r}getSchema(){let t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,o.ie)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.hot.countSourceRows(),s=n,a=0,u=t;("number"!=typeof u||u>=n)&&(u=n),u<this.hot.countRows()&&(s=this.hot.toPhysicalRow(u));let h=this.hot.runHooks("beforeCreateRow",u,e,r);if(!1===h||null===s)return{delta:0};let c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<e&&n+a<c;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=(0,o.I8)(this.getSchema()):(t=[],(0,l.q4)(d-1,()=>t.push(null))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(u+a):(t={},(0,o.ZB)(t,this.getSchema())),f.push(t),a+=1}this.hot.rowIndexMapper.insertIndexes(u,a),"below"===i&&(s=Math.min(s+1,n)),this.spliceData(s,0,f);let g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(null==t?this.metaManager.createRow(null,a):"auto"!==r&&this.metaManager.createRow(s,e)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let n=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols(),l=t;("number"!=typeof l||l>=s)&&(l=s);let a=this.hot.runHooks("beforeCreateCol",l,e,r);if(!1===a)return{delta:0};let u=s;l<this.hot.countCols()&&(u=this.hot.toPhysicalColumn(l));let h=this.hot.countSourceRows(),c=this.hot.countCols(),d=0,f=u;"end"===i&&(f=Math.min(f+1,s));let g=f;for(;d<e&&c<o;){if("number"!=typeof l||l>=c){if(h>0)for(let t=0;t<h;t+=1)void 0===n[t]&&(n[t]=[]),n[t].push(null);else n.push([null])}else for(let t=0;t<h;t++)n[t].splice(f,0,null);d+=1,f+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(l,d),d>0&&(null==t?this.metaManager.createColumn(null,d):"auto"!==r&&this.metaManager.createColumn(g,e));let p=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",p,d,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(t)?t:-e,n=this.visualRowsToPhysical(i,e),o=this.hot.countSourceRows();i=(o+i)%o;let s=this.hot.runHooks("beforeRemoveRow",i,n.length,n,r);if(!1===s)return!1;let l=n.length;if(this.filterData(i,l,n),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);let t=(0,a.$K)(this.tableMeta.columns)||(0,a.$K)(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}let u=n.slice(0).sort((t,e)=>e-t);return u.forEach(t=>{this.metaManager.removeRow(t,1)}),this.hot.runHooks("afterRemoveRow",i,l,n,r),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let i="number"!=typeof t?-e:t;i=(this.hot.countCols()+i)%this.hot.countCols();let n=this.visualColumnsToPhysical(i,e),o=n.slice(0).sort((t,e)=>e-t),s=this.hot.runHooks("beforeRemoveCol",i,e,n,r);if(!1===s)return!1;let l=!0,a=o.length,u=this.dataSource;for(let t=0;t<a;t++)l&&n[0]!==n[t]-t&&(l=!1);if(l)for(let t=0,r=this.hot.countSourceRows();t<r;t++)u[t].splice(n[0],e),0===t&&this.metaManager.removeColumn(n[0],e);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<a;e++)u[t].splice(o[e],1),0===t&&this.metaManager.removeColumn(o[e],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,e,n,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,r){let i=this.hot.getDataAtCol(t),n=i.slice(e,e+r),o=i.slice(e+r);for(var l=arguments.length,a=Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];(0,s.g9)(a,o);let h=0;for(;h<r;)a.push(null),h+=1;return(0,s.PI)(a),this.hot.populateFromArray(e,t,a,null,null,"spliceCol"),n}spliceRow(t,e,r){let i=this.hot.getSourceDataAtRow(t),n=i.slice(e,e+r),o=i.slice(e+r);for(var l=arguments.length,a=Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];(0,s.g9)(a,o);let h=0;for(;h<r;)a.push(null),h+=1;return this.hot.populateFromArray(t,e,[a],null,null,"spliceRow"),n}spliceData(t,e,r){let i=this.hot.runHooks("beforeDataSplice",t,e,r);if(!1!==i){let e=[...this.dataSource.slice(0,t),...r,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach(t=>this.dataSource.push(t))}}filterData(t,e,r){let i=this.hot.runHooks("filterData",t,e,r);!1===Array.isArray(i)&&(i=this.dataSource.filter((t,e)=>-1===r.indexOf(e))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(t,e){let r=this.hot.toPhysicalRow(t),i=this.dataSource[r],n=this.hot.runHooks("modifyRowData",r);i=isNaN(n)?n:i;let s=null;if(i&&i.hasOwnProperty&&(0,o.nr)(i,e))s=i[e];else if("string"==typeof e&&e.indexOf(".")>-1){let t=e.split("."),r=i;if(!r)return null;for(let e=0,i=t.length;e<i;e++)if(void 0===(r=r[t[e]]))return null;s=r}else"function"==typeof e&&(s=e(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){let t=(0,o.sm)(s);this.hot.runHooks("modifyData",r,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,r){let i=this.hot.toPhysicalRow(t),n=r,s=this.dataSource[i],l=this.hot.runHooks("modifyRowData",i);if(s=isNaN(l)?l:s,this.hot.hasHook("modifyData")){let t=(0,o.sm)(n);this.hot.runHooks("modifyData",i,this.propToCol(e),t,"set"),t.isTouched()&&(n=t.value)}if(s&&s.hasOwnProperty&&(0,o.nr)(s,e))s[e]=n;else if("string"==typeof e&&e.indexOf(".")>-1){let t;let r=e.split("."),i=s,o=0;for(o=0,t=r.length-1;o<t;o++)void 0===i[r[o]]&&(i[r[o]]={}),i=i[r[o]];i[r[o]]=n}else"function"==typeof e?e(this.dataSource.slice(i,i+1)[0],n):s[e]=n}visualRowsToPhysical(t,e){let r=this.hot.countSourceRows(),i=[],n=(r+t)%r,o=e;for(;n<r&&o;)i.push(this.hot.toPhysicalRow(n)),o-=1,n+=1;return i}visualColumnsToPhysical(t,e){let r=this.hot.countCols(),i=[],n=(r+t)%r,o=e;for(;n<r&&o;){let t=this.hot.toPhysicalColumn(n);i.push(t),o-=1,n+=1}return i}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){let t=this.tableMeta.maxRows,e=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t<0||0===t?0:t||1/0)}getAll(){let t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,h.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,r){let i,n,o;let s=[],l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];let u=r===h.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),d=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){o=[];let r=i>=0?this.hot.toPhysicalRow(i):i;for(n=Math.min(t.col,e.col);n<=d&&null!==r;n++)o.push(u.call(this,i,this.colToProp(n)));null!==r&&s.push(o)}return s}getText(t,e){return(0,i.P)(this.getRange(t,e,h.DESTINATION_RENDERER))}getCopyableText(t,e){return(0,i.P)(this.getRange(t,e,h.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}e.Z=h},3891:function(t,e,r){"use strict";r(2916),r(2954);var i=r(9488),n=r(7628),o=r(9440),s=r(7790),l=r(8179);function a(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class u{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,"hot",void 0),a(this,"data",void 0),a(this,"dataType","array"),a(this,"colToProp",()=>{}),a(this,"propToCol",()=>{}),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){let e=[];return(0,o.Bk)(this.data,(r,i)=>{let n=this.getAtCell(i,t);e.push(n)}),e}getAtRow(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===e&&void 0===r,a=null,u=null;if(Array.isArray(a=this.modifyRowData(t)))u=[],o?a.forEach((e,r)=>{u[r]=this.getAtPhysicalCell(t,r,a)}):(0,s.q4)(e,r,r=>{u[r-e]=this.getAtPhysicalCell(t,r,a)});else if((0,i.Kn)(a)||(0,l.mf)(a)){if(u=n?[]:{},!o||n){let o=this.countFirstRowKeys()-1;(0,s.q4)(0,o,s=>{let l=this.colToProp(s);if(s>=(e||0)&&s<=(r||o)&&!Number.isInteger(l)){let e=this.getAtPhysicalCell(t,l,a);n?u.push(e):(0,i.Hn)(u,l,e)}})}else(0,i._l)(a,(e,r)=>{(0,i.Hn)(u,r,this.getAtPhysicalCell(t,r,a))})}return u}setAtCell(t,e,r){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=(0,i.sm)(r);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(r=n.value)}Number.isInteger(e)?this.data[t][e]=r:(0,i.Hn)(this.data[t],e,r)}}getAtPhysicalCell(t,e,r){let n=null;if(r&&(n="string"==typeof e?(0,i.$s)(r,e):"function"==typeof e?e(r):r[e]),this.hot.hasHook("modifySourceData")){let r=(0,i.sm)(n);this.hot.runHooks("modifySourceData",t,e,r,"get"),r.isTouched()&&(n=r.value)}return n}getAtCell(t,e){let r=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),r)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1,n=null,o=null,l=null,a=null;null===t||null===e?(i=!0,n=0,l=this.countRows()-1):(n=Math.min(t.row,e.row),o=Math.min(t.col,e.col),l=Math.max(t.row,e.row),a=Math.max(t.col,e.col));let u=[];return(0,s.q4)(n,l,t=>{u.push(i?this.getAtRow(t,void 0,void 0,r):this.getAtRow(t,o,a,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){let t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return(0,n.Eb)(this.data)}destroy(){this.data=null,this.hot=null}}e.Z=u},4072:function(t,e,r){"use strict";r.r(e),r.d(e,{DataMap:function(){return i.Z},DynamicCellMetaMod:function(){return l.$},ExtendMetaPropertiesMod:function(){return a._},MetaManager:function(){return n.Z},metaSchemaFactory:function(){return o.Z},replaceData:function(){return s.o}});var i=r(8902),n=r(2230),o=r(8015),s=r(7830),l=r(243),a=r(45)},2230:function(t,e,r){"use strict";let i;r.d(e,{Z:function(){return E}}),r(2954);var n=r(9488),o=r(6324);function s(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i="string"==typeof e.type?(0,o.getCellType)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&(0,n._l)(e,(e,r)=>void t._automaticallyAssignedMetaProps.delete(r)),!(0,n.Kn)(i))return;r!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);let s={};(0,n._l)(i,(e,i)=>{var o,l;"CELL_TYPE"!==i&&((null===(o=r._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(i))||!(0,n.nr)(r,i))&&(s[i]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(i))}),(0,n.l7)(t,s)}function l(t){return Number.isInteger(t)&&t>=0}function a(t,e){if(!t())throw Error(`Assertion failed: ${e}`)}var u=r(8015);function h(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class c{constructor(t){h(this,"metaCtor",class{}),h(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,n.l7)(this.meta,(0,u.Z)()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;(0,n.l7)(this.meta,t),s(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class d{constructor(t){var e,r,i;r=void 0,(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="meta","string"))?i:String(i))in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r;let n=t.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(t){(0,n.l7)(this.meta,t),s(this.meta,t,t)}}r(2916);var f=r(9440);function g(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}i=Symbol.iterator;class p{constructor(t){g(this,"valueFactory",void 0),g(this,"data",[]),g(this,"index",[]),g(this,"holes",new Set),this.valueFactory=t}obtain(t){let e;a(()=>l(t),"Expecting an unsigned number.");let r=this._getStorageIndexByKey(t);if(r>=0)void 0===(e=this.data[r])&&(e=this.valueFactory(t),this.data[r]=e);else if(e=this.valueFactory(t),this.holes.size>0){let r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=e,this.index[t]=r}else this.data.push(e),this.index[t]=this.data.length-1;return e}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a(()=>l(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let r=[],i=this.data.length;for(let t=0;t<e;t++)r.push(i+t),this.data.push(void 0);let n=null==t?this.index.length:t;this.index=[...this.index.slice(0,n),...r,...this.index.slice(n)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a(()=>l(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let r=this.index.splice(null==t?this.index.length-e:t,e);for(let t=0;t<r.length;t++){let e=r[t];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return(0,f.w7)(this.data,(t,e)=>!this.holes.has(e))[Symbol.iterator]()}entries(){let t=[];for(let e=0;e<this.data.length;e++){let r=this._getKeyByStorageIndex(e);-1!==r&&t.push([r,this.data[e]])}let e=0;return{next:()=>{if(e<t.length){let r=t[e];return e+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[i](){return this.entries()}}function m(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}let w=["data","width"];class y{constructor(t){m(this,"globalMeta",void 0),m(this,"metas",new p(()=>this._createMeta())),this.globalMeta=t,this.metas=new p(()=>this._createMeta())}updateMeta(t,e){let r=this.getMeta(t);(0,n.l7)(r,e),s(r,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function r(){}(0,n.ED)(r,t);for(let t=0;t<e.length;t++)r.prototype[e[t]]=void 0;return r}(this.globalMeta.getMetaConstructor(),w).prototype}}function b(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class C{constructor(t){b(this,"columnMeta",void 0),b(this,"metas",new p(()=>this._createRow())),this.columnMeta=t}updateMeta(t,e,r){let i=this.getMeta(t,e);(0,n.l7)(i,r),s(i,r)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(t,e)}getMeta(t,e,r){let i=this.metas.obtain(t).obtain(e);return void 0===r?i:i[r]}setMeta(t,e,r,i){var n;let o=this.metas.obtain(t).obtain(e);null===(n=o._automaticallyAssignedMetaProps)||void 0===n||n.delete(r),o[r]=i}removeMeta(t,e,r){let i=this.metas.obtain(t).obtain(e);delete i[r]}getMetas(){let t=[],e=Array.from(this.metas.values());for(let r=0;r<e.length;r++)t.push(...e[r].values());return t}getMetasAtRow(t){a(()=>l(t),"Expecting an unsigned number.");let e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new p(t=>this._createMeta(t))}_createMeta(t){let e=this.columnMeta.getMetaConstructor(t);return new e}}var S=r(3437);class E{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new c(t),this.tableMeta=new d(this.globalMeta),this.columnMeta=new y(this.globalMeta),this.cellMeta=new C(this.columnMeta),r.forEach(t=>new t(this)),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,r){let{visualRow:i,visualColumn:n}=r,o=this.cellMeta.getMeta(t,e);return o.visualRow=i,o.visualCol=n,o.row=t,o.col=e,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(t,e,r){if("string"!=typeof r)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,r)}setCellMeta(t,e,r,i){this.cellMeta.setMeta(t,e,r,i)}updateCellMeta(t,e,r){this.cellMeta.updateMeta(t,e,r)}removeCellMeta(t,e,r){this.cellMeta.removeMeta(t,e,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,n.jB)(E,S.Z)},243:function(t,e,r){"use strict";r.d(e,{$:function(){return l}}),r(2954);var i=r(4317),n=r(9488),o=r(8179);function s(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class l{constructor(t){s(this,"metaManager",void 0),s(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),i.default.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var e,r;let{row:i,col:s}=t;if(null!==(e=this.metaSyncMemo.get(i))&&void 0!==e&&e.has(s))return;let{visualRow:l,visualCol:a}=t,u=this.metaManager.hot,h=u.colToProp(a);t.prop=h,u.runHooks("beforeGetCellMeta",l,a,t);let c=(0,n.nr)(t,"type")?t.type:null,d=(0,o.mf)(t.cells)?t.cells(i,s,h):null;c&&(d?d.type=null!==(r=d.type)&&void 0!==r?r:c:d={type:c}),d&&this.metaManager.updateCellMeta(i,s,d),u.runHooks("afterGetCellMeta",l,a,t),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(s)}}},45:function(t,e,r){"use strict";function i(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{_:function(){return n}}),r(2954);class n{constructor(t){i(this,"metaManager",void 0),i(this,"usageTracker",new Set),i(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,r){if(!r)throw Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){let e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,r){if(!r)throw Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((t,e)=>{let{target:r,onChange:i=()=>{}}=t,n="string"==typeof r,o=n?r:e,s=`_${o}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[o],this.installPropWatcher(e,s,i),n&&this.installPropWatcher(r,s,i)})}installPropWatcher(t,e,r){let i=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(n){let o=!i.usageTracker.has(t);i.usageTracker.add(t),r.call(i,t,n,o),this[e]=n},enumerable:!0,configurable:!0})}}},7830:function(t,e,r){"use strict";r.d(e,{o:function(){return u}}),r(2916),r(2954);var i=r(6411),n=r(8179),o=r(8902),s=r(9488),l=r(5878),a=r(8200);function u(t,e,r,u){let{hotInstance:h,dataMap:c,dataSource:d,internalSource:f,source:g,metaManager:p,firstRun:m}=u,w=(0,i.ct)(f),y=h.getSettings();Array.isArray(y.dataSchema)?h.dataType="array":(0,n.mf)(y.dataSchema)?h.dataType="function":h.dataType="object",c&&c.destroy(),t=h.runHooks(`before${w}`,t,m,g);let b=new o.Z(h,t,p);if(e(b),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else if(null===t){let e;let r=b.getSchema();t=[];let i=0,n=0;for(i=0,n=y.startRows;i<n;i++)if(("object"===h.dataType||"function"===h.dataType)&&y.dataSchema)e=(0,s.I8)(r),t.push(e);else if("array"===h.dataType)e=(0,s.I8)(r[0]),t.push(e);else{e=[];for(let t=0,r=y.startCols;t<r;t++)e.push(null);t.push(e)}}else throw Error(`${f} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(h.dataType="array"),y.data=t,b.dataSource=t,d.data=t,d.dataType=h.dataType,d.colToProp=b.colToProp.bind(b),d.propToCol=b.propToCol.bind(b),d.countCachedColumns=b.countCachedColumns.bind(b),r(b),h.runHooks(`after${w}`,t,m,g),m||(h.runHooks("afterChange",null,f),h.render()),h.getSettings().ariaTags&&(0,l.P$)(h.rootElement,[(0,a.a2)(-1),(0,a.Wv)(h.countCols()+(h.view?h.countRowHeaders():0))])}},4692:function(t,e,r){"use strict";r.d(e,{H:function(){return c}}),r(2954);var i=r(6678),n=r(7687),o=r(7416),s=r(9773),l=r(2518);function a(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function u(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}let c="editorManager.navigation";var d=new WeakSet,f=new WeakSet;class g{constructor(t,e,r){a(this,f),a(this,d),u(this,"hot",void 0),u(this,"tableMeta",void 0),u(this,"selection",void 0),u(this,"eventManager",void 0),u(this,"destroyed",!1),u(this,"lock",!1),u(this,"activeEditor",void 0),u(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=r,this.eventManager=new s.Z(t),this.hot.addHook("afterDocumentKeyDown",t=>h(this,d,p).call(this,t)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)}),this.hot.view._wt.update("onCellDblClick",(t,e,r)=>h(this,f,m).call(this,t,e,r))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,t=>{t&&this.prepareEditor()});return}let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;let{row:r,col:i}=e,n=this.hot.runHooks("modifyGetCellCoords",r,i),s=r,l=i;if(Array.isArray(n)&&([s,l]=n),this.cellProperties=this.hot.getCellMeta(s,l),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.hot.getCell(r,i,!0);if(a){let t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(l),n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),l);this.activeEditor=(0,o.Jq)(t,this.hot),this.activeEditor.prepare(r,i,e,a,n,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}closeEditor(t,e,r){this.activeEditor?this.activeEditor.finishEditing(t,e,r):r&&r(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let t=this.hot.getSelectedRangeLast();if(!t)return!1;let e=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=t.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,s=n.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(i));return!this.cellProperties.readOnly&&!!e&&!s}moveSelectionAfterEnter(t){let e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function p(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||(0,n.Ty)(t))return;let{keyCode:r}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(0,i.DC)(r)&&!(0,i.T2)(r)&&!o&&!this.isEditorOpened()){let e=this.hot.getShortcutManager(),r=e.getContext("editor");r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,l.$K)(this.hot.getSelected()),group:c}),this.openEditor("",t)}}function m(t,e,r){"TD"===r.nodeName&&this.openEditor(null,t,!0)}let w=new WeakMap;g.getInstance=function(t,e,r){let i=w.get(t);return i||(i=new g(t,e,r),w.set(t,i)),i},e.Z=g},8422:function(t,e,r){"use strict";r.d(e,{Hf:function(){return f},ed:function(){return c},FM:function(){return h},PP:function(){return d}}),r(2954);var i=r(2518),n=r(9488),o=r(4692);r(2916);var s=r(9440);let l={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){(0,s.Bk)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,n._l)(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};(0,n.jW)(l,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var a=r(5878);function u(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}let h="base",c=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),d="baseEditor";class f{static get EDITOR_TYPE(){return h}constructor(t){u(this,"hot",void 0),u(this,"state",c.VIRGIN),u(this,"_opened",!1),u(this,"_fullEditMode",!1),u(this,"_closeCallback",null),u(this,"TD",null),u(this,"row",null),u(this,"col",null),u(this,"prop",null),u(this,"originalValue",null),u(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,r,i,n,o){this.TD=i,this.row=t,this.col=e,this.prop=r,this.originalValue=n,this.cellProperties=o,this.state=c.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let r,n,o,s;if(e){let t=this.hot.getSelectedLast();r=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),o=Math.max(t[0],t[2]),s=Math.max(t[1],t[3])}else[r,n,o,s]=[this.row,this.col,null,null];let l=this.hot.runHooks("modifyGetCellCoords",r,n);Array.isArray(l)&&([r,n]=l);let a=this.hot.getShortcutManager(),u=a.getContext("editor");this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,i.$K)(this.hot.getSelected()),group:d}),this.hot.populateFromArray(r,n,t,o,s,"edit")}beginEditing(t,e){if(this.state!==c.VIRGIN)return;let r=this.hot,n=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(n,o)),this.state=c.EDITING,this.isInFullEditMode()){let e="string"==typeof t?t:(0,i.Pz)(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,r){let i;if(r){let t=this._closeCallback;this._closeCallback=e=>{t&&t(e),r(e),this.hot.view.render()}}if(this.isWaiting())return;let n=this.hot.getShortcutManager(),s=n.getContext("editor");if(s.removeShortcutsByGroup(d),s.removeShortcutsByGroup(o.H),this.state===c.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===c.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}let r=this.getValue();i=this.cellProperties.trimWhitespace?[["string"==typeof r?String.prototype.trim.call(r||""):r]]:[[r]],this.state=c.WAITING,this.saveValue(i,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",t=>{this.state=c.FINISHED,this.discardEditor(t)}):(this.state=c.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=c.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===c.FINISHED){if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=c.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=c.VIRGIN,this._fireCallbacks(!0);let t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===c.WAITING}getEditedCellRect(){var t;let e=this.getEditedCell();if(!e)return;let{wtOverlays:r,wtViewport:i}=this.hot.view._wt,n=this.hot.rootWindow,o=(0,a.cv)(e),s=(0,a.iO)(e),l=(0,a.cv)(this.hot.rootElement),u=(0,a.iO)(this.hot.rootElement),h=r.topOverlay.holder,c=r.inlineStartOverlay.holder,d=h!==n?h.scrollTop:0,f=c!==n?c.scrollLeft:0,g=n.innerWidth-l.left-u,{wtTable:p}=null!==(t=r.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=p.name,w=["master","inline_start"].includes(m)?d:0,y=["master","top","bottom"].includes(m)?f:0,b=o.top===l.top?0:1,C=o.top-l.top-b-w,S=0;S=this.hot.isRtl()?n.innerWidth-o.left-s-g-1+y:o.left-l.left-1-y,["top","top_inline_start_corner"].includes(m)&&(C+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(S+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));let E=this.hot.hasColHeaders(),T=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),O=this.hot.rowIndexMapper.getRenderableIndexesLength(),M=O-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&T<=0||T===M)&&(C+=1),R<=0&&(S+=1);let I=i.rowsRenderCalculator.startPosition,N=i.columnsRenderCalculator.startPosition,x=Math.abs(r.inlineStartOverlay.getScrollPosition()),k=r.topOverlay.getScrollPosition(),H=(0,a.np)(this.hot.rootDocument),_=e.offsetTop;if(["inline_start","master"].includes(m)&&(_+=I-k),["bottom","bottom_inline_start_corner"].includes(m)){let{wtViewport:t,wtTable:e}=r.bottomOverlay.clone;_+=t.getWorkspaceHeight()-e.getHeight()-H}let A=e.offsetLeft;this.hot.isRtl()?A=(A>=0?p.getWidth()-e.offsetLeft:Math.abs(A))+(N-x-s):["top","master","bottom"].includes(m)&&(A+=N-x);let L=(0,a.Dx)(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",D=parseInt(L[P],10)>0?0:1,B=parseInt(L.borderTopWidth,10)>0?0:1,F=(0,a.iO)(e)+D,W=(0,a.Pb)(e)+B,V=(0,a.do)(h)?H:0,j=(0,a.vw)(c)?H:0,U=this.hot.view.maximumVisibleElementWidth(A)-V+D,$=Math.max(this.hot.view.maximumVisibleElementHeight(_)-j+B,23);return{top:C,start:S,height:W,maxHeight:$,width:F,maxWidth:U}}getEditedCellsLayerClass(){let t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}(0,n.jB)(f,l)},6557:function(t,e,r){"use strict";r.r(e),r.d(e,{BaseEditor:function(){return i.Hf},EDITOR_STATE:function(){return i.ed},EDITOR_TYPE:function(){return i.FM}});var i=r(8422)},7416:function(t,e,r){"use strict";r.d(e,{Jq:function(){return d},Wu:function(){return a},qm:function(){return g},y$:function(){return f}}),r(2954);var i=r(4317),n=r(2656);let o=new WeakMap,{register:s,getItem:l,hasItem:a,getNames:u,getValues:h}=(0,n.Z)("editors");function c(t){let e={};this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new t(r)),e[r.guid]},i.default.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function d(t,e){let r;if("function"==typeof t)o.get(t)||g(null,t),r=o.get(t);else if("string"==typeof t)r=l(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function f(t){if("function"==typeof t)return t;if(!a(t))throw Error(`No registered editor found under "${t}" name`);return l(t).getConstructor()}function g(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);let r=new c(e);"string"==typeof t&&s(t,r),o.set(e,r)}},2694:function(t,e,r){"use strict";r.d(e,{H:function(){return y}}),r(2954);var i=r(8422),n=r(9773),o=r(2228),s=r(5878),l=r(7790);function a(t,e,r){t.addEventListener(e,r,!1)}function u(t,e,r){t.removeEventListener(e,r,!1)}function h(t){return t.ownerDocument.defaultView.getComputedStyle(t)}var c=r(2518),d=r(4692);function f(t,e){let r=(0,s.qK)(e),i=e.value.split("\n"),n=r,o=0;for(let e=0;e<i.length;e++){let s=i[e];0!==e&&(o+=i[e-1].length+1);let l=o+s.length;if("home"===t?n=o:"end"===t&&(n=l),r<=l)break}(0,s.Mq)(e,n)}var g=r(8200);function p(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}let m="ht_editor_hidden",w="textEditor";class y extends i.Hf{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),p(this,"eventManager",new n.Z(this)),p(this,"autoResize",function(t){let e;let r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=t.body,n=t.createTextNode(""),o=t.createElement("span");function s(){n.textContent=e.value,o.style.position="absolute",o.style.fontSize=h(e).fontSize,o.style.fontFamily=h(e).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);let t=o.clientWidth+2;i.removeChild(o);let s=e.style;s.height=`${r.minHeight}px`,r.minWidth>t?s.width=`${r.minWidth}px`:t>r.maxWidth?s.width=`${r.maxWidth}px`:s.width=`${t}px`;let l=e.scrollHeight?e.scrollHeight-1:0;r.minHeight>l?s.height=`${r.minHeight}px`:r.maxHeight<l?(s.height=`${r.maxHeight}px`,s.overflowY="visible"):s.height=`${l}px`}function l(){t.defaultView.setTimeout(s,0)}return{init:function(t,i){let u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=t,function(t){if(t&&t.minHeight){if("inherit"===t.minHeight)r.minHeight=e.clientHeight;else{let e=parseInt(t.minHeight,10);isNaN(e)||(r.minHeight=e)}}if(t&&t.maxHeight){if("inherit"===t.maxHeight)r.maxHeight=e.clientHeight;else{let e=parseInt(t.maxHeight,10);isNaN(e)||(r.maxHeight=e)}}if(t&&t.minWidth){if("inherit"===t.minWidth)r.minWidth=e.clientWidth;else{let e=parseInt(t.minWidth,10);isNaN(e)||(r.minWidth=e)}}if(t&&t.maxWidth){if("inherit"===t.maxWidth)r.maxWidth=e.clientWidth;else{let e=parseInt(t.maxWidth,10);isNaN(e)||(r.maxWidth=e)}}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))}(i),"TEXTAREA"===e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=`${r.minHeight}px`,e.style.minWidth=`${r.minWidth}px`,e.style.maxWidth=`${r.maxWidth}px`,e.style.overflowY="hidden"),u&&(a(e,"input",s),a(e,"keydown",l)),s()},resize:s,unObserve(){u(e,"input",s),u(e,"keydown",l)}}}(this.hot.rootDocument)),p(this,"TEXTAREA",void 0),p(this,"textareaStyle",void 0),p(this,"TEXTAREA_PARENT",void 0),p(this,"textareaParentStyle",void 0),p(this,"layerClass",void 0),this.eventManager=new n.Z(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,s.yv)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,r,n,o,s){let l=this.state;if(super.prepare(t,e,r,n,o,s),!s.readOnly){this.refreshDimensions(!0);let{allowInvalid:t}=s;t&&(this.TEXTAREA.value=""),l!==i.ed.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===i.ed.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),(0,s.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),(0,s.P$)(this.TEXTAREA,[["data-hot-input",""],(0,g.Qk)(-1)]),this.hot.getSettings().ariaTags&&(0,s.P$)(this.TEXTAREA,[(0,g.cV)()]),(0,s.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),(0,s.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,s.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,s.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,s.cn)(this.TEXTAREA_PARENT,m),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,o.un)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,s.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,s.cn)(this.TEXTAREA_PARENT,m)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";let t=this.TEXTAREA_PARENT.childNodes,e=!1;(0,l.q4)(t.length-1,r=>{let i=t[r];if((0,s.pv)(i,"handsontableEditor"))return e=!0,!1}),(0,s.pv)(this.TEXTAREA_PARENT,m)&&(0,s.IV)(this.TEXTAREA_PARENT,m),e?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,s.cn)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==i.ed.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD){t||this.close();return}let{top:e,start:r,width:n,maxWidth:o,height:l,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();let u=(0,s.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let h=(0,s.Dx)(this.TEXTAREA),c=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),d=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),f=o-c,g=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(n-c,f),minHeight:Math.min(l-d,g),maxWidth:f,maxHeight:g},!0)}bindEvents(){(0,o.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===i.ed.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===i.ed.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor"),r=t.getContext("grid"),i=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[r]=e;f(r,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[r]=e;f(r,this.TEXTAREA)}}],{runOnlyIf:()=>(0,c.$K)(this.hot.getSelected()),group:w})}unregisterShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(d.H),e.removeShortcutsByGroup(w),e.removeShortcutsByGroup(i.PP)}}},9773:function(t,e,r){"use strict";r.d(e,{k:function(){return s}}),r(2916),r(2954);var i=r(7687);let n=0;class o{constructor(){var t,e,r;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=void 0,(t="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="context","string"))?r:String(r))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.context=i||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(t){r.call(this,function(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),(0,i.mM)(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:r,callbackProxy:s,options:o,eventManager:this}),t.addEventListener(e,s,o),n+=1,()=>{this.removeEventListener(t,e,r)}}removeEventListener(t,e,r){let i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;for(;s;)if(s-=1,(i=this.context.eventListeners[s]).event===e&&i.element===t){if(r&&r!==i.callback||o&&i.eventManager!==this)continue;this.context.eventListeners.splice(s,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),n-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;let r=this.context.eventListeners[e];t&&r.eventManager!==this||(this.context.eventListeners.splice(e,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),n-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let r,i=t.document,n=t;i||(n=(i=t.ownerDocument?t.ownerDocument:t).defaultView);let o={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};i.createEvent?(r=i.createEvent("MouseEvents")).initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||i.body.parentNode):r=i.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}}function s(){return n}e.Z=o},8407:function(t,e,r){"use strict";r.d(e,{I:function(){return T}}),r(2954);var i=r(4748),n=r(5878),o=r(8179);function s(t,e){a(t,e),e.add(t)}function l(t,e,r){a(t,e),e.set(t,r)}function a(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function u(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function h(t,e){var r=d(t,e,"get");return r.get?r.get.call(t):r.value}function c(t,e,r){var i=d(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function d(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}let f=Object.freeze({CELL:"cell",MIXED:"mixed"});var g=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakSet,C=new WeakSet,S=new WeakSet,E=new WeakSet;class T{constructor(t){var e=this;s(this,E),s(this,S),s(this,C),s(this,b),l(this,g,{writable:!0,value:void 0}),l(this,p,{writable:!0,value:void 0}),l(this,m,{writable:!0,value:50}),l(this,w,{writable:!0,value:null}),l(this,y,{writable:!0,value:new Map});let r=t.getSettings();c(this,g,t),c(this,p,r.imeFastEdit?f.MIXED:f.CELL),h(this,g).addHook("afterUpdateSettings",function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return u(e,E,I).call(e,...r)}),h(this,g).addHook("afterSelection",function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return u(e,C,O).call(e,...r)}),h(this,g).addHook("afterSelectionEnd",function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return u(e,S,M).call(e,...r)})}getFocusMode(){return h(this,p)}setFocusMode(t){Object.values(f).includes(t)?c(this,p,t):(0,i.ZK)(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return h(this,m)}setRefocusDelay(t){c(this,m,t)}setRefocusElementGetter(t){c(this,w,t)}getRefocusElement(){var t;return"function"==typeof h(this,w)?h(this,w).call(this):null===(t=h(this,g).getActiveEditor())||void 0===t?void 0:t.TEXTAREA}focusOnHighlightedCell(t){let e=t=>{var e,r;let i=null===(e=h(this,g).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!i)return;let n=h(this,g).runHooks("modifyFocusedElement",i.row,i.col,t);n instanceof HTMLElement||(n=t),n&&!(null!==(r=h(this,g).getActiveEditor())&&void 0!==r&&r.isOpened())&&n.focus({preventScroll:!0})};t?e(t):u(this,b,R).call(this,t=>e(t))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h(this,m),r=this.getRefocusElement();h(this,g).getSettings().imeFastEdit&&!(null!==(t=h(this,g).getActiveEditor())&&void 0!==t&&t.isOpened())&&r&&(h(this,y).has(e)||h(this,y).set(e,(0,o.Ds)(()=>{r.select()},e)),h(this,y).get(e)())}}function R(t){var e;let r=null===(e=h(this,g).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!r||!h(this,g).selection.isCellVisible(r)){t(null);return}let i=h(this,g).getCell(r.row,r.col,!0);null===i?h(this,g).addHookOnce("afterScroll",()=>{t(h(this,g).getCell(r.row,r.col,!0))}):t(i)}function O(){u(this,b,R).call(this,t=>{let{activeElement:e}=h(this,g).rootDocument;e&&(0,n.pV)(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function M(){u(this,b,R).call(this,t=>{this.getFocusMode()===f.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()})}function I(t){t.imeFastEdit&&this.getFocusMode()!==f.MIXED?this.setFocusMode(f.MIXED):t.imeFastEdit||this.getFocusMode()===f.CELL||this.setFocusMode(f.CELL)}},8200:function(t,e,r){"use strict";r.d(e,{Ak:function(){return k},Ct:function(){return a},JV:function(){return M},Ng:function(){return u},Pn:function(){return x},Pp:function(){return m},QK:function(){return w},Qk:function(){return i},Qz:function(){return s},Rn:function(){return o},Wv:function(){return T},a2:function(){return E},a6:function(){return f},cV:function(){return y},d5:function(){return R},f3:function(){return h},fv:function(){return S},gw:function(){return b},iJ:function(){return p},iL:function(){return l},nO:function(){return n},qt:function(){return C},rQ:function(){return d},tm:function(){return c},w1:function(){return N},wt:function(){return g},yz:function(){return O},zR:function(){return I}});let i=t=>["tabindex",t],n=()=>["role","treegrid"],o=()=>["role","presentation"],s=()=>["role","gridcell"],l=()=>["role","rowheader"],a=()=>["role","rowgroup"],u=()=>["role","columnheader"],h=()=>["role","row"],c=()=>["role","menu"],d=()=>["role","menuitem"],f=()=>["role","listbox"],g=()=>["role","checkbox"],p=()=>["scope","col"],m=()=>["scope","row"],w=t=>["aria-label",t],y=()=>["aria-hidden","true"],b=()=>["aria-disabled","true"],C=()=>["aria-multiselectable","true"],S=t=>["aria-haspopup",t],E=t=>["aria-rowcount",t],T=t=>["aria-colcount",t],R=t=>["aria-rowindex",t],O=t=>["aria-colindex",t],M=t=>["aria-expanded",t],I=()=>["aria-readonly","true"],N=()=>["aria-invalid","true"],x=t=>["aria-checked",t],k=()=>["aria-selected","true"]},9440:function(t,e,r){"use strict";function i(t){let e=t.length,r=0;for(;r<e;)t[r]=[t[r]],r+=1}function n(t,e){let r=e.length,i=0;for(;i<r;)t.push(e[i]),i+=1}function o(t){let e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;let r=t.length,i=t[0].length;for(let n=0;n<r;n++)for(let r=0;r<i;r++)e[r]||(e[r]=[]),e[r][n]=t[n][r];return e}function s(t,e,r,i){let n=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));let l=o.length;for(i&&l&&(n+=1,s=o[n]),n+=1;n<l;)s=e(s,o[n],n,o),n+=1;return s}function l(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));let n=i.length,o=[],s=-1;for(;r<n;){let t=i[r];e(t,r,i)&&(o[s+=1]=t),r+=1}return o}function a(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));let n=i.length,o=[],s=-1;for(;r<n;){let t=i[r];o[s+=1]=e(t,r,i),r+=1}return o}function u(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));let n=i.length;for(;r<n&&!1!==e(i[r],r,i);)r+=1;return t}function h(t){let e=[];return u(t,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function c(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];let[i,...n]=[...e],o=i;return u(n,t=>{o=o.filter(e=>!t.includes(e))}),o}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}r.d(e,{Bk:function(){return u},PI:function(){return i},Sc:function(){return a},W7:function(){return d},g9:function(){return n},jz:function(){return o},k$:function(){return s},o0:function(){return c},uW:function(){return h},w7:function(){return l}}),r(2916)},2228:function(t,e,r){"use strict";r.d(e,{E6:function(){return u},G6:function(){return d},K1:function(){return g},L:function(){return m},eE:function(){return y},gn:function(){return p},i7:function(){return a},iF:function(){return c},uM:function(){return w},un:function(){return f},vU:function(){return h}});var i=r(9488),n=r(973);let o=t=>{let e={value:!1};return e.test=(r,i)=>{e.value=t(r,i)},e},s={chrome:o((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:o(t=>/CriOS/.test(t)),edge:o(t=>/Edge/.test(t)),edgeWebKit:o(t=>/EdgiOS/.test(t)),firefox:o(t=>/Firefox/.test(t)),firefoxWebKit:o(t=>/FxiOS/.test(t)),mobile:o(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:o((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},l={mac:o(t=>/^Mac/.test(t)),win:o(t=>/^Win/.test(t)),linux:o(t=>/^Linux/.test(t)),ios:o(t=>/iPhone|iPad|iPod/i.test(t))};function a(){return s.chrome.value}function u(){return s.chromeWebKit.value}function h(){return s.firefox.value}function c(){return s.firefoxWebKit.value}function d(){return s.safari.value}function f(){return s.edge.value}function g(){return s.mobile.value}function p(){return l.ios.value}function m(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&l.mac.value}function w(){return l.win.value}function y(){return l.mac.value}(0,n.o6)()&&(!function(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i._l)(s,r=>{let{test:i}=r;i(t,e)})}(),function(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i._l)(l,e=>{let{test:r}=e;r(t)})}())},4748:function(t,e,r){"use strict";r.d(e,{ZK:function(){return n},vU:function(){return o}});var i=r(2518);function n(){(0,i.$K)(console)&&console.warn(...arguments)}function o(){(0,i.$K)(console)&&console.error(...arguments)}},7628:function(t,e,r){"use strict";r.d(e,{Eb:function(){return s},Yl:function(){return n},ec:function(){return o}}),r(2916);var i=r(9488);function n(t){let e,r=t+1,i="";for(;r>0;)i=String.fromCharCode(65+(e=(r-1)%26))+i,r=parseInt((r-e)/26,10);return i}function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t,i=[];return Array.isArray(t)&&Array.isArray(t[0])||(r=[t]),r.forEach((t,r)=>{Array.isArray(t)?t.forEach((t,n)=>{i.push([r+e,n,t])}):Object.keys(t).forEach(n=>{i.push([r+e,n,t[n]])})}),i}function s(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&(0,i.Kn)(t[0])&&(e=(0,i.Q8)(t[0]))),e}},5878:function(t,e,r){"use strict";let i;r.d(e,{$g:function(){return H},AQ:function(){return M},C2:function(){return _},DZ:function(){return I},Dx:function(){return A},G_:function(){return s},I2:function(){return z},IV:function(){return y},Kz:function(){return d},MO:function(){return c},Mq:function(){return V},P$:function(){return b},Pb:function(){return P},TT:function(){return Y},W6:function(){return h},WH:function(){return G},WS:function(){return D},Wu:function(){return function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){let r=e.childNodes;for(let e=r.length-1;e>=0;e--)t(r[e])}}},a7:function(){return W},cS:function(){return S},cn:function(){return w},cv:function(){return O},cx:function(){return N},d$:function(){return C},dD:function(){return k},do:function(){return U},f5:function(){return a},iO:function(){return L},l2:function(){return q},lq:function(){return Q},mK:function(){return f},np:function(){return j},oq:function(){return u},pV:function(){return X},pn:function(){return function t(e){let r=e.ownerDocument.documentElement,i=e;for(;i!==r;){if(null===i)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!i.host)return!1;if(i.host.impl)return t(i.host.impl);if(i.host)return t(i.host);throw Error("Lost in Web Components world")}if("none"===A(i).display)return!1;i=i.parentNode}return!0}},pv:function(){return m},qK:function(){return F},tT:function(){return R},u7:function(){return K},uS:function(){return T},vj:function(){return x},vw:function(){return $},x9:function(){return B},yY:function(){return Z},yv:function(){return l}}),r(2916),r(2954);var n=r(6411),o=r(8200);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,i=null,n=t;for(;null!==n;){if(r===e){i=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(r+=1,n=n.parentNode)}return i}function l(t,e){let r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function a(t){return Object.getPrototypeOf(t.parent)&&t.frameElement&&t.parent}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:n}=Node,o=t;for(;null!=o&&o!==r;){let{nodeType:t,nodeName:r}=o;if(t===i&&(e.includes(r)||e.includes(o)))return o;let{host:s}=o;o=s&&t===n?s:o.parentNode}return null}function h(t,e,r){let i=[],n=t;for(;n&&(n=u(n,e,r))&&(!r||r.contains(n));)i.push(n),n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode;let o=i.length;return o?i[o-1]:null}function c(t,e){let r=t.parentNode,i=[];for("string"==typeof e?i=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);null!==r;){if(i.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function d(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function f(t,e,r){let i=r.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function g(t){return t&&t.length?t.filter(t=>!!t):[]}function p(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let r=[],i=[];return i.push(...t.filter(t=>{let i=t instanceof RegExp;return i&&e&&r.push(t),!i})),e?{regexFree:i,regexes:r}:i}function m(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function w(t,e){"string"==typeof e&&(e=e.split(" ")),(e=g(e)).length>0&&t.classList.add(...e)}function y(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:i}=p(e,!0);(r=g(r)).length>0&&t.classList.remove(...r),i.forEach(e=>{t.classList.forEach(r=>{e.test(r)&&t.classList.remove(r)})})}function b(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:i}=p(e,!0);r.forEach(e=>{""!==e&&t.removeAttribute(e)}),i.forEach(e=>{t.getAttributeNames().forEach(r=>{e.test(r)&&t.removeAttribute(r)})})}function S(t){let e;for(;e=t.lastChild;)t.removeChild(e)}let E=/(<(.*)>|&(.*);)/;function T(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];E.test(e)?t.innerHTML=r?(0,n.Nw)(e):e:R(t,e)}function R(t,e){let r=t.firstChild;r&&3===r.nodeType&&null===r.nextSibling?r.textContent=e:(S(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function O(t){let e,r,i;let n=t.ownerDocument,o=n.defaultView,s=n.documentElement,l=t;for(e=l.offsetLeft,r=l.offsetTop,i=l;(l=l.offsetParent)&&l!==n.body&&("offsetLeft"in l);)e+=l.offsetLeft,r+=l.offsetTop,i=l;return i&&"fixed"===i.style.position&&(e+=o.pageXOffset||s.scrollLeft,r+=o.pageYOffset||s.scrollTop),{left:e,top:r}}function M(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function I(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function N(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?M(e):t.scrollTop}function x(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?I(e):t.scrollLeft}function k(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(r=(e=t.document?t.document:t).defaultView);let i=["auto","scroll"],n=t.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:t,overflowX:e,overflowY:o}=n.style;if([t,e,o].includes("scroll")||({overflow:t,overflowX:e,overflowY:o}=r.getComputedStyle(n),i.includes(t)||i.includes(e)||i.includes(o))||n.clientHeight<=n.scrollHeight+1&&(i.includes(o)||i.includes(t))||n.clientWidth<=n.scrollWidth+1&&(i.includes(e)||i.includes(t)))return n;n=n.parentNode}return r}function H(t){let e=t.ownerDocument,r=e.defaultView,i=t.parentNode;for(;i&&i.style&&e.body!==i;){if("visible"!==i.style.overflow&&""!==i.style.overflow)return i;let t=A(i,r),e=["scroll","hidden","auto"],n=t.getPropertyValue("overflow"),o=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(n)||e.includes(o)||e.includes(s))return i;i=i.parentNode}return r}function _(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===r)return"width"===e?`${r.innerWidth}px`:"height"===e?`${r.innerHeight}px`:void 0;let i=t.style[e];if(""!==i&&void 0!==i)return i;let n=A(t,r);if(""!==n[e]&&void 0!==n[e])return n[e]}function A(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function L(t){return t.offsetWidth}function P(t){return t.offsetHeight}function D(t){return t.clientHeight||t.innerHeight}function B(t){return t.clientWidth||t.innerWidth}function F(t){return t.selectionStart?t.selectionStart:0}function W(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function V(t,e,r){if(void 0===r&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch(o){let i=t.parentNode,n=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=n}}}function j(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===i&&(i=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);let i=e.offsetWidth;r.style.overflow="scroll";let n=e.offsetWidth;return i===n&&(n=r.clientWidth),(t.body||t.documentElement).removeChild(r),i-n}(t)),i}function U(t){return t.offsetWidth!==t.clientWidth}function $(t){return t.offsetHeight!==t.clientHeight}function z(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function G(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function K(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function X(t){return K(t)&&!1===t.hasAttribute("data-hot-input")}function Y(t,e){let r=new IntersectionObserver((r,i)=>{r.forEach(r=>{r.isIntersecting&&null!==t.offsetParent&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body});r.observe(t)}function q(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.ownerDocument,n=i.createRange(),s=i.defaultView.getSelection();b(t,"contenteditable",!0),r&&b(t,...(0,o.cV)()),e&&w(t,"invisibleSelection"),n.selectNodeContents(t),s.removeAllRanges(),s.addRange(n)}function Z(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&y(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Q(t,e){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];q(t,r),e(),Z(t,r)}},7687:function(t,e,r){"use strict";function i(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function n(t){return!1===t.isImmediatePropagationEnabled}function o(t){return 2===t.button}function s(t){return 0===t.button}r.d(e,{Ty:function(){return n},dO:function(){return o},mM:function(){return i},pW:function(){return s}})},973:function(t,e,r){"use strict";let i;function n(t){return window.requestAnimationFrame(t)}function o(t){window.cancelAnimationFrame(t)}function s(){return"ontouchstart"in window}function l(){return"undefined"!=typeof window}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i||(i="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1)}r.d(e,{JS:function(){return s},U7:function(){return n},Wx:function(){return o},o6:function(){return l},sx:function(){return a}})},8179:function(t,e,r){"use strict";r.d(e,{$Z:function(){return a},Ds:function(){return o},WA:function(){return l},mf:function(){return n},r$:function(){return s}});var i=r(2518);function n(t){return"function"==typeof t}function o(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=null;return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return i&&clearTimeout(i),i=setTimeout(()=>{e=t.apply(this,o)},r),e}}function s(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.apply(this,r.concat(i))}}function l(t){let e=t.length;return function r(i){return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];let l=i.concat(o);return l.length>=e?t.apply(this,l):r(l)}}([])}function a(t,e,r,n,o,s,l,a){return(0,i.$K)(a)?t.call(e,r,n,o,s,l,a):(0,i.$K)(l)?t.call(e,r,n,o,s,l):(0,i.$K)(s)?t.call(e,r,n,o,s):(0,i.$K)(o)?t.call(e,r,n,o):(0,i.$K)(n)?t.call(e,r,n):(0,i.$K)(r)?t.call(e,r):t.call(e)}},2518:function(t,e,r){"use strict";r.d(e,{$K:function(){return s},Kj:function(){return u},Pz:function(){return o},ge:function(){return S},o8:function(){return l},xb:function(){return a}});var i=r(2067),n=r(2836);function o(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function s(t){return void 0!==t}function l(t){return void 0===t}function a(t){return null===t||""===t||l(t)}function u(t){return"[object RegExp]"===Object.prototype.toString.call(t)}let h="length",c=t=>parseInt(t,16),d=t=>parseInt(t,10),f=(t,e,r)=>t.substr(e,r),g=t=>t.codePointAt(0)-65,p=t=>`${t}`.replace(/\-/g,""),m=t=>c(f(p(t),c("12"),g("F")))/(c(f(p(t),g("B"),~~![][h]))||9),w=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),y=!1,b={invalid:()=>n.e`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return n.e`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>n.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C={invalid:()=>n.e`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return n.e`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>n.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function S(t,e){let r;let n=!a(t),o="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),s="14.1.0",l="invalid",u="invalid";t=p(t||"");let S=function(t){let e=[][h],r=e;if(t[h]!==g("Z"))return!1;for(let e="",i="B<H4P+".split(""),n=g(i.shift());n;n=g(i.shift()||"A"))--n<""[h]?r|=(d(`${d(c(e)+(c(f(t,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:e=f(t,n,n?1===i[h]?9:8:6);return r===e}(t);if(n||o||S){if(S){let e=i("16/01/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),o=m(t);r=i((o+1)*864e5,"x").format("MMMM DD, YYYY"),n>o?(l="expired",u="expired"):(l="valid",u="valid")}else o?(l="non_commercial",u="valid"):(l="invalid",u="invalid")}else l="missing",u="missing";if(w()&&(l="valid",u="valid"),!y&&"valid"!==l){let t=b[l]({keyValidityDate:r,hotVersion:s});t&&console["non_commercial"===l?"info":"warn"](b[l]({keyValidityDate:r,hotVersion:s})),y=!0}if("valid"!==u&&e.parentNode){let t=C[u]({keyValidityDate:r,hotVersion:s});if(t){let t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=C[u]({keyValidityDate:r,hotVersion:s}),e.parentNode.insertBefore(t,e.nextSibling)}}}},7790:function(t,e,r){"use strict";function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=typeof t;if("number"===r)return!isNaN(t)&&isFinite(t);if("string"===r){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);let r=Array.from(new Set([".",...e])).map(t=>`\\${t}`).join("|");return RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===r&&!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date)}function n(t){return i(t,[","])}function o(t,e,r){let i=-1;for("function"==typeof e?(r=e,e=t):i=t-1;++i<=e&&!1!==r(i););}function s(t,e,r){let i=t+1;for("function"==typeof e&&(r=e,e=0);--i>=e&&!1!==r(i););}function l(t,e){return parseInt(t*(e=isNaN(e=parseInt(e.toString().replace("%",""),10))?0:e)/100,10)}function a(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}r.d(e,{N1:function(){return l},TR:function(){return n},kE:function(){return i},q4:function(){return o},uZ:function(){return a},yh:function(){return s}})},9488:function(t,e,r){"use strict";r.d(e,{$s:function(){return f},ED:function(){return n},Hn:function(){return g},I8:function(){return s},Kn:function(){return h},Q8:function(){return p},Z1:function(){return u},ZB:function(){return function t(e,r){d(r,(i,n)=>{r[n]&&"object"==typeof r[n]?(e[n]||(Array.isArray(r[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(r[n])?e[n]=r[n]:e[n]={}),t(e[n],r[n])):e[n]=r[n]})}},_l:function(){return d},d9:function(){return l},ie:function(){return function t(e){let r;return Array.isArray(e)?r=e.length?Array(e.length).fill(null):[]:(r={},d(e,(e,i)=>{"__children"!==i&&(e&&"object"==typeof e&&!Array.isArray(e)?r[i]=t(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?r[i]=[t(e[0])]:r[i]=[]:r[i]=null)})),r}},jB:function(){return a},jW:function(){return c},l7:function(){return o},nr:function(){return w},sm:function(){return m}}),r(7277),r(2916),r(2954);var i=r(9440);function n(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function o(t,e,r){let i=Array.isArray(r);return d(e,(e,n)=>{(!1===i||r.includes(n))&&(t[n]=e)}),t}function s(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function l(t){let e={};return d(t,(t,r)=>{e[r]=t}),e}function a(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return(0,i.Bk)(r,e=>{t.MIXINS.push(e.MIXIN_NAME),d(e,(e,r)=>{if(void 0!==t.prototype[r])throw Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);"function"==typeof e?t.prototype[r]=e:Object.defineProperty(t.prototype,r,{get:function(t,e){let r=`_${t}`,i=t=>{let e=t;return(Array.isArray(e)||h(e))&&(e=s(e)),e};return function(){return void 0===this[r]&&(this[r]=i(e)),this[r]}}(r,e),set:function(t){let e=`_${t}`;return function(t){this[e]=t}}(r),configurable:!0})})}),t}function u(t,e){return JSON.stringify(t)===JSON.stringify(e)}function h(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t,e,r,i){i.value=r,i.writable=!1!==i.writable,i.enumerable=!1!==i.enumerable,i.configurable=!1!==i.configurable,Object.defineProperty(t,e,i)}function d(t,e){for(let r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&!1===e(t[r],r,t))break;return t}function f(t,e){let r=e.split("."),i=t;return d(r,t=>{if(void 0===(i=i[t]))return i=void 0,!1}),i}function g(t,e,r){let i=e.split("."),n=t;i.forEach((t,e)=>{e!==i.length-1?(w(n,t)||(n[t]={}),n=n[t]):n[t]=r})}function p(t){if(!h(t))return 0;let e=function(t){let r=0;return h(t)?d(t,(t,i)=>{"__children"!==i&&(r+=e(t))}):r+=1,r};return e(t)}function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r=`_${e}`,i={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[r]},set(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),i}function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},6411:function(t,e,r){"use strict";r.d(e,{Nw:function(){return a},O1:function(){return o},ct:function(){return n},ng:function(){return l},wK:function(){return s}}),r(2916);var i=r(3571);function n(t){return t[0].toUpperCase()+t.substr(1)}function o(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function s(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,r)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[r]?"":e[r])}function a(t,e){return i.sanitize(t,e)}},2836:function(t,e,r){"use strict";r.d(e,{e:function(){return n}});var i=r(9440);function n(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];let o=(0,i.k$)(t,(t,e,i)=>{let n=e.replace(/\r?\n\s*/g,""),o=r[i]?r[i]:"";return t+n+o},"");return o.trim()}},6678:function(t,e,r){"use strict";r.d(e,{DC:function(){return l},T2:function(){return a},ot:function(){return u}}),r(2916);var i=r(9440),n=r(2228);let o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,n.vU)()?182:174,AUDIO_MUTE:(0,n.vU)()?181:173,AUDIO_UP:(0,n.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function l(t){return s.includes(t)}function a(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function u(t,e){let r=e.split("|"),n=!1;return(0,i.Bk)(r,e=>{if(t===o[e])return n=!0,!1}),n}},2855:function(t,e,r){"use strict";r.r(e),r.d(e,{CHECKBOX_CHECKED:function(){return tk},CHECKBOX_RENDERER_NAMESPACE:function(){return tx},CHECKBOX_UNCHECKED:function(){return tH},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return R},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return N},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return P},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return k},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return _},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return x},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return L},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return H},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return A},CONTEXTMENU_ITEMS_BORDERS:function(){return D},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return W},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return V},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return F},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return B},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return g},CONTEXTMENU_ITEMS_COPY:function(){return p},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return y},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return w},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return m},CONTEXTMENU_ITEMS_CUT:function(){return b},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return O},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return C},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return z},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return K},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return l},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return a},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return E},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return $},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return U},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return n},CONTEXTMENU_ITEMS_READ_ONLY:function(){return f},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return I},CONTEXTMENU_ITEMS_REDO:function(){return d},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return j},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return h},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return M},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return u},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return o},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return s},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return G},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return X},CONTEXTMENU_ITEMS_UNDO:function(){return c},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return S},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return T},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return i},FILTERS_BUTTONS_CANCEL:function(){return tO},FILTERS_BUTTONS_CLEAR:function(){return tT},FILTERS_BUTTONS_OK:function(){return tR},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return tM},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return tN},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return tI},FILTERS_BUTTONS_SELECT_ALL:function(){return tE},FILTERS_CONDITIONS_AFTER:function(){return tf},FILTERS_CONDITIONS_BEFORE:function(){return tg},FILTERS_CONDITIONS_BEGINS_WITH:function(){return tr},FILTERS_CONDITIONS_BETWEEN:function(){return tc},FILTERS_CONDITIONS_BY_VALUE:function(){return ts},FILTERS_CONDITIONS_CONTAINS:function(){return tn},FILTERS_CONDITIONS_EMPTY:function(){return Q},FILTERS_CONDITIONS_ENDS_WITH:function(){return ti},FILTERS_CONDITIONS_EQUAL:function(){return tt},FILTERS_CONDITIONS_GREATER_THAN:function(){return tl},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return ta},FILTERS_CONDITIONS_LESS_THAN:function(){return tu},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return th},FILTERS_CONDITIONS_NAMESPACE:function(){return q},FILTERS_CONDITIONS_NONE:function(){return Z},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return td},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return to},FILTERS_CONDITIONS_NOT_EMPTY:function(){return J},FILTERS_CONDITIONS_NOT_EQUAL:function(){return te},FILTERS_CONDITIONS_TODAY:function(){return tp},FILTERS_CONDITIONS_TOMORROW:function(){return tm},FILTERS_CONDITIONS_YESTERDAY:function(){return tv},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return tw},FILTERS_DIVS_FILTER_BY_VALUE:function(){return ty},FILTERS_LABELS_CONJUNCTION:function(){return tb},FILTERS_LABELS_DISJUNCTION:function(){return tC},FILTERS_NAMESPACE:function(){return Y},FILTERS_VALUES_BLANK_CELLS:function(){return tS}});let i="ContextMenu:items",n=`${i}.noItems`,o=`${i}.insertRowAbove`,s=`${i}.insertRowBelow`,l=`${i}.insertColumnOnTheLeft`,a=`${i}.insertColumnOnTheRight`,u=`${i}.removeRow`,h=`${i}.removeColumn`,c=`${i}.undo`,d=`${i}.redo`,f=`${i}.readOnly`,g=`${i}.clearColumn`,p=`${i}.copy`,m=`${i}.copyWithHeaders`,w=`${i}.copyWithGroupHeaders`,y=`${i}.copyHeadersOnly`,b=`${i}.cut`,C=`${i}.freezeColumn`,S=`${i}.unfreezeColumn`,E=`${i}.mergeCells`,T=`${i}.unmergeCells`,R=`${i}.addComment`,O=`${i}.editComment`,M=`${i}.removeComment`,I=`${i}.readOnlyComment`,N=`${i}.align`,x=`${i}.align.left`,k=`${i}.align.center`,H=`${i}.align.right`,_=`${i}.align.justify`,A=`${i}.align.top`,L=`${i}.align.middle`,P=`${i}.align.bottom`,D=`${i}.borders`,B=`${i}.borders.top`,F=`${i}.borders.right`,W=`${i}.borders.bottom`,V=`${i}.borders.left`,j=`${i}.borders.remove`,U=`${i}.nestedHeaders.insertChildRow`,$=`${i}.nestedHeaders.detachFromParent`,z=`${i}.hideColumn`,G=`${i}.showColumn`,K=`${i}.hideRow`,X=`${i}.showRow`,Y="Filters:",q=`${Y}conditions`,Z=`${q}.none`,Q=`${q}.isEmpty`,J=`${q}.isNotEmpty`,tt=`${q}.isEqualTo`,te=`${q}.isNotEqualTo`,tr=`${q}.beginsWith`,ti=`${q}.endsWith`,tn=`${q}.contains`,to=`${q}.doesNotContain`,ts=`${q}.byValue`,tl=`${q}.greaterThan`,ta=`${q}.greaterThanOrEqualTo`,tu=`${q}.lessThan`,th=`${q}.lessThanOrEqualTo`,tc=`${q}.isBetween`,td=`${q}.isNotBetween`,tf=`${q}.after`,tg=`${q}.before`,tp=`${q}.today`,tm=`${q}.tomorrow`,tv=`${q}.yesterday`,tw=`${Y}labels.filterByCondition`,ty=`${Y}labels.filterByValue`,tb=`${Y}labels.conjunction`,tC=`${Y}labels.disjunction`,tS=`${Y}values.blankCells`,tE=`${Y}buttons.selectAll`,tT=`${Y}buttons.clear`,tR=`${Y}buttons.ok`,tO=`${Y}buttons.cancel`,tM=`${Y}buttons.placeholder.search`,tI=`${Y}buttons.placeholder.value`,tN=`${Y}buttons.placeholder.secondValue`,tx="CheckboxRenderer:",tk=`${tx}checked`,tH=`${tx}unchecked`},8444:function(t,e,r){"use strict";r.r(e),r.d(e,{DEFAULT_LANGUAGE_CODE:function(){return f},dictionaryKeys:function(){return d},getDefaultLanguageDictionary:function(){return S},getLanguageDictionary:function(){return b},getLanguagesDictionaries:function(){return E},getTranslatedPhrase:function(){return T},getValidLanguageCode:function(){return R},hasLanguageDictionary:function(){return C},registerLanguageDictionary:function(){return y}});var i=r(9488),n=r(9440),o=r(2518),s=r(1870),l=r(2656);let{register:a,getValues:u}=(0,l.Z)("phraseFormatters");a("pluralize",function(t,e){let r=Array.isArray(t)&&Number.isInteger(e);return r?t[e]:t});var h=r(2855);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */let c={languageCode:"en-US",[h.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[h.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[h.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[h.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[h.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[h.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[h.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[h.CONTEXTMENU_ITEMS_UNDO]:"Undo",[h.CONTEXTMENU_ITEMS_REDO]:"Redo",[h.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[h.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[h.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[h.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[h.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[h.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[h.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[h.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[h.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[h.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[h.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[h.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[h.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[h.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[h.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[h.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[h.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[h.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[h.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[h.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[h.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[h.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[h.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[h.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[h.CONTEXTMENU_ITEMS_COPY]:"Copy",[h.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[h.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[h.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[h.CONTEXTMENU_ITEMS_CUT]:"Cut",[h.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[h.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[h.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[h.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[h.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[h.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[h.FILTERS_CONDITIONS_NONE]:"None",[h.FILTERS_CONDITIONS_EMPTY]:"Is empty",[h.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[h.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[h.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[h.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[h.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[h.FILTERS_CONDITIONS_CONTAINS]:"Contains",[h.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[h.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[h.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[h.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[h.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[h.FILTERS_CONDITIONS_BETWEEN]:"Is between",[h.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[h.FILTERS_CONDITIONS_AFTER]:"After",[h.FILTERS_CONDITIONS_BEFORE]:"Before",[h.FILTERS_CONDITIONS_TODAY]:"Today",[h.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[h.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[h.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[h.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[h.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[h.FILTERS_LABELS_CONJUNCTION]:"And",[h.FILTERS_LABELS_DISJUNCTION]:"Or",[h.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[h.FILTERS_BUTTONS_CLEAR]:"Clear",[h.FILTERS_BUTTONS_OK]:"OK",[h.FILTERS_BUTTONS_CANCEL]:"Cancel",[h.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[h.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[h.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[h.CHECKBOX_CHECKED]:"Checked",[h.CHECKBOX_UNCHECKED]:"Unchecked"},d=h,f=c.languageCode,{register:g,getItem:p,hasItem:m,getValues:w}=(0,l.Z)("languagesDictionaries");function y(t,e){var r,n;let o=t,l=e;return(0,i.Kn)(t)&&(o=(l=t).languageCode),r=o,n=l,r!==f&&(0,s.eb)(n,p(f)),g(o,(0,i.I8)(l)),(0,i.I8)(l)}function b(t){return m(t)?(0,i.I8)(p(t)):null}function C(t){return m(t)}function S(){return c}function E(){return w()}function T(t,e,r){let i;let s=b(t);if(null===s)return null;let l=s[e];if((0,o.o8)(l))return null;let a=(i=l,(0,n.Bk)(u(),t=>{i=t(l,r)}),i);return Array.isArray(a)?a[0]:a}function R(t){let e=(0,s.TH)(t);return m(e)||(e=f,(0,s.Vn)(t)),e}y(c)},1870:function(t,e,r){"use strict";r.d(e,{TH:function(){return a},Vn:function(){return u},eb:function(){return l}});var i=r(2518),n=r(9488),o=r(4748),s=r(2836);function l(t,e){return(0,n._l)(e,(e,r)=>{(0,i.o8)(t[r])&&(t[r]=e)}),t}function a(t){let e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function u(t){(0,i.$K)(t)&&(0,o.vU)(s.e`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}},3437:function(t,e,r){"use strict";r(2916);var i=r(9488),n=r(8179);let o={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,i,o,s,l){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let u=0;u<a;u++)(0,n.$Z)(this._localHooks[t][u],this,e,r,i,o,s,l)}},clearLocalHooks(){return this._localHooks={},this}};(0,i.jW)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.Z=o},4317:function(t,e,r){"use strict";r.r(e),r(2916),r(2954);var i=r(9440),n=r(9488),o=r(6411),s=r(4748),l=r(2836),a=r(8179);let u=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],h=l.e`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,c=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),d=new Map([[]]);class f{static getSingleton(){return g}constructor(){var t,e,r;e=void 0,(t="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="globalBucket","string"))?r:String(r))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let t=Object.create(null);return(0,i.Bk)(u,e=>t[e]=[]),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))(0,i.Bk)(e,e=>this.add(t,e,r));else{c.has(t)&&(0,s.ZK)((0,o.ng)(h,{hookName:t,removedInVersion:c.get(t)})),d.has(t)&&(0,s.ZK)(d.get(t));let n=this.getBucket(r);if(void 0===n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let r=!1;e.initialHook&&(0,i.Bk)(n[t],(i,o)=>{if(i.initialHook)return n[t][o]=e,r=!0,!1}),r||n[t].push(e)}}return this}once(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,i.Bk)(e,e=>this.once(t,e,r)):(e.runOnce=!0,this.add(t,e,r))}remove(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.getBucket(r);return!!(void 0!==i[t]&&i[t].indexOf(e)>=0)&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getBucket(e);return!!(void 0!==r[t]&&r[t].length)}run(t,e,r,i,n,o,s,l){{let u=this.globalBucket[e],h=u?u.length:0,c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}let h=(0,a.$Z)(u[c],t,r,i,n,o,s,l);void 0!==h&&(r=h),u[c]&&u[c].runOnce&&this.remove(e,u[c]),c+=1}}{let u=this.getBucket(t)[e],h=u?u.length:0,c=0;if(h)for(;c<h;){if(!u[c]||u[c].skip){c+=1;continue}let h=(0,a.$Z)(u[c],t,r,i,n,o,s,l);void 0!==h&&(r=h),u[c]&&u[c].runOnce&&this.remove(e,u[c],t),c+=1}}return r}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,n._l)(this.getBucket(t),(t,e,r)=>r[e].length=0)}register(t){this.isRegistered(t)||u.push(t)}deregister(t){this.isRegistered(t)&&u.splice(u.indexOf(t),1)}isDeprecated(t){return d.has(t)||c.has(t)}isRegistered(t){return u.indexOf(t)>=0}getRegistered(){return u}}let g=new f;e.default=f},5915:function(t,e,r){"use strict";r.d(e,{s3:function(){return m},a9:function(){return p},_j:function(){return w},fo:function(){return y}}),r(2954);var i=r(6411),n=r(7790),o=r(8179);let s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),l=t=>`The priority '${t}' is already declared in a map.`,a=t=>`The priority '${t}' is not a number.`;var u=r(2488);let h=t=>`'${t}' value is already declared in a unique set.`,c=t=>`There is already registered "${t}" plugin.`,d=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new Map;return t=(0,o.mf)(t)?t:l,e=(0,o.mf)(e)?e:a,{addItem:function(i,o){if(!(0,n.kE)(i))throw Error(e(i));if(r.has(i))throw Error(t(i));r.set(i,o)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[e,i]=s.get(t)||s.get("asc");return[...r].sort((t,r)=>t[0]<r[0]?e:i).map(t=>t[1])}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),f=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Set;return t=(0,o.mf)(t)?t:h,{addItem:function(r){if(e.has(r))throw Error(t(r));e.add(r)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:c}),g=(0,u.I)({errorIdExists:c});function p(){return[...d.getItems(),...f.getItems()]}function m(t){let e=(0,i.ct)(t);return g.getItem(e)}function w(t){return!!m(t)}function y(t,e,r){var n,o,s;[t,e,r]=(n=t,o=e,s=r,"function"==typeof n&&(n=(o=n).PLUGIN_KEY,s=o.PLUGIN_PRIORITY),[n,o,s]),void 0===m(t)&&function(t,e,r){let n=(0,i.ct)(t);if(g.hasItem(n))throw Error(c(n));void 0===r?f.addItem(n):d.addItem(r,n),g.addItem(n,e)}(t,e,r)}},1881:function(t,e,r){"use strict";r.d(e,{Z:function(){return o}}),r(2916);var i=r(5878),n=r(8200);function o(t,e,r,o,s,l,a){let u=a.ariaTags,h=[],c=[],d=[],f=[];a.className&&(0,i.cn)(e,a.className),a.readOnly?(h.push(a.readOnlyCellClassName),u&&f.push((0,n.zR)())):u&&d.push((0,n.zR)()[0]),!1===a.valid&&a.invalidCellClassName?(h.push(a.invalidCellClassName),u&&f.push((0,n.w1)())):(c.push(a.invalidCellClassName),u&&d.push((0,n.w1)()[0])),!1===a.wordWrap&&a.noWordWrapClassName&&h.push(a.noWordWrapClassName),!l&&a.placeholder&&h.push(a.placeholderCellClassName),(0,i.IV)(e,c),(0,i.cn)(e,h),(0,i.d$)(e,d),(0,i.P$)(e,f)}o.RENDERER_TYPE="base"},6903:function(t,e,r){"use strict";r.d(e,{Bp:function(){return u},Y3:function(){return s},zn:function(){return h}}),r(2954);var i=r(2656);let{register:n,getItem:o,hasItem:s,getNames:l,getValues:a}=(0,i.Z)("renderers");function u(t){if("function"==typeof t)return t;if(!s(t))throw Error(`No registered renderer found under "${t}" name`);return o(t)}function h(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),n(t,e)}},9275:function(t,e,r){"use strict";r.d(e,{V:function(){return s}});var i=r(1881),n=r(5878),o=r(2518);function s(t,e,r,s,l,a,u){i.Z.apply(this,[t,e,r,s,l,a,u]);let h=a;if(!h&&u.placeholder&&(h=u.placeholder),h=(0,o.Pz)(h),u.trimWhitespace&&(h=h.trim()),u.rendererTemplate){(0,n.cS)(e);let i=t.rootDocument.createElement("TEMPLATE");i.setAttribute("bind","{{}}"),i.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(i),i.model=t.getSourceDataAtRow(r),e.appendChild(i)}else(0,n.tT)(e,h)}s.RENDERER_TYPE="text"},641:function(t,e,r){"use strict";let i,n;r.d(e,{Z:function(){return tr}}),r(2954),r(2916);var o=r(8352),s=r(7682);class l extends s.Z{constructor(t,e){var r,i;super(t,null),(r="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(r="visualCellRange","string"))?i:String(i))in this?Object.defineProperty(this,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[r]=null,this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:r}=t,i=this.getNearestNotHiddenCoords(e,1),n=this.getNearestNotHiddenCoords(r,-1);return null===i||null===n?null:((i.row>n.row||i.col>n.col)&&(i=e,n=r),this.settings.createCellRange(i,i,n))}getNearestNotHiddenCoords(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===i)return null;let n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,r);return null===n?null:this.settings.createCellCoords(i,n)}getNearestNotHiddenIndex(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}commit(){if(null===this.visualCellRange)return this;let t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===t?this.cellRange=null:this.cellRange=this.createRenderableCellRange(t.from,t.to),this}syncWith(t){let e=t.from.clone().normalize(),r="N-S"===t.getVerticalDirection()?1:-1,i="W-E"===t.getHorizontalDirection()?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),o=null;if((null===n||null===n.col||null===n.row)&&(o=this.getNearestNotHiddenCoords(e,r,i)),null!==o&&t.overlaps(o)){let e=t.highlight.clone();if(e.row>=0&&(e.row=o.row),e.col>=0&&(e.col=o.col),null===this.cellRange){let t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==n&&null===o&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){let t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){let r=this.settings.visualToRenderableCoords(t),i=this.settings.visualToRenderableCoords(e);return null===r.row||null===r.col||null===i.row||null===i.col?null:this.settings.createCellRange(r,r,i)}}function a(t){let{activeHeaderClassName:e,...r}=t;return new l({className:e,...r,selectionType:o.CD})}function u(t){let{areaCornerVisible:e,...r}=t;return new l({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:o.AI})}function h(t){let{...e}=t;return new l({className:"highlight",...e,selectionType:o.AI})}function c(t){let{columnClassName:e,...r}=t;return new l({className:e,...r,selectionType:o.BA})}var d=r(8200);function f(t){let{headerClassName:e,...r}=t;return new l({className:e,...r,selectionType:o.Nc})}function g(t){let{rowClassName:e,...r}=t;return new l({className:e,...r,selectionType:o.Os})}var p=r(9440);function m(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}var y=new WeakSet;i=Symbol.iterator;class b{constructor(t){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,y),y.add(this),m(this,"options",void 0),m(this,"layerLevel",0),m(this,"focus",void 0),m(this,"fill",void 0),m(this,"layeredAreas",new Map),m(this,"areas",new Map),m(this,"rowHeaders",new Map),m(this,"columnHeaders",new Map),m(this,"activeRowHeaders",new Map),m(this,"activeColumnHeaders",new Map),m(this,"activeCornerHeaders",new Map),m(this,"rowHighlights",new Map),m(this,"columnHighlights",new Map),m(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e,...r}=t;return new l({className:"current",headerAttributes:[(0,d.Ak)()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:o.t8})}(t),this.fill=function(t){let{...e}=t;return new l({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:o.P$})}(t)}isEnabledFor(t,e){let r=t;t===o.t8&&(r="current");let i=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof i&&(i=[i]),!1===i||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return w(this,y,C).call(this,this.layeredAreas,u)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return w(this,y,C).call(this,this.areas,h)}getAreas(){return[...this.areas.values()]}createRowHeader(){return w(this,y,C).call(this,this.rowHeaders,f)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return w(this,y,C).call(this,this.columnHeaders,f)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return w(this,y,C).call(this,this.activeRowHeaders,a)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return w(this,y,C).call(this,this.activeColumnHeaders,a)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return w(this,y,C).call(this,this.activeCornerHeaders,a)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return w(this,y,C).call(this,this.rowHighlights,g)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return w(this,y,C).call(this,this.columnHighlights,c)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:r,...i}=t;return new l({...e,...i,selectionType:o.$7},r)}({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),(0,p.Bk)(this.areas.values(),t=>void t.clear()),(0,p.Bk)(this.layeredAreas.values(),t=>void t.clear()),(0,p.Bk)(this.rowHeaders.values(),t=>void t.clear()),(0,p.Bk)(this.columnHeaders.values(),t=>void t.clear()),(0,p.Bk)(this.activeRowHeaders.values(),t=>void t.clear()),(0,p.Bk)(this.activeColumnHeaders.values(),t=>void t.clear()),(0,p.Bk)(this.activeCornerHeaders.values(),t=>void t.clear()),(0,p.Bk)(this.rowHighlights.values(),t=>void t.clear()),(0,p.Bk)(this.columnHighlights.values(),t=>void t.clear())}[i](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function C(t,e){let r=this.layerLevel;if(t.has(r))return t.get(r);let i=e({layerLevel:r,...this.options});return t.set(r,i),i}function S(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}n=Symbol.iterator;class E{constructor(t){S(this,"ranges",[]),S(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[n](){return this.ranges[Symbol.iterator]()}}var T=r(9488),R=r(2518),O=r(7790),M=r(3437);function I(t,e){x(t,e),e.add(t)}function N(t,e,r){x(t,e),e.set(t,r)}function x(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function k(t,e){var r=A(t,e,"get");return r.get?r.get.call(t):r.value}function H(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function _(t,e,r){var i=A(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function A(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var L=new WeakMap,P=new WeakMap,D=new WeakMap,B=new WeakSet,F=new WeakSet,W=new WeakSet,V=new WeakSet,j=new WeakSet;class U{constructor(t,e){I(this,j),I(this,V),I(this,W),I(this,F),I(this,B),N(this,L,{writable:!0,value:void 0}),N(this,P,{writable:!0,value:void 0}),N(this,D,{writable:!0,value:{x:0,y:0}}),_(this,L,t),_(this,P,e)}transformStart(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];H(this,B,$).call(this,{x:k(this,P).navigableHeaders()?k(this,P).countRowHeaders():0,y:k(this,P).navigableHeaders()?k(this,P).countColHeaders():0});let i=k(this,P).createCellCoords(t,e),n=k(this,L).current().highlight,o=k(this,P).visualToRenderableCoords(n),s=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),null!==o.row&&null!==o.col){let{width:t,height:e}=H(this,W,G).call(this),{row:o,col:a}=H(this,V,K).call(this,n),u=k(this,P).fixedRowsBottom(),h=k(this,P).minSpareRows(),c=k(this,P).minSpareCols(),d=k(this,P).autoWrapRow(),f=k(this,P).autoWrapCol(),g=k(this,P).createCellCoords(o+i.row,a+i.col);if(g.row>=e){let i=(0,T.sm)(r&&h>0&&0===u),n=g.col+1,o=k(this,P).createCellCoords(g.row-e,n>=t?n-t:n);this.runLocalHooks("beforeColumnWrap",i,H(this,j,X).call(this,o),n>=t),i.value?this.runLocalHooks("insertRowRequire",k(this,P).countRenderableRows()):f&&g.assign(o)}else if(g.row<0){let r=(0,T.sm)(f),i=g.col-1,n=k(this,P).createCellCoords(e+g.row,i<0?t+i:i);this.runLocalHooks("beforeColumnWrap",r,H(this,j,X).call(this,n),i<0),f&&g.assign(n)}if(g.col>=t){let i=(0,T.sm)(r&&c>0),n=g.row+1,o=k(this,P).createCellCoords(n>=e?n-e:n,g.col-t);this.runLocalHooks("beforeRowWrap",i,H(this,j,X).call(this,o),n>=e),i.value?this.runLocalHooks("insertColRequire",k(this,P).countRenderableColumns()):d&&g.assign(o)}else if(g.col<0){let r=(0,T.sm)(d),i=g.row-1,n=k(this,P).createCellCoords(i<0?e+i:i,t+g.col);this.runLocalHooks("beforeRowWrap",r,H(this,j,X).call(this,n),i<0),d&&g.assign(n)}let{rowDir:p,colDir:m}=H(this,F,z).call(this,g);s=p,l=m,n=H(this,j,X).call(this,g)}return this.runLocalHooks("afterTransformStart",n,s,l),n}transformEnd(t,e){H(this,B,$).call(this,{x:k(this,P).navigableHeaders()?k(this,P).countRowHeaders():0,y:k(this,P).navigableHeaders()?k(this,P).countColHeaders():0});let r=k(this,P).createCellCoords(t,e),i=k(this,L).current(),n=k(this,P).visualToRenderableCoords(i.highlight),o=i.to.clone(),s=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),null!==n.row&&null!==n.col){let{row:t,col:e}=H(this,V,K).call(this,i.to),n=k(this,P).createCellCoords(t+r.row,e+r.col),{rowDir:a,colDir:u}=H(this,F,z).call(this,n);s=a,l=u;let h=H(this,j,X).call(this,n);0===r.row&&0!==r.col?o.col=h.col:0!==r.row&&0===r.col?o.row=h.row:(o.row=h.row,o.col=h.col)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}function $(t){let{x:e,y:r}=t;_(this,D,{x:e,y:r})}function z(t){let{width:e,height:r}=H(this,W,G).call(this),i=0,n=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=r&&(i=1,t.row=r-1),t.col<0?(n=-1,t.col=0):t.col>0&&t.col>=e&&(n=1,t.col=e-1),{rowDir:i,colDir:n}}function G(){return{width:k(this,D).x+k(this,P).countRenderableColumns(),height:k(this,D).y+k(this,P).countRenderableRows()}}function K(t){let{row:e,col:r}=k(this,P).visualToRenderableCoords(t);return k(this,P).createCellCoords(k(this,D).y+e,k(this,D).x+r)}function X(t){let e=t.clone();return e.col=t.col-k(this,D).x,e.row=t.row-k(this,D).y,k(this,P).renderableToVisualCoords(e)}(0,T.jB)(U,M.Z);var Y=r(855),q=r(2836);function Z(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q(t,e,r){var i=tt(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function J(t,e){var r=tt(t,e,"get");return r.get?r.get.call(t):r.value}function tt(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var te=new WeakMap;class Selection{constructor(t,e){var r=this;Z(this,"settings",void 0),Z(this,"tableProps",void 0),Z(this,"inProgress",!1),Z(this,"selectedRange",new E((t,e,r)=>this.tableProps.createCellRange(t,e,r))),Z(this,"highlight",void 0),Z(this,"transformation",void 0),Z(this,"selectedByRowHeader",new Set),Z(this,"selectedByColumnHeader",new Set),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,te),te.set(this,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new b({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[(0,d.Ak)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,r)=>this.tableProps.createCellRange(t,e,r)}),this.transformation=new U(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("beforeModifyTransformStart",...e)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("afterModifyTransformStart",...e)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("beforeModifyTransformEnd",...e)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("afterModifyTransformEnd",...e)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("insertRowRequire",...e)}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("insertColRequire",...e)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("beforeRowWrap",...e)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.runLocalHooks("beforeColumnWrap",...e)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,n="multiple"===this.settings.selectionMode,o=(0,R.o8)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,s),(!n||n&&!o&&(0,R.o8)(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(i.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(t)}setRangeStartOnly(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,r)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;let e=t.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((r>0||i>0)&&(0===r&&e.col<0&&!n||0===i&&e.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();let s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),"single"===this.settings.selectionMode?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(e),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");let l=this.highlight.getFocus();l.clear(),this.highlight.isEnabledFor(o.t8,s.highlight)&&l.add(this.selectedRange.current().highlight).commit().syncWith(s);let a=this.getLayerLevel();a<this.highlight.layerLevel&&((0,p.Bk)(this.highlight.getAreas(),t=>void t.clear()),(0,p.Bk)(this.highlight.getLayeredAreas(),t=>void t.clear()),(0,p.Bk)(this.highlight.getRowHeaders(),t=>void t.clear()),(0,p.Bk)(this.highlight.getColumnHeaders(),t=>void t.clear()),(0,p.Bk)(this.highlight.getActiveRowHeaders(),t=>void t.clear()),(0,p.Bk)(this.highlight.getActiveColumnHeaders(),t=>void t.clear()),(0,p.Bk)(this.highlight.getActiveCornerHeaders(),t=>void t.clear()),(0,p.Bk)(this.highlight.getRowHighlights(),t=>void t.clear()),(0,p.Bk)(this.highlight.getColumnHighlights(),t=>void t.clear())),this.highlight.useLayerLevel(a);let u=this.highlight.createArea(),h=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),f=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),m=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(u.clear(),h.clear(),c.clear(),d.clear(),f.clear(),g.clear(),m.clear(),w.clear(),y.clear(),this.highlight.isEnabledFor(o.AI,s.highlight)&&(this.isMultiple()||a>=1)&&(u.add(s.from).add(s.to).commit(),h.add(s.from).add(s.to).commit(),1===a)){let t=this.selectedRange.previous();this.highlight.useLayerLevel(a-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(o.Nc,s.highlight)){if(!s.isSingleHeader()){let t=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),e=this.tableProps.createCellCoords(s.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),i=this.tableProps.createCellCoords(-1,s.to.col);"single"===this.settings.selectionMode?(c.add(t).commit(),d.add(r).commit(),w.add(t).commit(),y.add(r).commit()):(c.add(t).add(e).commit(),d.add(r).add(i).commit(),w.add(t).add(e).commit(),y.add(r).add(i).commit())}let t=!J(this,te)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||0===i&&this.isSelectedByRowHeader()),e=!J(this,te)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||0===r&&this.isSelectedByColumnHeader());t&&f.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),e&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),t&&e&&m.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){let t=(0,T.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,r))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{col:e}=t.getOuterTopStartCorner(),r=this.tableProps.countRowHeaders(),i=this.tableProps.countCols();return(r>0&&e<0||0===r)&&t.getWidth()===i};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let r=this.selectedRange.peekByIndex(t);return!!r&&e(r)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{row:e}=t.getOuterTopStartCorner(),r=this.tableProps.countColHeaders(),i=this.tableProps.countRows();return(r>0&&e<0||0===r)&&t.getHeight()===i};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let r=this.selectedRange.peekByIndex(t);return!!r&&e(r)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){let e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},n=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=r?-l:0,u=e?-s:0;if(0===a&&0===u&&(0===n||0===o))return;let h=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight,{focusPosition:c,disableHeadersHighlight:d}=i;Q(this,te,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(h=this.tableProps.createCellCoords((0,O.uZ)(c.row,a,n-1),(0,O.uZ)(c.col,u,o-1)));let f=this.tableProps.createCellCoords(a,u),g=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(f,void 0,h),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),Q(this,te,!1)}selectCells(t){var e=this;let r=(0,Y.AV)(t);if(r===Y.gk)return!1;if(r===Y.Kk)throw Error(q.e`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let i=(0,Y.S5)(r,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!t.some(t=>{let e=i(t),r=e.isValid(o);return!(r&&!e.containsHeaders()||r&&e.containsHeaders()&&e.isSingleHeader())});return s&&(this.clear(),(0,p.Bk)(t,t=>{let{from:e,to:r}=i(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(r.clone()),this.finish()})),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i="string"==typeof t?this.tableProps.propToCol(t):t,n="string"==typeof e?this.tableProps.propToCol(e):e,o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,u=this.tableProps.createCellCoords(a,i),h=this.tableProps.createCellCoords(o-1,n),c=this.tableProps.createCellRange(u,u,h).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:l});if(c){let t=0===l?0:(0,O.uZ)(r,a,-1),e=o-1,s=this.tableProps.createCellCoords(t,i),u=this.tableProps.createCellCoords(e,n),h=this.tableProps.createCellCoords((0,O.uZ)(r,a,o-1),i);this.runLocalHooks("beforeSelectColumns",s,u,h),s.row=t,u.row=e,this.setRangeStartOnly(s,void 0,h),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(u),this.runLocalHooks("afterSelectColumns",s,u,h),this.finish()}return c}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,n-1),u=this.tableProps.createCellRange(l,l,a).isValid({countRows:i,countCols:n,countRowHeaders:o,countColHeaders:0});if(u){let i=0===o?0:(0,O.uZ)(r,s,-1),l=n-1,a=this.tableProps.createCellCoords(t,i),u=this.tableProps.createCellCoords(e,l),h=this.tableProps.createCellCoords(t,(0,O.uZ)(r,s,n-1));this.runLocalHooks("beforeSelectRows",a,u,h),a.col=i,u.col=l,this.setRangeStartOnly(a,void 0,h),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(u),this.runLocalHooks("afterSelectRows",a,u,h),this.finish()}return u}refresh(){let t=this.highlight.getCustomSelections();if(t.forEach(t=>{t.commit()}),!this.isSelected())return;let e=this.highlight.getFocus(),r=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let t=0;t<this.selectedRange.size();t+=1){this.highlight.useLayerLevel(t);let e=this.highlight.createArea(),r=this.highlight.createLayeredArea(),i=this.highlight.createRowHeader(),n=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),u=this.highlight.createColumnHighlight();e.commit(),r.commit(),i.commit(),n.commit(),o.commit(),s.commit(),l.commit(),a.commit(),u.commit()}this.highlight.useLayerLevel(r)}}(0,T.jB)(Selection,M.Z);var tr=Selection},855:function(t,e,r){"use strict";r.d(e,{AV:function(){return d},I8:function(){return p},Kk:function(){return s},S5:function(){return f},X8:function(){return g},gk:function(){return l}}),r(2954),r(2916);var i=r(1648),n=r(9440),o=r(2518);let s=0,l=1,a=[3,2],u=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],h=Symbol("root"),c=Symbol("child");function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;if(e!==h&&e!==c)throw Error("The second argument is used internally only and cannot be overwritten.");let r=Array.isArray(t),n=e===h,o=s;if(r){let e=t[0];if(0===t.length)o=l;else if(n&&e instanceof i.Z)o=3;else if(n&&Array.isArray(e))o=d(e,c);else if(t.length>=2&&t.length<=4){let e=!t.some((t,e)=>!u[e].includes(typeof t));e&&(o=2)}}return o}function f(t){let{createCellCoords:e,createCellRange:r,keepDirection:i=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a.includes(t))throw Error("Unsupported selection ranges schema type was provided.");return function(s){let l=3===t,a=l?s.from.row:s[0],u=l?s.from.col:s[1],h=l?s.to.row:s[2],c=l?s.to.col:s[3];if("function"==typeof n&&("string"==typeof u&&(u=n(u)),"string"==typeof c&&(c=n(c))),(0,o.o8)(h)&&(h=a),(0,o.o8)(c)&&(c=u),!i){let t=a,e=u,r=h,i=c;a=Math.min(t,r),u=Math.min(e,i),h=Math.max(t,r),c=Math.max(e,i)}let d=e(a,u),f=e(h,c);return r(d,d,f)}}function g(t){let e=d(t.getSelected());if(e===s||e===l)return[];let r=f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;(0,n.Bk)(t.getSelected(),t=>{let{from:e,to:o}=r(t),s=Math.max(e.col,0),l=o.col-s+1;(0,n.Bk)(Array.from(Array(l),(t,e)=>s+e),t=>{i.has(t)||i.add(t)})});let o=Array.from(i).sort((t,e)=>t-e),a=(0,n.k$)(o,(t,e,r,i)=>(0!==r&&e===i[r-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return a}function p(t){let e=d(t.getSelected());if(e===s||e===l)return[];let r=f(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;(0,n.Bk)(t.getSelected(),t=>{let{from:e,to:o}=r(t),s=Math.max(e.row,0),l=o.row-s+1;(0,n.Bk)(Array.from(Array(l),(t,e)=>s+e),t=>{i.has(t)||i.add(t)})});let o=Array.from(i).sort((t,e)=>t-e),a=(0,n.k$)(o,(t,e,r,i)=>(0!==r&&e===i[r-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return a}},2659:function(t,e,r){"use strict";r.d(e,{I:function(){return n},W:function(){return i}});let i="gridDefault",n="editorManager.handlingEditor"},9366:function(t,e,r){"use strict";r.d(e,{xg:function(){return h}});var i=r(2659),n=r(7687);let o=[{name:"editorCloseAndSave",callback(t,e,r){let i=t._getEditorManager();i.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),i.moveSelectionAfterEnter(r.includes("shift"))}},{name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},{name:"editorFastOpen",callback(t,e){let{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},{name:"editorOpen",callback(t,e,r){let i=t._getEditorManager(),{highlight:o}=t.getSelectedRangeLast();o.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter():i.openEditor(null,e,!0):i.moveSelectionAfterEnter(r.includes("shift")),(0,n.mM)(e))}},{name:"extendCellsSelectionDown",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(null!==i){let r=t._createCellCoords(i,e.col),n=e.row-t.view.getFirstFullyVisibleRow(),o=Math.min(r.row-n,t.countRows()-1);t.selection.setRangeEnd(r),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(t){let{highlight:e,from:r,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,i.col,e.row)}},{name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:r}=t,{highlight:i,from:n,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){let i=r.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(i,o.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:i}=t.getSelectedRangeLast();i.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:i}=t.getSelectedRangeLast();i.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,r.getNearestNotHiddenIndex(0,1)))}},{name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:i,from:n,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,i))}}},{name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:r}=t,{highlight:i,from:n,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,i))}}},{name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:r}=t,{highlight:i,from:n,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){let i=r.getNearestNotHiddenIndex(0,1);e.setRangeStart(n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(i,o.col))}}},{name:"extendCellsSelectionToRows",callback(t){let{highlight:e,from:r,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,i.row,e.col)}},{name:"extendCellsSelectionUp",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(null!==i){let r=t._createCellCoords(i,e.col),n=e.row-t.view.getFirstFullyVisibleRow(),o=Math.max(r.row-n,0);t.selection.setRangeEnd(r),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(t){let{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight,n=t.countVisibleRows()+r;i===t.countRows()-1?n=1:i+n>t.countRows()&&(n=t.countRows()-i-1),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(t,e){let r=t.getSettings(),i="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;t.selection.transformStart(-i.row,-i.col)}},{name:"moveCellSelectionInlineStart",callback(t,e){let r=t.getSettings(),i="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;t.selection.transformStart(i.row,i.col)}},{name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===r&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,n=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-n-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),n=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(n,o))}},{name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:r}=t,i=t.getSelectedRangeLast().highlight.row,n=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===n&&(n=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,n))}},{name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:r}=t,{row:i}=t.getSelectedRangeLast().highlight,n=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===n&&(n=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,n))}},{name:"moveCellSelectionToMostTop",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},{name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,n=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(n,1),l=i.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,l))}},{name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(t){let{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight,n=-(t.countVisibleRows()+r);i===-r?n=-1:i+n<r&&(n=-(i+r)),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),r=t.view.getFirstFullyVisibleRow()-1,i=t.view.getFirstFullyVisibleColumn()-1,n=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,i),l=t._createCellCoords(n,o),a=t._createCellRange(s,s,l);if(!a.includes(e)&&(e.row>=0||e.col>=0)){let r={};if(e.col>=0){let i=Math.floor(t.countVisibleCols()/2);r.col=Math.max(e.col-i,0)}if(e.row>=0){let i=Math.floor(t.countVisibleRows()/2);r.row=Math.max(e.row-i,0)}t.scrollViewportTo({...r,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:r,col:i}=e[e.length-1].highlight.normalize(),n=t.getDataAtCell(r,i),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((e,s)=>{if(e>=0&&s>=0&&(e!==r||s!==i)){let{readOnly:r}=t.getCellMeta(e,s);r||o.set(`${e}x${s}`,[e,s,n])}});t.setDataAtCell(Array.from(o.values()))}}];function s(t){let e={};return o.forEach(r=>{let{name:i,callback:n}=r;e[i]=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return n(t,...r)}}),e}function l(t){let e=t.getShortcutManager().addContext("editor"),r=s(t),n={group:i.I};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>r.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>r.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}var a=r(2518);function u(t){let e=t.getShortcutManager().addContext("grid"),r=s(t),n={runOnlyIf:()=>{let{navigableHeaders:e}=t.getSettings();return(0,a.$K)(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:i.W};e.addShortcuts([{keys:[["F2"]],callback:t=>r.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>r.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:i.I,runOnlyIf:()=>(0,a.$K)(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>r.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>r.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function h(t){[l,u].forEach(e=>e(t))}},9949:function(t,e,r){"use strict";r.d(e,{U:function(){return T}}),r(2954);var i=r(2488),n=r(7687);r(2916);let o=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),s=t=>t.map(t=>{let e=t.toLowerCase();return o.has(e)?o.get(e):e}).sort().join("+"),l=t=>t.split("+"),a=RegExp("^(?:Key|Digit)([A-Z0-9])$"),u=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),h=t=>{let{key:e,code:r}=t,i=e;return a.test(r)?i=r.replace(a,"$1"):u.has(r)&&(i=r),i.toLowerCase()};var c=r(2518),d=r(8179),f=r(9488),g=r(2836);let p=Symbol("shortcut-context");function m(t){return(0,f.Kn)(t)&&t.__kindOf===p}let w=t=>{let e=(0,i.I)({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:t,callback:r,group:i,runOnlyIf:n=()=>!0,captureCtrl:o=!1,preventDefault:l=!0,stopPropagation:a=!1,relativeToGroup:u,position:h,forwardToContext:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,c.o8)(i))throw Error("You need to define the shortcut's group.");if(!1===(0,d.mf)(r))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw Error(g.e`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let p={callback:r,group:i,runOnlyIf:n,captureCtrl:o,preventDefault:l,stopPropagation:a};(0,c.$K)(u)&&([p.relativeToGroup,p.position]=[u,h]),m(f)&&(p.forwardToContext=f),t.forEach(t=>{let r=s(t),i=e.hasItem(r);if(i){let t=e.getItem(r),i=t.findIndex(t=>t.group===u);-1!==i?"before"===h?i-=1:i+=1:i=t.length,t.splice(i,0,p)}else e.addItem(r,[p])})},n=t=>{let r=s(t);e.removeItem(r)};return{__kindOf:p,addShortcut:r,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(t=>{(0,f._l)(e,(r,i)=>{!1===Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=e[i])}),r(t)})},getShortcuts:t=>{let r=s(t),i=e.getItem(r);return(0,c.$K)(i)?i.slice():[]},hasShortcut:t=>{let r=s(t);return e.hasItem(r)},removeShortcutsByKeys:n,removeShortcutsByGroup:t=>{let r=e.getItems();r.forEach(e=>{let[r,i]=e,o=i.filter(e=>e.group!==t);0===o.length?n(l(r)):(i.length=0,i.push(...o))})}}};var y=r(5878),b=r(2228);let C=["meta","alt","shift","control"],S=function(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),E=0,T=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:o,afterKeyDown:s}=t,l=(0,i.I)({errorIdExists:t=>`The "${t}" context name is already registered.`}),a="grid",u=()=>a,c=t=>l.getItem(t),d=!1,f=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u(),i=m(r)?r:c(r),o=!1;if(!i.hasShortcut(e))return o;let s=i.getShortcuts(e);for(let r=0;r<s.length;r++){let{callback:i,runOnlyIf:l,preventDefault:a,stopPropagation:u,captureCtrl:h,forwardToContext:c}=s[r];if(!0===l(t)){if(d=h,o=!1===i(t,e),d=!1,a&&t.preventDefault(),u&&((0,n.mM)(t),t.stopPropagation()),o)break;c&&f(t,e,c)}}return o},p=function(t,e,r,i,o){let s=t=>C.includes(t),l=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[];return t.altKey&&r.push("alt"),e&&(t.ctrlKey||t.metaKey)?r.push("control/meta"):(t.ctrlKey&&r.push("control"),t.metaKey&&r.push("meta")),t.shiftKey&&r.push("shift"),r},a=t=>{if(!1===e(t))return;let a=r(t);if(229===t.keyCode||!1===a||(0,n.Ty)(t))return;let u=h(t),c=[];s(u)||(c=l(t));let d=[u].concat(c),f=o(t,d);!f&&((0,b.eE)()&&c.includes("meta")||!(0,b.eE)()&&c.includes("control"))&&o(t,[u].concat(l(t,!0))),i(t)},u=t=>{let e=h(t);s(e)&&S.press(e)},c=t=>{let e=h(t);s(e)&&S.release(e)},d=()=>{S.releaseAll()};return{mount:()=>{let e=t;for(E+=1;e;)1===E&&(e.document.documentElement.addEventListener("keydown",u),e.document.documentElement.addEventListener("keyup",c)),e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("blur",d),e=(0,y.f5)(e)},unmount:()=>{let e=t;for(E-=1;e;)0===E&&(e.document.documentElement.removeEventListener("keydown",u),e.document.documentElement.removeEventListener("keyup",c)),e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("blur",d),e=(0,y.f5)(e)},isPressed:t=>S.isPressed(t),releasePressedKeys:()=>S.releaseAll()}}(e,r,o,s,f);return p.mount(),{addContext:t=>{let e=w(t);return l.addItem(t,e),e},getActiveContextName:u,getContext:c,setActiveContextName:t=>{if(!l.hasItem(t))throw Error(g.e`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=t},isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}}},2036:function(t,e,r){"use strict";r.d(e,{Z:function(){return _}}),r(2916),r(2954);var i=r(5878),n=r(9773),o=r(7687),s=r(6352);function l(t){let{isShiftKey:e,isLeftClick:r,isRightClick:i,coords:n,selection:o,controller:s,cellCoordsFactory:l}=t,a=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),h=o.isSelectedByRowHeader();if(e&&a)n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(n):(u||h)&&n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(l(n.row,n.col)):u&&n.row<0&&!s.column?o.setRangeEnd(l(a.to.row,n.col)):h&&n.col<0&&!s.row?o.setRangeEnd(l(n.row,a.to.col)):(!u&&!h&&n.col<0||u&&n.col<0)&&!s.row?o.selectRows(Math.max(a.from.row,0),n.row,n.col):(!u&&!h&&n.row<0||h&&n.row<0)&&!s.column&&o.selectColumns(Math.max(a.from.col,0),n.col,n.row);else{let t=!o.inInSelection(n),e=r||i&&t;n.row<0&&n.col>=0&&!s.column?e&&o.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?e&&o.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?e&&o.setRangeStart(n):n.col<0&&n.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}let a=new Map([["mousedown",l],["mouseover",function(t){let{isLeftClick:e,coords:r,selection:i,controller:n,cellCoordsFactory:o}=t;if(!e)return;let s=i.isSelectedByRowHeader(),l=i.isSelectedByColumnHeader(),a=i.tableProps.countCols(),u=i.tableProps.countRows();l&&!n.column?i.setRangeEnd(o(u-1,r.col)):s&&!n.row?i.setRangeEnd(o(r.row,a-1)):n.cell||i.setRangeEnd(r)}],["touchstart",l]]);function u(t,e){let{coords:r,selection:i,controller:n,cellCoordsFactory:s}=e;a.get(t.type)({coords:r,selection:i,controller:n,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:(0,o.pW)(t)||"touchstart"===t.type,isRightClick:(0,o.dO)(t)})}var h=r(3732),c=r(8200);function d(t,e){g(t,e),e.add(t)}function f(t,e,r){g(t,e),e.set(t,r)}function g(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function p(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function w(t,e){var r=b(t,e,"get");return r.get?r.get.call(t):r.value}function y(t,e,r){var i=b(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function b(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var C=new WeakMap,S=new WeakMap,E=new WeakMap,T=new WeakMap,R=new WeakMap,O=new WeakMap,M=new WeakMap,I=new WeakSet,N=new WeakSet;class x{constructor(t){d(this,N),d(this,I),p(this,"hot",void 0),p(this,"eventManager",void 0),p(this,"settings",void 0),p(this,"THEAD",void 0),p(this,"TBODY",void 0),p(this,"_wt",void 0),p(this,"activeWt",void 0),f(this,C,{writable:!0,value:0}),f(this,S,{writable:!0,value:0}),p(this,"postponedAdjustElementsSize",!1),f(this,E,{writable:!0,value:!1}),f(this,T,{writable:!0,value:void 0}),f(this,R,{writable:!0,value:void 0}),f(this,O,{writable:!0,value:0}),f(this,M,{writable:!0,value:0}),this.hot=t,this.eventManager=new n.Z(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){let r=this._wt.getCell(t,e);return r<0?null:r}scrollViewport(t,e,r,i,n){return this._wt.scrollViewport(t,e,r,i,n)}scrollViewportHorizontally(t,e,r){return this._wt.scrollViewportHorizontally(t,e,r)}scrollViewportVertically(t,e,r){return this._wt.scrollViewportVertically(t,e,r)}createElements(){let{rootElement:t,rootDocument:e}=this.hot,r=t.getAttribute("style");r&&t.setAttribute("data-originalstyle",r),(0,i.cn)(t,"handsontable"),y(this,R,e.createElement("TABLE")),(0,i.cn)(w(this,R),"htCore"),this.hot.getSettings().tableClassName&&(0,i.cn)(w(this,R),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,i.P$)(w(this,R),[(0,c.Rn)()]),(0,i.P$)(t,[(0,c.nO)(),(0,c.a2)(-1),(0,c.Wv)(this.hot.countCols()),(0,c.qt)()])),this.THEAD=e.createElement("THEAD"),w(this,R).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),w(this,R).appendChild(this.TBODY),this.hot.table=w(this,R),this.hot.container.insertBefore(w(this,R),this.hot.container.firstChild)}registerEvents(){let{rootElement:t,rootDocument:e,selection:r}=this.hot,n=e.documentElement;this.eventManager.addEventListener(t,"mousedown",t=>{if(y(this,E,!0),!this.isTextSelectionAllowed(t.target)){let{rootWindow:e}=this.hot;(0,i.a7)(e),t.preventDefault(),e.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{y(this,E,!1)}),this.eventManager.addEventListener(t,"mousemove",t=>{w(this,E)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&(0,i.a7)(this.hot.rootWindow),t.preventDefault())}),this.eventManager.addEventListener(n,"keyup",t=>{r.isInProgress()&&!t.shiftKey&&r.finish()}),this.eventManager.addEventListener(n,"mouseup",n=>{r.isInProgress()&&(0,o.pW)(n)&&r.finish(),y(this,T,!1);let s=(0,i.pV)(e.activeElement);(!(0,i.u7)(e.activeElement)||s)&&(!s&&(r.isSelected()||r.isSelectedByAnyHeader()||t.contains(n.target)||(0,o.dO)(n))||this.hot.unlisten())}),this.eventManager.addEventListener(n,"contextmenu",t=>{r.isInProgress()&&(0,o.dO)(t)&&(r.finish(),y(this,T,!1))}),this.eventManager.addEventListener(n,"touchend",()=>{r.isInProgress()&&r.finish(),y(this,T,!1)}),this.eventManager.addEventListener(n,"mousedown",r=>{let o=r.target,s=r.x||r.clientX,l=r.y||r.clientY,a=r.target;if(w(this,T)||!t||!this.hot.view)return;let{holder:u}=this.hot.view._wt.wtTable;if(a===u){let t=(0,i.np)(e);if(e.elementFromPoint(s+t,l)!==u||e.elementFromPoint(s,l+t)!==u)return}else for(;a!==n;){if(null===a){if(r.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}let h="function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(o):this.settings.outsideClickDeselects;h?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(w(this,R),"selectstart",t=>{this.settings.fragmentSelection||(0,i.u7)(t.target)||t.preventDefault()})}translateFromRenderableToVisualCoords(t){let{row:e,col:r}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,r))}translateFromRenderableToVisualIndex(t,e){let r=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,i=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===r&&(r=t),null===i&&(i=e),[r,i]}countRenderableIndexes(t,e){let r=Math.min(t.getNotTrimmedIndexesLength(),e),i=t.getNearestNotHiddenIndex(r-1,-1);return null===i?0:t.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,r,i){if(isNaN(t)||t<0)return 0;let n=r.getNearestNotHiddenIndex(t,e),o=r.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let s=0;return e<0?s=o+1:e>0&&(s=i-o),s}countNotHiddenFixedColumnsStart(){let t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){let t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){let t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let r=0;for(let i=t;i<=e;i++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)&&(r+=1);return r}countRenderableRowsInRange(t,e){let r=0;for(let i=t;i<=e;i++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){let t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){let t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:w(this,R),isDataViewInstance:()=>(0,h.isRootInstance)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let t=[];return this.hot.hasRowHeaders()&&t.push((t,e)=>{let r=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(r,e)}),this.hot.runHooks("afterGetRowHeaderRenderers",t),y(this,S,t.length),this.hot.getSettings().ariaTags&&m(this,I,k).call(this)===this.hot.countCols()&&m(this,N,H).call(this,w(this,S)),t},columnHeaders:()=>{let t=[];return this.hot.hasColHeaders()&&t.push((t,e)=>{let r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(r,e)}),this.hot.runHooks("afterGetColumnHeaderRenderers",t),y(this,C,t.length),t},columnWidth:t=>{let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{let e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,r)=>{let[i,n]=this.translateFromRenderableToVisualIndex(t,e),o=this.hot.runHooks("modifyGetCellCoords",i,n),s=i,l=n;Array.isArray(o)&&([s,l]=o);let a=this.hot.getCellMeta(s,l),u=this.hot.colToProp(l),h=this.hot.getDataAtRowProp(s,u);this.hot.hasHook("beforeValueRender")&&(h=this.hot.runHooks("beforeValueRender",h,a)),this.hot.runHooks("beforeRenderer",r,i,n,u,h,a),this.hot.getCellRenderer(a)(this.hot,r,i,n,u,h,a),this.hot.runHooks("afterRenderer",r,i,n,u,h,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,i.pn)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,r,i)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=i,y(this,T,!0),this.hot.runHooks("beforeOnCellMouseDown",t,n,r,s),(0,o.Ty)(t)||(u(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,n,r),this.activeWt=this._wt)},onCellContextMenu:(t,e,r,i)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=i,y(this,T,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,n,r),(0,o.Ty)(t)||(this.hot.runHooks("afterOnCellContextMenu",t,n,r),this.activeWt=this._wt)},onCellMouseOut:(t,e,r,i)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=i,this.hot.runHooks("beforeOnCellMouseOut",t,n,r),(0,o.Ty)(t)||(this.hot.runHooks("afterOnCellMouseOut",t,n,r),this.activeWt=this._wt)},onCellMouseOver:(t,e,r,i)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.activeWt=i,this.hot.runHooks("beforeOnCellMouseOver",t,n,r,s),(0,o.Ty)(t)||(w(this,T)&&u(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,n,r),this.activeWt=this._wt)},onCellMouseUp:(t,e,r,i)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=i,this.hot.runHooks("beforeOnCellMouseUp",t,n,r),(0,o.Ty)(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,n,r),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{let e=this.hot.rowIndexMapper,r=t<0,i=t;return r||null!==(i=e.getVisualFromRenderableIndex(t))?(i=this.hot.runHooks("beforeViewportScrollVertically",i),this.hot.runHooks("beforeViewportScroll"),r)?i:e.getRenderableFromVisualIndex(i):t},onBeforeViewportScrollHorizontally:t=>{let e=this.hot.columnIndexMapper,r=t<0,i=t;return r||null!==(i=e.getVisualFromRenderableIndex(t))?(i=this.hot.runHooks("beforeViewportScrollHorizontally",i),this.hot.runHooks("beforeViewportScroll"),r)?i:e.getRenderableFromVisualIndex(i):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,r)=>{let i=this.hot.rowIndexMapper,n=t<0,o=t;n||(o=i.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingRowHeader",o,e,r);return n?s:i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,r)=>{let i=this.hot.columnIndexMapper,n=t<0,o=t;n||(o=i.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingColumnHeader",o,e,r);return n?s:i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,r)=>{let i;let[n,o]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange(),l=s.size();if(l>0){let t=s.peekByIndex(null!=r?r:0);i=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",n,o,i,r)},onBeforeDrawBorders:(t,e)=>{let[r,i,n,o]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{let r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,r)=>{let i=this.hot.rowIndexMapper,n=this.hot.columnIndexMapper,o=e>=0?n.getVisualFromRenderableIndex(e):e,s=t>=0?i.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,o,r);if(Array.isArray(l)){let[t,e,r,o]=l;return[t>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){let r=this.countRenderableRows(),i=t.startRow,n=t.endRow;if("number"==typeof e)t.startRow=Math.max(i-e,0),t.endRow=Math.min(n+e,r-1);else if("auto"===e){let e=Math.ceil(n/r*12);t.startRow=Math.max(i-e,0),t.endRow=Math.min(n+e,r-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){let r=this.countRenderableColumns(),i=t.startColumn,n=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(i-e,0),t.endColumn=Math.min(n+e,r-1)),"auto"===e){let e=Math.ceil(n/r*6);t.startColumn=Math.max(i-e,0),t.endColumn=Math.min(n+e,r-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new s.Z(t),this.activeWt=this._wt;let e=this._wt.wtTable.spreader,{width:r,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,n),this.eventManager.addEventListener(e,"mousedown",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(e,"contextmenu",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(t){if((0,i.u7)(t))return!0;let e=(0,i.MO)(t,this.hot.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return w(this,T)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){let t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){let r=e.firstChild;if(!(0,i.pv)(r,"relative")){(0,i.cS)(e),this.appendRowHeader(t,e);return}this.updateCellHeader(r.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{let{rootDocument:r,getRowHeader:i}=this.hot,n=r.createElement("div"),o=r.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,t,i),n.appendChild(o),e.appendChild(n)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){let o=e.firstChild;(0,i.pv)(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,r,n):((0,i.cS)(e),this.appendColHeader(t,e,r,n))}else{let{rootDocument:o}=this.hot,s=o.createElement("div"),l=o.createElement("span");s.className="relative",l.className="colHeader",this.settings.ariaTags&&((0,i.P$)(s,...(0,c.Rn)()),(0,i.P$)(l,...(0,c.Rn)())),this.updateCellHeader(l,t,r,n),s.appendChild(l),e.appendChild(s)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&((0,i.pv)(t,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(e):(0,i.pv)(t,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(e))),o>-1?(0,i.uS)(t,r(e,n)):((0,i.tT)(t,String.fromCharCode(160)),(0,i.cn)(t,"cornerHeader"))}maximumVisibleElementWidth(t){let e=this._wt.wtViewport.getWorkspaceWidth(),r=e-t;return r>0?r:0}maximumVisibleElementHeight(t){let e=this._wt.wtViewport.getWorkspaceHeight(),r=e-t;return r>0?r:0}setLastSize(t,e){y(this,O,t),y(this,M,e)}getLastSize(){return{width:w(this,O),height:w(this,M)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return w(this,C)}getRowHeadersCount(){return w(this,S)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function k(){return parseInt(this.hot.rootElement.getAttribute((0,c.Wv)()[0]),10)}function H(t){let e=m(this,I,k).call(this)+t;(0,i.P$)(this.hot.rootElement,...(0,c.Wv)(e))}var _=x},9291:function(t,e,r){"use strict";r.d(e,{d:function(){return P}}),r(2954);var i=r(9440),n=r(6301),o=r(7362),s=r(5724);class l extends n.n{constructor(){super(t=>t)}insert(t,e){let r=(0,s.X)(this.indexedValues,e);this.indexedValues=(0,o.S)(r,t,e),super.insert(t,e)}remove(t){let e=(0,o.t)(this.indexedValues,t);this.indexedValues=(0,s.i)(e,t),super.remove(t)}}var a=r(7392),u=r(537),h=r(5843),c=r(6592);let d=new Map([["hiding",a.o],["index",n.n],["linkedPhysicalIndexToValue",u.A],["physicalIndexToValue",h.L],["trimming",c.n]]);r(2916);var f=r(2518),g=r(9488),p=r(3437);let m=0;class w{constructor(){var t,e,r;t="collection",e=new Map,(t="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string"))?r:String(r))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",()=>this.runLocalHooks("change",e)),m+=1)}unregister(t){let e=this.collection.get(t);(0,f.$K)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),m-=1)}unregisterAll(){this.collection.forEach((t,e)=>this.unregister(e)),this.collection.clear()}get(t){return(0,f.o8)(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,e){this.collection.forEach(r=>{r.insert(t,e)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}function y(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}(0,g.jB)(w,p.Z);class b extends w{constructor(t,e){super(),y(this,"mergedValuesCache",[]),y(this,"aggregationFunction",void 0),y(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];let e=(0,i.Sc)(this.get(),t=>t.getValues()),r=[],n=(0,f.$K)(e[0])&&e[0].length||0;for(let t=0;t<n;t+=1){let i=[];for(let r=0;r<this.getLength();r+=1)i.push(e[r][t]);r.push(i)}return(0,i.Sc)(r,this.aggregationFunction)}getMergedValueAtIndex(t,e){let r=this.getMergedValues(e)[t];return(0,f.$K)(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function C(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}var S=new WeakMap;class E{constructor(){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,S),S.set(this,{writable:!0,value:[]})}subscribe(t){var e;return this.addLocalHook("change",t),this._write((e=C(this,S,"get")).get?e.get.call(this):e.value),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){!function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(this,C(this,S,"set"),t)}}function T(t,e){let r=[],i=0,n=0;for(;i<t.length&&n<e.length;i++,n++)t[i]!==e[n]&&r.push({op:"replace",index:n,oldValue:t[i],newValue:e[n]});for(;i<e.length;i++)r.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;n<t.length;n++)r.push({op:"remove",index:n,oldValue:t[n],newValue:void 0});return r}function R(t,e,r){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function O(t,e){var r=I(t,e,"get");return r.get?r.get.call(t):r.value}function M(t,e,r){var i=I(t,e,"set");return function(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=r}}(t,i,r),r}function I(t,e,r){if(!e.has(t))throw TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}(0,g.jB)(E,p.Z);var N=new WeakMap,x=new WeakMap,k=new WeakMap,H=new WeakMap,_=new WeakMap;class A{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(this,N,{writable:!0,value:new Set}),R(this,x,{writable:!0,value:[]}),R(this,k,{writable:!0,value:[]}),R(this,H,{writable:!0,value:!1}),R(this,_,{writable:!0,value:!1}),M(this,_,null!=t&&t)}createObserver(){let t=new E;return O(this,N).add(t),t.addLocalHook("unsubscribe",()=>{O(this,N).delete(t)}),t._writeInitialChanges(T(O(this,x),O(this,k))),t}emit(t){let e=O(this,k);O(this,H)&&O(this,x).length===t.length||(0===t.length?t=Array(e.length).fill(O(this,_)):M(this,x,Array(t.length).fill(O(this,_))),O(this,H)||(M(this,H,!0),e=O(this,x)));let r=T(e,t);O(this,N).forEach(t=>t._write(r)),M(this,k,t)}}function L(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class P{constructor(){L(this,"indexesSequence",new l),L(this,"trimmingMapsCollection",new b(t=>t.some(t=>!0===t),!1)),L(this,"hidingMapsCollection",new b(t=>t.some(t=>!0===t),!1)),L(this,"variousMapsCollection",new w),L(this,"hidingChangesObservable",new A({initialIndexValue:!1})),L(this,"notTrimmedIndexesCache",[]),L(this,"notHiddenIndexesCache",[]),L(this,"isBatched",!1),L(this,"indexesSequenceChanged",!1),L(this,"indexesChangeSource",void 0),L(this,"trimmedIndexesChanged",!1),L(this,"hiddenIndexesChanged",!1),L(this,"renderablePhysicalIndexesCache",[]),L(this,"fromPhysicalToVisualIndexesCache",new Map),L(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",t=>{this.runLocalHooks("change",t,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,r){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!d.has(t))throw Error(`The provided map type ("${t}") does not exist.`);return new(d.get(t))(e)}(e,r))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof c.n?this.trimmingMapsCollection.register(t,e):e instanceof a.o?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);let r=this.getNumberOfIndexes();return r>0&&e.init(r),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){let e=this.notTrimmedIndexesCache[t];return(0,f.$K)(e)?e:null}getPhysicalFromRenderableIndex(t){let e=this.renderablePhysicalIndexesCache[t];return(0,f.$K)(e)?e:null}getVisualFromPhysicalIndex(t){let e=this.fromPhysicalToVisualIndexesCache.get(t);return(0,f.$K)(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){let e=this.fromVisualToRenderableIndexesCache.get(t);return(0,f.$K)(e)?e:null}getNearestNotHiddenIndex(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getPhysicalFromVisualIndex(t);if(null===i)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;let n=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return -1===(o=e>0?n.findIndex(e=>e>t):n.reverse().findIndex(e=>e<t))?r?this.getNearestNotHiddenIndex(t,-e,!1):null:n[o]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(t).keys()],this.notHiddenIndexesCache=[...Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){let e=this.getNumberOfIndexes();if(t<e){let e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t);this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;let e=this.getIndexesSequence();return e.filter(t=>!1===this.isTrimmed(t))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.notHiddenIndexesCache;let e=this.getIndexesSequence();return e.filter(t=>!1===this.isHidden(t))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;let e=this.getNotTrimmedIndexes();return e.filter(t=>!1===this.isHidden(t))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);let r=(0,i.Sc)(t,t=>this.getPhysicalFromVisualIndex(t)),n=this.getNotTrimmedIndexesLength(),s=t.length,l=(0,o.t)(this.getIndexesSequence(),r),a=l.filter(t=>!1===this.isTrimmed(t)),u=l.indexOf(a[a.length-1])+1;if(e+s<n){let t=a[e];u=l.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence((0,o.S)(l,u,r)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){let r=this.getNotTrimmedIndexes()[t],n=(0,f.$K)(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=(0,i.Sc)(Array(e).fill(n),(t,e)=>t+e);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){let t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromRenderableIndex(e),r=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(r,e)}}}(0,g.jB)(P,p.Z)},7392:function(t,e,r){"use strict";r.d(e,{o:function(){return o}}),r(2916);var i=r(5843),n=r(9440);class o extends i.L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return(0,n.k$)(this.getValues(),(t,e,r)=>(e&&t.push(r),t),[])}}},6301:function(t,e,r){"use strict";r.d(e,{n:function(){return a}}),r(2916),r(2954);var i=r(7790),n=r(9488),o=r(8179),s=r(3437);function l(t,e,r){var i;return(e="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?i:String(i))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,"indexedValues",[]),l(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){let e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,o.mf)(this.initValueOrFn)?(0,i.q4)(t-1,t=>this.indexedValues.push(this.initValueOrFn(t))):(0,i.q4)(t-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,n.jB)(a,s.Z)},537:function(t,e,r){"use strict";r.d(e,{A:function(){return a}}),r(2954);var i=r(6301),n=r(1825),o=r(7362),s=r(5724),l=r(8179);class a extends i.n{constructor(){var t,e,r;super(...arguments),e=[],(t="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="orderOfIndexes","string"))?r:String(r))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}getValues(){return this.orderOfIndexes.map(t=>this.indexedValues[t])}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(r,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=(0,o.t)(this.orderOfIndexes,[t]),(0,l.mf)(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=(0,n.S)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=(0,s.X)(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=(0,n.t)(this.indexedValues,t),this.orderOfIndexes=(0,o.t)(this.orderOfIndexes,t),this.orderOfIndexes=(0,s.i)(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map(t=>[t,this.getValueAtIndex(t)])}}},5843:function(t,e,r){"use strict";r.d(e,{L:function(){return o}});var i=r(6301),n=r(1825);class o extends i.n{insert(t,e){this.indexedValues=(0,n.S)(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=(0,n.t)(this.indexedValues,t),super.remove(t)}}},6592:function(t,e,r){"use strict";r.d(e,{n:function(){return o}}),r(2916);var i=r(5843),n=r(9440);class o extends i.L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return(0,n.k$)(this.getValues(),(t,e,r)=>(e&&t.push(r),t),[])}}},5724:function(t,e,r){"use strict";r.d(e,{X:function(){return o},i:function(){return n}});var i=r(9440);function n(t,e){return(0,i.Sc)(t,t=>t-e.filter(e=>e<t).length)}function o(t,e){let r=e[0],n=e.length;return(0,i.Sc)(t,t=>t>=r?t+n:t)}},7362:function(t,e,r){"use strict";r.d(e,{S:function(){return n},t:function(){return o}});var i=r(9440);function n(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function o(t,e){return(0,i.w7)(t,t=>!1===e.includes(t))}},1825:function(t,e,r){"use strict";r.d(e,{S:function(){return o},t:function(){return s}});var i=r(8179),n=r(9440);function o(t,e,r,n){let o=r.length?r[0]:void 0;return[...t.slice(0,o),...r.map((t,e)=>(0,i.mf)(n)?n(t,e):n),...void 0===o?[]:t.slice(o)]}function s(t,e){return(0,n.w7)(t,(t,r)=>!1===e.includes(r))}},2488:function(t,e,r){"use strict";r.d(e,{I:function(){return o}}),r(2954);var i=r(8179);let n=t=>`The id '${t}' is already declared in a map.`;function o(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Map;function r(){return[...e]}function o(t){return e.has(t)}return t=(0,i.mf)(t)?t:n,{addItem:function(r,i){if(o(r))throw Error(t(r));e.set(r,i)},clear:function(){e.clear()},getId:function(t){let[e]=r().find(e=>{let[r,i]=e;return t===i&&r})||[null];return e},getItem:function(t){return e.get(t)},getItems:r,hasItem:o,removeItem:function(t){return e.delete(t)}}}},4350:function(t,e,r){"use strict";r.d(e,{BU:function(){return a},bt:function(){return l},vo:function(){return s}}),r(2916);var i=r(2518);let n={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},o=RegExp(Object.keys(n).map(t=>`(${t})`).join("|"),"gi");function s(t){let e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...n),s=o.length,l=s>0?o[0].length:0,a=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=r?1:0,d=e?1:0;for(let n=0;n<s;n+=1){let s=e&&0===n,a=[];for(let e=0;e<l;e+=1){let l=!s&&r&&0===e,u="";if(s)u=`<th>${t.getColHeader(e-c)}</th>`;else if(l)u=`<th>${t.getRowHeader(n-d)}</th>`;else{let r=o[n][e],{hidden:s,rowspan:l,colspan:a}=t.getCellMeta(n-d,e-c);if(!s){let t=[];if(l&&t.push(`rowspan="${l}"`),a&&t.push(`colspan="${a}"`),(0,i.xb)(r))u=`<td ${t.join(" ")}></td>`;else{let e=r.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");u=`<td ${t.join(" ")}>${e}</td>`}}}a.push(u)}let f=["<tr>",...a,"</tr>"].join("");s?u.splice(1,0,f):h.splice(-1,0,f)}return a.splice(1,0,u.join(""),h.join("")),a.join("")}function l(t){let e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){let o=t[n],s=o.length,l=[];0===n&&r.push("<tbody>");for(let t=0;t<s;t+=1){let e=o[t],r=(0,i.xb)(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;");l.push(`<td>${r}</td>`)}r.push("<tr>",...l,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function a(t){var e;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,i={},s=r.createDocumentFragment(),l=r.createElement("div");s.appendChild(l);let a=t;if("string"==typeof a){let t=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,t=>{let e=t.match(/<td\b[^>]*?>/g)[0],r=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${e}${r}</td>`});l.insertAdjacentHTML("afterbegin",`${t}`),a=l.querySelector("table")}if(!a||"TABLE"!==((e=a)&&e.nodeName||""))return;let u=l.querySelector('meta[name$="enerator"]'),h=null!==a.querySelector("tbody th"),c=a.querySelector("tr"),d=c?Array.from(c.cells).reduce((t,e)=>t+e.colSpan,0)-(h?1:0):0,f=a.tFoot&&Array.from(a.tFoot.rows)||[],g=[],p=!1,m=0,w=0;if(a.tHead){let t=Array.from(a.tHead.rows).filter(t=>{let e=null!==t.querySelector("td");return e&&g.push(t),!e});p=(m=t.length)>0,m>1?i.nestedHeaders=Array.from(t).reduce((t,e)=>{let r=Array.from(e.cells).reduce((t,e,r)=>{if(h&&0===r)return t;let{colSpan:i,innerHTML:n}=e;return t.push(i>1?{label:n,colspan:i}:n),t},[]);return t.push(r),t},[]):p&&(i.colHeaders=Array.from(t[0].children).reduce((t,e,r)=>(h&&0===r||t.push(e.innerHTML),t),[]))}g.length&&(i.fixedRowsTop=g.length),f.length&&(i.fixedRowsBottom=f.length);let y=[...g,...Array.from(a.tBodies).reduce((t,e)=>(t.push(...Array.from(e.rows)),t),[]),...f];w=y.length;let b=Array(w);for(let t=0;t<w;t++)b[t]=Array(d);let C=[],S=[];for(let t=0;t<w;t++){let e=y[t],r=Array.from(e.cells),i=r.length;for(let e=0;e<i;e++){let i=r[e],{nodeName:s,innerHTML:l,rowSpan:a,colSpan:h}=i,c=b[t].findIndex(t=>void 0===t);if("TD"===s){if(a>1||h>1){for(let e=t;e<t+a;e++)if(e<w)for(let t=c;t<c+h;t++)b[e][t]=null;let e=i.getAttribute("style"),r=e&&e.includes("mso-ignore:colspan");r||C.push({col:c,row:t,rowspan:a,colspan:h})}let e="";e=u&&/excel/gi.test(u.content)?l.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):l.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),b[t][c]=e.replace(o,t=>n[t])}else S.push(l)}}return C.length&&(i.mergeCells=C),S.length&&(i.rowHeaders=S),b.length&&(i.data=b),i}},3732:function(t,e,r){"use strict";r.r(e),r.d(e,{hasValidParameter:function(){return s},holder:function(){return i},isRootInstance:function(){return l},registerAsRootInstance:function(){return o},rootInstanceSymbol:function(){return n}});let i=new WeakMap,n=Symbol("rootInstance");function o(t){i.set(t,!0)}function s(t){return t===n}function l(t){return i.has(t)}},2656:function(t,e,r){"use strict";r.d(e,{Z:function(){return n}});let i=new Map;function n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";i.has(t)||i.set(t,new Map);let e=i.get(t);return{register:function(t,r){e.set(t,r)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}},2740:function(t,e,r){"use strict";r.d(e,{Ie:function(){return h},Te:function(){return u},oh:function(){return s}}),r(2954);var i=r(2656);let{register:n,getItem:o,hasItem:s,getNames:l,getValues:a}=(0,i.Z)("validators");function u(t){if("function"==typeof t)return t;if(!s(t))throw Error(`No registered validator found under "${t}" name`);return o(t)}function h(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),n(t,e)}},5938:function(t){"use strict";t.exports=JSON.parse('{"nodes":[{"id":"","group":"","year":-800},{"id":"","group":"","year":-800},{"id":"","group":"","year":8},{"id":"","group":"","year":-30},{"id":" ","group":" ","year":17},{"id":"","group":"","year":-322},{"id":" ","group":"","year":-430},{"id":"","group":"","year":-441},{"id":"","group":"","year":-410},{"id":" ","group":""},{"id":"","group":"","year":1321},{"id":"","group":" ","year":1532},{"id":"","group":" ","year":1516},{"id":"","group":" ","year":1601},{"id":"","group":" ","year":1604},{"id":"","group":" ","year":1606},{"id":"","group":" ","year":1605},{"id":" ","group":" ","year":1595},{"id":" ","group":" "},{"id":"  ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"","group":" ","year":1651},{"id":"","group":" ","year":1687},{"id":" ","group":" ","year":1726},{"id":" ","group":""},{"id":"","group":" "},{"id":"   ","group":" "},{"id":"  ","group":" "},{"id":"","group":" "},{"id":"  ","group":"","year":1759},{"id":"   ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":"","group":""},{"id":" ","group":" ","year":1787},{"id":"   ","group":" ","year":1782},{"id":" 120   ","group":" ","year":1785},{"id":" ","group":" ","year":1797},{"id":"  ","group":""},{"id":"","group":"   "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" ","year":1857},{"id":"","group":" "},{"id":"  ","group":""},{"id":" ","group":""},{"id":"  ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":" ","group":" ","year":1903},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"  ","group":" "},{"id":" ","group":" ","year":1912},{"id":"  ","group":" ","year":1913},{"id":" ","group":" "},{"id":"   ","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"","group":" ","year":1927},{"id":" ","group":" ","year":1925},{"id":"","group":" ","year":1928},{"id":" ","group":" ","year":1929},{"id":"3","group":" ","year":1938},{"id":"","group":" ","year":1912},{"id":"","group":" ","year":1917},{"id":"","group":" "},{"id":"","group":" "},{"id":"  ","group":" "},{"id":"","group":" ","year":1912},{"id":" ","group":" ","year":1922},{"id":" ","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"","group":""},{"id":"","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":"  "},{"id":" ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" ","year":1960},{"id":"","group":" ","year":1956},{"id":" ","group":" "},{"id":"","group":" ","year":1950},{"id":"","group":" "},{"id":"","group":"","year":1993},{"id":" ","group":"","year":1996},{"id":"Q","group":""},{"id":"","group":" ","year":2001},{"id":"","group":" ","year":1994},{"id":"","group":" ","year":2005},{"id":" ","group":" ","year":2020},{"id":" ","group":" "},{"id":"","group":" "},{"id":" 6","group":" "},{"id":"","group":"  "},{"id":"","group":"  "},{"id":" ","group":" "},{"id":" ","group":"E.H. "},{"id":" ","group":" "},{"id":"","group":""},{"id":" ","group":"  "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":""},{"id":" ","group":""},{"id":" ","group":"J.D. "},{"id":" ","group":"  "},{"id":"","group":" "},{"id":"5 ","group":" "},{"id":"","group":""},{"id":"","group":""},{"id":"","group":" "},{"id":" ","group":" "},{"id":"","group":""},{"id":"","group":"  "},{"id":"","group":" "},{"id":"  ","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":" ","group":"  "},{"id":"  ","group":""},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"1984","group":" "},{"id":" ","group":" S. "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"   ","group":" "},{"id":"  ","group":" "},{"id":"  ","group":" "},{"id":" ","group":"D.H. "},{"id":"  ","group":"  "},{"id":"   ","group":" "},{"id":"","group":""},{"id":"","group":""},{"id":"","group":" "},{"id":"","group":" "},{"id":"  ","group":"  "},{"id":"  ","group":" "},{"id":"","group":" "},{"id":"","group":""},{"id":"","group":" "},{"id":"","group":"  "},{"id":", ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":"    ","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":"  ","group":""},{"id":"  ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"  ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":"  "},{"id":"21 ","group":" "},{"id":" ","group":"  "},{"id":" ","group":" "},{"id":"   ","group":" "},{"id":"","group":" "},{"id":"","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":" ","group":" "},{"id":"","group":" "},{"id":" ","group":""},{"id":"    ","group":" ","year":1896},{"id":"   ","group":" ","year":1896},{"id":"  ","group":" ","year":1886},{"id":" ","group":" "},{"id":"  ","group":" ","year":1896},{"id":"","group":" ","year":2001},{"id":"","group":" ","year":1965},{"id":"  ","group":" ","year":1859}],"links":[{"source":"","target":"","description":""},{"source":" ","target":"","description":" "},{"source":" ","target":"","description":" "},{"source":" ","target":" ","description":" "},{"source":" ","target":" ","description":" , "},{"source":"  ","target":"","description":" "},{"source":"  ","target":"","description":" "},{"source":"  ","target":"  ","description":"   "},{"source":" ","target":"  ","description":" "},{"source":"  ","target":"    ","description":" "},{"source":" 120   ","target":"   ","description":" , "},{"source":" ","target":"1984","description":""},{"source":"","target":"1984","description":""},{"source":"","target":" ","description":""},{"source":"  ","target":"","description":" , "},{"source":"","target":" ","description":""},{"source":"","target":" ","description":""},{"source":"","target":" ","description":""},{"source":"","target":" ","description":""},{"source":" ","target":"","description":" , "},{"source":" ","target":"  ","description":""},{"source":"  ","target":" 120   ","description":", "},{"source":" ","target":"  ","description":", "},{"source":" ","target":" ","description":", "},{"source":"  ","target":"","description":" "},{"source":"","target":"","description":", "},{"source":"   ","target":"","description":" , , "},{"source":" 120   ","target":" ","description":", "},{"source":" 120   ","target":"","description":""},{"source":" 120   ","target":"  ","description":", "},{"source":" 120   ","target":"  ","description":""},{"source":" ","target":" ","description":""},{"source":" ","target":" ","description":""},{"source":" ","target":"","description":""},{"source":" ","target":" ","description":""},{"source":" ","target":"","description":""},{"source":"   ","target":"","description":""},{"source":"   ","target":"","description":""},{"source":"","target":"","description":""},{"source":"","target":"","description":", "},{"source":"","target":" ","description":", , "},{"source":" ","target":" ","description":", "},{"source":" ","target":"","description":", , "},{"source":" ","target":"  ","description":", ,  "},{"source":" ","target":"","description":", "},{"source":" ","target":" ","description":", "},{"source":" ","target":"","description":", , "},{"source":" ","target":"","description":", "},{"source":"","target":"","description":", "},{"source":"","target":"","description":", "},{"source":"","target":"","description":" , "},{"source":"","target":"  ","description":" "},{"source":"","target":"  ","description":" ,  "},{"source":" ","target":"  ","description":" , "},{"source":" ","target":"","description":" "},{"source":" ","target":"","description":" , "},{"source":"","target":"","description":""},{"source":"","target":"","description":", "},{"source":" ","target":" ","description":", ,  , "},{"source":" ","target":"","description":""},{"source":" ","target":"","description":", "},{"source":"","target":"  ","description":" , "},{"source":"","target":"    ","description":" , "},{"source":" ","target":"  ","description":" "},{"source":" ","target":"  ","description":", "},{"source":" ","target":"  ","description":", "}]}')}},function(t){t.O(0,[121,66,990,622,971,472,744],function(){return t(t.s=9514)}),_N_E=t.O()}]);